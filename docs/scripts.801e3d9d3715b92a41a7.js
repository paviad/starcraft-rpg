if(function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.jSuites=t()}(this,function(){"use strict";var e=function(e){return{init:function(){}}};return(e.ajax=function(t,o){if(Array.isArray(t)){var n={instance:[],complete:o};if(t.length>0)for(var i=0;i<t.length;i++)t[i].multiple=n,n.instance.push(e.ajax(t[i]));return n}if(t.data||(t.data={}),t.type&&(t.method=t.type),t.method||(t.method="GET"),t.dataType||(t.dataType="json"),t.data){var r=function(e,t){var o=[],n=Object.keys(e);if(n.length)for(var i=0;i<n.length;i++){if(t)var s=t+"["+n[i]+"]";else s=n[i];if("object"==typeof e[n[i]])for(var a=r(e[n[i]],s),l=Object.keys(a),u=0;u<l.length;u++)o[l[u]]=a[l[u]];else o[s]=e[n[i]]}return o},s=[],a=r(t.data),l=Object.keys(a);for(i=0;i<l.length;i++)s.push(l[i]+"="+encodeURIComponent(a[l[i]]));"GET"==t.method&&s.length>0&&(t.url.indexOf("?")<0&&(t.url+="?"),t.url+=s.join("&"))}var u=new XMLHttpRequest;return u.open(t.method,t.url,!0),u.setRequestHeader("X-Requested-With","XMLHttpRequest"),"POST"==t.method?(u.setRequestHeader("Accept","application/json"),u.setRequestHeader("Content-Type","application/x-www-form-urlencoded")):"json"==t.dataType&&u.setRequestHeader("Content-Type","text/json"),1!=t.cache&&(u.setRequestHeader("pragma","no-cache"),u.setRequestHeader("cache-control","no-cache")),1==t.withCredentials&&(u.withCredentials=!0),"function"==typeof t.beforeSend&&t.beforeSend(u),u.onload=function(){if(200===u.status)if("json"==t.dataType)try{var o=JSON.parse(u.responseText);t.success&&"function"==typeof t.success&&t.success(o)}catch(i){t.error&&"function"==typeof t.error&&t.error(i,o)}else o=u.responseText,t.success&&"function"==typeof t.success&&t.success(o);else t.error&&"function"==typeof t.error&&t.error(u.responseText);if(e.ajax.queue&&e.ajax.queue.length>0&&e.ajax.send(e.ajax.queue.shift()),e.ajax.requests&&e.ajax.requests.length){var n=e.ajax.requests.indexOf(u);e.ajax.requests.splice(n,1),e.ajax.requests.length||t.complete&&"function"==typeof t.complete&&t.complete(o),t.multiple&&t.multiple.instance&&(n=t.multiple.instance.indexOf(u),t.multiple.instance.splice(n,1),t.multiple.instance.length||t.multiple.complete&&"function"==typeof t.multiple.complete&&t.multiple.complete(o))}},u.data=s,1==t.queue&&e.ajax.requests.length>0?e.ajax.queue.push(u):e.ajax.send(u),u}).send=function(t){t.data?t.send(t.data.join("&")):t.send(),e.ajax.requests.push(t)},e.ajax.exists=function(e,t){var o=new XMLHttpRequest;o.open("HEAD",e,!1),o.send(),o.status&&t(o.status)},e.ajax.requests=[],e.ajax.queue=[],e.alert=function(t){e.getWindowWidth()<800&&e.dialog?e.dialog.open({title:"Alert",message:t}):alert(t)},(e.animation={}).slideLeft=function(e,t,o){1==t?(e.classList.add("slide-left-in"),setTimeout(function(){e.classList.remove("slide-left-in"),"function"==typeof o&&o()},400)):(e.classList.add("slide-left-out"),setTimeout(function(){e.classList.remove("slide-left-out"),"function"==typeof o&&o()},400))},e.animation.slideRight=function(e,t,o){1==t?(e.classList.add("slide-right-in"),setTimeout(function(){e.classList.remove("slide-right-in"),"function"==typeof o&&o()},400)):(e.classList.add("slide-right-out"),setTimeout(function(){e.classList.remove("slide-right-out"),"function"==typeof o&&o()},400))},e.animation.slideTop=function(e,t,o){1==t?(e.classList.add("slide-top-in"),setTimeout(function(){e.classList.remove("slide-top-in"),"function"==typeof o&&o()},400)):(e.classList.add("slide-top-out"),setTimeout(function(){e.classList.remove("slide-top-out"),"function"==typeof o&&o()},400))},e.animation.slideBottom=function(e,t,o){1==t?(e.classList.add("slide-bottom-in"),setTimeout(function(){e.classList.remove("slide-bottom-in"),"function"==typeof o&&o()},400)):(e.classList.add("slide-bottom-out"),setTimeout(function(){e.classList.remove("slide-bottom-out"),"function"==typeof o&&o()},100))},e.animation.fadeIn=function(e,t){e.style.display="",e.classList.add("fade-in"),setTimeout(function(){e.classList.remove("fade-in"),"function"==typeof t&&t()},2e3)},e.animation.fadeOut=function(e,t){e.classList.add("fade-out"),setTimeout(function(){e.style.display="none",e.classList.remove("fade-out"),"function"==typeof t&&t()},1e3)},(e.calendar=function(t,o){var n={options:{}};e.calendar.current||(e.calendar.current=null);var i={type:"default",validRange:null,startingDay:null,format:"DD/MM/YYYY",readonly:!0,today:!1,time:!1,resetButton:!0,placeholder:"",months:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],monthsFull:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdays_short:["S","M","T","W","T","F","S"],textDone:"Done",textReset:"Reset",textUpdate:"Update",value:null,fullscreen:!1,opened:!1,onopen:null,onclose:null,onchange:null,onupdate:null,mode:null,position:null};for(var r in i)n.options[r]=o&&o.hasOwnProperty(r)?o[r]:i[r];if(n.options.value||"INPUT"==t.tagName&&t.value&&(n.options.value=t.value),n.date=null,n.options.value)n.date=e.calendar.toArray(n.options.value);else if(n.options.today){var s=new Date,a=s.getFullYear(),l=s.getMonth()+1,u=s.getDate(),c=s.getHours(),d=s.getMinutes();n.date=[a,l,u,c,d,0]}var h=document.createElement("div");h.className="jcalendar-reset",h.innerHTML=n.options.textReset;var p=document.createElement("div");p.className="jcalendar-confirm",p.innerHTML=n.options.textDone;var f=document.createElement("div");f.className="jcalendar-controls",f.style.borderBottom="1px solid #ddd",n.options.resetButton&&f.appendChild(h),f.appendChild(p);var v=document.createElement("div");v.className="jcalendar-container";var g,b=document.createElement("div");b.className="jcalendar-content",v.appendChild(b),"DIV"==t.tagName?(g=t).classList.add("jcalendar-inline"):(b.appendChild(f),(g=document.createElement("div")).className="jcalendar"),g.appendChild(v);var m=document.createElement("div");m.className="jcalendar-table",b.appendChild(m);var y=document.createElement("td");y.setAttribute("colspan","2"),y.className="jcalendar-prev";var j=document.createElement("span");j.className="jcalendar-year";var w=document.createElement("span");w.className="jcalendar-month";var x=document.createElement("td");x.className="jcalendar-header",x.setAttribute("colspan","3"),x.appendChild(w),x.appendChild(j);var C=document.createElement("td");C.setAttribute("colspan","2"),C.className="jcalendar-next";var E=document.createElement("tr");E.appendChild(y),E.appendChild(x),E.appendChild(C);var k=document.createElement("thead");k.appendChild(E);var _=document.createElement("tbody"),A=document.createElement("tfoot"),O=document.createElement("table");O.setAttribute("cellpadding","0"),O.setAttribute("cellspacing","0"),O.appendChild(k),O.appendChild(_),O.appendChild(A),m.appendChild(O);var M=document.createElement("select");for(M.className="jcalendar-select",M.onchange=function(){n.date[3]=this.value,"function"==typeof n.options.onupdate&&n.options.onupdate(t,n.getValue())},d=0;d<24;d++)(N=document.createElement("option")).value=d,N.innerHTML=e.two(d),M.appendChild(N);var I=document.createElement("select");for(I.className="jcalendar-select",I.onchange=function(){n.date[4]=this.value,"function"==typeof n.options.onupdate&&n.options.onupdate(t,n.getValue())},d=0;d<60;d++){var N;(N=document.createElement("option")).value=d,N.innerHTML=e.two(d),I.appendChild(N)}var S=document.createElement("div");S.className="jcalendar-controls";var T=document.createElement("div");T.className="jcalendar-time",T.style.maxWidth="140px",T.appendChild(M),T.appendChild(I);var D=document.createElement("input");D.setAttribute("type","button"),D.className="jcalendar-update",D.value=n.options.textUpdate;var L=document.createElement("div");L.style.flexGrow="10",L.appendChild(D),S.appendChild(T),"INPUT"==t.tagName&&S.appendChild(L),b.appendChild(S);var F=document.createElement("div");F.className="jcalendar-backdrop",g.appendChild(F);var R=function(){var e=g.querySelector(".jcalendar-selected");e&&e.classList.contains("jcalendar-disabled")?(D.setAttribute("disabled","disabled"),M.setAttribute("disabled","disabled"),I.setAttribute("disabled","disabled")):(D.removeAttribute("disabled"),M.removeAttribute("disabled"),I.removeAttribute("disabled"))};n.open=function(o){if(!g.classList.contains("jcalendar-focus")&&!g.classList.contains("jcalendar-inline")){if(n.getDays(),"year-month-picker"==n.options.type&&n.getMonths(),n.options.time&&(M.value=n.date[3],I.value=n.date[4]),e.calendar.current&&e.calendar.current.close(),e.calendar.current=n,g.classList.add("jcalendar-focus"),e.getWindowWidth()<800||n.options.fullscreen)g.classList.add("jcalendar-fullsize"),e.animation.slideBottom(b,1);else{var i=t.getBoundingClientRect(),r=b.getBoundingClientRect();n.options.position?(v.style.position="fixed",v.style.top=window.innerHeight<i.bottom+r.height?i.top-(r.height+2)+"px":i.top+i.height+2+"px",v.style.left=i.left+"px"):window.innerHeight<i.bottom+r.height?v.style.bottom=1*i.height+r.height+2+"px":v.style.top="2px"}"function"==typeof n.options.onopen&&n.options.onopen(t)}},n.close=function(o,i){if(e.calendar.current){if(e.calendar.current=null,!1!==i){var r=g.querySelector(".jcalendar-selected");if("string"==typeof i)var s=i;else s=!r||r.classList.contains("jcalendar-disabled")?n.options.value:n.getValue();n.setValue(s)}o||"function"!=typeof n.options.onclose||n.options.onclose(t),g.classList.remove("jcalendar-focus")}return n.options.value},n.prev=function(){"years"==n.options.mode?(n.date[0]=n.date[0]-12,n.getYears()):"months"==n.options.mode?(n.date[0]=parseInt(n.date[0])-1,n.getMonths()):(n.date[1]<2?(n.date[0]=n.date[0]-1,n.date[1]=12):n.date[1]=n.date[1]-1,n.getDays())},n.next=function(){"years"==n.options.mode?(n.date[0]=parseInt(n.date[0])+12,n.getYears()):"months"==n.options.mode?(n.date[0]=parseInt(n.date[0])+1,n.getMonths()):(n.date[1]>11?(n.date[0]=parseInt(n.date[0])+1,n.date[1]=1):n.date[1]=parseInt(n.date[1])+1,n.getDays())},n.setValue=function(e){e||(e=""+e);var o=e,i=n.options.value;if(i!=o){n.setLabel(o,n.options),(s=o.split(" "))[1]||(s[1]="00:00:00");var r=s[1].split(":"),s=s[0].split("-"),a=parseInt(s[0]),l=parseInt(s[1]),u=parseInt(s[2]),c=parseInt(r[0]),d=parseInt(r[1]);n.date=[a,l,u,c,d,0],e=n.setLabel(o,n.options),n.options.value=o,"function"==typeof n.options.onchange&&n.options.onchange(t,o,i),t.value!=e&&(t.value=e,"function"==typeof t.onchange&&t.onchange({type:"change",target:t,value:t.value}))}n.getDays()},n.getValue=function(){return n.date?n.options.time?e.two(n.date[0])+"-"+e.two(n.date[1])+"-"+e.two(n.date[2])+" "+e.two(n.date[3])+":"+e.two(n.date[4])+":"+e.two(0):e.two(n.date[0])+"-"+e.two(n.date[1])+"-"+e.two(n.date[2])+" "+e.two(0)+":"+e.two(0)+":"+e.two(0):""},n.update=function(e,o){if(e.classList.contains("jcalendar-disabled"));else{var i=g.querySelector(".jcalendar-selected");i&&i.classList.remove("jcalendar-selected"),e.classList.add("jcalendar-selected"),e.classList.contains("jcalendar-set-month")?n.date[1]=o:n.date[2]=e.innerText,n.options.time?(n.date[3]=M.value,n.date[4]=I.value):n.close(),"function"==typeof n.options.onupdate&&n.options.onupdate(t,n.getValue())}R()},n.reset=function(){n.setValue(""),n.close(!1,!1)},n.getDays=function(){n.options.mode="days";var t=new Date,o=n.date&&e.isNumeric(n.date[0])?n.date[0]:parseInt(t.getFullYear()),i=n.date&&e.isNumeric(n.date[1])?n.date[1]:parseInt(t.getMonth())+1,r=n.date&&e.isNumeric(n.date[2])?n.date[2]:parseInt(t.getDate()),s=n.date&&e.isNumeric(n.date[3])?n.date[3]:parseInt(t.getHours()),a=n.date&&e.isNumeric(n.date[4])?n.date[4]:parseInt(t.getMinutes());n.date=[o,i,r,s,a,0],j.innerHTML=o,w.innerHTML=n.options.months[i-1];var l=t.getMonth()==i-1&&t.getFullYear()==o,u=t.getDate(),c=(t=new Date(o,i,0,0,0)).getDate(),d=(t=new Date(o,i-1,0,0,0)).getDay()+1;d-=p=n.options.startingDay||0,_.innerHTML="",(g=document.createElement("tr")).setAttribute("align","center"),_.appendChild(g);for(var h=0;h<7;h++)(m=document.createElement("td")).classList.add("jcalendar-weekday"),m.innerHTML=n.options.weekdays_short[p],g.appendChild(m),++p>6&&(p=0);for(var p=0,f=0,v=0;v<6;v++){var g;(g=document.createElement("tr")).setAttribute("align","center");var b=!0;for(h=0;h<7;h++){var m;if((m=document.createElement("td")).classList.add("jcalendar-set-day"),p>=d&&p<d+c){f++,m.innerHTML=f,f==r&&m.classList.add("jcalendar-selected"),l&&u==f&&(m.style.fontWeight="bold");var y=e.calendar.now(new Date(o,i-1,f),!0);if(n.options.validRange){if(!n.options.validRange[0]||y>=n.options.validRange[0])var x=!0;else x=!1;if(!n.options.validRange[1]||y<=n.options.validRange[1])var C=!0;else C=!1;x&&C||m.classList.add("jcalendar-disabled")}b=!1}g.appendChild(m),p++}0==b&&_.appendChild(g)}T.style.display=n.options.time?"":"none",R()},n.getMonths=function(){n.options.mode="months";var t=n.options.months,o=n.options.value,i=new Date,r=n.date&&e.isNumeric(n.date[0])?n.date[0]:parseInt(i.getFullYear());n.date&&e.isNumeric(n.date[1])||parseInt(i.getMonth()),o||(o=parseInt(i.getFullYear())+"-"+e.two(parseInt(i.getMonth())+1)),o=o.substr(0,10).split("-"),j.innerHTML=n.date[0],w.innerHTML="";for(var s=parseInt(i.getFullYear()),a=parseInt(i.getMonth()),l=document.createElement("table"),u=null,c=0;c<12;c++){c%4||((u=document.createElement("tr")).setAttribute("align","center"),l.appendChild(u));var d=document.createElement("td");if(d.classList.add("jcalendar-set-month"),d.setAttribute("data-value",c+1),d.innerText=t[c],n.options.validRange){var h=r+"-"+e.two(c+1);if(!n.options.validRange[0]||h>=n.options.validRange[0].substr(0,7))var p=!0;else p=!1;if(!n.options.validRange[1]||h<=n.options.validRange[1].substr(0,7))var f=!0;else f=!1;p&&f||d.classList.add("jcalendar-disabled")}r==o[0]&&c+1==o[1]&&d.classList.add("jcalendar-selected"),s==r&&a==c&&(d.style.fontWeight="bold"),u.appendChild(d)}_.innerHTML='<tr><td colspan="7"></td></tr>',_.children[0].children[0].appendChild(l),R()},n.getYears=function(){n.options.mode="years";var e=[];for(d=0;d<25;d++)e[d]=parseInt(n.date[0])+(d-12);var t='<td colspan="7"><table width="100%"><tr align="center">';for(d=0;d<25;d++)d>0&&!(d%5)&&(t+='</tr><tr align="center">'),t+='<td class="jcalendar-set-year">'+e[d]+"</td>";_.innerHTML=t+="</tr></table></td>",R()},n.setLabel=function(t,o){return e.calendar.getDateString(t,o)},n.fromFormatted=function(t,o){return e.calendar.extractDateFromString(t,o)};var P=function(e){var t=e.target.className;"jcalendar-prev"==t?(n.prev(),e.stopPropagation(),e.preventDefault()):"jcalendar-next"==t?(n.next(),e.stopPropagation(),e.preventDefault()):"jcalendar-month"==t?(n.getMonths(),e.stopPropagation(),e.preventDefault()):"jcalendar-year"==t?(n.getYears(),e.stopPropagation(),e.preventDefault()):"jcalendar-set-year"==t?(n.date[0]=e.target.innerText,"year-month-picker"==n.options.type?n.getMonths():n.getDays(),e.stopPropagation(),e.preventDefault()):e.target.classList.contains("jcalendar-set-month")?("year-month-picker"==n.options.type?n.update(e.target,parseInt(e.target.getAttribute("data-value"))):n.getDays(),e.stopPropagation(),e.preventDefault()):"jcalendar-confirm"==t||"jcalendar-update"==t||"jcalendar-close"==t?(n.close(),e.stopPropagation(),e.preventDefault()):"jcalendar-backdrop"==t?(n.close(!1,!1),e.stopPropagation(),e.preventDefault()):"jcalendar-reset"==t?(n.reset(),e.stopPropagation(),e.preventDefault()):e.target.classList.contains("jcalendar-set-day")&&e.target.innerText&&(n.update(e.target),e.stopPropagation(),e.preventDefault())};return t.addEventListener("keyup",function(t){if(t.target.value&&t.target.value.length>3){var o=e.calendar.extractDateFromString(t.target.value,n.options.format);o&&"true"==t.target.getAttribute("data-completed")&&n.setValue(o)}}),g.addEventListener("swipeleft",function(t){e.animation.slideLeft(O,0,function(){n.next(),e.animation.slideRight(O,1)}),t.preventDefault(),t.stopPropagation()}),g.addEventListener("swiperight",function(t){e.animation.slideRight(O,0,function(){n.prev(),e.animation.slideLeft(O,1)}),t.preventDefault(),t.stopPropagation()}),"ontouchend"in document.documentElement==1?(g.addEventListener("touchend",P),t.addEventListener("touchend",function(e){n.open()})):(g.addEventListener("mouseup",P),t.addEventListener("mouseup",function(e){n.open()})),e.calendar.hasEvents||("ontouchstart"in document.documentElement==1?document.addEventListener("touchstart",e.calendar.isOpen):document.addEventListener("mousedown",e.calendar.isOpen),document.addEventListener("keydown",function(t){13==t.which?e.calendar.current&&e.calendar.current.close(!1,!0):27==t.which&&e.calendar.current&&e.calendar.current.close(!1,!1)}),e.calendar.hasEvents=!0),"INPUT"==t.tagName?(t.parentNode.insertBefore(g,t.nextSibling),t.setAttribute("autocomplete","off"),t.setAttribute("data-mask",n.options.format.toLowerCase()),n.options.readonly&&t.setAttribute("readonly","readonly"),n.options.placeholder&&t.setAttribute("placeholder",n.options.placeholder),t.classList.add("jcalendar-input"),t.value=n.setLabel(n.getValue(),n.options)):(n.getDays(),n.options.time&&(M.value=n.date[3],I.value=n.date[4])),t.change=n.setValue,t.calendar=n,1==n.options.opened&&n.open(),n}).prettify=function(e,t){t||(t={justNow:"Just now",xMinutesAgo:"{0}m ago",xHoursAgo:"{0}h ago",xDaysAgo:"{0}d ago",xWeeksAgo:"{0}w ago",xMonthsAgo:"{0} mon ago",xYearsAgo:"{0}y ago"});var o=new Date,n=new Date(e),i=parseInt((o-n)/1e3/60);if(String.prototype.format=function(e){return this.replace("{0}",e)},0==i)var r=t.justNow;else r=i<90?t.xMinutesAgo.format(i):i<1440?t.xHoursAgo.format(Math.round(i/60)):i<20160?t.xDaysAgo.format(Math.round(i/1440)):i<43200?t.xWeeksAgo.format(Math.round(i/10080)):i<1036800?t.xMonthsAgo.format(Math.round(i/43200)):t.xYearsAgo.format(Math.round(i/525600));return r},e.calendar.prettifyAll=function(){for(var t=document.querySelectorAll(".prettydate"),o=0;o<t.length;o++)t[o].getAttribute("data-date")?t[o].innerHTML=e.calendar.prettify(t[o].getAttribute("data-date")):(t[o].setAttribute("data-date",t[o].innerHTML),t[o].innerHTML=e.calendar.prettify(t[o].innerHTML))},e.calendar.now=function(t,o){t||(t=new Date);var n=t.getFullYear(),i=t.getMonth()+1,r=t.getDate(),s=t.getHours(),a=t.getMinutes(),l=t.getSeconds();return 1==o?e.two(n)+"-"+e.two(i)+"-"+e.two(r):e.two(n)+"-"+e.two(i)+"-"+e.two(r)+" "+e.two(s)+":"+e.two(a)+":"+e.two(l)},e.calendar.toArray=function(e){var t=(o=e.split(-1!==e.indexOf("T")?"T":" "))[1],o=o[0].split("-"),n=parseInt(o[0]),i=parseInt(o[1]),r=parseInt(o[2]);if(t){t=t.split(":");var s=parseInt(t[0]),a=parseInt(t[1])}else s=0,a=0;return[n,i,r,s,a,0]},e.calendar.extractDateFromString=function(t,o){if(t>0&&Number(t)==t)return(l=new Date(Math.round(86400*(t-25569)*1e3))).getFullYear()+"-"+e.two(l.getMonth())+"-"+e.two(l.getDate())+" 00:00:00";var n=""+t,i=o.replace(/[0-9]/g,""),r=1,s=i.search("YYYY");s=n.substr(s,4),parseInt(s)!=s&&(r=0);var a=i.search("MM");a=n.substr(a,2),(parseInt(a)!=a||a>12)&&(r=0);var l=i.search("DD");l=n.substr(l,2),(parseInt(l)!=l||l>31)&&(r=0);var u=i.search("HH");u>=0?(u=n.substr(u,2),(!parseInt(u)||u>23)&&(u="00")):u="00";var c=i.search("MI");c>=0?(c=n.substr(c,2),(!parseInt(c)||c>59)&&(c="00")):c="00";var d=i.search("SS");return d>=0?(d=n.substr(d,2),(!parseInt(d)||d>59)&&(d="00")):d="00",1==r&&t.length==i.length?s+"-"+a+"-"+l+" "+u+":"+c+":"+d:""},e.calendar.getDateString=function(e,t){if(t||(t={}),"string"==typeof t)var o=t;else o=t.format;if(t&&t.weekdays)var n=t.weekdays;else n=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];if(t&&t.months)var i=t.months;else i=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];if(t&&t.months)var r=t.monthsFull;else r=["January","February","March","April","May","June","July","August","September","October","November","December"];if(o||(o="DD/MM/YYYY"),e){var s=""+e,a=-1!==s.indexOf("T")?"T":" ",l="",u="",c="";if((s=s.split(a))[1]?(u=(l=s[1].split(":"))[1]?l[1]:"00",c=l[2]?l[2]:"00",l=l[0]?l[0]:"00"):(l="00",u="00",c="00"),(s=s[0].split("-"))[0]&&s[1]&&s[2]&&s[0]>0&&s[1]>0&&s[1]<13&&s[2]>0&&s[2]<32){var d=new Date(s[0],s[1]-1,s[2]);s[1]=(s[1].length<2?"0":"")+s[1],s[2]=(s[2].length<2?"0":"")+s[2],l=(l.length<2?"0":"")+l,u=(u.length<2?"0":"")+u,c=(c.length<2?"0":"")+c,e=(e=o).replace("MMM","MON");for(var h=["YYYY","YYY","YY","Y","MM","DD","DY","DAY","WD","D","Q","HH24","HH12","HH","PM","AM","MI","SS","MS","MONTH","MON"],p=[],f=e;f;){for(var v=0,g=0;g<h.length;g++)0==v&&0===f.toUpperCase().indexOf(h[g])&&(v=h[g].length);0==v?(p.push(f.substr(0,1)),f=f.substr(1)):(p.push(f.substr(0,v)),f=f.substr(v))}var b=function(e,t,o){if(1==o)for(var n=0;n<p.length;n++)p[n].toUpperCase()==e&&(p[n]=t);else for(n=0;n<p.length;n++)p[n]==e&&(p[n]=t)};b("YYYY",s[0],!0),b("YYY",s[0].substring(1,4),!0),b("YY",s[0].substring(2,4),!0),b("Y",s[0].substring(3,4),!0),b("MM",s[1],!0),b("DD",s[2],!0),b("Q",Math.floor((d.getMonth()+3)/3),!0),l&&b("HH24",l),l>12?(b("HH12",l-12,!0),b("HH",l-12,!0),b("AM","pm",!0),b("PM","pm",!0)):(b("HH12",l,!0),b("HH",l,!0),b("AM","am",!0),b("PM","am",!0)),b("MI",u,!0),b("SS",c,!0),b("MS",d.getMilliseconds(),!0),b("MONTH",r[d.getMonth()].toUpperCase()),b("Month",r[d.getMonth()]),b("month",r[d.getMonth()].toLowerCase()),b("MON",i[d.getMonth()].toUpperCase()),b("MMM",i[d.getMonth()].toUpperCase()),b("Mon",i[d.getMonth()]),b("mon",i[d.getMonth()].toLowerCase()),b("DAY",n[d.getDay()].toUpperCase()),b("Day",n[d.getDay()]),b("day",n[d.getDay()].toLowerCase()),b("DY",n[d.getDay()].substr(0,3).toUpperCase()),b("Dy",n[d.getDay()].substr(0,3)),b("dy",n[d.getDay()].substr(0,3).toLowerCase()),b("D",n[d.getDay()]),b("WD",n[d.getDay()]),e=p.join("")}else e=""}return e},e.calendar.isOpen=function(t){e.calendar.current&&t.target.className&&-1==t.target.className.indexOf("jcalendar")&&e.calendar.current.close(!1,!1)},e.color=function(t,o){var n={options:{},values:[]};e.color.current||(e.color.current=null);var i={placeholder:"",value:null,onopen:null,onclose:null,onchange:null,closeOnChange:!0,palette:null,position:null,doneLabel:"Done",resetLabel:"Reset",fullscreen:!1};for(var r in i)n.options[r]=o&&o.hasOwnProperty(r)?o[r]:i[r];n.options.palette||(n.options.palette=e.palette()),n.options.value&&(t.value=n.options.value),"INPUT"==t.tagName&&t.classList.add("jcolor-input");var s=document.createElement("div");s.className="jcolor";var a=document.createElement("div");a.className="jcolor-backdrop",s.appendChild(a);var l=document.createElement("div");l.className="jcolor-content";var u=document.createElement("div");u.className="jcolor-controls",l.appendChild(u);var c=document.createElement("div");c.className="jcolor-reset",c.innerHTML=n.options.resetLabel,c.onclick=function(){n.setValue(""),n.close()},u.appendChild(c);var d=document.createElement("div");d.className="jcolor-close",d.innerHTML=n.options.doneLabel,d.onclick=function(){n.close()},u.appendChild(d);var h=document.createElement("table");h.setAttribute("cellpadding","7"),h.setAttribute("cellspacing","0");for(var p=0;p<n.options.palette.length;p++){for(var f=document.createElement("tr"),v=0;v<n.options.palette[p].length;v++){var g=document.createElement("td"),b=n.options.palette[p][v];b.length<7&&"#"!==b.substr(0,1)&&(b="#"+b),g.style.backgroundColor=b,g.setAttribute("data-value",b),g.innerHTML="",f.appendChild(g),n.options.value==b&&g.classList.add("jcolor-selected"),n.values[b]=g}h.appendChild(f)}n.open=function(){if(e.color.current&&e.color.current!=n&&e.color.current.close(),!e.color.current){e.color.current=n,s.classList.add("jcolor-focus");var o=l.getBoundingClientRect();if(e.getWindowWidth()<800||1==n.options.fullscreen)l.style.top="",l.classList.add("jcolor-fullscreen"),e.animation.slideBottom(l,1),a.style.display="block";else{l.classList.contains("jcolor-fullscreen")&&(l.classList.remove("jcolor-fullscreen"),a.style.display="");var i=t.getBoundingClientRect();n.options.position?(l.style.position="fixed",l.style.top=window.innerHeight<i.bottom+o.height?i.top-(o.height+2)+"px":i.top+i.height+2+"px",l.style.left=i.left+"px"):l.style.top=window.innerHeight<i.bottom+o.height?-1*(o.height+i.height+2)+"px":"2px"}s.focus(),"function"==typeof n.options.onopen&&n.options.onopen(t)}},n.close=function(o){return e.color.current&&(t.focus(),e.color.current=null,o||"function"!=typeof n.options.onclose||n.options.onclose(t),s.classList.remove("jcolor-focus")),a.style.display="",n.options.value},n.setValue=function(e){if(e||(e=""),e!=n.options.value){n.options.value=e;var o=s.querySelector(".jcolor-selected");o&&o.classList.remove("jcolor-selected"),n.values[e]&&n.values[e].classList.add("jcolor-selected"),"function"==typeof n.options.onchange&&n.options.onchange(t,e),t.value!=n.options.value&&(t.value=n.options.value,"function"==typeof t.onchange&&t.onchange({type:"change",target:t,value:t.value}))}1==n.options.closeOnChange&&n.close()},n.getValue=function(){return n.options.value};var m=!1;return t.addEventListener("focus",function(t){e.color.current||n.open()}),t.addEventListener("mouseup",function(t){e.color.current||n.open(),t.preventDefault(),t.stopPropagation()}),a.addEventListener("mousedown",function(e){m=!0,e.preventDefault(),e.stopPropagation()}),a.addEventListener("mouseup",function(t){m&&e.color.current&&(n.close(),m=!1),t.preventDefault(),t.stopPropagation()}),s.addEventListener("mouseup",function(t){"TD"==t.target.tagName&&(e.color.current.setValue(t.target.getAttribute("data-value")),e.color.current&&e.color.current.close(),t.preventDefault(),t.stopPropagation())}),document.addEventListener("mousedown",function(t){e.color.current&&(e.findElement(t.target,"jcolor")||e.color.current.close())}),s.setAttribute("tabindex","900"),n.options.placeholder&&t.setAttribute("placeholder",n.options.placeholder),l.appendChild(h),s.appendChild(l),"INPUT"==t.tagName?t.parentNode.insertBefore(s,t.nextSibling):t.appendChild(s),t.change=n.setValue,t.color=n,n},(e.contextmenu=function(t,o){var n={options:{}},i={items:null,onclick:null};for(var r in i)n.options[r]=o&&o.hasOwnProperty(r)?o[r]:i[r];function s(e){if(!e.type||"line"!=e.type&&"divisor"!=e.type){u=document.createElement("div");var t=document.createElement("a");if(t.innerHTML=e.title,e.tooltip&&u.setAttribute("title",e.tooltip),e.icon&&u.setAttribute("data-icon",e.icon),e.id&&(u.id=e.id),e.disabled?u.className="jcontextmenu-disabled":e.onclick&&(u.method=e.onclick,u.addEventListener("mousedown",function(e){e.preventDefault()}),u.addEventListener("mouseup",function(){this.method(this)})),u.appendChild(t),e.submenu){var o=document.createElement("span");o.innerHTML="&#9658;",u.appendChild(o),u.classList.add("jcontexthassubmenu");var n=document.createElement("div");n.classList.add("jcontextmenu"),n.setAttribute("tabindex","900");for(var i=e.submenu,r=0;r<i.length;r++){var a=s(i[r]);n.appendChild(a)}u.appendChild(n)}else if(e.shortcut){var l=document.createElement("span");l.innerHTML=e.shortcut,u.appendChild(l)}}else var u=document.createElement("hr");return u}return t.classList.add("jcontextmenu"),t.setAttribute("tabindex","900"),n.open=function(e,o){if(o&&(n.options.items=o,n.create(o)),n.options.items&&n.options.items.length>0||t.children.length){if(e.target)var i=e.clientX,r=e.clientY;else i=e.x,r=e.y;t.classList.add("jcontextmenu-focus"),t.focus();var s=t.getBoundingClientRect();if(window.innerHeight<r+s.height){var a=r-s.height;a<0&&(a=0),t.style.top=a+"px"}else t.style.top=r+"px";t.style.left=window.innerWidth<i+s.width?i-s.width>0?i-s.width+"px":"10px":i+"px"}},n.close=function(){t.classList.contains("jcontextmenu-focus")&&t.classList.remove("jcontextmenu-focus")},n.create=function(e){t.innerHTML="";for(var o=0;o<e.length;o++){var n=s(e[o]);t.appendChild(n)}},"function"==typeof n.options.onclick&&t.addEventListener("click",function(e){n.options.onclick(n,e)}),n.options.items&&n.create(n.options.items),t.addEventListener("blur",function(e){setTimeout(function(){n.close()},120)}),e.contextmenu.hasEvents||(window.addEventListener("mousewheel",function(){n.close()}),document.addEventListener("contextmenu",function(t){var o=e.contextmenu.getElement(t.target);if(o){var n=document.querySelector("#"+o);n?(n.contextmenu.open(t),t.preventDefault()):console.error("JSUITES: Contextmenu id not found")}}),e.contextmenu.hasEvents=!0),t.contextmenu=n,n}).getElement=function(e){var t=0;return function e(o){o.parentNode&&o.getAttribute("aria-contextmenu-id")?t=o.getAttribute("aria-contextmenu-id"):o.parentNode&&e(o.parentNode)}(e),t},(e.dropdown=function(t,o){var n={options:{}};if("SELECT"==t.tagName){var i=e.dropdown.extractFromDom(t,o);t=i.el,o=i.options}var r={url:null,data:[],multiple:!1,autocomplete:!1,remoteSearch:!1,lazyLoading:!1,type:null,width:null,maxWidth:null,opened:!1,value:null,placeholder:"",newOptions:!1,position:!1,onchange:null,onload:null,onopen:null,onclose:null,onfocus:null,onblur:null,oninsert:null};for(var s in r)n.options[s]=o&&o.hasOwnProperty(s)?o[s]:r[s];e.dropdown.current||(e.dropdown.current=null),1==n.options.remoteSearch&&(n.options.autocomplete=!0),n.items=[],n.groups=[],n.value=[],n.search="",n.results=null,n.numOfItems=0,t.classList.add("jdropdown"),"searchbar"==n.options.type?t.classList.add("jdropdown-searchbar"):"list"==n.options.type?t.classList.add("jdropdown-list"):"picker"==n.options.type?t.classList.add("jdropdown-picker"):e.getWindowWidth()<800?n.options.autocomplete?(t.classList.add("jdropdown-searchbar"),n.options.type="searchbar"):(t.classList.add("jdropdown-picker"),n.options.type="picker"):(n.options.width&&(t.style.width=n.options.width,t.style.minWidth=n.options.width),t.classList.add("jdropdown-default"),n.options.type="default");var a=document.createElement("div");a.className="jdropdown-container-header",n.header=document.createElement("input"),n.header.className="jdropdown-header",n.header.setAttribute("autocomplete","off"),"function"==typeof n.options.onfocus&&(n.header.onfocus=function(){n.options.onfocus(t)}),"function"==typeof n.options.onblur&&(n.header.onblur=function(){n.options.onblur(t)}),1==n.options.newOptions&&n.header.classList.add("jdropdown-add");var l=document.createElement("div");l.className="jdropdown-container";var u=document.createElement("div");u.className="jdropdown-content";var c=document.createElement("div");c.className="jdropdown-close",c.innerHTML="Done";var d=document.createElement("div");d.className="jdropdown-reset",d.innerHTML="x",d.onclick=function(){n.reset(),n.close()};var h=document.createElement("div");if(h.className="jdropdown-backdrop",1==n.options.autocomplete){t.setAttribute("data-autocomplete",!0);var p=null;n.header.addEventListener("keyup",function(e){p||(n.search!=n.header.value.trim()&&(p=setTimeout(function(){n.find(n.header.value.trim()),p=null},400)),t.classList.contains("jdropdown-focus")||n.open())})}else n.header.setAttribute("readonly","readonly");return!n.options.placeholder&&t.getAttribute("placeholder")&&(n.options.placeholder=t.getAttribute("placeholder")),n.options.placeholder&&n.header.setAttribute("placeholder",n.options.placeholder),a.appendChild(n.header),"searchbar"==n.options.type?a.appendChild(c):l.appendChild(c),l.appendChild(u),t.appendChild(a),t.appendChild(l),t.appendChild(h),n.init=function(){if(n.options.url&&!n.options.data.length)e.ajax({url:n.options.url,method:"GET",dataType:"json",success:function(e){e&&(n.setData(e),null!=n.options.value&&n.setValue(n.options.value,!0),"function"==typeof n.options.onload&&n.options.onload(t,n,e))}});else{var o=[];if(n.options.data.length)for(var i=0;i<n.options.data.length;i++)o.push(n.options.data[i]);n.setData(o),null!=n.options.value&&n.setValue(n.options.value,!0),"function"==typeof n.options.onload&&n.options.onload(t,n,n.options.data)}1==n.options.opened&&n.open()},n.getUrl=function(){return n.options.url},n.setUrl=function(t){n.options.url=t,e.ajax({url:n.options.url,method:"GET",dataType:"json",success:function(e){n.setData(e)}})},n.add=function(t){if(!t&&!(t=prompt("Text",1==n.options.autocomplete?n.header.value:"")))return!1;var o={value:e.guid(),text:t};n.options.data.push(o);var i=n.createItem(o);return u.appendChild(i.element),"function"==typeof n.options.oninsert&&n.options.oninsert(n,i,o),"none"==u.style.display&&(u.style.display=""),o},n.createItem=function(e,t,o){void 0===e.text&&e.name&&(e.text=e.name),void 0===e.value&&e.id&&(e.value=e.id);var i={};if(i.element=document.createElement("div"),i.element.className="jdropdown-item",i.element.indexValue=n.items.length,i.value=e.value,i.text=e.text,e.id&&i.element.setAttribute("id",e.id),t&&(i.group=t,i.groupName=o),e.image){var r=document.createElement("img");r.className="jdropdown-image",r.src=e.image,e.title||r.classList.add("jdropdown-image-small"),i.element.appendChild(r)}else if(e.color){var s=document.createElement("div");s.className="jdropdown-color",s.style.backgroundColor=e.color,i.element.appendChild(s)}var a=document.createElement("div");if(a.className="jdropdown-description",e.text?a.innerText=e.text:a.innerHTML="&nbsp;",e.title){var l=document.createElement("div");l.className="jdropdown-title",l.innerText=e.title,a.appendChild(l),i.title=e.title}return n.value&&n.value[e.value]&&(i.element.classList.add("jdropdown-selected"),i.selected=!0),n.items.push(i),i.element.appendChild(a),i},n.appendData=function(e){if(e.length){n.numOfItems=0;for(var t=[],o=[],i=0;i<e.length;i++)e[i].group?(o[e[i].group]||(o[e[i].group]=[]),o[e[i].group].push(i)):t.push(i);var r=Object.keys(o);if(r.length>0)for(i=0;i<r.length;i++){var s=document.createElement("div");s.className="jdropdown-group";var a=document.createElement("div");a.className="jdropdown-group-name",a.innerHTML=r[i];var l=document.createElement("i");l.className="jdropdown-group-arrow jdropdown-group-arrow-down",a.appendChild(l);var c=document.createElement("div");c.className="jdropdown-group-items";for(var d=0;d<o[r[i]].length;d++){var h=n.createItem(e[o[r[i]][d]],s,r[i]);(0==n.options.lazyLoading||n.numOfItems<200)&&(c.appendChild(h.element),n.numOfItems++)}s.appendChild(a),s.appendChild(c),n.groups.push(s),c.children.length>0&&u.appendChild(s)}if(t.length)for(i=0;i<t.length;i++)h=n.createItem(e[t[i]]),(0==n.options.lazyLoading||n.numOfItems<200)&&(u.appendChild(h.element),n.numOfItems++)}},n.setData=function(e){if(e.length){for(var t=0;t<e.length;t++)"object"!=typeof e[t]&&(e[t]={value:e[t],text:e[t]});u.innerHTML="",n.reset(),n.items=[],n.appendData(e)}n.options.data=e},n.getPosition=function(e){for(var t=0;t<n.items.length;t++)if(n.items[t].value==e)return t;return 0},n.getText=function(e){for(var t=[],o=Object.keys(n.value),i=0;i<o.length;i++)t.push(n.value[o[i]]);return e?t:t.join("; ")},n.getValue=function(e){return e?Object.keys(n.value):Object.keys(n.value).join(";")},n.setValue=function(e,o){for(var i=function(e,t){n.items[e].value==t&&(n.items[e].element&&n.items[e].element.classList.add("jdropdown-selected"),n.items[e].selected=!0,n.value[t]=n.items[e].text)},r=n.getValue(),s=0;s<n.items.length;s++)1==n.items[s].selected&&(n.items[s].element&&n.items[s].element.classList.remove("jdropdown-selected"),n.items[s].selected=null);if(n.value=[],null!==e)if(Array.isArray(e))for(s=0;s<n.items.length;s++)for(var a=0;a<e.length;a++)i(s,e[a]);else for(s=0;s<n.items.length;s++)i(s,e);r!=n.getValue()&&(t.classList.contains("jdropdown-focus")||(n.header.value=n.getText()),n.options.value=n.getValue(),!0!==o&&"function"==typeof n.options.onchange&&n.options.onchange(t,null,r,n.options.value),t.value!=n.options.value&&(t.value=n.options.value,"function"==typeof t.onchange&&t.onchange({type:"change",target:t,value:t.value})))},n.resetSelected=function(){n.setValue(null)},n.selectIndex=function(e){if(e=parseInt(e),n.items&&n.items[e])if(n.getValue(),n.setCursor(e,!1),n.options.multiple){var t=Object.keys(n.value);if(n.items[e].selected){n.items[e].element.classList.remove("jdropdown-selected"),n.items[e].selected=!1;var o=t.indexOf(""+n.items[e].value);-1!=o&&t.splice(o,1)}else n.items[e].element.classList.add("jdropdown-selected"),n.items[e].selected=!0,t.push(n.items[e].value);n.setValue(t)}else n.setValue(n.value[n.items[e].value]?null:n.items[e].value),n.close()},n.selectItem=function(t){e.dropdown.current&&n.selectIndex(t.indexValue)},n.find=function(t){if(n.search==t.trim())return!1;if(n.search=t,n.numOfItems=0,1==n.options.remoteSearch)n.currentIndex=null,n.results=null,e.ajax({url:n.options.url+"?q="+t,method:"GET",dataType:"json",success:function(e){n.items=[],u.innerHTML="",n.appendData(e),u.style.display=e.length?"":"none"}});else{t=new RegExp(t,"gi"),n.results=[];for(var o=0;o<n.items.length;o++){var i=n.items[o].title||"",r=n.items[o].groupName||"";if((null==t||null!=n.value[n.items[o].value]||n.items[o].text.match(t)||i.match(t)||r.match(t))&&(n.results.push(n.items[o]),n.items[o].group&&n.items[o].group.children[1].children[0]))for(;n.items[o].group.children[1].children[0];)n.items[o].group.children[1].removeChild(n.items[o].group.children[1].children[0])}for(;u.children[0];)u.removeChild(u.children[0]);var s=n.results.length||0;for(1==n.options.lazyLoading&&s>200&&(s=200),o=0;o<s;o++)n.results[o].group?(n.results[o].group.parentNode||u.appendChild(n.results[o].group),n.results[o].group.children[1].appendChild(n.results[o].element)):u.appendChild(n.results[o].element),n.numOfItems++;u.style.display=n.results.length?"":"none"}},n.open=function(){if(e.dropdown.current!=t&&(e.dropdown.current&&e.dropdown.current.dropdown.close(),e.dropdown.current=t),!t.classList.contains("jdropdown-focus")){t.classList.add("jdropdown-focus"),e.getWindowWidth()<800&&(null!=n.options.type&&"picker"!=n.options.type||e.animation.slideBottom(l,1)),1==n.options.autocomplete&&(n.header.value=n.search,n.header.focus());var o=Object.keys(n.value);if(o[0]){var i=n.getPosition(o[0]);i&&n.setCursor(i)}if(!n.options.type||"default"==n.options.type){var r=t.getBoundingClientRect(),s=l.getBoundingClientRect();n.options.position?(l.style.position="fixed",window.innerHeight<r.bottom+s.height?(l.style.top="",l.style.bottom=window.innerHeight-r.top+1+"px"):(l.style.top=r.bottom+"px",l.style.bottom=""),l.style.left=r.left+"px"):window.innerHeight<r.bottom+s.height?(l.style.top="",l.style.bottom=r.height+1+"px"):(l.style.top="",l.style.bottom=""),l.style.minWidth=r.width+"px",n.options.maxWidth&&(l.style.maxWidth=n.options.maxWidth),u.style.display=n.items.length||1!=n.options.autocomplete?"":"none"}}"function"==typeof n.options.onopen&&n.options.onopen(t)},n.close=function(o){return e.dropdown.current&&(e.dropdown.current=null,n.setCursor(),n.header.value=n.getText(),o||"function"!=typeof n.options.onclose||n.options.onclose(t),n.header.blur&&n.header.blur(),t.classList.remove("jdropdown-focus")),n.getValue()},n.setCursor=function(e,t){if(null!=n.currentIndex&&n.items&&n.items[n.currentIndex]&&n.items[n.currentIndex].element.classList.remove("jdropdown-cursor"),null==e)n.currentIndex=null;else if(parseInt(e),n.items[e].element.classList.add("jdropdown-cursor"),n.currentIndex=e,!1!==t&&n.items[n.currentIndex].element){var o=n.items[n.currentIndex].element;u.scrollTop=o.offsetTop-o.scrollTop+o.clientTop-95}},n.resetCursor=n.setCursor,n.updateCursor=n.setCursor,n.reset=function(){n.setCursor(),n.setValue(null)},n.firstVisible=function(){for(var e=null,t=0;t<n.items.length;t++)if(n.items&&n.items[t]&&n.items[t].element.parentNode&&"none"!=n.items[t].element.style.display){e=t;break}if(null==e)return!1;n.setCursor(e)},n.first=function(){for(var e=null,t=n.currentIndex-1;t>=0;t--)n.items&&n.items[t]&&n.items[t].element.parentNode&&"none"!=n.items[t].element.style.display&&(e=t);if(null==e)return!1;n.setCursor(e)},n.last=function(){for(var e=null,t=n.currentIndex+1;t<n.items.length;t++)n.items&&n.items[t]&&n.items[t].element.parentNode&&"none"!=n.items[t].element.style.display&&(e=t);if(null==e)return!1;n.setCursor(e)},n.next=function(){for(var e=null,t=n.currentIndex+1;t<n.items.length;t++)if(n.items&&n.items[t]&&n.items[t].element.parentNode){e=t;break}if(null==e)return!1;n.setCursor(e)},n.prev=function(){for(var e=null,t=n.currentIndex-1;t>=0;t--)if(n.items&&n.items[t]&&n.items[t].element.parentNode){e=t;break}if(null==e)return!1;n.setCursor(e)},n.loadUp=function(){return!1},n.loadDown=function(){var e=!1;if(n.results)var t=n.results;else t=n.items;if(t.length>n.numOfItems){var o=n.numOfItems,i=t.length-o;i>200&&(i=200);for(var r=o;r<o+i;r++)t[r].group?(t[r].group.parentNode||u.appendChild(t[r].group),t[r].group.children[2].appendChild(t[r].element)):u.appendChild(t[r].element),n.numOfItems++;e=!0}return e},e.dropdown.hasEvents||("ontouchsend"in document.documentElement==1?document.addEventListener("touchsend",e.dropdown.mouseup):document.addEventListener("mouseup",e.dropdown.mouseup),document.addEventListener("keydown",e.dropdown.onkeydown),e.dropdown.hasEvents=!0),1==n.options.lazyLoading&&e.lazyLoading(u,{loadUp:n.loadUp,loadDown:n.loadDown}),n.init(),t.change=n.setValue,t.dropdown=n,n}).hasEvents=!1,e.dropdown.mouseup=function(t){var o=e.findElement(t.target,"jdropdown");if(o){var n=o.dropdown;if(t.target.classList.contains("jdropdown-header"))if(o.classList.contains("jdropdown-focus")&&o.classList.contains("jdropdown-default")){var i=o.getBoundingClientRect();if(t.changedTouches&&t.changedTouches[0])var r=t.changedTouches[0].clientX;else r=t.clientX;i.width-(r-i.left)<30?t.target.classList.contains("jdropdown-add")?n.add():n.close():0==n.options.autocomplete&&n.close()}else n.open();else if(t.target.classList.contains("jdropdown-group-name")){var s=t.target.nextSibling.children;if("none"!=t.target.nextSibling.style.display)for(var a=0;a<s.length;a++)"none"!=s[a].style.display&&n.selectItem(s[a])}else t.target.classList.contains("jdropdown-group-arrow")?t.target.classList.contains("jdropdown-group-arrow-down")?(t.target.classList.remove("jdropdown-group-arrow-down"),t.target.classList.add("jdropdown-group-arrow-up"),t.target.parentNode.nextSibling.style.display="none"):(t.target.classList.remove("jdropdown-group-arrow-up"),t.target.classList.add("jdropdown-group-arrow-down"),t.target.parentNode.nextSibling.style.display=""):t.target.classList.contains("jdropdown-item")?n.selectItem(t.target):t.target.classList.contains("jdropdown-image")||t.target.classList.contains("jdropdown-description")?n.selectItem(t.target.parentNode):t.target.classList.contains("jdropdown-title")?n.selectItem(t.target.parentNode.parentNode):(t.target.classList.contains("jdropdown-close")||t.target.classList.contains("jdropdown-backdrop"))&&n.close();t.stopPropagation(),t.preventDefault()}else e.dropdown.current&&e.dropdown.current.dropdown.close()},e.dropdown.onkeydown=function(t){if(e.dropdown.current){var o=e.dropdown.current.dropdown,n=o.currentIndex;t.shiftKey||13!=t.which&&27!=t.which&&35!=t.which&&36!=t.which&&38!=t.which&&40!=t.which||(13==t.which?o.selectIndex(n):38==t.which?null==n?o.firstVisible():n>0&&o.prev():40==t.which?null==n?o.firstVisible():n+1<o.items.length&&o.next():36==t.which?o.first():35==t.which?o.last():27==t.which&&o.close(),t.stopPropagation(),t.preventDefault())}},e.dropdown.extractFromDom=function(e,t){var o=e;if(t||(t={}),!e.getAttribute("multiple")||t&&null!=t.multiple||(t.multiple=!0),!e.getAttribute("placeholder")||t&&null!=t.placeholder||(t.placeholder=e.getAttribute("placeholder")),!e.getAttribute("data-autocomplete")||t&&null!=t.autocomplete||(t.autocomplete=!0),t&&null!=t.width||(t.width=e.offsetWidth),!e.value||t&&null!=t.value||(t.value=e.value),!t||null==t.data){t.data=[];for(var n=0;n<e.children.length;n++)if("OPTGROUP"==e.children[n].tagName)for(var i=0;i<e.children[n].children.length;i++)t.data.push({value:e.children[n].children[i].value,text:e.children[n].children[i].innerHTML,group:e.children[n].getAttribute("label")});else t.data.push({value:e.children[n].value,text:e.children[n].innerHTML})}t&&null!=t.onchange||(t.onchange=function(e,n,i,r){1==t.multiple?obj.items[n].classList.contains("jdropdown-selected")?o.options[n].setAttribute("selected","selected"):o.options[n].removeAttribute("selected"):o.value=r});var r=document.createElement("div");return e.parentNode.insertBefore(r,e),e.style.display="none",{el:e=r,options:t}},(e.editor=function(t,o){var n={options:{}};if("TEXTAREA"==t.tagName||"INPUT"==t.tagName){var i=t;i.style.display="none",t=document.createElement("div"),o.value||(o.value=i.value),o.onblur=function(e,t,o){i.value=t.getData()},i.insertBefore(t)}var r={value:null,snippet:null,toolbar:null,remoteParser:null,placeholder:null,parseURL:!1,filterPaste:!0,dropZone:!1,dropAsAttachment:!1,acceptImages:!1,acceptFiles:!1,maxFileSize:5e6,allowImageResize:!0,border:!0,padding:!0,maxHeight:null,height:null,focus:!1,onclick:null,onfocus:null,onblur:null,onload:null,onkeyup:null,onkeydown:null,onchange:null};for(var s in r)n.options[s]=o&&o.hasOwnProperty(s)?o[s]:r[s];var a=null,l=null;t.innerHTML="","function"==typeof n.options.onclick&&(t.onclick=function(e){n.options.onclick(t,n,e)}),t.classList.add("jeditor-container"),1==n.options.padding&&t.classList.add("jeditor-padding"),n.options.placeholder&&t.setAttribute("data-placeholder",n.options.placeholder),0==n.options.border&&(t.style.border="0px");var u=document.createElement("div");u.className="jsnippet",u.setAttribute("contenteditable",!1);var c=document.createElement("div");c.className="jeditor-toolbar";var d=document.createElement("div");if(d.setAttribute("contenteditable",!0),d.setAttribute("spellcheck",!1),d.className="jeditor",(n.options.maxHeight||n.options.height)&&(d.style.overflowY="auto",n.options.maxHeight&&(d.style.maxHeight=n.options.maxHeight),n.options.height&&(d.style.height=n.options.height)),n.options.value)var h=n.options.value;else h=t.innerHTML?t.innerHTML:"";h||(h="<br>");var p=function(e){"function"==typeof n.options.onchange&&n.options.onchange(t,n,e),n.options.value=n.getData(),t.value!=n.options.value&&(t.value=n.options.value,"function"==typeof t.onchange&&t.onchange({type:"change",target:t,value:t.value}))},f=function(e){var t=document.createElement("div");t.innerHTML=e;var o=t.querySelectorAll("img");if(o.length)for(var i=0;i<o.length;i++)n.addImage(o[i].src)},v=function(e){var t,o;window.getSelection&&(t=window.getSelection()).rangeCount&&((o=t.getRangeAt(0)).toString(),o.deleteContents(),o.insertNode(e),o.setStartAfter(e),o.setEndAfter(e),t.removeAllRanges(),t.addRange(o))},g=function(e){if(u.innerHTML="",e.image){(o=document.createElement("div")).className="jsnippet-image",o.setAttribute("data-k","image"),u.appendChild(o);var t=document.createElement("img");t.src=e.image,o.appendChild(t)}var o;(o=document.createElement("div")).className="jsnippet-title",o.setAttribute("data-k","title"),o.innerHTML=e.title,u.appendChild(o),(o=document.createElement("div")).className="jsnippet-description",o.setAttribute("data-k","description"),o.innerHTML=e.description,u.appendChild(o),(o=document.createElement("div")).className="jsnippet-host",o.setAttribute("data-k","host"),o.innerHTML=e.host,u.appendChild(o),(o=document.createElement("div")).className="jsnippet-url",o.setAttribute("data-k","url"),o.innerHTML=e.url,u.appendChild(o),d.appendChild(u)},b=function(){clearTimeout(a),a=setTimeout(function(){var o=d.querySelector(".jsnippet"),i=t.querySelector(".jeditor-thumbs-container");if(!o&&!i){var r=d.innerHTML.replace(/\n/g," "),s=document.createElement("div");s.innerHTML=r,(i=s.querySelector(".jeditor-thumbs-container"))&&i.remove();var a=e.editor.detectUrl(s.innerText);if(a)if("jpg"==a[0].substr(-3)||"png"==a[0].substr(-3)||"gif"==a[0].substr(-3))e.editor.getDomain(a[0])==window.location.hostname?n.importImage(a[0],""):n.importImage(n.options.remoteParser+a[0],"");else{var l=e.editor.youtubeParser(a[0]);n.parseWebsite(a[0],l)}}},1e3)};n.parseContent=function(){b()},n.parseWebsite=function(t,o){if(n.options.remoteParser){o&&(t="https://www.youtube.com/watch?v="+o);var i={title:"",description:"",image:"",host:t.split("/")[2],url:t};e.ajax({url:n.options.remoteParser+encodeURI(t.trim()),method:"GET",dataType:"json",success:function(e){e.title&&(i.title=e.title),e.description&&(i.description=e.description),e.image?i.image=e.image:e["og:image"]&&(i.image=e["og:image"]),e.host&&(i.host=e.host),e.url&&(i.url=e.url),g(i)}})}else console.log("The remoteParser is not defined")},n.setData=function(t){d.innerHTML=t,e.editor.setCursor(d,!0)},n.getText=function(){return d.innerText},n.getData=function(e){if(e){s={content:""};var t=d.querySelectorAll(".post-tag");if(t.length){s.users=[];for(var o=0;o<t.length;o++){var n=t[o].getAttribute("data-user");n&&s.users.push(n)}s.users=s.users.join(",")}if(u.innerHTML){for(s.snippet={},o=0;o<u.children.length;o++){var i=u.children[o].getAttribute("data-k");i&&("image"==i?s.snippet.image=u.children[o].children[0].getAttribute("src"):s.snippet[i]=u.children[o].innerHTML)}u.innerHTML="",u.remove()}var r=d.innerHTML;r=(r=(r=r.replace(/<br>/g,"\n")).replace(/<\/div>/g,"</div>\n")).replace(/<(?:.|\n)*?>/gm,""),s.content=r.trim(),s=JSON.stringify(s)}else var s=d.innerHTML;return s},n.reset=function(){d.innerHTML=""},n.addPdf=function(e){if("data"!=e.result.substr(0,4))console.error("Invalid source");else{var t=document.createElement("canvas");t.width=60,t.height=60;var o=new Image;t.getContext("2d").drawImage(o,0,0,t.width,t.height),t.toBlob(function(t){var o=document.createElement("img");o.src=window.URL.createObjectURL(t),o.setAttribute("data-extension","pdf"),e.name&&o.setAttribute("data-name",e.name),e.size&&o.setAttribute("data-size",e.size),e.date&&o.setAttribute("data-date",e.date),o.className="jfile pdf",v(o),o.content=e.result.substr(e.result.indexOf(",")+1)})}},n.getFiles=function(){return e.files(d).get()},n.addImage=function(e,t,o,i){if("data"==e.substr(0,4)||n.options.remoteParser){if("data"==e.substr(0,4))r=(r=(r=e.split(";"))[0].split("/"))[1];else{var r=e.substr(e.lastIndexOf(".")+1);e=n.options.remoteParser+e}var s=new Image;s.onload=function(){var e=document.createElement("canvas");e.width=s.width,e.height=s.height,e.getContext("2d").drawImage(s,0,0,e.width,e.height),e.toBlob(function(n){var s=document.createElement("img");s.src=window.URL.createObjectURL(n),s.setAttribute("tabindex","900"),s.setAttribute("data-extension",r),t&&s.setAttribute("data-name",t),o&&s.setAttribute("data-size",o),i&&s.setAttribute("data-date",i),s.className="jfile";var a=e.toDataURL();v(s),s.content=a.substr(a.indexOf(",")+1),p()})},s.src=e}else console.error("remoteParser not defined in your initialization")},n.addFile=function(e){for(var t=[],o=0;o<e.length;o++)if(e[o].size>n.options.maxFileSize)alert("The file is too big");else{var i=e[o].type.split("/");(i="image"==i[0]?1:"pdf"==i[1]?2:0)?(t[o]=new FileReader,t[o].index=o,t[o].type=i,t[o].name=e[o].name,t[o].date=e[o].lastModified,t[o].size=e[o].size,t[o].addEventListener("load",function(e){2==e.target.type?1==n.options.acceptFiles&&n.addPdf(e.target):n.addImage(e.target.result,e.target.name,e.total,e.target.lastModified)},!1),t[o].readAsDataURL(e[o])):alert("The extension is not allowed")}},n.destroy=function(){d.removeEventListener("mouseup",m),d.removeEventListener("mousedown",y),d.removeEventListener("mousemove",j),d.removeEventListener("keyup",w),d.removeEventListener("keydown",x),d.removeEventListener("dragstart",E),d.removeEventListener("dragenter",k),d.removeEventListener("dragover",_),d.removeEventListener("drop",A),d.removeEventListener("paste",C),"function"==typeof n.options.onblur&&d.removeEventListener("blur",O),"function"==typeof n.options.onfocus&&d.removeEventListener("focus",M),t.editor=null,t.classList.remove("jeditor-container"),c.remove(),u.remove(),d.remove()};var m=function(e){l=!1},y=function(e){var t=function(t){var o=t.getBoundingClientRect();o.width-(e.clientX-o.left)<40&&e.clientY-o.top<40&&(t.innerHTML="",t.remove())};if("IMG"==e.target.tagName)if(e.target.style.cursor){var o=e.target.getBoundingClientRect();l={e:e.target,x:e.clientX,y:e.clientY,w:o.width,h:o.height,d:e.target.style.cursor},e.target.style.width||(e.target.style.width=o.width+"px"),e.target.style.height||(e.target.style.height=o.height+"px");var n=window.getSelection();if(n.rangeCount)for(var i=0;i<n.rangeCount;i++)n.removeRange(n.getRangeAt(i))}else l=!0;else e.target.classList.contains("jsnippet")?t(e.target):e.target.parentNode.classList.contains("jsnippet")&&t(e.target.parentNode),l=!0},j=function(e){if("IMG"==e.target.tagName&&1==n.options.allowImageResize&&e.target.getAttribute("tabindex")){var t=e.target.getBoundingClientRect();e.target.style.cursor=e.clientY-t.top<5?t.width-(e.clientX-t.left)<5?"ne-resize":e.clientX-t.left<5?"nw-resize":"n-resize":t.height-(e.clientY-t.top)<5?t.width-(e.clientX-t.left)<5?"se-resize":e.clientX-t.left<5?"sw-resize":"s-resize":t.width-(e.clientX-t.left)<5?"e-resize":e.clientX-t.left<5?"w-resize":""}if(1==e.which&&l&&l.d){if("e-resize"==l.d||"ne-resize"==l.d||"se-resize"==l.d)if(l.e.style.width=l.w+(e.clientX-l.x)+"px",e.shiftKey)l.e.style.height=l.h+(o=l.h/l.w*(e.clientX-l.x))+"px";else var o=null;o||"s-resize"!=l.d&&"se-resize"!=l.d&&"sw-resize"!=l.d||e.shiftKey||(l.e.style.height=l.h+(e.clientY-l.y)+"px")}},w=function(e){d.innerHTML||(d.innerHTML="<div><br></div>"),"function"==typeof n.options.onkeyup&&n.options.onkeyup(t,n,e)},x=function(e){1==n.options.parseURL&&b(),"function"==typeof n.options.onkeydown&&n.options.onkeydown(t,n,e)},C=function(e){if(1==n.options.filterPaste){if(e.clipboardData||e.originalEvent.clipboardData)var t=(e.originalEvent||e).clipboardData.getData("text/html"),o=(e.originalEvent||e).clipboardData.getData("text/plain"),i=(e.originalEvent||e).clipboardData.files;else window.clipboardData&&(t=window.clipboardData.getData("Html"),o=window.clipboardData.getData("Text"),i=window.clipboardData.files);if(i.length)n.addFile(i);else{if(o=o.split("\r\n"),"DIV"==e.target.nodeName&&e.target.classList.contains("jeditor"))for(var r=0;r<o.length;r++){var s=document.createElement("div");o[r]?s.innerText=o[r]:s.innerHTML="<br/>",e.target.appendChild(s)}else{var a=document.createElement("div");for(r=0;r<o.length;r++)if(o[r]){var l=document.createElement("div");l.innerText=o[r],a.appendChild(l)}document.execCommand("insertHtml",!1,a.innerHTML)}1==n.options.acceptImages&&f(t)}e.preventDefault()}},E=function(e){l&&l.e&&e.preventDefault()},k=function(e){l||0==n.options.dropZone||t.classList.add("jeditor-dragging")},_=function(e){l||0==n.options.dropZone||(a&&clearTimeout(a),a=setTimeout(function(){t.classList.remove("jeditor-dragging")},100))},A=function(e){if(l||0==n.options.dropZone);else{var o=null;document.caretRangeFromPoint?o=document.caretRangeFromPoint(e.clientX,e.clientY):e.rangeParent&&(o=document.createRange()).setStart(e.rangeParent,e.rangeOffset);var i=window.getSelection();i.removeAllRanges(),i.addRange(o),i.anchorNode.parentNode.focus();var r=(e.originalEvent||e).dataTransfer.getData("text/html"),s=(e.originalEvent||e).dataTransfer.getData("text/plain"),a=(e.originalEvent||e).dataTransfer.files;a.length?n.addFile(a):s&&f(r),t.classList.remove("jeditor-dragging"),e.preventDefault()}},O=function(e){"function"==typeof n.options.onblur&&n.options.onblur(t,n,e),p(e)},M=function(e){"function"==typeof n.options.onfocus&&n.options.onfocus(t,n,e)};return d.addEventListener("mouseup",m),d.addEventListener("mousedown",y),d.addEventListener("mousemove",j),d.addEventListener("keyup",w),d.addEventListener("keydown",x),d.addEventListener("dragstart",E),d.addEventListener("dragenter",k),d.addEventListener("dragover",_),d.addEventListener("drop",A),d.addEventListener("paste",C),d.addEventListener("focus",M),d.addEventListener("blur",O),"function"==typeof n.options.onload&&n.options.onload(t,n,d),d.innerHTML=h,t.appendChild(d),n.options.snippet&&g(n.options.snippet),null==n.options.toolbar&&(n.options.toolbar=e.editor.getDefaultToolbar()),n.options.toolbar&&(e.toolbar(c,{container:!0,items:n.options.toolbar}),t.appendChild(c)),n.options.focus&&e.editor.setCursor(d,"initial"==n.options.focus),t.change=n.setData,t.editor=n,n}).setCursor=function(e,t){e.focus(),document.execCommand("selectAll");var o=window.getSelection(),n=o.getRangeAt(0);if(1==t)var i=n.startContainer,r=0;else r=(i=n.endContainer).length;n.setStart(i,r),n.setEnd(i,r),o.removeAllRanges(),o.addRange(n)},e.editor.getDomain=function(e){return e.replace("http://","").replace("https://","").replace("www.","").split(/[/?#]/)[0].split(/:/g)[0]},e.editor.detectUrl=function(e){var t=e.match(/(((https?:\/\/)|(www\.))[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|]+)/gi);return t&&"www"==t[0].substr(0,3)&&(t[0]="http://"+t[0]),t},e.editor.youtubeParser=function(e){var t=e.match(/^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#\&\?]*).*/);return!(!t||11!=t[7].length)&&t[7]},e.editor.getDefaultToolbar=function(){return[{content:"undo",onclick:function(){document.execCommand("undo")}},{content:"redo",onclick:function(){document.execCommand("redo")}},{type:"divisor"},{content:"format_bold",onclick:function(e,t,o){document.execCommand("bold"),document.queryCommandState("bold")?o.classList.add("selected"):o.classList.remove("selected")}},{content:"format_italic",onclick:function(e,t,o){document.execCommand("italic"),document.queryCommandState("italic")?o.classList.add("selected"):o.classList.remove("selected")}},{content:"format_underline",onclick:function(e,t,o){document.execCommand("underline"),document.queryCommandState("underline")?o.classList.add("selected"):o.classList.remove("selected")}},{type:"divisor"},{content:"format_list_bulleted",onclick:function(e,t,o){document.execCommand("insertUnorderedList"),document.queryCommandState("insertUnorderedList")?o.classList.add("selected"):o.classList.remove("selected")}},{content:"format_list_numbered",onclick:function(e,t,o){document.execCommand("insertOrderedList"),document.queryCommandState("insertOrderedList")?o.classList.add("selected"):o.classList.remove("selected")}},{content:"format_indent_increase",onclick:function(e,t,o){document.execCommand("indent",!0,null),document.queryCommandState("indent")?o.classList.add("selected"):o.classList.remove("selected")}},{content:"format_indent_decrease",onclick:function(){document.execCommand("outdent"),document.queryCommandState("outdent")?this.classList.add("selected"):this.classList.remove("selected")}}]},e.files=function(e){e||console.error("No element defined in the arguments of your method");var t={},o=[];return t.data=[],t.get=function(){return t.data},t.getNames=function(e){if(e&&e.folder)var t=e.folder;else t="/media";for(var n={},i=0;i<o.length;i++)if(o[i]&&"blob:"==o[i].src.substr(0,5)){var r=o[i].src.split("/");n[o[i].src]=t+"/"+r[r.length-1]+"."+o[i].getAttribute("data-extension")}return n},t.updateNames=function(e){if(e&&e.folder)var t=e.folder;else t="/media";for(var n=0;n<o.length;n++)if(o[n]&&"blob:"==o[n].src.substr(0,5)){var i=o[n].src.split("/");o[n].src=t+"/"+i[i.length-1]+"."+o[n].getAttribute("data-extension")}},t.remove=function(){var t=e.querySelectorAll(".jfile");if(t.length>0)for(var o=0;o<t.length;o++)t[o].getAttribute("src"),t[o].classList.contains("jremove")&&t[o].remove()},t.set=function(){o=[],t.data=[];var n=e.querySelectorAll(".jfile");if(n.length>0){for(var i=0;i<n.length;i++){var r={},s=n[i].getAttribute("src");n[i].classList.contains("jremove")?r.remove=1:("data:"==s.substr(0,5)?(r.content=s.substr(5),r.extension=n[i].getAttribute("data-extension")):(r.file=s,r.extension=n[i].getAttribute("data-extension"),r.extension||(r.extension=s.substr(s.lastIndexOf(".")+1)),n[i].content&&(r.content=n[i].content)),n[i].getAttribute("data-name")&&(r.name=n[i].getAttribute("data-name")),n[i].getAttribute("data-file")&&(r.file=n[i].getAttribute("data-file")),n[i].getAttribute("data-size")&&(r.size=n[i].getAttribute("data-size")),n[i].getAttribute("data-date")&&(r.date=n[i].getAttribute("data-date")),n[i].getAttribute("data-cover")&&(r.cover=n[i].getAttribute("data-cover"))),o.push(n[i]),t.data.push(r)}return t.data}},t.set(),t},(e.form=function(t,o){var n={options:{}},i={url:null,message:"Are you sure? There are unsaved information in your form",ignore:!1,currentHash:null,submitButton:null,validations:null,onload:null,onbeforesave:null,onsave:null,onerror:function(t,o){e.alert(o)}};for(var r in i)n.options[r]=o&&o.hasOwnProperty(r)?o[r]:i[r];return n.options.validations||(n.options.validations={}),n.options.submitButton||(n.options.submitButton=t.querySelector("input[type=submit]")),n.options.submitButton&&n.options.url&&(n.options.submitButton.onclick=function(){n.save()}),n.options.validations.email||(n.options.validations.email=e.validations.email),n.options.validations.length||(n.options.validations.length=e.validations.length),n.options.validations.required||(n.options.validations.required=e.validations.required),n.setUrl=function(e){n.options.url=e},n.load=function(){e.ajax({url:n.options.url,method:"GET",dataType:"json",success:function(o){e.form.setElements(t,o),"function"==typeof n.options.onload&&n.options.onload(t,o)}})},n.save=function(){var o=n.validate();if(o)n.options.onerror(t,o);else{var i=e.form.getElements(t,!0);if("function"==typeof n.options.onbeforesave&&!1===(i=n.options.onbeforesave(t,i)))return void console.log("Onbeforesave returned false");e.ajax({url:n.options.url,method:"POST",dataType:"json",data:i,success:function(e){"function"==typeof n.options.onsave&&n.options.onsave(t,i,e),n.reset()}})}},n.validateElement=function(e){var o=!1,i=e.getAttribute("data-validation");return"function"!=typeof n.options.validations[i]||n.options.validations[i](e.value,e)?e.classList.contains("error")&&function(e){var o=!1;e.classList.remove("error"),e.removeAttribute("title");for(var i=t.querySelectorAll("input, select, textarea"),r=0;r<i.length;r++)i[r].getAttribute("data-validation")&&i[r].classList.contains("error")&&(o=!0);n.options.submitButton&&(o?n.options.submitButton.setAttribute("disabled",!0):n.options.submitButton.removeAttribute("disabled"))}(e):o=function(e){e.classList.add("error"),n.options.submitButton&&n.options.submitButton.setAttribute("disabled",!0);var t=e.getAttribute("data-error")||"There is an error in the form";return e.setAttribute("title",t),t}(e),o},n.reset=function(){for(var e=t.querySelectorAll("input, select, textarea"),o=0;o<e.length;o++)"INPUT"==e[o].tagName&&"checkbox"==e[o].type?e[o].removeAttribute("checked"):e[o].value=""},n.validate=function(){for(var e=[],o=t.querySelectorAll("input, select, textarea"),i=0;i<o.length;i++)if(o[i].getAttribute("data-validation")){var r=n.validateElement(o[i]);r&&e.push(r)}return e.length>0&&e.join("<br>")},n.getError=function(){return!!n.validation()},n.setHash=function(){return n.getHash(e.form.getElements(t))},n.getHash=function(e){var t,o=0;if(0===e.length)return o;for(t=0;t<e.length;t++)o=(o<<5)-o+e.charCodeAt(t),o|=0;return o},n.isChanged=function(){var e=n.setHash();return n.options.currentHash!=e},n.resetTracker=function(){n.options.currentHash=n.setHash(),n.options.ignore=!1},n.reset=function(){n.options.currentHash=n.setHash(),n.options.ignore=!1},n.setIgnore=function(e){n.options.ignore=!!e},setTimeout(function(){n.options.currentHash=n.setHash()},1e3),t.addEventListener("keyup",function(e){e.target.getAttribute("data-validation")&&n.validateElement(e.target)}),e.form.hasEvents||(window.addEventListener("beforeunload",function(e){if(n.isChanged()&&0==n.options.ignore){var t=n.options.message?n.options.message:"o/";return t?(void 0===e&&(e=window.event),e&&(e.returnValue=t),t):void 0}}),e.form.hasEvents=!0),t.form=n,n}).getElements=function(e,t){for(var o={},n=e.querySelectorAll("input, select, textarea"),i=0;i<n.length;i++){var r=n[i],s=r.name,a=r.value;s&&("checkbox"!=n[i].type&&"radio"!=n[i].type||(a=n[i].checked),o[s]=a)}return 1==t?o:JSON.stringify(o)},e.form.setElements=function(e,t){for(var o=e.querySelectorAll("input, select, textarea"),n=0;n<o.length;n++){var i=o[n].getAttribute("name"),r=o[n].getAttribute("type");"checkbox"==r||"radio"==r?t[i]&&(o[n].checked=!0):t[i]&&(o[n].value=t[i])}},e.tracker=e.form,e.focus=function(e){if(e.innerText.length){var t=document.createRange(),o=window.getSelection(),n=e.childNodes[e.childNodes.length-1];t.setStart(n,n.length),t.collapse(!0),o.removeAllRanges(),o.addRange(t),e.scrollLeft=e.scrollWidth}},e.isNumeric=function(e){return!isNaN(e)&&null!=e&&""!=e},e.guid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})},e.hash=function(e){var t,o=0;if(0===e.length)return o;for(t=0;t<e.length;t++)o=(o<<5)-o+e.charCodeAt(t),o|=0;return o},e.randomColor=function(t){var o=String("#"+Math.random().toString(16).slice(2,8).toUpperCase()).replace(/[^0-9a-f]/gi,"");o.length<6&&(o=o[0]+o[0]+o[1]+o[1]+o[2]+o[2]);var n,i,r=[];for(i=0;i<3;i++)n=parseInt(o.substr(2*i,2),16),n=Math.round(Math.min(Math.max(0,n+-.25*n),255)).toString(16),r.push(("00"+n).substr(n.length));return 1==t?"#"+e.two(color[0].toString(16))+e.two(color[1].toString(16))+e.two(color[2].toString(16)):r},e.getWindowWidth=function(){var e=window,t=document,o=t.documentElement,n=t.getElementsByTagName("body")[0];return e.innerWidth||o.clientWidth||n.clientWidth},e.getWindowHeight=function(){var e=window,t=document,o=t.documentElement,n=t.getElementsByTagName("body")[0];return e.innerHeight||o.clientHeight||n.clientHeight},e.getPosition=function(e){if(e.changedTouches&&e.changedTouches[0])var t=e.changedTouches[0].pageX,o=e.changedTouches[0].pageY;else t=window.Event?e.pageX:e.clientX+(document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft),o=window.Event?e.pageY:e.clientY+(document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop);return[t,o]},e.click=function(e){if(e.click)e.click();else{var t=new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window});e.dispatchEvent(t)}},e.findElement=function(e,t){var o=!1;return function e(n){n&&!o&&("function"==typeof t?o=t(n):"string"==typeof t&&n.classList&&n.classList.contains(t)&&(o=n)),n.parentNode&&!o&&e(n.parentNode)}(e),o},e.two=function(e){return 1==(e=""+e).length&&(e="0"+e),e},e.sha512=function(e){function t(e,t){this.highOrder=e,this.lowOrder=t}var o,n,i,r,s,a,l,u,c,d,h=[new t(1779033703,4089235720),new t(3144134277,2227873595),new t(1013904242,4271175723),new t(2773480762,1595750129),new t(1359893119,2917565137),new t(2600822924,725511199),new t(528734635,4215389547),new t(1541459225,327033209)],p=[new t(1116352408,3609767458),new t(1899447441,602891725),new t(3049323471,3964484399),new t(3921009573,2173295548),new t(961987163,4081628472),new t(1508970993,3053834265),new t(2453635748,2937671579),new t(2870763221,3664609560),new t(3624381080,2734883394),new t(310598401,1164996542),new t(607225278,1323610764),new t(1426881987,3590304994),new t(1925078388,4068182383),new t(2162078206,991336113),new t(2614888103,633803317),new t(3248222580,3479774868),new t(3835390401,2666613458),new t(4022224774,944711139),new t(264347078,2341262773),new t(604807628,2007800933),new t(770255983,1495990901),new t(1249150122,1856431235),new t(1555081692,3175218132),new t(1996064986,2198950837),new t(2554220882,3999719339),new t(2821834349,766784016),new t(2952996808,2566594879),new t(3210313671,3203337956),new t(3336571891,1034457026),new t(3584528711,2466948901),new t(113926993,3758326383),new t(338241895,168717936),new t(666307205,1188179964),new t(773529912,1546045734),new t(1294757372,1522805485),new t(1396182291,2643833823),new t(1695183700,2343527390),new t(1986661051,1014477480),new t(2177026350,1206759142),new t(2456956037,344077627),new t(2730485921,1290863460),new t(2820302411,3158454273),new t(3259730800,3505952657),new t(3345764771,106217008),new t(3516065817,3606008344),new t(3600352804,1432725776),new t(4094571909,1467031594),new t(275423344,851169720),new t(430227734,3100823752),new t(506948616,1363258195),new t(659060556,3750685593),new t(883997877,3785050280),new t(958139571,3318307427),new t(1322822218,3812723403),new t(1537002063,2003034995),new t(1747873779,3602036899),new t(1955562222,1575990012),new t(2024104815,1125592928),new t(2227730452,2716904306),new t(2361852424,442776044),new t(2428436474,593698344),new t(2756734187,3733110249),new t(3204031479,2999351573),new t(3329325298,3815920427),new t(3391569614,3928383900),new t(3515267271,566280711),new t(3940187606,3454069534),new t(4118630271,4000239992),new t(116418474,1914138554),new t(174292421,2731055270),new t(289380356,3203993006),new t(460393269,320620315),new t(685471733,587496836),new t(852142971,1086792851),new t(1017036298,365543100),new t(1126000580,2618297676),new t(1288033470,3409855158),new t(1501505948,4234509866),new t(1607167915,987167468),new t(1816402316,1246189591)],f=new Array(64);function v(e,o){var n,i,r;return r=(65535&(i=(e.lowOrder>>>16)+(o.lowOrder>>>16)+((n=(65535&e.lowOrder)+(65535&o.lowOrder))>>>16)))<<16|65535&n,new t((65535&(i=(e.highOrder>>>16)+(o.highOrder>>>16)+((n=(65535&e.highOrder)+(65535&o.highOrder)+(i>>>16))>>>16)))<<16|65535&n,r)}function g(e,o,n,i){var r,s,a;return a=(65535&(s=(e.lowOrder>>>16)+(o.lowOrder>>>16)+(n.lowOrder>>>16)+(i.lowOrder>>>16)+((r=(65535&e.lowOrder)+(65535&o.lowOrder)+(65535&n.lowOrder)+(65535&i.lowOrder))>>>16)))<<16|65535&r,new t((65535&(s=(e.highOrder>>>16)+(o.highOrder>>>16)+(n.highOrder>>>16)+(i.highOrder>>>16)+((r=(65535&e.highOrder)+(65535&o.highOrder)+(65535&n.highOrder)+(65535&i.highOrder)+(s>>>16))>>>16)))<<16|65535&r,a)}function b(e,o,n,i,r){var s,a,l;return l=(65535&(a=(e.lowOrder>>>16)+(o.lowOrder>>>16)+(n.lowOrder>>>16)+(i.lowOrder>>>16)+(r.lowOrder>>>16)+((s=(65535&e.lowOrder)+(65535&o.lowOrder)+(65535&n.lowOrder)+(65535&i.lowOrder)+(65535&r.lowOrder))>>>16)))<<16|65535&s,new t((65535&(a=(e.highOrder>>>16)+(o.highOrder>>>16)+(n.highOrder>>>16)+(i.highOrder>>>16)+(r.highOrder>>>16)+((s=(65535&e.highOrder)+(65535&o.highOrder)+(65535&n.highOrder)+(65535&i.highOrder)+(65535&r.highOrder)+(a>>>16))>>>16)))<<16|65535&s,l)}function m(e,o,n){return new t(e.highOrder&o.highOrder^e.highOrder&n.highOrder^o.highOrder&n.highOrder,e.lowOrder&o.lowOrder^e.lowOrder&n.lowOrder^o.lowOrder&n.lowOrder)}function y(e,o,n){return new t(e.highOrder&o.highOrder^~e.highOrder&n.highOrder,e.lowOrder&o.lowOrder^~e.lowOrder&n.lowOrder)}function j(e,o){return o<=32?new t(e.highOrder>>>o|e.lowOrder<<32-o,e.lowOrder>>>o|e.highOrder<<32-o):new t(e.lowOrder>>>o|e.highOrder<<32-o,e.highOrder>>>o|e.lowOrder<<32-o)}function w(e){var o=j(e,28),n=j(e,34),i=j(e,39);return new t(o.highOrder^n.highOrder^i.highOrder,o.lowOrder^n.lowOrder^i.lowOrder)}function x(e){var o=j(e,14),n=j(e,18),i=j(e,41);return new t(o.highOrder^n.highOrder^i.highOrder,o.lowOrder^n.lowOrder^i.lowOrder)}function C(e){var o=j(e,1),n=j(e,8),i=E(e,7);return new t(o.highOrder^n.highOrder^i.highOrder,o.lowOrder^n.lowOrder^i.lowOrder)}function E(e,o){return o<=32?new t(e.highOrder>>>o,e.lowOrder>>>o|e.highOrder<<32-o):new t(0,e.highOrder<<32-o)}var k,_,A,O,M=8*(e=function(e){return unescape(encodeURIComponent(e))}(e)).length;(e=function(e){for(var t=[],o=8*e.length,n=0;n<o;n+=8)t[n>>5]|=(255&e.charCodeAt(n/8))<<24-n%32;return t}(e))[M>>5]|=128<<24-M%32,e[31+(M+128>>10<<5)]=M;for(var I=0;I<e.length;I+=32){o=h[0],n=h[1],i=h[2],r=h[3],s=h[4],a=h[5],l=h[6],u=h[7];for(var N=0;N<80;N++)f[N]=N<16?new t(e[2*N+I],e[2*N+I+1]):g((_=j(k=f[N-2],19),A=j(k,61),O=E(k,6),new t(_.highOrder^A.highOrder^O.highOrder,_.lowOrder^A.lowOrder^O.lowOrder)),f[N-7],C(f[N-15]),f[N-16]),c=b(u,x(s),y(s,a,l),p[N],f[N]),d=v(w(o),m(o,n,i)),u=l,l=a,a=s,s=v(r,c),r=i,i=n,n=o,o=v(c,d);h[0]=v(o,h[0]),h[1]=v(n,h[1]),h[2]=v(i,h[2]),h[3]=v(r,h[3]),h[4]=v(s,h[4]),h[5]=v(a,h[5]),h[6]=v(l,h[6]),h[7]=v(u,h[7])}var S=[];for(I=0;I<h.length;I++)S.push(h[I].highOrder),S.push(h[I].lowOrder);return function(e){for(var t,o="0123456789abcdef",n="",i=4*e.length,r=0;r<i;r+=1)n+=o.charAt((t=e[r>>2]>>8*(3-r%4))>>4&15)+o.charAt(15&t);return n}(S)},e.login||((e.login={}).sha512=e.sha512),(e.image=function(t,o){var n={options:{}},i={input:!1,minWidth:!1,maxWidth:null,maxHeight:null,maxJpegSizeBytes:null,onchange:null,singleFile:!0,remoteParser:null,text:{extensionNotAllowed:"The extension is not allowed",imageTooSmall:"The resolution is too low, try a image with a better resolution. width > 800px"}};for(var r in i)n.options[r]=o&&o.hasOwnProperty(r)?o[r]:i[r];t.classList.add("jupload"),1==n.options.input&&t.classList.add("input"),n.addImage=function(t){return e.image.create(t)},n.addImages=function(e){1==n.options.singleFile&&(t.innerHTML="");for(var o=0;o<e.length;o++)t.appendChild(n.addImage(e[o]))},n.addFromFile=function(e){if("image"==e.type.split("/")[0]){1==n.options.singleFile&&(t.innerHTML="");var o=new FileReader;o.addEventListener("load",function(o){var i=new Image;i.onload=function(){var o=document.createElement("canvas");o.width=i.width,o.height=i.height,o.getContext("2d").drawImage(i,0,0,o.width,o.height);var r={file:n.getDataURL(o,e.type),extension:e.name.substr(e.name.lastIndexOf(".")+1),name:e.name,size:e.size,lastmodified:e.lastModified};if("data:"==this.src.substr(0,5)){var s=this.src.split(",");r.content=s[1]}var a=n.addImage(r);t.appendChild(a),"function"==typeof n.options.onchange&&n.options.onchange(a,r)},i.src=o.srcElement.result}),o.readAsDataURL(e)}else alert(text.extentionNotAllowed)},n.addFromUrl=function(e){if("data"==e.substr(0,4)||n.options.remoteParser){if("data"==e.substr(0,4))o=(o=(o=e.split(";"))[0].split("/"))[1];else{var o=e.substr(e.lastIndexOf(".")+1);e=n.options.remoteParser+e}var i=new Image;i.onload=function(){var e=document.createElement("canvas");e.width=i.width,e.height=i.height,e.getContext("2d").drawImage(i,0,0,e.width,e.height),e.toBlob(function(i){var r={file:window.URL.createObjectURL(i),extension:o};r.content=e.toDataURL(),r.content=r.content.split(","),r.content=r.content[1];var s=n.addImage(r);t.appendChild(s),"function"==typeof n.options.onchange&&n.options.onchange(s,r)})},i.src=e}else console.error("remoteParser not defined in your initialization")},n.getCanvas=function(e){var t=document.createElement("canvas"),o=Math.min((n.options.maxWidth||e.width)/e.width,(n.options.maxHeight||e.height)/e.height,1);return t.width=e.width*o,t.height=e.height*o,t},n.getDataURL=function(e,t){for(var o=.92,i=null,r=e.toDataURL(t,o);n.options.maxJpegSizeBytes&&"image/jpeg"===t&&r.length>n.options.maxJpegSizeBytes&&r.length!==i;)i=r.length,r=e.toDataURL(t,o*=.9);return r};var s=document.createElement("input");return s.type="file",s.setAttribute("accept","image/*"),s.onchange=function(){for(var e=0;e<this.files.length;e++)n.addFromFile(this.files[e])},t.addEventListener("click",function(t){e.click(s)}),t.addEventListener("dragenter",function(e){t.style.border="1px dashed #000"}),t.addEventListener("dragleave",function(e){t.style.border="1px solid #eee"}),t.addEventListener("dragstop",function(e){t.style.border="1px solid #eee"}),t.addEventListener("dragover",function(e){e.preventDefault()}),t.addEventListener("drop",function(e){e.preventDefault(),e.stopPropagation();var o=(e.originalEvent||e).dataTransfer.getData("text/html");if((e.originalEvent||e).dataTransfer.files.length)for(var i=0;i<e.dataTransfer.files.length;i++)n.addFromFile(e.dataTransfer.files[i]);else if(o){1==n.options.singleFile&&(t.innerHTML="");var r=document.createElement("div");r.innerHTML=o;var s=r.querySelectorAll("img");if(s.length)for(i=0;i<s.length;i++)n.addFromUrl(s[i].src)}return t.style.border="1px solid #eee",!1}),t.image=n,n}).create=function(e){e.date||(e.date="");var t=document.createElement("img");return t.setAttribute("data-date",e.lastmodified?e.lastmodified:e.date),t.setAttribute("data-name",e.name),t.setAttribute("data-size",e.size),t.setAttribute("data-small",e.small?e.small:""),t.setAttribute("data-cover",e.cover?1:0),t.setAttribute("data-extension",e.extension),t.setAttribute("src",e.file),t.className="jfile",t.style.width="100%",e.content&&(t.content=e.content),t},e.lazyLoading=function(e,t){t.loadUp&&"function"==typeof t.loadUp||(t.loadUp=function(){return!1}),t.loadDown&&"function"==typeof t.loadDown||(t.loadDown=function(){return!1}),t.timer||(t.timer=100);var o=null,n=function(n){if(null==o){var i=e.scrollTop;e.scrollTop+2*e.clientHeight>=e.scrollHeight?t.loadDown()&&i==e.scrollTop&&(e.scrollTop=e.scrollTop-e.clientHeight):e.scrollTop<=e.clientHeight&&t.loadUp()&&i==e.scrollTop&&(e.scrollTop=e.scrollTop+e.clientHeight),o=setTimeout(function(){o=null},t.timer)}};return e.onscroll=function(e){n()},e.onwheel=function(e){n()},{}},e.loading=function(){var e={},t=null;return e.show=function(){t||((t=document.createElement("div")).className="jloading"),document.body.appendChild(t)},e.hide=function(){t&&document.body.removeChild(t)},e}(),e.mask=function(){var t={},o=0,n=[],i=[];return t.run=function(i,r,s){if(i.toString().length&&r.toString().length){if(void 0===s&&(s="."),e.isNumeric(i))var a=(""+i).split(s),l=(i=a[0],a[1]);else i=""+i;var u;if(o=0,n=[],t.prepare(r),u=i)for(var c=0;c<u.length;c++)null!=u[c]&&t.process(u[c]);if(l&&(t.process(s),u=l))for(c=0;c<u.length;c++)null!=u[c]&&t.process(u[c]);return n.join("")}return""},t.apply=function(r){if(r.target&&!r.target.getAttribute("readonly")){var s=r.target.getAttribute("data-mask");if(s&&r.key.length<2){o=0,n=[],t.prepare(s);var a="";if("DIV"==r.target.tagName){if(r.target.innerText){var l=window.getSelection();a=l&&l.anchorOffset!=l.focusOffset?r.target.innerText.substring(0,l.anchorOffset>l.focusOffset?l.focusOffset:l.anchorOffset):r.target.innerText}}else a=r.target.selectionStart<r.target.selectionEnd?r.target.value.substring(0,r.target.selectionStart):r.target.value;if(a)for(var u=0;u<a.length;u++)null!=a[u]&&t.process(a[u]);t.process(t.fromKeyCode(r)),r.preventDefault();var c=n.join("");"DIV"==r.target.tagName?c!=r.target.innerText&&(r.target.innerText=c,e.focus(r.target)):r.target.value=c,r.target.setAttribute("data-completed",i.length==n.length&&i[i.length-1].length==n[n.length-1].length?"true":"false")}}},t.process=function(e){do{if("mm"==i[o])return null==n[o]||""==n[o]?parseInt(e)>1&&parseInt(e)<10?(n[o]="0"+e,o++,!0):parseInt(e)<10&&(n[o]=e,!0):(1==n[o]&&n[o]<2&&parseInt(e)<3||0==n[o]&&n[o]<10)&&(n[o]+=e,o++,!0);if("dd"==i[o])return null==n[o]||""==n[o]?parseInt(e)>3&&parseInt(e)<10?(n[o]="0"+e,o++,!0):parseInt(e)<10&&(n[o]=e,!0):(3==n[o]&&parseInt(e)<2||n[o]<3&&parseInt(e)<10)&&(n[o]+=e,o++,!0);if("hh24"==i[o])return null==n[o]||""==n[o]?parseInt(e)>2&&parseInt(e)<10?(n[o]="0"+e,o++,!0):parseInt(e)<10&&(n[o]=e,!0):(2==n[o]&&parseInt(e)<4||n[o]<2&&parseInt(e)<10)&&(n[o]+=e,o++,!0);if("hh"==i[o])return null==n[o]||""==n[o]?parseInt(e)>1&&parseInt(e)<10?(n[o]="0"+e,o++,!0):parseInt(e)<10&&(n[o]=e,!0):(1==n[o]&&parseInt(e)<3||n[o]<1&&parseInt(e)<10)&&(n[o]+=e,o++,!0);if("mi"==i[o]||"ss"==i[o])return null==n[o]||""==n[o]?parseInt(e)>5&&parseInt(e)<10?(n[o]="0"+e,o++,!0):parseInt(e)<10&&(n[o]=e,!0):parseInt(e)<10&&(n[o]+=e,o++,!0);if("yy"==i[o]||"yyyy"==i[o])return parseInt(e)<10&&(null==n[o]||""==n[o]?n[o]=e:n[o]+=e,n[o].length==i[o].length&&o++,!0);if("#"==i[o]||"#.##"==i[o]||"#,##"==i[o]||"# ##"==i[o]||"#'##"==i[o]){if(e.match(/[0-9]/g)){if("#.##"==i[o])var t=".";else t="#,##"==i[o]?",":"# ##"==i[o]?" ":"#'##"==i[o]?"'":"";if(null==n[o]||""==n[o])n[o]=e;else if(n[o]+=e,t){n[o]=n[o].match(/[0-9]/g).join("");for(var r=[],s=0,a=n[o].length-1;a>=0;a--)r.push(n[o][a]),++s%3||r.push(t);r=r.reverse(),n[o]=r.join(""),n[o].substr(0,1)==t&&(n[o]=n[o].substr(1))}return!0}if("#.##"==i[o]&&"."==e);else if("#,##"==i[o]&&","==e);else if("# ##"==i[o]&&" "==e);else if("#'##"==i[o]&&"'"==e);else if(n[o]&&(o++,i[o])){if(i[o]==e)return n[o]=e,!0;if("0"==i[o]&&i[o+1]==e)return o++,n[o]=e,!0}return!1}if("0"==i[o])return!!e.match(/[0-9]/g)&&(n[o]=e,o++,!0);if("a"==i[o])return!!e.match(/[a-zA-Z]/g)&&(n[o]=e,o++,!0);if(null!=i[o]){if("\\a"==i[o])var l="a";else l="\\0"==i[o]?"0":"[-]"==i[o]?"-"==e||"+"==e?e:" ":i[o];if(n[o]=l,e==l)return o++,!0}o++}while(i[o])},t.prepare=function(e){i=[];for(var t=0;t<e.length;t++)e[t].match(/[0-9]|[a-z]|\\/g)?"y"==e[t]&&"y"==e[t+1]&&"y"==e[t+2]&&"y"==e[t+3]?(i.push("yyyy"),t+=3):"y"==e[t]&&"y"==e[t+1]?(i.push("yy"),t++):"m"==e[t]&&"m"==e[t+1]&&"m"==e[t+2]&&"m"==e[t+3]?(i.push("mmmm"),t+=3):"m"==e[t]&&"m"==e[t+1]&&"m"==e[t+2]?(i.push("mmm"),t+=2):"m"==e[t]&&"m"==e[t+1]?(i.push("mm"),t++):"d"==e[t]&&"d"==e[t+1]?(i.push("dd"),t++):"h"==e[t]&&"h"==e[t+1]&&"2"==e[t+2]&&"4"==e[t+3]?(i.push("hh24"),t+=3):"h"==e[t]&&"h"==e[t+1]?(i.push("hh"),t++):"m"==e[t]&&"i"==e[t+1]?(i.push("mi"),t++):"s"==e[t]&&"s"==e[t+1]?(i.push("ss"),t++):"a"==e[t]&&"m"==e[t+1]?(i.push("am"),t++):"p"==e[t]&&"m"==e[t+1]?(i.push("pm"),t++):"\\"==e[t]&&"0"==e[t+1]?(i.push("\\0"),t++):"\\"==e[t]&&"a"==e[t+1]?(i.push("\\a"),t++):i.push(e[t]):"#"==e[t]&&"."==e[t+1]&&"#"==e[t+2]&&"#"==e[t+3]?(i.push("#.##"),t+=3):"#"==e[t]&&","==e[t+1]&&"#"==e[t+2]&&"#"==e[t+3]?(i.push("#,##"),t+=3):"#"==e[t]&&" "==e[t+1]&&"#"==e[t+2]&&"#"==e[t+3]?(i.push("# ##"),t+=3):"#"==e[t]&&"'"==e[t+1]&&"#"==e[t+2]&&"#"==e[t+3]?(i.push("#'##"),t+=3):"["==e[t]&&"-"==e[t+1]&&"]"==e[t+2]?(i.push("[-]"),t+=2):i.push(e[t])},t.fromKeyCode=function(e){var t={188:"44",109:"45",190:"46",191:"47",192:"96",220:"92",222:"39",221:"93",219:"91",173:"45",187:"61",186:"59",189:"45"},o={96:"~",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",48:")",45:"_",61:"+",91:"{",93:"}",92:"|",59:":",39:'"',44:"<",46:">",47:"?"},n=e.which;return t.hasOwnProperty(n)&&(n=t[n]),!e.shiftKey&&n>=65&&n<=90?String.fromCharCode(n+32):e.shiftKey&&o.hasOwnProperty(n)?o[n]:String.fromCharCode(96<=n&&n<=105?n-48:n)},"undefined"!=typeof document&&document.addEventListener("keydown",function(t){e.mask&&e.mask.apply(t)}),t}(),(e.modal=function(t,o){var n={options:{}},i={url:null,onopen:null,onclose:null,closed:!1,width:null,height:null,title:null,padding:null};for(var r in i)n.options[r]=o&&o.hasOwnProperty(r)?o[r]:i[r];!n.options.title&&t.getAttribute("title")&&(n.options.title=t.getAttribute("title"));for(var s=document.createElement("div");t.children[0];)s.appendChild(t.children[0]);for(n.content=document.createElement("div"),n.content.className="jmodal_content",n.content.innerHTML=t.innerHTML;s.children[0];)n.content.appendChild(s.children[0]);n.container=document.createElement("div"),n.container.className="jmodal",n.container.appendChild(n.content),n.options.padding&&(n.content.style.padding=n.options.padding),n.options.width&&(n.container.style.width=n.options.width),n.options.height&&(n.container.style.height=n.options.height),n.options.title?n.container.setAttribute("title",n.options.title):n.container.classList.add("no-title"),t.innerHTML="",t.style.display="none",t.appendChild(n.container);var a=document.createElement("div");return a.className="jmodal_backdrop",a.onclick=function(){n.close()},t.appendChild(a),n.open=function(){t.style.display="block";var o=n.container.getBoundingClientRect();e.getWindowWidth()<o.width?(n.container.style.top="",n.container.style.left="",n.container.classList.add("jmodal_fullscreen"),e.animation.slideBottom(n.container,1)):a.style.display="block",e.modal.current=n,"function"==typeof n.options.onopen&&n.options.onopen(t,n)},n.resetPosition=function(){n.container.style.top="",n.container.style.left=""},n.isOpen=function(){return"none"!=t.style.display},n.close=function(){t.style.display="none",a.style.display="",e.modal.current=null,n.container.classList.remove("jmodal_fullscreen"),"function"==typeof n.options.onclose&&n.options.onclose(t,n)},e.modal.hasEvents||(e.modal.current=n,"ontouchstart"in document.documentElement==1?document.addEventListener("touchstart",e.modal.mouseDownControls):(document.addEventListener("mousedown",e.modal.mouseDownControls),document.addEventListener("mousemove",e.modal.mouseMoveControls),document.addEventListener("mouseup",e.modal.mouseUpControls)),document.addEventListener("keydown",e.modal.keyDownControls),e.modal.hasEvents=!0),n.options.url?e.ajax({url:n.options.url,method:"GET",dataType:"text/html",success:function(e){n.content.innerHTML=e,n.options.closed||n.open()}}):n.options.closed||n.open(),t.modal=n,n}).current=null,e.modal.position=null,e.modal.keyDownControls=function(t){27==t.which&&e.modal.current&&e.modal.current.close()},e.modal.mouseUpControls=function(t){e.modal.current&&(e.modal.current.container.style.cursor="auto"),e.modal.position=null},e.modal.mouseMoveControls=function(t){if(e.modal.current&&e.modal.position)if(1==t.which||3==t.which){var o=e.modal.position;e.modal.current.container.style.top=o[1]+(t.clientY-o[3])+o[5]/2+"px",e.modal.current.container.style.left=o[0]+(t.clientX-o[2])+o[4]/2+"px",e.modal.current.container.style.cursor="move"}else e.modal.current.container.style.cursor="auto"},e.modal.mouseDownControls=function(t){e.modal.position=[],t.target.classList.contains("jmodal")&&setTimeout(function(){var o=t.target.getBoundingClientRect();if(t.changedTouches&&t.changedTouches[0])var n=t.changedTouches[0].clientX,i=t.changedTouches[0].clientY;else n=t.clientX,i=t.clientY;o.width-(n-o.left)<50&&i-o.top<50?setTimeout(function(){e.modal.current.close()},100):t.target.getAttribute("title")&&i-o.top<50&&(document.selection?document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges(),e.modal.position=[o.left,o.top,t.clientX,t.clientY,o.width,o.height])},100)},(e.notification=function(t){var o={options:{}},n={icon:null,name:"Notification",date:null,error:null,title:null,message:null,timeout:4e3,autoHide:!0,closeable:!0};for(var i in n)o.options[i]=t&&t.hasOwnProperty(i)?t[i]:n[i];var r=document.createElement("div");r.className="jnotification",o.options.error&&r.classList.add("jnotification-error");var s=document.createElement("div");s.className="jnotification-container",r.appendChild(s);var a=document.createElement("div");a.className="jnotification-header",s.appendChild(a);var l=document.createElement("div");if(l.className="jnotification-image",a.appendChild(l),o.options.icon){var u=document.createElement("img");u.src=o.options.icon,l.appendChild(u)}var c=document.createElement("div");if(c.className="jnotification-name",c.innerHTML=o.options.name,a.appendChild(c),1==o.options.closeable){var d=document.createElement("div");d.className="jnotification-close",d.onclick=function(){o.hide()},a.appendChild(d)}var h=document.createElement("div");h.className="jnotification-date",a.appendChild(h);var p=document.createElement("div");if(p.className="jnotification-content",s.appendChild(p),o.options.title){var f=document.createElement("div");f.className="jnotification-title",f.innerHTML=o.options.title,p.appendChild(f)}var v=document.createElement("div");if(v.className="jnotification-message",v.innerHTML=o.options.message,p.appendChild(v),o.show=function(){document.body.appendChild(r),e.getWindowWidth()>800?e.animation.fadeIn(r):e.animation.slideTop(r,1)},o.hide=function(){e.getWindowWidth()>800?e.animation.fadeOut(r,function(){r.parentNode&&(r.parentNode.removeChild(r),g&&clearTimeout(g))}):e.animation.slideTop(r,0,function(){r.parentNode&&(r.parentNode.removeChild(r),g&&clearTimeout(g))})},o.show(),1==o.options.autoHide)var g=setTimeout(function(){o.hide()},o.options.timeout);return e.getWindowWidth()<800&&r.addEventListener("swipeup",function(e){o.hide(),e.preventDefault(),e.stopPropagation()}),o}).isVisible=function(){var e=document.querySelector(".jnotification");return!(!e||!e.parentNode)},e.palette=function(e){var t={material:[["#ffebee","#fce4ec","#f3e5f5","#e8eaf6","#e3f2fd","#e0f7fa","#e0f2f1","#e8f5e9","#f1f8e9","#f9fbe7","#fffde7","#fff8e1","#fff3e0","#fbe9e7","#efebe9","#fafafa","#eceff1"],["#ffcdd2","#f8bbd0","#e1bee7","#c5cae9","#bbdefb","#b2ebf2","#b2dfdb","#c8e6c9","#dcedc8","#f0f4c3","#fff9c4","#ffecb3","#ffe0b2","#ffccbc","#d7ccc8","#f5f5f5","#cfd8dc"],["#ef9a9a","#f48fb1","#ce93d8","#9fa8da","#90caf9","#80deea","#80cbc4","#a5d6a7","#c5e1a5","#e6ee9c","#fff59d","#ffe082","#ffcc80","#ffab91","#bcaaa4","#eeeeee","#b0bec5"],["#e57373","#f06292","#ba68c8","#7986cb","#64b5f6","#4dd0e1","#4db6ac","#81c784","#aed581","#dce775","#fff176","#ffd54f","#ffb74d","#ff8a65","#a1887f","#e0e0e0","#90a4ae"],["#ef5350","#ec407a","#ab47bc","#5c6bc0","#42a5f5","#26c6da","#26a69a","#66bb6a","#9ccc65","#d4e157","#ffee58","#ffca28","#ffa726","#ff7043","#8d6e63","#bdbdbd","#78909c"],["#f44336","#e91e63","#9c27b0","#3f51b5","#2196f3","#00bcd4","#009688","#4caf50","#8bc34a","#cddc39","#ffeb3b","#ffc107","#ff9800","#ff5722","#795548","#9e9e9e","#607d8b"],["#e53935","#d81b60","#8e24aa","#3949ab","#1e88e5","#00acc1","#00897b","#43a047","#7cb342","#c0ca33","#fdd835","#ffb300","#fb8c00","#f4511e","#6d4c41","#757575","#546e7a"],["#d32f2f","#c2185b","#7b1fa2","#303f9f","#1976d2","#0097a7","#00796b","#388e3c","#689f38","#afb42b","#fbc02d","#ffa000","#f57c00","#e64a19","#5d4037","#616161","#455a64"],["#c62828","#ad1457","#6a1b9a","#283593","#1565c0","#00838f","#00695c","#2e7d32","#558b2f","#9e9d24","#f9a825","#ff8f00","#ef6c00","#d84315","#4e342e","#424242","#37474f"],["#b71c1c","#880e4f","#4a148c","#1a237e","#0d47a1","#006064","#004d40","#1b5e20","#33691e","#827717","#f57f17","#ff6f00","#e65100","#bf360c","#3e2723","#212121","#263238"]],fire:[["0b1a6d","840f38","b60718","de030b","ff0c0c","fd491c","fc7521","faa331","fbb535","ffc73a"],["071147","5f0b28","930513","be0309","ef0000","fa3403","fb670b","f9991b","faad1e","ffc123"],["03071e","370617","6a040f","9d0208","d00000","dc2f02","e85d04","f48c06","faa307","ffba08"],["020619","320615","61040d","8c0207","bc0000","c82a02","d05203","db7f06","e19405","efab00"],["020515","2d0513","58040c","7f0206","aa0000","b62602","b94903","c57205","ca8504","d89b00"]],baby:[["eddcd2","fff1e6","fde2e4","fad2e1","c5dedd","dbe7e4","f0efeb","d6e2e9","bcd4e6","99c1de"],["e1c4b3","ffd5b5","fab6ba","f5a8c4","aacecd","bfd5cf","dbd9d0","baceda","9dc0db","7eb1d5"],["daa990","ffb787","f88e95","f282a9","8fc4c3","a3c8be","cec9b3","9dbcce","82acd2","649dcb"],["d69070","ff9c5e","f66770","f05f8f","74bbb9","87bfae","c5b993","83aac3","699bca","4d89c2"],["c97d5d","f58443","eb4d57","e54a7b","66a9a7","78ae9c","b5a67e","7599b1","5c88b7","4978aa"]]};return t[e]?t[e]:t.material},e.picker=function(e,t){var o={options:{}},n={value:null,data:null,render:null,onchange:null,width:null,header:!0,right:!1,content:!1};for(var i in n)o.options[i]=t&&t.hasOwnProperty(i)?t[i]:n[i];t.options&&(o.options.data=t.options),null===o.options.value&&(o.options.value=Object.keys(o.options.data)[0]);var r=null,s=null;return e.classList.add("jpicker"),e.setAttribute("tabindex","900"),o.init=function(){(r=document.createElement("div")).classList.add("jpicker-header"),!1===o.options.header&&(r.style.display="none"),o.options.width&&(r.style.width=parseInt(o.options.width)+"px"),r.innerHTML=o.options.value&&o.options.data[o.options.value]?o.options.data[o.options.value]:"<div><br/></div>",(s=document.createElement("div")).classList.add("jpicker-content"),e.appendChild(r),e.appendChild(s);for(var t=Object.keys(o.options.data),n=0;n<t.length;n++){var i=document.createElement("div");i.k=t[n],i.v=o.options.data[t[n]],i.innerHTML=o.getLabel(t[n]),i.onclick=function(){o.setValue(this.k),"function"==typeof o.options.onchange&&o.options.onchange(e,o,this.v,this.k)},s.appendChild(i)}o.setValue(o.options.value)},o.setValue=function(t){if(o.options.content)var n='<i class="material-icons">'+o.options.content+"</i>";else n=o.getLabel(t);r.innerHTML=n,o.options.value=n,e.value!=o.options.value&&(e.value=o.options.value,"function"==typeof e.onchange&&e.onchange({type:"change",target:e,value:e.value}))},o.getLabel=function(e){var t=o.options.data[e];return"function"==typeof o.options.render&&(t=o.options.render(t)),t},o.open=function(){e.classList.add("jpicker-focus"),e.focus();var t=r.getBoundingClientRect(),n=s.getBoundingClientRect();s.style.marginTop=window.innerHeight<t.bottom+n.height?-1*(n.height+4)+"px":t.height+2+"px",!0===o.options.right&&(s.style.marginLeft=-1*n.width+24+"px")},e.onclick=function(){e.classList.contains("jpicker-focus")?e.classList.remove("jpicker-focus"):o.open()},e.onblur=function(){setTimeout(function(){e.classList.remove("jpicker-focus")},250)},o.init(),e.change=o.setValue,e.picker=o,o},e.progressbar=function(e,t){var o={options:{}},n={value:0,onchange:null,width:null};for(var i in n)o.options[i]=t&&t.hasOwnProperty(i)?t[i]:n[i];e.classList.add("jprogressbar"),e.setAttribute("tabindex",1),e.setAttribute("data-value",o.options.value);var r=document.createElement("div");r.style.width=o.options.value+"%",r.style.color="#fff",e.appendChild(r),o.options.width&&(e.style.width=o.options.width),o.setValue=function(t){t=parseInt(t),o.options.value=t,r.style.width=t+"%",e.setAttribute("data-value",t+"%"),e.style.color=t<6?"#000":"#fff",o.options.value=t,"function"==typeof o.options.onchange&&o.options.onchange(e,t),e.value!=o.options.value&&(e.value=o.options.value,"function"==typeof e.onchange&&e.onchange({type:"change",target:e,value:e.value}))},o.getValue=function(){return o.options.value};var s=function(t){if(t.which){var n=e.getBoundingClientRect();if(t.changedTouches&&t.changedTouches[0])var i=t.changedTouches[0].clientX;else i=t.clientX;o.setValue(Math.round((i-n.left)/n.width*100))}};return"touchstart"in document.documentElement==1?(e.addEventListener("touchstart",s),e.addEventListener("touchend",s)):(e.addEventListener("mousedown",s),e.addEventListener("mousemove",s)),e.change=o.setValue,e.progressbar=o,o},e.rating=function(e,t){var o={options:{}},n={number:5,value:0,tooltip:["Very bad","Bad","Average","Good","Very good"],onchange:null};for(var i in n)o.options[i]=t&&t.hasOwnProperty(i)?t[i]:n[i];e.classList.add("jrating");for(var r=0;r<o.options.number;r++){var s=document.createElement("div");s.setAttribute("data-index",r+1),s.setAttribute("title",o.options.tooltip[r]),e.appendChild(s)}if(o.setValue=function(t){for(var n=0;n<o.options.number;n++)n<t?e.children[n].classList.add("jrating-selected"):(e.children[n].classList.remove("jrating-over"),e.children[n].classList.remove("jrating-selected"));o.options.value=t,"function"==typeof o.options.onchange&&o.options.onchange(e,t),e.value!=o.options.value&&(e.value=o.options.value,"function"==typeof e.onchange&&e.onchange({type:"change",target:e,value:e.value}))},o.getValue=function(){return o.options.value},o.options.value)for(r=0;r<o.options.number;r++)r<o.options.value&&e.children[r].classList.add("jrating-selected");return e.addEventListener("click",function(e){var t=e.target.getAttribute("data-index");null!=t&&o.setValue(t==o.options.value?0:t)}),e.addEventListener("mouseover",function(t){for(var n=t.target.getAttribute("data-index"),i=0;i<o.options.number;i++)i<n?e.children[i].classList.add("jrating-over"):e.children[i].classList.remove("jrating-over")}),e.addEventListener("mouseout",function(t){for(var n=0;n<o.options.number;n++)e.children[n].classList.remove("jrating-over")}),e.change=o.setValue,e.rating=o,o},e.slider=function(t,o){var n={options:{},currentImage:null};if(o&&(n.options=o),n.options.items=[],t.classList.contains("jslider"))i=t.querySelector("slider-container");else{var i;if(t.classList.add("jslider"),(i=document.createElement("div")).className="jslider-container",t.children.length>0)for(var r=0;r<t.children.length;r++)n.options.items.push(t.children[r]);if(n.options.items.length>0)for(r=0;r<n.options.items.length;r++){n.options.items[r].classList.add("jfile");var s=n.options.items[r].src.lastIndexOf("/");n.options.items[r].setAttribute("data-name",s<0?n.options.items[r].src:n.options.items[r].src.substr(s+1)),s=n.options.items[r].src.lastIndexOf("/"),i.appendChild(n.options.items[r])}t.appendChild(i);var a=document.createElement("div");a.className="jslider-close",a.innerHTML="",a.onclick=function(){n.close()},t.appendChild(a)}if(n.show=function(e){e||(e=i.children[0]),i.classList.contains("jslider-preview")||(i.classList.add("jslider-preview"),a.style.display="block");for(var t=0;t<i.children.length;t++)i.children[t].style.display="none";e.style.display="block",e.previousSibling?i.classList.add("jslider-left"):i.classList.remove("jslider-left"),e.nextSibling?i.classList.add("jslider-right"):i.classList.remove("jslider-right"),n.currentImage=e},n.open=function(){n.show(),"function"==typeof n.options.onopen&&n.options.onopen(t)},n.close=function(){i.classList.remove("jslider-preview"),i.classList.remove("jslider-left"),i.classList.remove("jslider-right");for(var e=0;e<i.children.length;e++)i.children[e].style.display="";a.style.display="",n.currentImage=null,"function"==typeof n.options.onclose&&n.options.onclose(t)},n.reset=function(){i.innerHTML=""},n.addFile=function(e,o){var r=document.createElement("img");r.setAttribute("data-lastmodified",e.lastmodified),r.setAttribute("data-name",e.name),r.setAttribute("data-size",e.size),r.setAttribute("data-extension",e.extension),r.setAttribute("data-cover",e.cover),r.setAttribute("src",e.file),r.className="jfile",i.appendChild(r),n.options.items.push(r),o||"function"==typeof n.options.onchange&&n.options.onchange(t,e)},n.addFiles=function(e){for(var t=0;t<e.length;t++)n.addFile(e[t])},n.next=function(){n.currentImage.nextSibling&&n.show(n.currentImage.nextSibling)},n.prev=function(){n.currentImage.previousSibling&&n.show(n.currentImage.previousSibling)},n.getData=function(){return e.files(i).get()},n.options.data&&n.options.data.length)for(r=0;r<n.options.data.length;r++)n.options.data[r]&&n.addFile(n.options.data[r]);if(n.options.allowAttachment){var l=document.createElement("input");l.type="file",l.className="slider-attachment",l.setAttribute("accept","image/*"),l.style.display="none",l.onchange=function(){for(var e=[],t=0;t<this.files.length;t++)if("image"==this.files[t].type.split("/")[0]){var o=this.files[t].name;o=o.split(".");var i={size:this.files[t].size,name:this.files[t].name,extension:o=o[o.length-1],cover:0,lastmodified:this.files[t].lastModified};e[t]=new FileReader,e[t].addEventListener("load",function(e){i.file=e.target.result,n.addFile(i)},!1),e[t].readAsDataURL(this.files[t])}else alert("The extension is not allowed")};var u=document.createElement("i");u.innerHTML="attachment",u.className="jslider-attach material-icons",u.onclick=function(){e.click(l)},t.appendChild(l),t.appendChild(u)}var c=null,d=function(e){"IMG"==e.target.tagName&&(c=setTimeout(function(){"data"==e.target.src.substr(0,4)?e.target.remove():e.target.classList.contains("jremove")?e.target.classList.remove("jremove"):e.target.classList.add("jremove"),"function"==typeof n.options.onchange&&n.options.onchange(t,e.target)},1e3))},h=function(e){c&&clearTimeout(c),"IMG"==e.target.tagName?e.target.classList.contains("jremove")||n.show(e.target):e.target.clientWidth-e.offsetX<40?n.next():e.offsetX<40&&n.prev()};return i.addEventListener("mousedown",d),i.addEventListener("touchstart",d),i.addEventListener("mouseup",h),i.addEventListener("touchend",h),t.addEventListener("swipeleft",function(e){n.next(),e.preventDefault(),e.stopPropagation()}),t.addEventListener("swiperight",function(e){n.prev(),e.preventDefault(),e.stopPropagation()}),e.slider.hasEvents||(document.addEventListener("keydown",function(e){27==e.which&&n.close()}),e.slider.hasEvents=!0),t.slider=n,n},e.sorting=function(e,t){var o={options:{}},n={pointer:null,direction:null,ondragstart:null,ondragend:null,ondrop:null},i=null;for(var r in n)o.options[r]=t&&t.hasOwnProperty(r)?t[r]:n[r];e.classList.add("jsorting"),e.addEventListener("dragstart",function(t){var n=Array.prototype.indexOf.call(t.target.parentNode.children,t.target);i={element:t.target,o:n,d:n},t.target.style.opacity="0.25","function"==typeof o.options.ondragstart&&o.options.ondragstart(e,t.target,t)}),e.addEventListener("dragover",function(e){if(e.preventDefault(),s(e.target)&&i&&"true"==e.target.getAttribute("draggable")&&i.element!=e.target){if(o.options.direction)t=e.target.clientWidth/2>e.offsetX;else var t=e.target.clientHeight/2>e.offsetY;e.target.parentNode.insertBefore(i.element,t?e.target:e.target.nextSibling),i.d=Array.prototype.indexOf.call(e.target.parentNode.children,i.element)}}),e.addEventListener("dragleave",function(e){e.preventDefault()}),e.addEventListener("dragend",function(t){t.preventDefault(),i&&("function"==typeof o.options.ondragend&&o.options.ondragend(e,i.element,t),t.target.parentNode.insertBefore(i.element,i.o<i.d?t.target.parentNode.children[i.o]:t.target.parentNode.children[i.o].nextSibling),i.element.style.opacity="",i=null)}),e.addEventListener("drop",function(t){t.preventDefault(),i&&i.o!=i.d&&"function"==typeof o.options.ondrop&&o.options.ondrop(e,i.o,i.d,i.element,t.target,t),i.element.style.opacity="",i=null});for(var s=function(e){var t=!1;return function e(o){o.className&&o.classList.contains("jsorting")&&(t=!0),t||e(o.parentNode)}(e),t},a=0;a<e.children.length;a++)e.children[a].hasAttribute("draggable")||e.children[a].setAttribute("draggable","true");return e},e.tabs=function(t,o){var n={options:{}},i={data:[],position:null,allowCreate:!1,allowChangePosition:!1,onclick:null,onload:null,onchange:null,oncreate:null,ondelete:null,onbeforecreate:null,onchangeposition:null,animation:!1,hideHeaders:!1,padding:null};for(var r in i)n.options[r]=o&&o.hasOwnProperty(r)?o[r]:i[r];t.classList.add("jtabs");var s=null,a=null,l=null,u=function(e){"function"==typeof n.headers.scrollTo?n.headers.scrollTo({left:e,behavior:"smooth"}):n.headers.scrollLeft=e,e<=1?s.classList.add("disabled"):s.classList.remove("disabled"),e>=n.headers.scrollWidth-n.headers.offsetWidth?a.classList.add("disabled"):a.classList.remove("disabled"),n.headers.scrollWidth<=n.headers.offsetWidth?(s.style.display="none",a.style.display="none"):(s.style.display="",a.style.display="")};if(n.open=function(e){for(var o=null,i=0;i<n.headers.children.length;i++)n.headers.children[i].classList.contains("jtabs-selected")&&(o=i),n.headers.children[i].classList.remove("jtabs-selected"),n.content.children[i]&&n.content.children[i].classList.remove("jtabs-selected");if(n.headers.children[e].classList.add("jtabs-selected"),n.content.children[e]&&n.content.children[e].classList.add("jtabs-selected"),o!=e&&"function"==typeof n.options.onchange&&n.content.children[e]&&n.options.onchange(t,n,e,n.headers.children[e],n.content.children[e]),1==n.options.hideHeaders&&n.headers.children.length<3&&0==n.options.allowCreate)n.headers.parentNode.style.display="none";else{n.headers.parentNode.style.display="",1==n.options.animation&&function(e){var t=n.headers.children[e].getBoundingClientRect();l.style.width=t.width+"px",l.style.left=n.headers.children[e].offsetLeft+"px",l.style.bottom="0px"}(e);var r=n.headers.children[e].offsetLeft,s=n.headers.scrollLeft;s<=r&&s+n.headers.offsetWidth>=r+n.headers.children[e].offsetWidth||u(r-1)}},n.selectIndex=function(e){var t=Array.prototype.indexOf.call(n.headers.children,e);return t>=0&&n.open(t),t},n.rename=function(e,t){t||(t=prompt("New title",n.headers.children[e].innerText)),n.headers.children[e].innerText=t,n.open(e)},n.create=function(e,o){if("function"==typeof n.options.onbeforecreate){var i=n.options.onbeforecreate(t);if(!1===i)return!1;e=i}var r=n.appendElement(e);return"function"==typeof n.options.oncreate&&n.options.oncreate(t,r),r},n.remove=function(e){return n.deleteElement(e)},n.nextNumber=function(){for(var e=0,t=0;t<n.headers.children.length;t++){var o=n.headers.children[t].innerText.match(/[0-9].*/);o>e&&(e=parseInt(o))}return e?e++:e=1,e},n.deleteElement=function(e){if(!n.headers.children[e])return!1;n.headers.removeChild(n.headers.children[e]),n.content.removeChild(n.content.children[e]),n.open(0),"function"==typeof n.options.ondelete&&n.options.ondelete(t,e)},n.appendElement=function(e){if(e||(e=prompt("Title?","")),e){var t=document.createElement("div");n.content.appendChild(t);var o=document.createElement("div");return o.innerHTML=e,o.content=t,n.headers.insertBefore(o,n.headers.lastChild),n.options.allowChangePosition&&o.setAttribute("draggable","true"),n.selectIndex(o),t}},n.getActive=function(){for(var e=0;e<n.headers.children.length;e++)if(n.headers.children[e].classList.contains("jtabs-selected"))return e;return 0},n.updatePosition=function(e,t){n.content.insertBefore(n.content.children[e],e>t?n.content.children[t]:n.content.children[t].nextSibling),n.open(t),"function"==typeof n.options.onchangeposition&&n.options.onchangeposition(n.headers,e,t)},n.move=function(e,t){n.headers.insertBefore(n.headers.children[e],e>t?n.headers.children[t]:n.headers.children[t].nextSibling),n.updatePosition(e,t)},n.init=function(){t.innerHTML="",n.headers=document.createElement("div"),n.content=document.createElement("div"),n.headers.classList.add("jtabs-headers"),n.content.classList.add("jtabs-content"),n.options.padding&&(n.content.style.padding=parseInt(n.options.padding)+"px");var o=document.createElement("div");o.className="jtabs-headers-container",o.appendChild(n.headers);var i=document.createElement("div");if(i.className="jtabs-controls",i.setAttribute("draggable","false"),o.appendChild(i),"bottom"==n.options.position?(t.appendChild(n.content),t.appendChild(o)):(t.appendChild(o),t.appendChild(n.content)),1==n.options.allowCreate){var r=document.createElement("div");r.className="jtabs-add",r.onclick=function(){n.create()},i.appendChild(r)}(s=document.createElement("div")).className="jtabs-prev",s.onclick=function(){u(n.headers.scrollLeft-n.headers.offsetWidth)},i.appendChild(s),(a=document.createElement("div")).className="jtabs-next",a.onclick=function(){u(n.headers.scrollLeft+n.headers.offsetWidth)},i.appendChild(a);for(var c=0;c<n.options.data.length;c++){if(n.options.data[c].titleElement)var d=n.options.data[c].titleElement;else d=document.createElement("div");if(n.options.data[c].icon){var h=document.createElement("div"),p=document.createElement("i");p.classList.add("material-icons"),p.innerHTML=n.options.data[c].icon,h.appendChild(p),d.appendChild(h)}if(n.options.data[c].title){var f=document.createTextNode(n.options.data[c].title);d.appendChild(f)}if(n.options.data[c].width&&(d.style.width=n.options.data[c].width),n.options.data[c].contentElement)var v=n.options.data[c].contentElement;else(v=document.createElement("div")).innerHTML=n.options.data[c].content;n.headers.appendChild(d),n.content.appendChild(v)}(l=document.createElement("div")).className="jtabs-border",n.headers.appendChild(l),n.options.animation&&t.classList.add("jtabs-animation"),n.headers.addEventListener("click",function(e){if(e.target.parentNode.classList.contains("jtabs-headers"))var o=e.target;else o="I"==e.target.tagName?e.target.parentNode.parentNode:e.target.parentNode;var i=n.selectIndex(o);"function"==typeof n.options.onclick&&n.options.onclick(t,n,i,n.headers.children[i],n.content.children[i])}),n.headers.addEventListener("contextmenu",function(e){n.selectIndex(e.target)}),n.headers.children.length&&n.open(0),u(0),1==n.options.allowChangePosition&&e.sorting(n.headers,{direction:1,ondrop:function(e,t,o){n.updatePosition(t,o)}}),"function"==typeof n.options.onload&&n.options.onload(t,n)},t.children[0]&&t.children[0].children.length)for(var c=0;c<t.children[0].children.length;c++){var d=n.options.data&&n.options.data[c]?n.options.data[c]:{};t.children[1]&&t.children[1].children[c]?(d.titleElement=t.children[0].children[c],d.contentElement=t.children[1].children[c]):d.contentElement=t.children[0].children[c],n.options.data[c]=d}var h=!1;if(n.options.data)for(c=0;c<n.options.data.length;c++)n.options.data[c].url&&(e.ajax({url:n.options.data[c].url,type:"GET",dataType:"text/html",index:c,success:function(e){n.options.data[this.index].content=e},complete:function(){n.init()}}),h=!0);return h||n.init(),t.tabs=n,n},e.tags=function(t,o){var n={options:{}},i={value:null,limit:null,limitMessage:"The limit of entries is: ",search:null,placeholder:null,validation:null,onbeforechange:null,onchange:null,onfocus:null,onblur:null,onload:null,colors:null};for(var r in i)n.options[r]=o&&o.hasOwnProperty(r)?o[r]:i[r];var s=null,a=null,l=0,u=0;n.add=function(e,o){if("function"==typeof n.options.onbeforechange){var i=n.options.onbeforechange(t,n,e);null!=i&&(e=i)}if(s&&(s.style.display=""),n.options.limit>0&&t.children.length>=n.options.limit)alert(n.options.limitMessage+" "+n.options.limit);else{var r=p();if(e&&"string"!=typeof e){r&&r.parentNode.classList.contains("jtags")&&(r.innerText.replace("\n","")||t.removeChild(r));for(var a=0;a<=e.length;a++)(!n.options.limit||t.children.length<n.options.limit)&&((l=document.createElement("div")).innerHTML=e[a]?e[a]:"<br>",t.appendChild(l))}else{var l;(l=document.createElement("div")).innerHTML=e||"<br>",r&&r.parentNode.classList.contains("jtags")?t.insertBefore(l,r.nextSibling):t.appendChild(l)}o&&setTimeout(function(){h(l)},0),d(),c()}},n.remove=function(e){e.parentNode.removeChild(e),t.children.length||n.add("")},n.getData=function(){for(var e=[],o=0;o<t.children.length;o++){var n=t.children[o].innerText.replace("\n",""),i=t.children[o].getAttribute("data-value");i||(i=n),(n||i)&&e.push({text:n,value:i})}return e},n.getValue=function(e){var o=null;if(null!=e)(o=t.children[e].getAttribute("data-value"))||(o=t.children[e].innerText.replace("\n",""));else{for(var i=[],r=0;r<t.children.length;r++)(o=t.children[r].innerText.replace("\n",""))&&i.push(n.getValue(r));o=i.join(",")}return o},n.setValue=function(e){if(e=(""+e).trim()){var o=f(e);t.innerHTML="",n.add(o)}else n.reset()},n.reset=function(){t.innerHTML="<div><br></div>",c()},n.isValid=function(){for(var e=0,o=0;o<t.children.length;o++)t.children[o].classList.contains("jtags_error")&&e++;return 0==e},n.selectIndex=function(e){a="";var t=p();t.innerText=e.children[1].innerText,e.children[1].getAttribute("data-value")&&t.setAttribute("data-value",e.children[1].getAttribute("data-value")),s&&(s.style.display="",s.innerHTML=""),t.classList.remove("jtags_error"),n.add("",!0)},n.search=function(o){if(!s){var i=document.createElement("div");i.style.position="relative",t.parentNode.insertBefore(i,t.nextSibling),(s=document.createElement("div")).classList.add("jtags_search"),i.appendChild(s)}o.anchorNode.nodeValue&&o.anchorNode.nodeValue!=a&&(l=0,e.ajax({url:n.options.search+(a=o.anchorNode.nodeValue),method:"GET",dataType:"json",success:function(e){if(s.innerHTML="",e.length){s.style.display="block";for(var t=e.length<11?e.length:10,o=0;o<t;o++){var i=e[o].text;!i&&e[o].name&&(i=e[o].name);var r=e[o].value;!r&&e[o].id&&(r=e[o].id);var a=document.createElement("div");0==o&&a.classList.add("selected");var l=document.createElement("img");e[o].image?l.src=e[o].image:l.style.display="none",a.appendChild(l);var u=document.createElement("div");u.setAttribute("data-value",r),u.innerHTML=i,a.onclick=function(){n.selectIndex(this)},a.appendChild(u),s.appendChild(a)}}else s.style.display=""}}))},n.destroy=function(){t.removeEventListener("mouseup",y),t.removeEventListener("keydown",g),t.removeEventListener("keyup",b),t.removeEventListener("paste",m),t.removeEventListener("focus",j),t.removeEventListener("blur",w),t.parentNode.removeChild(t)};var c=function(){n.options.value=n.getValue(),"function"==typeof n.options.onchange&&n.options.onchange(t,n,n.options.value),t.value!=n.options.value&&(t.value=n.options.value,"function"==typeof t.onchange&&t.onchange({type:"change",target:t,value:t.value}))},d=function(){for(var e=0;e<t.children.length;e++)n.getValue(e)?(t.children[e].classList.add("jtags_label"),"function"==typeof n.options.validation&&(n.getValue(e)?n.options.validation(t.children[e],t.children[e].innerText,t.children[e].getAttribute("data-value"))?t.children[e].classList.remove("jtags_error"):t.children[e].classList.add("jtags_error"):t.children[e].classList.remove("jtags_error"))):t.children[e].classList.remove("jtags_label")},h=function(e){var t=document.createRange(),o=window.getSelection();t.setStart(e,e.innerText.length),t.collapse(!0),o.removeAllRanges(),o.addRange(t)},p=function(){var e=document.getSelection().anchorNode;return e?3==e.nodeType?e.parentNode:e:null},f=function(e){var t=[],o="";if(e=e.trim()){for(var n=0;n<e.length;n++)","==e[n]||";"==e[n]||"\n"==e[n]?o&&(t.push(o.trim()),o=""):o+=e[n];o&&t.push(o)}return t},v=0,g=function(e){if(v=window.getSelection().anchorOffset,!t.children.length){var o=document.createElement("div");o.innerHTML="<div><br/></div>",t.appendChild(o)}9==e.which||186==e.which||188==e.which?(window.getSelection().anchorOffset>1&&(!n.options.limit||t.children.length<n.options.limit)&&n.add("",!0),e.preventDefault()):13==e.which?(s&&""!=s.style.display?n.selectIndex(s.children[l]):window.getSelection().anchorOffset>1&&(!n.options.limit||t.children.length<n.options.limit)&&n.add("",!0),e.preventDefault()):38==e.which?s&&""!=s.style.display&&(s.children[l].classList.remove("selected"),l>0&&l--,s.children[l].classList.add("selected"),e.preventDefault()):40==e.which?s&&""!=s.style.display&&(s.children[l].classList.remove("selected"),l<9&&l++,s.children[l].classList.add("selected"),e.preventDefault()):8==e.which&&1==t.children.length&&window.getSelection().anchorOffset<1&&e.preventDefault()},b=function(e){if(39==e.which){var o=window.getSelection().anchorOffset;o>1&&o==v&&n.add("",!0)}else if(13==e.which||38==e.which||40==e.which)e.preventDefault();else if(8==e.which)t.innerHTML||n.add("",!0),e.preventDefault();else if(46==e.which){if(!t.children.length){var i=document.createElement("div");i.innerHTML="<div><br/></div>",t.appendChild(i)}e.preventDefault()}else u&&clearTimeout(u),u=setTimeout(function(){var e=window.getSelection();n.options.search&&n.search(e),u=null},300);d()},m=function(e){if(e.clipboardData||e.originalEvent.clipboardData){(e.originalEvent||e).clipboardData.getData("text/html");var t=(e.originalEvent||e).clipboardData.getData("text/plain")}else window.clipboardData&&(window.clipboardData.getData("Html"),t=window.clipboardData.getData("Text"));n.setValue(t),e.preventDefault()},y=function(e){if(e.target.parentNode&&e.target.parentNode.classList.contains("jtags")&&(e.target.classList.contains("jtags_label")||e.target.classList.contains("jtags_error"))){var t=e.target.getBoundingClientRect();t.width-(e.clientX-t.left)<16&&n.remove(e.target)}s&&(s.style.display="")},j=function(e){if((!t.children.length||n.getValue(t.children.length-1))&&(!n.options.limit||t.children.length<n.options.limit)){var o=document.createElement("div");o.innerHTML="<br>",t.appendChild(o)}"function"==typeof n.options.onfocus&&n.options.onfocus(t,n,n.getValue()),t.classList.add("jtags-focus")},w=function(e){s&&setTimeout(function(){s.style.display=""},200);for(var o=0;o<t.children.length-1;o++)n.getValue(o)||t.removeChild(t.children[o]);"function"==typeof n.options.onblur&&n.options.onblur(t,n,n.getValue()),c(),t.classList.remove("jtags-focus"),t.children[0].innerText.trim()?t.classList.remove("jtags-empty"):t.classList.add("jtags-empty")};return t.addEventListener("mouseup",y),t.addEventListener("keydown",g),t.addEventListener("keyup",b),t.addEventListener("paste",m),t.addEventListener("focus",j),t.addEventListener("blur",w),t.classList.add("jtags"),t.setAttribute("contenteditable",!0),t.setAttribute("spellcheck",!1),n.options.placeholder&&(t.setAttribute("data-placeholder",n.options.placeholder),t.placeholder=n.options.placeholder),n.options.value?n.setValue(n.options.value):(t.innerHTML="<div><br></div>",t.classList.add("jtags-empty")),"function"==typeof n.options.onload&&n.options.onload(t,n),t.change=n.setValue,t.tags=n,n},e.toolbar=function(t,o){var n={options:{}},i={app:null,container:!1,badge:!1,title:!1,items:[]};for(var r in i)n.options[r]=o&&o.hasOwnProperty(r)?o[r]:i[r];!t&&o.app&&o.app.el&&(t=document.createElement("div"),o.app.el.appendChild(t));var s=document.createElement("div");s.classList.add("jtoolbar-item"),s.classList.add("jtoolbar-arrow");var a=document.createElement("div");a.classList.add("jtoolbar-floating"),s.appendChild(a),n.selectItem=function(e){for(var t=u.children,o=0;o<t.length;o++)e!=t[o]&&t[o].classList.remove("jtoolbar-selected");e.classList.add("jtoolbar-selected")},n.hide=function(){e.animation.slideBottom(t,0,function(){t.style.display="none"})},n.show=function(){t.style.display="",e.animation.slideBottom(t,1)},n.get=function(){return t},n.setBadge=function(e,t){u.children[e].children[1].firstChild.innerHTML=t},n.destroy=function(){toolbar.remove(),t.innerHTML=""};var l=function(){this.classList.contains("jtoolbar-active")?this.classList.remove("jtoolbar-active"):this.classList.add("jtoolbar-active")};n.create=function(o){u.innerHTML="";for(var i=0;i<o.length;i++){var r=document.createElement("div");if(r.classList.add("jtoolbar-item"),o[i].width&&(r.style.width=parseInt(o[i].width)+"px"),o[i].k&&(r.k=o[i].k),o[i].tooltip&&r.setAttribute("title",o[i].tooltip),o[i].id&&r.setAttribute("id",o[i].id),o[i].state&&(r.toggleState=l),o[i].active&&r.classList.add("jtoolbar-active"),"select"==o[i].type||"dropdown"==o[i].type)"function"==typeof o[i].onchange&&(o[i].onchange=function(e){return function(o,i,r,s){e(t,n,o,r,s)}}(o[i].onchange)),e.picker(r,o[i]);else if("divisor"==o[i].type)r.classList.add("jtoolbar-divisor");else if("label"==o[i].type)r.classList.add("jtoolbar-label"),r.innerHTML=o[i].content;else{var s=document.createElement("i");if(void 0===o[i].class)s.classList.add("material-icons");else for(var a=o[i].class.split(" "),c=0;c<a.length;c++)s.classList.add(a[c]);if(s.innerHTML=o[i].content?o[i].content:"",r.appendChild(s),1==n.options.badge){var d=document.createElement("div");d.classList.add("jbadge");var h=document.createElement("div");h.innerHTML=o[i].badge?o[i].badge:"",d.appendChild(h),r.appendChild(d)}if(o[i].title)if(1==n.options.title){var p=document.createElement("span");p.innerHTML=o[i].title,r.appendChild(p)}else r.setAttribute("title",o[i].title);n.options.app&&o[i].route&&(r.route=o[i].route,r.onclick=function(){n.options.app.pages(this.route)},n.options.app.pages(o[i].route,{toolbarItem:r,closed:!0}))}o[i].onclick&&(r.onclick=function(e){return function(){o[e].onclick(t,n,this)}}(i)),u.appendChild(r)}},n.resize=function(){t.style.width=t.parentNode.offsetWidth,u.appendChild(s)},t.classList.add("jtoolbar"),1==n.options.container&&t.classList.add("jtoolbar-container"),t.innerHTML="",t.onclick=function(t){var o=e.findElement(t.target,"jtoolbar-item");o&&n.selectItem(o),t.target.classList.contains("jtoolbar-arrow")&&(t.target.classList.add("jtoolbar-arrow-selected"),t.target.children[0].focus())};var u=document.createElement("div");return t.appendChild(u),n.options.app&&t.classList.add("jtoolbar-mobile"),n.create(n.options.items),t.toolbar=n,n},(e.validations={}).email=function(e){var t=new RegExp(/^[^\s@]+@[^\s@]+\.[^\s@]+$/);return!(!e||!t.test(e))},e.validations.length=function(e,t){var o=t.getAttribute("data-length")||5;return e.length>=o},e.validations.required=function(e){return!!e.trim()},e.validations.number=function(t){return e.isNumber(t)},e}),!jSuites&&"function"==typeof require){var jSuites=require("jsuites");require("jsuites/dist/jsuites.css")}!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.jexcel=t()}(this,function(){"use strict";var jexcel=function(el,options){var obj={options:{}};if(!(el instanceof Element||el instanceof HTMLDocument))return console.error("JEXCEL: el is not a valid DOM element"),!1;if("TABLE"==el.tagName){if(!(options=jexcel.createFromTable(el,options)))return console.error("JEXCEL: el is not a valid DOM element"),!1;var div=document.createElement("div");el.parentNode.insertBefore(div,el),el.remove(),el=div}var defaults={url:null,method:"GET",requestVariables:null,data:null,sorting:null,copyCompatibility:!1,root:null,rows:[],columns:[],colHeaders:[],colWidths:[],colAlignments:[],nestedHeaders:null,defaultColWidth:50,defaultColAlign:"center",minSpareRows:0,minSpareCols:0,minDimensions:[0,0],allowExport:!0,includeHeadersOnDownload:!1,includeHeadersOnCopy:!1,columnSorting:!0,columnDrag:!1,columnResize:!0,rowResize:!1,rowDrag:!0,editable:!0,allowInsertRow:!0,allowManualInsertRow:!0,allowInsertColumn:!0,allowManualInsertColumn:!0,allowDeleteRow:!0,allowDeletingAllRows:!1,allowDeleteColumn:!0,allowRenameColumn:!0,allowComments:!1,wordWrap:!1,imageOptions:null,csv:null,csvFileName:"jexcel",csvHeaders:!0,csvDelimiter:",",parseTableFirstRowAsHeader:!1,parseTableAutoCellType:!1,selectionCopy:!0,mergeCells:{},toolbar:null,search:!1,pagination:!1,paginationOptions:null,fullscreen:!1,lazyLoading:!1,loadingSpin:!1,tableOverflow:!1,tableHeight:"300px",tableWidth:null,textOverflow:!1,meta:null,style:null,parseFormulas:!0,autoIncrement:!0,autoCasting:!0,secureFormulas:!0,stripHTML:!0,stripHTMLOnCopy:!1,filters:!1,footers:null,onundo:null,onredo:null,onload:null,onchange:null,oncomments:null,onbeforechange:null,onafterchanges:null,onbeforeinsertrow:null,oninsertrow:null,onbeforeinsertcolumn:null,oninsertcolumn:null,onbeforedeleterow:null,ondeleterow:null,onbeforedeletecolumn:null,ondeletecolumn:null,onmoverow:null,onmovecolumn:null,onresizerow:null,onresizecolumn:null,onsort:null,onselection:null,oncopy:null,onpaste:null,onbeforepaste:null,onmerge:null,onfocus:null,onblur:null,onchangeheader:null,oncreateeditor:null,oneditionstart:null,oneditionend:null,onchangestyle:null,onchangemeta:null,onchangepage:null,onbeforesave:null,onsave:null,onevent:null,persistance:!1,updateTable:null,detachForUpdates:!1,freezeColumns:null,text:{noRecordsFound:"No records found",showingPage:"Showing page {0} of {1} entries",show:"Show ",search:"Search",entries:" entries",columnName:"Column name",insertANewColumnBefore:"Insert a new column before",insertANewColumnAfter:"Insert a new column after",deleteSelectedColumns:"Delete selected columns",renameThisColumn:"Rename this column",orderAscending:"Order ascending",orderDescending:"Order descending",insertANewRowBefore:"Insert a new row before",insertANewRowAfter:"Insert a new row after",deleteSelectedRows:"Delete selected rows",editComments:"Edit comments",addComments:"Add comments",comments:"Comments",clearComments:"Clear comments",copy:"Copy...",paste:"Paste...",saveAs:"Save as...",about:"About",areYouSureToDeleteTheSelectedRows:"Are you sure to delete the selected rows?",areYouSureToDeleteTheSelectedColumns:"Are you sure to delete the selected columns?",thisActionWillDestroyAnyExistingMergedCellsAreYouSure:"This action will destroy any existing merged cells. Are you sure?",thisActionWillClearYourSearchResultsAreYouSure:"This action will clear your search results. Are you sure?",thereIsAConflictWithAnotherMergedCell:"There is a conflict with another merged cell",invalidMergeProperties:"Invalid merged properties",cellAlreadyMerged:"Cell already merged",noCellsSelected:"No cells selected"},about:"jExcel CE Spreadsheet\nVersion 4.5.0\nWebsite: https://bossanova.uk/jexcel/v3"};for(var property in defaults)if(options&&options.hasOwnProperty(property))if("text"===property)for(var textKey in obj.options[property]=defaults[property],options[property])options[property].hasOwnProperty(textKey)&&(obj.options[property][textKey]=options[property][textKey]);else obj.options[property]=options[property];else obj.options[property]=defaults[property];obj.el=el,obj.corner=null,obj.contextMenu=null,obj.textarea=null,obj.ads=null,obj.content=null,obj.table=null,obj.thead=null,obj.tbody=null,obj.rows=[],obj.results=null,obj.searchInput=null,obj.toolbar=null,obj.pagination=null,obj.pageNumber=null,obj.headerContainer=null,obj.colgroupContainer=null,obj.headers=[],obj.records=[],obj.history=[],obj.formula=[],obj.colgroup=[],obj.selection=[],obj.highlighted=[],obj.selectedCell=null,obj.selectedContainer=null,obj.style=[],obj.data=null,obj.filter=null,obj.filters=[],obj.cursor=null,obj.historyIndex=-1,obj.ignoreEvents=!1,obj.ignoreHistory=!1,obj.edition=null,obj.hashString=null,obj.resizing=null,obj.dragging=null,1==obj.options.lazyLoading&&0==obj.options.tableOverflow&&0==obj.options.fullscreen&&(console.error("JEXCEL: The lazyloading only works when tableOverflow = yes or fullscreen = yes"),obj.options.lazyLoading=!1),obj.fullscreen=function(e){null==e&&(e=!obj.options.fullscreen),obj.options.fullscreen!=e&&(obj.options.fullscreen=e,1==e?el.classList.add("fullscreen"):el.classList.remove("fullscreen"))},obj.dispatch=function(e){if(!obj.ignoreEvents){if("function"==typeof obj.options.onevent)var t=obj.options.onevent.apply(this,arguments);"function"==typeof obj.options[e]&&(t=obj.options[e].apply(this,Array.prototype.slice.call(arguments,1)))}if("onafterchanges"==e&&obj.options.persistance){var o=1==obj.options.persistance?obj.options.url:obj.options.persistance,n=obj.prepareJson(arguments[2]);obj.save(o,n)}return t},obj.prepareTable=function(){var e=obj.options.columns.length;if(obj.options.data&&void 0!==obj.options.data[0]){var t=Object.keys(obj.options.data[0]);t.length>e&&(e=t.length)}obj.options.minDimensions[0]>e&&(e=obj.options.minDimensions[0]);for(var o=[],n=0;n<e;n++)obj.options.colHeaders[n]||(obj.options.colHeaders[n]=""),obj.options.colWidths[n]||(obj.options.colWidths[n]=obj.options.defaultColWidth),obj.options.colAlignments[n]||(obj.options.colAlignments[n]=obj.options.defaultColAlign),obj.options.columns[n]?obj.options.columns[n].type||(obj.options.columns[n].type="text"):obj.options.columns[n]={type:"text"},obj.options.columns[n].name||(obj.options.columns[n].name=t&&t[n]?t[n]:n),obj.options.columns[n].source||(obj.options.columns[n].source=[]),obj.options.columns[n].options||(obj.options.columns[n].options=[]),obj.options.columns[n].editor||(obj.options.columns[n].editor=null),obj.options.columns[n].allowEmpty||(obj.options.columns[n].allowEmpty=!1),obj.options.columns[n].title||(obj.options.columns[n].title=obj.options.colHeaders[n]?obj.options.colHeaders[n]:""),obj.options.columns[n].width||(obj.options.columns[n].width=obj.options.colWidths[n]?obj.options.colWidths[n]:obj.options.defaultColWidth),obj.options.columns[n].align||(obj.options.columns[n].align=obj.options.colAlignments[n]?obj.options.colAlignments[n]:"center"),"autocomplete"==obj.options.columns[n].type||"dropdown"==obj.options.columns[n].type?obj.options.columns[n].url&&o.push({url:obj.options.columns[n].url,index:n,method:"GET",dataType:"json",success:function(e){for(var t=0;t<e.length;t++)obj.options.columns[this.index].source.push(e[t])}}):"calendar"==obj.options.columns[n].type&&(obj.options.columns[n].options.format||(obj.options.columns[n].options.format="DD/MM/YYYY"));o.length?jSuites.ajax(o,function(){obj.createTable()}):obj.createTable()},obj.createTable=function(){obj.table=document.createElement("table"),obj.thead=document.createElement("thead"),obj.tbody=document.createElement("tbody"),obj.headers=[],obj.colgroup=[],obj.content=document.createElement("div"),obj.content.classList.add("jexcel_content"),obj.content.onscroll=function(e){obj.scrollControls(e)},obj.content.onwheel=function(e){obj.wheelControls(e)},obj.toolbar=document.createElement("div"),obj.toolbar.classList.add("jexcel_toolbar");var e=document.createElement("div"),t=document.createTextNode(obj.options.text.search+": ");obj.searchInput=document.createElement("input"),obj.searchInput.classList.add("jexcel_search"),e.appendChild(t),e.appendChild(obj.searchInput),obj.searchInput.onfocus=function(){obj.resetSelection()};var o=document.createElement("div");if(obj.options.pagination>0&&obj.options.paginationOptions&&obj.options.paginationOptions.length>0){obj.paginationDropdown=document.createElement("select"),obj.paginationDropdown.classList.add("jexcel_pagination_dropdown"),obj.paginationDropdown.onchange=function(){obj.options.pagination=parseInt(this.value),obj.page(0)};for(var n=0;n<obj.options.paginationOptions.length;n++){var i=document.createElement("option");i.value=obj.options.paginationOptions[n],i.innerHTML=obj.options.paginationOptions[n],obj.paginationDropdown.appendChild(i)}obj.paginationDropdown.value=obj.options.pagination,o.appendChild(document.createTextNode(obj.options.text.show)),o.appendChild(obj.paginationDropdown),o.appendChild(document.createTextNode(obj.options.text.entries))}var r,s=document.createElement("div");if(s.classList.add("jexcel_filter"),s.appendChild(o),s.appendChild(e),obj.colgroupContainer=document.createElement("colgroup"),(r=document.createElement("col")).setAttribute("width","50"),obj.colgroupContainer.appendChild(r),obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(var a=0;a<obj.options.nestedHeaders.length;a++)obj.thead.appendChild(obj.createNestedHeader(obj.options.nestedHeaders[a]));else obj.thead.appendChild(obj.createNestedHeader(obj.options.nestedHeaders));for(obj.headerContainer=document.createElement("tr"),(r=document.createElement("td")).classList.add("jexcel_selectall"),obj.headerContainer.appendChild(r),n=0;n<obj.options.columns.length;n++)obj.createCellHeader(n),obj.headerContainer.appendChild(obj.headers[n]),obj.colgroupContainer.appendChild(obj.colgroup[n]);if(obj.thead.appendChild(obj.headerContainer),1==obj.options.filters){obj.filter=document.createElement("tr");var l=document.createElement("td");for(obj.filter.appendChild(l),n=0;n<obj.options.columns.length;n++)(l=document.createElement("td")).innerHTML="&nbsp;",l.setAttribute("data-x",n),l.className="jexcel_column_filter","hidden"==obj.options.columns[n].type&&(l.style.display="none"),obj.filter.appendChild(l);obj.thead.appendChild(obj.filter)}obj.table=document.createElement("table"),obj.table.classList.add("jexcel"),obj.table.setAttribute("cellpadding","0"),obj.table.setAttribute("cellspacing","0"),obj.table.setAttribute("unselectable","yes"),obj.table.appendChild(obj.colgroupContainer),obj.table.appendChild(obj.thead),obj.table.appendChild(obj.tbody),obj.options.textOverflow||obj.table.classList.add("jexcel_overflow"),obj.corner=document.createElement("div"),obj.corner.className="jexcel_corner",obj.corner.setAttribute("unselectable","on"),obj.corner.setAttribute("onselectstart","return false"),0==obj.options.selectionCopy&&(obj.corner.style.display="none"),obj.textarea=document.createElement("textarea"),obj.textarea.className="jexcel_textarea",obj.textarea.id="jexcel_textarea",obj.textarea.tabIndex="-1",obj.contextMenu=document.createElement("div"),obj.contextMenu.className="jexcel_contextmenu",jSuites.contextmenu(obj.contextMenu,{onclick:function(){obj.contextMenu.contextmenu.close(!1)}});var u=document.createElement("a");u.setAttribute("href","https://bossanova.uk/jexcel/"),obj.ads=document.createElement("div"),obj.ads.className="jexcel_about";try{if("undefined"!=typeof sessionStorage&&!sessionStorage.getItem("jexcel")){sessionStorage.setItem("jexcel",!0);var c=document.createElement("img");c.src="//bossanova.uk/jexcel/logo.png",u.appendChild(c)}}catch(f){}var d=document.createElement("span");d.innerHTML="Jexcel spreadsheet",u.appendChild(d),obj.ads.appendChild(u),document.createElement("div").classList.add("jexcel_table"),obj.pagination=document.createElement("div"),obj.pagination.classList.add("jexcel_pagination");var h=document.createElement("div"),p=document.createElement("div");obj.pagination.appendChild(h),obj.pagination.appendChild(p),obj.options.pagination||(obj.pagination.style.display="none"),1==obj.options.search&&el.appendChild(s),obj.content.appendChild(obj.table),obj.content.appendChild(obj.corner),obj.content.appendChild(obj.textarea),el.appendChild(obj.toolbar),el.appendChild(obj.content),el.appendChild(obj.pagination),el.appendChild(obj.contextMenu),el.appendChild(obj.ads),el.classList.add("jexcel_container"),obj.options.toolbar&&obj.options.toolbar.length&&obj.createToolbar(),1==obj.options.fullscreen?el.classList.add("fullscreen"):1==obj.options.tableOverflow&&(obj.options.tableHeight&&(obj.content.style["overflow-y"]="auto",obj.content.style.maxHeight=obj.options.tableHeight),obj.options.tableWidth&&(obj.content.style["overflow-x"]="auto",obj.content.style.width=obj.options.tableWidth)),1!=obj.options.tableOverflow&&obj.options.toolbar&&el.classList.add("with-toolbar"),1==obj.options.columnDrag&&obj.thead.classList.add("draggable"),1==obj.options.columnResize&&obj.thead.classList.add("resizable"),1==obj.options.rowDrag&&obj.tbody.classList.add("draggable"),1==obj.options.rowResize&&obj.tbody.classList.add("resizable"),obj.setData(),obj.options.style&&obj.setStyle(obj.options.style,null,null,1,1)},obj.refresh=function(){obj.options.url?(1==obj.options.loadingSpin&&jSuites.loading.show(),jSuites.ajax({url:obj.options.url,method:obj.options.method,data:obj.options.requestVariables,dataType:"json",success:function(e){obj.options.data=e.data?e.data:e,obj.setData(),1==obj.options.loadingSpin&&jSuites.loading.hide()}})):obj.setData()},obj.setData=function(e){if(e&&("string"==typeof e&&(e=JSON.parse(e)),obj.options.data=e),obj.options.data||(obj.options.data=[]),obj.options.data&&obj.options.data[0]&&!Array.isArray(obj.options.data[0])){e=[];for(var t=0;t<obj.options.data.length;t++){for(var o=[],n=0;n<obj.options.columns.length;n++)o[n]=obj.options.data[t][obj.options.columns[n].name];e.push(o)}obj.options.data=e}t=0,n=0;var i=obj.options.columns.length,r=obj.options.data.length,s=obj.options.minDimensions[0],a=obj.options.minDimensions[1],l=s>i?s:i,u=a>r?a:r;for(t=0;t<u;t++)for(n=0;n<l;n++)null==obj.options.data[t]&&(obj.options.data[t]=[]),null==obj.options.data[t][n]&&(obj.options.data[t][n]="");if(obj.rows=[],obj.results=null,obj.records=[],obj.history=[],obj.historyIndex=-1,obj.tbody.innerHTML="",1==obj.options.lazyLoading){var c=0,d=obj.options.data.length<100?obj.options.data.length:100;obj.options.pagination&&(obj.options.pagination=!1,console.error("JEXCEL: Pagination will be disable due the lazyLoading"))}else obj.options.pagination?(obj.pageNumber||(obj.pageNumber=0),c=obj.options.pagination*obj.pageNumber,obj.options.data.length<(d=obj.options.pagination*obj.pageNumber+obj.options.pagination)&&(d=obj.options.data.length)):(c=0,d=obj.options.data.length);for(t=0;t<obj.options.data.length;t++){var h=obj.createRow(t,obj.options.data[t]);t>=c&&t<d&&obj.tbody.appendChild(h)}if(1==obj.options.lazyLoading||obj.options.pagination&&obj.updatePagination(),obj.options.mergeCells){var p=Object.keys(obj.options.mergeCells);for(n=0;n<p.length;n++){var f=obj.options.mergeCells[p[n]];obj.setMerge(p[n],f[0],f[1],1)}}obj.updateTable(),obj.dispatch("onload",el,obj)},obj.getData=function(e,t){for(var o=[],n=0,i=0,r=1==t||0==obj.options.copyCompatibility,s=obj.options.columns.length,a=obj.options.data.length,l=0;l<a;l++){n=0;for(var u=0;u<s;u++)e&&!obj.records[l][u].classList.contains("highlight")||(o[i]||(o[i]=[]),o[i][n]=r?obj.options.data[l][u]:obj.records[l][u].innerHTML,n++);n>0&&i++}return o},obj.getJsonRow=function(e){for(var t=obj.options.data[e],o=obj.options.columns.length,n={},i=0;i<o;i++)obj.options.columns[i].name||(obj.options.columns[i].name=i),n[obj.options.columns[i].name]=t[i];return n},obj.getJson=function(e){for(var t=[],o=obj.options.columns.length,n=obj.options.data.length,i=0;i<n;i++){for(var r=null,s=0;s<o;s++)e&&!obj.records[i][s].classList.contains("highlight")||(null==r&&(r={}),obj.options.columns[s].name||(obj.options.columns[s].name=s),r[obj.options.columns[s].name]=obj.options.data[i][s]);null!=r&&t.push(r)}return t},obj.prepareJson=function(e){for(var t=[],o=0;o<e.length;o++){var n=e[o].x,i=e[o].y,r=obj.options.columns[n].name?obj.options.columns[n].name:n;t[i]||(t[i]={row:i,data:{}}),t[i].data[r]=e[o].newValue}return t.filter(function(e){return null!=e})},obj.save=function(e,t){var o=obj.dispatch("onbeforesave",el,obj,t);if(o)t=o;else if(!1===o)return!1;jSuites.ajax({url:e,method:"POST",dataType:"json",data:{data:JSON.stringify(t)},success:function(e){obj.dispatch("onsave",el,obj,t)}})},obj.getRowData=function(e){return obj.options.data[e]},obj.setRowData=function(e,t){for(var o=0;o<obj.headers.length;o++){var n=jexcel.getColumnNameFromId([o,e]);null!=t[o]&&obj.setValue(n,t[o])}},obj.getColumnData=function(e){for(var t=[],o=0;o<obj.options.data.length;o++)t.push(obj.options.data[o][e]);return t},obj.setColumnData=function(e,t){for(var o=0;o<obj.rows.length;o++){var n=jexcel.getColumnNameFromId([e,o]);null!=t[o]&&obj.setValue(n,t[o])}},obj.createRow=function(e,t){obj.records[e]||(obj.records[e]=[]),t||(t=obj.options.data[e]),obj.rows[e]=document.createElement("tr"),obj.rows[e].setAttribute("data-y",e);var o=null;obj.options.rows[e]&&(obj.options.rows[e].height&&(obj.rows[e].style.height=obj.options.rows[e].height),obj.options.rows[e].title&&(o=obj.options.rows[e].title)),o||(o=parseInt(e+1));var n=document.createElement("td");n.innerHTML=o,n.setAttribute("data-y",e),n.className="jexcel_row",obj.rows[e].appendChild(n);for(var i=0;i<obj.options.columns.length;i++)obj.records[e][i]=obj.createCell(i,e,t[i]),obj.rows[e].appendChild(obj.records[e][i]);return obj.rows[e]},obj.parseValue=function(e,t,o){return"="==(""+o).substr(0,1)&&1==obj.options.parseFormulas&&(o=obj.executeFormula(o,e,t)),obj.options.columns[e].mask&&(o=""+jSuites.mask.run(o,obj.options.columns[e].mask,obj.options.columns[e].decimal||".")),o},obj.createCell=function(e,t,o){var n=document.createElement("td");if(n.setAttribute("data-x",e),n.setAttribute("data-y",t),"="==(""+o).substr(0,1)&&1==obj.options.secureFormulas){var i=secureFormula(o);i!=o&&(o=i)}if(obj.options.columns[e].editor)!1===obj.options.stripHTML||!1===obj.options.columns[e].stripHTML?n.innerHTML=o:n.innerText=o,"function"==typeof obj.options.columns[e].editor.createCell&&(n=obj.options.columns[e].editor.createCell(n));else if("hidden"==obj.options.columns[e].type)n.style.display="none",n.innerText=o;else if("checkbox"==obj.options.columns[e].type||"radio"==obj.options.columns[e].type){var r=document.createElement("input");r.type=obj.options.columns[e].type,r.name="c"+e,r.checked=1==o||1==o||"true"==o,r.onclick=function(){obj.setValue(n,this.checked)},1!=obj.options.columns[e].readOnly&&0!=obj.options.editable||r.setAttribute("disabled","disabled"),n.appendChild(r),obj.options.data[t][e]=r.checked}else if("calendar"==obj.options.columns[e].type){var s=jSuites.calendar.extractDateFromString(o,obj.options.columns[e].options.format);n.innerText=jSuites.calendar.getDateString(s||o,obj.options.columns[e].options.format)}else if("dropdown"==obj.options.columns[e].type||"autocomplete"==obj.options.columns[e].type)n.classList.add("jexcel_dropdown"),n.innerText=obj.getDropDownValue(e,o);else if("color"==obj.options.columns[e].type)if("square"==obj.options.columns[e].render){var a=document.createElement("div");a.className="color",a.style.backgroundColor=o,n.appendChild(a)}else n.style.color=o,n.innerText=o;else if("image"==obj.options.columns[e].type){if(o&&"data:image"==o.substr(0,10)){var l=document.createElement("img");l.src=o,n.appendChild(l)}}else"html"==obj.options.columns[e].type||!1===obj.options.stripHTML||!1===obj.options.columns[e].stripHTML?n.innerHTML=stripScript(obj.parseValue(e,t,o)):n.innerText=obj.parseValue(e,t,o);return 1==obj.options.columns[e].readOnly&&(n.className="readonly"),n.style.textAlign=obj.options.columns[e].align?obj.options.columns[e].align:"center",0!=obj.options.columns[e].wordWrap&&(1==obj.options.wordWrap||1==obj.options.columns[e].wordWrap||n.innerHTML.length>200)&&(n.style.whiteSpace="pre-wrap"),e>0&&1==this.options.textOverflow&&(o||n.innerHTML?obj.records[t][e-1].style.overflow="hidden":e==obj.options.columns.length-1&&(n.style.overflow="hidden")),n},obj.createCellHeader=function(e){var t=obj.options.columns[e].width?obj.options.columns[e].width:obj.options.defaultColWidth,o=obj.options.columns[e].align?obj.options.columns[e].align:obj.options.defaultColAlign;obj.headers[e]=document.createElement("td"),obj.options.stripHTML?obj.headers[e].innerText=obj.options.columns[e].title?obj.options.columns[e].title:jexcel.getColumnName(e):obj.headers[e].innerHTML=obj.options.columns[e].title?obj.options.columns[e].title:jexcel.getColumnName(e),obj.headers[e].setAttribute("data-x",e),obj.headers[e].style.textAlign=o,obj.options.columns[e].title&&obj.headers[e].setAttribute("title",obj.options.columns[e].textContent),obj.colgroup[e]=document.createElement("col"),obj.colgroup[e].setAttribute("width",t),"hidden"==obj.options.columns[e].type&&(obj.headers[e].style.display="none",obj.colgroup[e].style.display="none")},obj.updateNestedHeader=function(e,t,o){obj.options.nestedHeaders[t][e].title&&(obj.options.nestedHeaders[t][e].title=o,obj.options.nestedHeaders[t].element.children[e+1].innerText=o)},obj.createNestedHeader=function(e){var t=document.createElement("tr");t.classList.add("jexcel_nested");var o=document.createElement("td");t.appendChild(o),e.element=t;for(var n=0,i=0;i<e.length;i++){e[i].colspan||(e[i].colspan=1),e[i].align||(e[i].align="center"),e[i].title||(e[i].title="");for(var r=e[i].colspan,s=[],a=0;a<r;a++)obj.options.columns[n]&&"hidden"==obj.options.columns[n].type&&r++,s.push(n),n++;(o=document.createElement("td")).setAttribute("data-column",s.join(",")),o.setAttribute("colspan",e[i].colspan),o.setAttribute("align",e[i].align),o.innerText=e[i].title,t.appendChild(o)}return t},obj.createToolbar=function(e){e?obj.options.toolbar=e:e=obj.options.toolbar;for(var t=0;t<e.length;t++)if("i"==e[t].type)(i=document.createElement("i")).classList.add("jexcel_toolbar_item"),i.classList.add("material-icons"),i.setAttribute("data-k",e[t].k),i.setAttribute("data-v",e[t].v),i.setAttribute("id",e[t].id),e[t].tooltip&&i.setAttribute("title",e[t].tooltip),i.onclick=e[t].onclick?function(t){var o=t;return function(){e[o].onclick(el,obj,this)}}(t):function(){var e=this.getAttribute("data-k"),t=this.getAttribute("data-v");obj.setStyle(obj.highlighted,e,t)},i.innerText=e[t].content,obj.toolbar.appendChild(i);else if("select"==e[t].type){(i=document.createElement("select")).classList.add("jexcel_toolbar_item"),i.setAttribute("data-k",e[t].k),e[t].tooltip&&i.setAttribute("title",e[t].tooltip),i.onchange=e[t].onchange?e[t].onchange:function(){var e=this.getAttribute("data-k");obj.setStyle(obj.highlighted,e,this.value)};for(var o=0;o<e[t].v.length;o++){var n=document.createElement("option");n.value=e[t].v[o],n.innerText=e[t].v[o],i.appendChild(n)}obj.toolbar.appendChild(i)}else if("color"==e[t].type){var i;(i=document.createElement("i")).classList.add("jexcel_toolbar_item"),i.classList.add("material-icons"),i.setAttribute("data-k",e[t].k),i.setAttribute("data-v",""),e[t].tooltip&&i.setAttribute("title",e[t].tooltip),obj.toolbar.appendChild(i),i.innerText=e[t].content,jSuites.color(i,{onchange:function(e,t){var o=e.getAttribute("data-k");obj.setStyle(obj.highlighted,o,t)}})}},obj.setMerge=function(e,t,o,n){var i=!1;if(!e){if(!obj.highlighted.length)return alert(obj.options.text.noCellsSelected),null;var r=parseInt(obj.highlighted[0].getAttribute("data-x")),s=parseInt(obj.highlighted[0].getAttribute("data-y")),a=parseInt(obj.highlighted[obj.highlighted.length-1].getAttribute("data-x")),l=parseInt(obj.highlighted[obj.highlighted.length-1].getAttribute("data-y"));e=jexcel.getColumnNameFromId([r,s]),t=a-r+1,o=l-s+1}var u=jexcel.getIdFromColumnName(e,!0);if(obj.options.mergeCells[e])obj.records[u[1]][u[0]].getAttribute("data-merged")&&(i=obj.options.text.cellAlreadyMerged);else if((!t||t<2)&&(!o||o<2))i=obj.options.text.invalidMergeProperties;else for(var c=u[1];c<u[1]+o;c++)for(var d=u[0];d<u[0]+t;d++)jexcel.getColumnNameFromId([d,c]),obj.records[c][d].getAttribute("data-merged")&&(i=obj.options.text.thereIsAConflictWithAnotherMergedCell);if(i)alert(i);else{t>1?obj.records[u[1]][u[0]].setAttribute("colspan",t):t=1,o>1?obj.records[u[1]][u[0]].setAttribute("rowspan",o):o=1,obj.options.mergeCells[e]=[t,o,[]],obj.records[u[1]][u[0]].setAttribute("data-merged","true"),obj.records[u[1]][u[0]].style.overflow="hidden";for(var h=[],p=u[1];p<u[1]+o;p++)for(var f=u[0];f<u[0]+t;f++)u[0]==f&&u[1]==p||(h.push(obj.options.data[p][f]),obj.updateCell(f,p,"",!0),obj.options.mergeCells[e][2].push(obj.records[p][f]),obj.records[p][f].style.display="none",obj.records[p][f]=obj.records[u[1]][u[0]]);obj.updateSelection(obj.records[u[1]][u[0]]),n||(obj.setHistory({action:"setMerge",column:e,colspan:t,rowspan:o,data:h}),obj.dispatch("onmerge",el,e,t,o))}},obj.getMerge=function(e){var t={};if(e)t=obj.options.mergeCells[e]?[obj.options.mergeCells[e][0],obj.options.mergeCells[e][1]]:null;else if(obj.options.mergeCells)for(var o=Object.keys(obj.options.mergeCells),n=0;n<o.length;n++)t[o[n]]=[obj.options.mergeCells[o[n]][0],obj.options.mergeCells[o[n]][1]];return t},obj.removeMerge=function(e,t,o){if(obj.options.mergeCells[e]){var n=jexcel.getIdFromColumnName(e,!0);obj.records[n[1]][n[0]].removeAttribute("colspan"),obj.records[n[1]][n[0]].removeAttribute("rowspan"),obj.records[n[1]][n[0]].removeAttribute("data-merged");for(var i=obj.options.mergeCells[e],r=0,s=0;s<i[1];s++)for(var a=0;a<i[0];a++)(s>0||a>0)&&(obj.records[n[1]+s][n[0]+a]=i[2][r],obj.records[n[1]+s][n[0]+a].style.display="",t&&t[r]&&obj.updateCell(n[0]+a,n[1]+s,t[r]),r++);obj.updateSelection(obj.records[n[1]][n[0]],obj.records[n[1]+s-1][n[0]+a-1]),o||delete obj.options.mergeCells[e]}},obj.destroyMerged=function(e){if(obj.options.mergeCells)for(var t=Object.keys(obj.options.mergeCells),o=0;o<t.length;o++)obj.removeMerge(t[o],null,e)},obj.isColMerged=function(e,t){var o=[];if(obj.options.mergeCells)for(var n=Object.keys(obj.options.mergeCells),i=0;i<n.length;i++){var r=jexcel.getIdFromColumnName(n[i],!0),s=obj.options.mergeCells[n[i]][0],a=r[0],l=r[0]+(s>1?s-1:0);null==t?a<=e&&l>=e&&o.push(n[i]):t?a<e&&l>=e&&o.push(n[i]):a<=e&&l>e&&o.push(n[i])}return o},obj.isRowMerged=function(e,t){var o=[];if(obj.options.mergeCells)for(var n=Object.keys(obj.options.mergeCells),i=0;i<n.length;i++){var r=jexcel.getIdFromColumnName(n[i],!0),s=obj.options.mergeCells[n[i]][1],a=r[1],l=r[1]+(s>1?s-1:0);null==t?a<=e&&l>=e&&o.push(n[i]):t?a<e&&l>=e&&o.push(n[i]):a<=e&&l>e&&o.push(n[i])}return o},obj.openFilter=function(e){if(obj.options.filters){e=parseInt(e),obj.resetSelection();var t=[];if("checkbox"==obj.options.columns[e].type)t.push({id:"true",name:"True"}),t.push({id:"false",name:"False"});else{for(var o=[],n=!1,i=0;i<obj.options.data.length;i++){var r=obj.options.data[i][e],s=obj.records[i][e].innerHTML;r&&s?o[r]=s:n=!0}var a=Object.keys(o);for(t=[],i=0;i<a.length;i++)t.push({id:a[i],name:o[a[i]]});n&&t.push({value:"",id:"",name:"(Blanks)"})}var l=document.createElement("div");obj.filter.children[e+1].innerHTML="",obj.filter.children[e+1].appendChild(l),obj.filter.children[e+1].style.paddingLeft="0px",obj.filter.children[e+1].style.paddingRight="0px",obj.filter.children[e+1].style.overflow="initial",jSuites.dropdown(l,{data:t,multiple:!0,autocomplete:!0,opened:!0,value:void 0!==obj.filters[e]?obj.filters[e]:null,width:"100%",position:1==obj.options.tableOverflow||1==obj.options.fullscreen,onclose:function(t){obj.resetFilters(),obj.filters[e]=t.dropdown.getValue(!0),obj.filter.children[e+1].innerHTML=t.dropdown.getText(),obj.filter.children[e+1].style.paddingLeft="",obj.filter.children[e+1].style.paddingRight="",obj.filter.children[e+1].style.overflow="",obj.closeFilter(e),obj.refreshSelection()}})}else console.log("JEXCEL: filters not enabled.")},obj.resetFilters=function(){if(obj.options.filters)for(var e=0;e<obj.filter.children.length;e++)obj.filter.children[e].innerHTML="&nbsp;",obj.filters[e]=null},obj.closeFilter=function(e){if(!e)for(var t=0;t<obj.filter.children.length;t++)obj.filters[t]&&(e=t);var o=function(e,t,o){for(var n=0;n<e.length;n++)if(""==e[n]&&(!1===obj.options.data[o][t]||""+obj.options.data[o][t]=="")||""!=e[n]&&((""+obj.options.data[o][t]).search(e[n])>=0||(""+obj.records[o][t].innerHTML).search(e[n])>=0))return!0;return!1},n=obj.filters[e];obj.results=[];for(var i=0;i<obj.options.data.length;i++)o(n,e,i)&&obj.results.push(i);obj.results.length||(obj.results=null),obj.updateResult()},obj.openEditor=function(e,t,o){var n=e.getAttribute("data-y"),i=e.getAttribute("data-x");obj.dispatch("oneditionstart",el,e,i,n),i>0&&(obj.records[n][i-1].style.overflow="hidden");var r=function(t){var o=e.getBoundingClientRect(),r=document.createElement(t);return r.style.width=o.width+"px",r.style.height=o.height-2+"px",r.style.minHeight=o.height-2+"px",e.classList.add("editor"),e.innerHTML="",e.appendChild(r),obj.dispatch("oncreateeditor",el,e,i,n,r),r};if(1==e.classList.contains("readonly"));else if(obj.edition=[obj.records[n][i],obj.records[n][i].innerHTML,i,n],obj.options.columns[i].editor)obj.options.columns[i].editor.openEditor(e,el,t,o);else if("hidden"==obj.options.columns[i].type);else if("checkbox"==obj.options.columns[i].type||"radio"==obj.options.columns[i].type)obj.setValue(e,s=!e.children[0].checked),obj.edition=null;else if("dropdown"==obj.options.columns[i].type||"autocomplete"==obj.options.columns[i].type){var s=obj.options.data[n][i];if(obj.options.columns[i].multiple&&!Array.isArray(s)&&(s=s.split(";")),"function"==typeof obj.options.columns[i].filter)var a=obj.options.columns[i].filter(el,e,i,n,obj.options.columns[i].source);else a=obj.options.columns[i].source;for(var l=[],u=0;u<a.length;u++)l.push(a[u]);var c=r("div"),d={data:l,multiple:!!obj.options.columns[i].multiple,autocomplete:!(!obj.options.columns[i].autocomplete&&"autocomplete"!=obj.options.columns[i].type),opened:!0,value:s,width:"100%",height:c.style.minHeight,position:1==obj.options.tableOverflow||1==obj.options.fullscreen,onclose:function(){obj.closeEditor(e,!0)}};obj.options.columns[i].options&&obj.options.columns[i].options.type&&(d.type=obj.options.columns[i].options.type),jSuites.dropdown(c,d)}else if("calendar"==obj.options.columns[i].type||"color"==obj.options.columns[i].type)s=obj.options.data[n][i],(c=r("input")).value=s,1!=obj.options.tableOverflow&&1!=obj.options.fullscreen||(obj.options.columns[i].options.position=!0),obj.options.columns[i].options.value=obj.options.data[n][i],obj.options.columns[i].options.opened=!0,obj.options.columns[i].options.onclose=function(t,o){obj.closeEditor(e,!0)},"color"==obj.options.columns[i].type?jSuites.color(c,obj.options.columns[i].options):jSuites.calendar(c,obj.options.columns[i].options),c.focus();else if("html"==obj.options.columns[i].type){s=obj.options.data[n][i],(c=r("div")).style.position="relative",(f=document.createElement("div")).classList.add("jexcel_richtext"),c.appendChild(f),jSuites.editor(f,{focus:!0,value:s});var h=e.getBoundingClientRect(),p=f.getBoundingClientRect();f.style.top=window.innerHeight<h.bottom+p.height?h.top-(p.height+2)+"px":h.top+"px"}else if("image"==obj.options.columns[i].type){var f,v=e.children[0];(c=r("div")).style.position="relative",(f=document.createElement("div")).classList.add("jclose"),v&&v.src&&f.appendChild(v),c.appendChild(f),jSuites.image(f,obj.options.imageOptions),h=e.getBoundingClientRect(),p=f.getBoundingClientRect(),f.style.top=window.innerHeight<h.bottom+p.height?h.top-(p.height+2)+"px":h.top+"px"}else s=1==t?"":obj.options.data[n][i],0==obj.options.columns[i].wordWrap||1!=obj.options.wordWrap&&1!=obj.options.columns[i].wordWrap?(c=r("input"),obj.options.columns[i].mask&&c.setAttribute("data-mask",obj.options.columns[i].mask)):c=r("textarea"),c.onblur=function(){obj.closeEditor(e,!0)},c.focus(),c.value=s,c.scrollLeft=c.scrollWidth},obj.closeEditor=function(e,t){var o=parseInt(e.getAttribute("data-x")),n=parseInt(e.getAttribute("data-y"));if(1==t){if(obj.options.columns[o].editor)var i=obj.options.columns[o].editor.closeEditor(e,t);else if("checkbox"==obj.options.columns[o].type||"radio"==obj.options.columns[o].type||"hidden"==obj.options.columns[o].type);else if("dropdown"==obj.options.columns[o].type||"autocomplete"==obj.options.columns[o].type)i=e.children[0].dropdown.close(!0);else if("calendar"==obj.options.columns[o].type)i=e.children[0].calendar.close(!0);else if("color"==obj.options.columns[o].type)i=e.children[0].color.close(!0);else if("html"==obj.options.columns[o].type)i=e.children[0].children[0].editor.getData();else if("image"==obj.options.columns[o].type){var r=e.children[0].children[0].children[0];i=r&&"IMG"==r.tagName?r.src:""}else"numeric"==obj.options.columns[o].type?("="!=(i=e.children[0].value).substr(0,1)&&""==i&&(i=obj.options.columns[o].allowEmpty?"":0),e.children[0].onblur=null):(i=e.children[0].value,e.children[0].onblur=null);obj.options.data[n][o]==i?e.innerHTML=obj.edition[1]:obj.setValue(e,i)}else obj.options.columns[o].editor?obj.options.columns[o].editor.closeEditor(e,t):"dropdown"==obj.options.columns[o].type||"autocomplete"==obj.options.columns[o].type?e.children[0].dropdown.close(!0):"calendar"==obj.options.columns[o].type?e.children[0].calendar.close(!0):"color"==obj.options.columns[o].type?e.children[0].color.close(!0):e.children[0].onblur=null,e.innerHTML=obj.edition&&obj.edition[1]?obj.edition[1]:"";obj.dispatch("oneditionend",el,e,o,n,i,t),e.classList.remove("editor"),obj.edition=null},obj.getCell=function(e){return e=jexcel.getIdFromColumnName(e,!0),obj.records[e[1]][e[0]]},obj.getCellFromCoords=function(e,t){return obj.records[t][e]},obj.getLabel=function(e){return e=jexcel.getIdFromColumnName(e,!0),obj.records[e[1]][e[0]].innerHTML},obj.getLabelFromCoords=function(e,t){return obj.records[t][e].innerHTML},obj.getValue=function(e,t){if("object"==typeof e)var o=e.getAttribute("data-x"),n=e.getAttribute("data-y");else o=(e=jexcel.getIdFromColumnName(e,!0))[0],n=e[1];var i=null;return null!=o&&null!=n&&(obj.records[n]&&obj.records[n][o]&&(t||1==obj.options.copyCompatibility)?i=obj.records[n][o].innerHTML:obj.options.data[n]&&"undefined"!=obj.options.data[n][o]&&(i=obj.options.data[n][o])),i},obj.getValueFromCoords=function(e,t,o){var n=null;return null!=e&&null!=t&&(obj.records[t]&&obj.records[t][e]&&o||1==obj.options.copyCompatibility?n=obj.records[t][e].innerHTML:obj.options.data[t]&&"undefined"!=obj.options.data[t][e]&&(n=obj.options.data[t][e])),n},obj.setValue=function(e,t,o){var n=[];if("string"==typeof e){var i=jexcel.getIdFromColumnName(e,!0);n.push(obj.updateCell(r=i[0],s=i[1],t,o)),obj.updateFormulaChain(r,s,n)}else{var r=null,s=null;if(e&&e.getAttribute&&(r=e.getAttribute("data-x"),s=e.getAttribute("data-y")),null!=r&&null!=s)n.push(obj.updateCell(r,s,t,o)),obj.updateFormulaChain(r,s,n);else{var a=Object.keys(e);if(a.length>0)for(var l=0;l<a.length;l++)"string"==typeof e[l]?(r=(i=jexcel.getIdFromColumnName(e[l],!0))[0],s=i[1]):null!=e[l].x&&null!=e[l].y?(r=e[l].x,s=e[l].y,null!=e[l].newValue?t=e[l].newValue:null!=e[l].value&&(t=e[l].value)):(r=e[l].getAttribute("data-x"),s=e[l].getAttribute("data-y")),null!=r&&null!=s&&(n.push(obj.updateCell(r,s,t,o)),obj.updateFormulaChain(r,s,n))}}obj.setHistory({action:"setValue",records:n,selection:obj.selectedCell}),obj.updateTable(),obj.onafterchanges(el,n)},obj.setValueFromCoords=function(e,t,o,n){var i=[];i.push(obj.updateCell(e,t,o,n)),obj.updateFormulaChain(e,t,i),obj.setHistory({action:"setValue",records:i,selection:obj.selectedCell}),obj.updateTable(),obj.onafterchanges(el,i)},obj.setCheckRadioValue=function(){for(var e=[],t=Object.keys(obj.highlighted),o=0;o<t.length;o++){var n=obj.highlighted[o].getAttribute("data-x"),i=obj.highlighted[o].getAttribute("data-y");"checkbox"!=obj.options.columns[n].type&&"radio"!=obj.options.columns[n].type||e.push(obj.updateCell(n,i,!obj.options.data[i][n]))}e.length&&(obj.setHistory({action:"setValue",records:e,selection:obj.selectedCell}),obj.onafterchanges(el,e))};var stripScript=function(e){var t=new Option;t.innerHTML=e;var o=null;for(e=t.getElementsByTagName("script");o=e[0];)o.parentNode.removeChild(o);return t.innerHTML};obj.updateCell=function(e,t,o,n){if(1!=obj.records[t][e].classList.contains("readonly")||n){var i;if("="==(""+o).substr(0,1)&&1==obj.options.secureFormulas&&(i=secureFormula(o))!=o&&(o=i),null!=(i=obj.dispatch("onbeforechange",el,obj.records[t][e],e,t,o))&&(o=i),obj.options.columns[e].editor&&"function"==typeof obj.options.columns[e].editor.updateCell&&(o=obj.options.columns[e].editor.updateCell(obj.records[t][e],o,n)),u={x:e,y:t,col:e,row:t,newValue:o,oldValue:obj.options.data[t][e]},obj.options.columns[e].editor)obj.options.data[t][e]=o;else if("checkbox"==obj.options.columns[e].type||"radio"==obj.options.columns[e].type){if("radio"==obj.options.columns[e].type)for(var r=0;r<obj.options.data.length;r++)obj.options.data[r][e]=!1;obj.records[t][e].children[0].checked=1==o||1==o||"true"==o||"TRUE"==o,obj.options.data[t][e]=obj.records[t][e].children[0].checked}else if("dropdown"==obj.options.columns[e].type||"autocomplete"==obj.options.columns[e].type)obj.options.data[t][e]=o,obj.records[t][e].innerText=obj.getDropDownValue(e,o);else if("calendar"==obj.options.columns[e].type){var s=jSuites.calendar.extractDateFromString(o,obj.options.columns[e].options.format);obj.options.data[t][e]=o,obj.records[t][e].innerText=jSuites.calendar.getDateString(s||o,obj.options.columns[e].options.format)}else if("color"==obj.options.columns[e].type)if(obj.options.data[t][e]=o,"square"==obj.options.columns[e].render){var a=document.createElement("div");a.className="color",a.style.backgroundColor=o,obj.records[t][e].innerText="",obj.records[t][e].appendChild(a)}else obj.records[t][e].style.color=o,obj.records[t][e].innerText=o;else if("image"==obj.options.columns[e].type){if(obj.options.data[t][e]=o=""+o,obj.records[t][e].innerHTML="",o&&"data:image"==o.substr(0,10)){var l=document.createElement("img");l.src=o,obj.records[t][e].appendChild(l)}}else obj.options.data[t][e]=o,"html"==obj.options.columns[e].type||!1===obj.options.stripHTML||!1===obj.options.columns[e].stripHTML?obj.records[t][e].innerHTML=stripScript(obj.parseValue(e,t,o)):obj.records[t][e].innerText=obj.parseValue(e,t,o),obj.records[t][e].style.whiteSpace=0!=obj.options.columns[e].wordWrap&&(1==obj.options.wordWrap||1==obj.options.columns[e].wordWrap||obj.records[t][e].innerHTML.length>200)?"pre-wrap":"";e>0&&(obj.records[t][e-1].style.overflow=o?"hidden":""),obj.dispatch("onchange",el,obj.records[t]&&obj.records[t][e]?obj.records[t][e]:null,e,t,o,u.oldValue)}else var u={x:e,y:t,col:e,row:t};return u},obj.copyData=function(e,t){var o=obj.getData(!0,!0),n=obj.selectedContainer,i=parseInt(e.getAttribute("data-x")),r=parseInt(e.getAttribute("data-y")),s=parseInt(t.getAttribute("data-x")),a=parseInt(t.getAttribute("data-y")),l=[],u=!1;if(n[0]==i){if(r<n[1])var c=r-n[1];else c=1;var d=0}else d=i<n[0]?i-n[0]:1,c=0;for(var h=0,p=0,f=r;f<=a;f++)if(!obj.rows[f]||"none"!=obj.rows[f].style.display){null==o[p]&&(p=0),h=0,n[0]!=i&&(d=i<n[0]?i-n[0]:1);for(var v=i;v<=s;v++){if(obj.records[f][v]&&!obj.records[f][v].classList.contains("readonly")&&"none"!=obj.records[f][v].style.display&&0==u){if(!obj.selection.length&&""!=obj.options.data[f][v]){u=!0;continue}(null==o[p]||null==o[p][h])&&(h=0);var g=o[p][h];if(g&&!o[1]&&1==obj.options.autoIncrement)if("text"==obj.options.columns[v].type||"number"==obj.options.columns[v].type)if("="==(""+g).substr(0,1)){var b=g.match(/([A-Z]+[0-9]+)/g);if(b){for(var m=[],y=0;y<b.length;y++){var j=jexcel.getIdFromColumnName(b[y],1);j[0]+=d,j[1]+=c,j[1]<0&&(j[1]=0);var w=jexcel.getColumnNameFromId([j[0],j[1]]);w!=b[y]&&(m[b[y]]=w)}m&&(g=obj.updateFormula(g,m))}}else g==Number(g)&&(g=Number(g)+c);else if("calendar"==obj.options.columns[v].type){var x=new Date(g);x.setDate(x.getDate()+c),g=x.getFullYear()+"-"+jexcel.doubleDigitFormat(parseInt(x.getMonth()+1))+"-"+jexcel.doubleDigitFormat(x.getDate())+" 00:00:00"}l.push(obj.updateCell(v,f,g)),obj.updateFormulaChain(v,f,l)}h++,n[0]!=i&&d++}p++,c++}obj.setHistory({action:"setValue",records:l,selection:obj.selectedCell}),obj.updateTable(),obj.onafterchanges(el,l)},obj.refreshSelection=function(){obj.selectedCell&&obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])},obj.conditionalSelectionUpdate=function(e,t,o){if(1==e){if(obj.selectedCell&&(t>=obj.selectedCell[1]&&t<=obj.selectedCell[3]||o>=obj.selectedCell[1]&&o<=obj.selectedCell[3]))return void obj.resetSelection()}else if(obj.selectedCell&&(t>=obj.selectedCell[0]&&t<=obj.selectedCell[2]||o>=obj.selectedCell[0]&&o<=obj.selectedCell[2]))return void obj.resetSelection()},obj.resetSelection=function(e){if(obj.highlighted.length){u=1;for(var t=0;t<obj.highlighted.length;t++){obj.highlighted[t].classList.remove("highlight"),obj.highlighted[t].classList.remove("highlight-left"),obj.highlighted[t].classList.remove("highlight-right"),obj.highlighted[t].classList.remove("highlight-top"),obj.highlighted[t].classList.remove("highlight-bottom"),obj.highlighted[t].classList.remove("highlight-selected");var o=parseInt(obj.highlighted[t].getAttribute("data-x")),n=parseInt(obj.highlighted[t].getAttribute("data-y"));if(obj.highlighted[t].getAttribute("data-merged"))var i=parseInt(obj.highlighted[t].getAttribute("colspan")),r=parseInt(obj.highlighted[t].getAttribute("rowspan")),s=i>0?o+(i-1):o,a=r>0?n+(r-1):n;else s=o,a=n;for(var l=o;l<=s;l++)obj.headers[l]&&obj.headers[l].classList.remove("selected");for(l=n;l<=a;l++)obj.rows[l]&&obj.rows[l].classList.remove("selected")}}else var u=0;return obj.highlighted=[],obj.selectedCell=null,obj.corner.style.top="-2000px",obj.corner.style.left="-2000px",1==e&&1==u&&obj.dispatch("onblur",el),u},obj.updateSelection=function(e,t,o){var n=e.getAttribute("data-x"),i=e.getAttribute("data-y");if(t)var r=t.getAttribute("data-x"),s=t.getAttribute("data-y");else r=n,s=i;obj.updateSelectionFromCoords(n,i,r,s,o)},obj.updateSelectionFromCoords=function(e,t,o,n,i){var r=obj.resetSelection();if(null==o&&(o=e),null==n&&(n=t),e>=obj.headers.length&&(e=obj.headers.length-1),t>=obj.rows.length&&(t=obj.rows.length-1),o>=obj.headers.length&&(o=obj.headers.length-1),n>=obj.rows.length&&(n=obj.rows.length-1),obj.selectedCell=[e,t,o,n],null!=e){if(obj.records[t][e]&&obj.records[t][e].classList.add("highlight-selected"),parseInt(e)<parseInt(o))var s=parseInt(e),a=parseInt(o);else s=parseInt(o),a=parseInt(e);if(parseInt(t)<parseInt(n))var l=parseInt(t),u=parseInt(n);else l=parseInt(n),u=parseInt(t);for(var c=s;c<=a;c++)for(var d=l;d<=u;d++)if(obj.records[d][c]&&obj.records[d][c].getAttribute("data-merged")){var h=parseInt(obj.records[d][c].getAttribute("data-x")),p=parseInt(obj.records[d][c].getAttribute("data-y")),f=parseInt(obj.records[d][c].getAttribute("colspan")),v=parseInt(obj.records[d][c].getAttribute("rowspan"));f>1&&(h<s&&(s=h),h+f>a&&(a=h+f-1)),v&&(p<l&&(l=p),p+v>u&&(u=p+v-1))}var g=null,b=null,m=null,y=null;for(d=l;d<=u;d++)"none"!=obj.rows[d].style.display&&(null==m&&(m=d),y=d);for(c=s;c<=a;c++){for(d=l;d<=u;d++)"none"!=obj.rows[d].style.display&&"none"!=obj.records[d][c].style.display&&(obj.records[d][c].classList.add("highlight"),obj.highlighted.push(obj.records[d][c]));"hidden"!=obj.options.columns[c].type&&(null==g&&(g=c),b=c)}for(g||(g=0),b||(b=0),c=g;c<=b;c++)"hidden"!=obj.options.columns[c].type&&(obj.records[m]&&obj.records[m][c]&&obj.records[m][c].classList.add("highlight-top"),obj.records[y]&&obj.records[y][c]&&obj.records[y][c].classList.add("highlight-bottom"),obj.headers[c].classList.add("selected"));for(d=m;d<=y;d++)obj.rows[d]&&"none"!=obj.rows[d].style.display&&(obj.records[d][g].classList.add("highlight-left"),obj.records[d][b].classList.add("highlight-right"),obj.rows[d].classList.add("selected"));obj.selectedContainer=[g,m,b,y]}0==r&&(obj.dispatch("onfocus",el),obj.removeCopyingSelection()),obj.dispatch("onselection",el,g,m,b,y,i),obj.updateCornerPosition()},obj.removeCopySelection=function(){for(var e=0;e<obj.selection.length;e++)obj.selection[e].classList.remove("selection"),obj.selection[e].classList.remove("selection-left"),obj.selection[e].classList.remove("selection-right"),obj.selection[e].classList.remove("selection-top"),obj.selection[e].classList.remove("selection-bottom");obj.selection=[]},obj.updateCopySelection=function(e,t){obj.removeCopySelection();var o=obj.selectedContainer[0],n=obj.selectedContainer[1],i=obj.selectedContainer[2],r=obj.selectedContainer[3];if(null!=e&&null!=t){if(e-i>0)var s=parseInt(i)+1,a=parseInt(e);else s=parseInt(e),a=parseInt(o)-1;if(t-r>0)var l=parseInt(r)+1,u=parseInt(t);else l=parseInt(t),u=parseInt(n)-1;a-s<=u-l?(s=parseInt(o),a=parseInt(i)):(l=parseInt(n),u=parseInt(r));for(var c=l;c<=u;c++)for(var d=s;d<=a;d++)obj.records[c][d]&&"none"!=obj.rows[c].style.display&&"none"!=obj.records[c][d].style.display&&(obj.records[c][d].classList.add("selection"),obj.records[l][d].classList.add("selection-top"),obj.records[u][d].classList.add("selection-bottom"),obj.records[c][s].classList.add("selection-left"),obj.records[c][a].classList.add("selection-right"),obj.selection.push(obj.records[c][d]))}},obj.updateCornerPosition=function(){if(obj.highlighted.length){var e=obj.highlighted[obj.highlighted.length-1],t=obj.content.getBoundingClientRect(),o=t.left,n=t.top,i=e.getBoundingClientRect(),r=i.left,s=i.width,a=r-o+obj.content.scrollLeft+s-4;obj.corner.style.top=i.top-n+obj.content.scrollTop+i.height-4+"px",obj.corner.style.left=a+"px",obj.options.freezeColumns&&r-o+s<obj.getFreezeWidth()?obj.corner.style.display="none":1==obj.options.selectionCopy&&(obj.corner.style.display="")}else obj.corner.style.top="-2000px",obj.corner.style.left="-2000px"},obj.updateScroll=function(e){var t=obj.content.getBoundingClientRect(),o=t.left,n=t.top,i=t.width,r=t.height,s=obj.records[obj.selectedCell[3]][obj.selectedCell[2]].getBoundingClientRect(),a=s.left,l=s.top,u=s.height;if(0==e||1==e)var c=a-o+obj.content.scrollLeft,d=l-n+obj.content.scrollTop-2;else c=a-o+obj.content.scrollLeft+s.width,d=l-n+obj.content.scrollTop+u;d>obj.content.scrollTop+30&&d<obj.content.scrollTop+r||(obj.content.scrollTop=d<obj.content.scrollTop+30?d-u:d-(r-2));var h=obj.getFreezeWidth();c>obj.content.scrollLeft+h&&c<obj.content.scrollLeft+i||(c<obj.content.scrollLeft+30?(obj.content.scrollLeft=c,obj.content.scrollLeft<50&&(obj.content.scrollLeft=0)):obj.content.scrollLeft=c<obj.content.scrollLeft+h?c-h-1:c-(i-20))},obj.getWidth=function(e){if(e)"object"==typeof e&&(e=$(e).getAttribute("data-x")),t=obj.colgroup[e].getAttribute("width");else for(var t=[],o=0;o<obj.headers.length;o++)t.push(obj.options.columns[o].width);return t},obj.setWidth=function(e,t,o){if(t){if(Array.isArray(e)){o||(o=[]);for(var n=0;n<e.length;n++){o[n]||(o[n]=obj.colgroup[e[n]].getAttribute("width"));var i=Array.isArray(t)&&t[n]?t[n]:t;obj.colgroup[e[n]].setAttribute("width",i),obj.options.columns[e[n]].width=i}}else o||(o=obj.colgroup[e].getAttribute("width")),obj.colgroup[e].setAttribute("width",t),obj.options.columns[e].width=t;obj.setHistory({action:"setWidth",column:e,oldValue:o,newValue:t}),obj.dispatch("onresizecolumn",el,e,t,o),obj.updateCornerPosition()}},obj.setHeight=function(e,t,o){t>0&&("object"==typeof e&&(e=e.getAttribute("data-y")),o||(o=obj.rows[e].getAttribute("height"))||(o=obj.rows[e].getBoundingClientRect().height),t=parseInt(t),obj.rows[e].style.height=t+"px",obj.options.rows[e]||(obj.options.rows[e]={}),obj.options.rows[e].height=t,obj.setHistory({action:"setHeight",row:e,oldValue:o,newValue:t}),obj.dispatch("onresizerow",el,e,t,o),obj.updateCornerPosition())},obj.getHeight=function(e){if(e)"object"==typeof e&&(e=$(e).getAttribute("data-y")),t=obj.rows[e].style.height;else for(var t=[],o=0;o<obj.rows.length;o++){var n=obj.rows[o].style.height;n&&(t[o]=n)}return t},obj.setFooter=function(e){if(e&&(obj.options.footers=e),obj.options.footers){obj.tfoot||(obj.tfoot=document.createElement("tfoot"),obj.table.appendChild(obj.tfoot));for(var t=0;t<obj.options.footers.length;t++){if(obj.tfoot.children[t])var o=obj.tfoot.children[t];else{o=document.createElement("tr");var n=document.createElement("td");o.appendChild(n),obj.tfoot.appendChild(o)}for(var i=0;i<obj.headers.length;i++)obj.options.footers[t][i]||(obj.options.footers[t][i]=""),obj.tfoot.children[t].children[i+1]?n=obj.tfoot.children[t].children[i+1]:(n=document.createElement("td"),o.appendChild(n),n.style.textAlign=obj.options.columns[i].align?obj.options.columns[i].align:"center"),n.innerText=obj.parseValue(i,t,obj.options.footers[t][i])}}},obj.getHeader=function(e){return obj.headers[e].innerText},obj.setHeader=function(e,t){if(obj.headers[e]){var o=obj.headers[e].innerText;t||(t=prompt(obj.options.text.columnName,o)),t&&(obj.headers[e].innerText=t,obj.headers[e].setAttribute("title",t),obj.options.columns[e].title=t),obj.setHistory({action:"setHeader",column:e,oldValue:o,newValue:t}),obj.dispatch("onchangeheader",el,e,o,t)}},obj.getHeaders=function(e){for(var t=[],o=0;o<obj.headers.length;o++)t.push(obj.getHeader(o));return e?t:t.join(obj.options.csvDelimiter)},obj.getMeta=function(e,t){return e?t?obj.options.meta[e]&&obj.options.meta[e][t]?obj.options.meta[e][t]:null:obj.options.meta[e]?obj.options.meta[e]:null:obj.options.meta},obj.setMeta=function(e,t,o){if(obj.options.meta||(obj.options.meta={}),t&&o)obj.options.meta[e]||(obj.options.meta[e]={}),obj.options.meta[e][t]=o;else for(var n=Object.keys(e),i=0;i<n.length;i++){obj.options.meta[n[i]]||(obj.options.meta[n[i]]={});for(var r=Object.keys(e[n[i]]),s=0;s<r.length;s++)obj.options.meta[n[i]][r[s]]=e[n[i]][r[s]]}obj.dispatch("onchangemeta",el,e,t,o)},obj.updateMeta=function(e){if(obj.options.meta){for(var t={},o=Object.keys(obj.options.meta),n=0;n<o.length;n++)e[o[n]]?t[e[o[n]]]=obj.options.meta[o[n]]:t[o[n]]=obj.options.meta[o[n]];obj.options.meta=t}},obj.getStyle=function(e,t){if(e)return e=jexcel.getIdFromColumnName(e,!0),t?obj.records[e[1]][e[0]].style[t]:obj.records[e[1]][e[0]].getAttribute("style");for(var o={},n=obj.options.data[0].length,i=obj.options.data.length,r=0;r<i;r++)for(var s=0;s<n;s++){var a=t?obj.records[r][s].style[t]:obj.records[r][s].getAttribute("style");a&&(o[jexcel.getColumnNameFromId([s,r])]=a)}return o},obj.resetStyle=function(e,t){for(var o=Object.keys(e),n=0;n<o.length;n++){var i=jexcel.getIdFromColumnName(o[n],!0);obj.records[i[1]]&&obj.records[i[1]][i[0]]&&obj.records[i[1]][i[0]].setAttribute("style","")}obj.setStyle(e,null,null,null,t)},obj.setStyle=function(e,t,o,n,i){var r={},s={},a=function(e,t,o){var i=jexcel.getIdFromColumnName(e,!0);if(obj.records[i[1]]&&obj.records[i[1]][i[0]]&&(0==obj.records[i[1]][i[0]].classList.contains("readonly")||n)){var a=obj.records[i[1]][i[0]].style[t];a!=o||n?obj.records[i[1]][i[0]].style[t]=o:(o="",obj.records[i[1]][i[0]].style[t]=""),s[e]||(s[e]=[]),r[e]||(r[e]=[]),s[e].push([t+":"+a]),r[e].push([t+":"+o])}};if(t&&o)if("string"==typeof e)a(e,t,o);else for(var l=[],u=0;u<e.length;u++){var c=e[u].getAttribute("data-x"),d=e[u].getAttribute("data-y"),h=jexcel.getColumnNameFromId([c,d]);l[h]||(a(h,t,o),l[h]=!0)}else{var p=Object.keys(e);for(u=0;u<p.length;u++){var f=e[p[u]];"string"==typeof f&&(f=f.split(";"));for(var v=0;v<f.length;v++)"string"==typeof f[v]&&(f[v]=f[v].split(":")),f[v][0].trim()&&a(p[u],f[v][0].trim(),f[v][1])}}for(p=Object.keys(s),u=0;u<p.length;u++)s[p[u]]=s[p[u]].join(";");for(p=Object.keys(r),u=0;u<p.length;u++)r[p[u]]=r[p[u]].join(";");i||obj.setHistory({action:"setStyle",oldValue:s,newValue:r}),obj.dispatch("onchangestyle",el,e,t,o)},obj.getComments=function(e,t){if(e)return"string"==typeof e&&(e=jexcel.getIdFromColumnName(e,!0)),t?[obj.records[e[1]][e[0]].getAttribute("title"),obj.records[e[1]][e[0]].getAttribute("author")]:obj.records[e[1]][e[0]].getAttribute("title")||"";for(var o={},n=0;n<obj.options.data.length;n++)for(var i=0;i<obj.options.columns.length;i++){var r=obj.records[n][i].getAttribute("title");r&&(o[e=jexcel.getColumnNameFromId([i,n])]=r)}return o},obj.setComments=function(e,t,o){if("string"==typeof e)var n=jexcel.getIdFromColumnName(e,!0);else n=e;var i=obj.records[n[1]][n[0]].getAttribute("title"),r=[i,o=obj.records[n[1]][n[0]].getAttribute("data-author")];obj.records[n[1]][n[0]].setAttribute("title",t||""),obj.records[n[1]][n[0]].setAttribute("data-author",o||""),t?obj.records[n[1]][n[0]].classList.add("jexcel_comments"):obj.records[n[1]][n[0]].classList.remove("jexcel_comments"),obj.setHistory({action:"setComments",column:e,newValue:[t,o],oldValue:r}),obj.dispatch("oncomments",el,t,i)},obj.getConfig=function(){var e=obj.options;return e.style=obj.getStyle(),e.mergeCells=obj.getMerge(),e.comments=obj.getComments(),e},obj.orderBy=function(e,t){if(e>=0){if(Object.keys(obj.options.mergeCells).length>0){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}t=null==t?obj.headers[e].classList.contains("arrow-down")?1:0:t?1:0;var o=[];if("number"==obj.options.columns[e].type||"percentage"==obj.options.columns[e].type||"autonumber"==obj.options.columns[e].type||"color"==obj.options.columns[e].type)for(var n=0;n<obj.options.data.length;n++)o[n]=[n,Number(obj.options.data[n][e])];else if("calendar"==obj.options.columns[e].type||"checkbox"==obj.options.columns[e].type||"radio"==obj.options.columns[e].type)for(n=0;n<obj.options.data.length;n++)o[n]=[n,obj.options.data[n][e]];else for(n=0;n<obj.options.data.length;n++)o[n]=[n,obj.records[n][e].innerText.toLowerCase()];"function"!=typeof obj.options.sorting&&(obj.options.sorting=function(e){return function(t,o){var n=t[1],i=o[1];return e?""===n&&""!==i?1:""!==n&&""===i||n>i?-1:n<i?1:0:""===n&&""!==i?1:""!==n&&""===i?-1:n>i?1:n<i?-1:0}}),o=o.sort(obj.options.sorting(t));var i=[];for(n=0;n<o.length;n++)i[n]=o[n][0];return obj.setHistory({action:"orderBy",rows:i,column:e,order:t}),obj.updateOrderArrow(e,t),obj.updateOrder(i),obj.dispatch("onsort",el,e,t),!0}},obj.updateOrderArrow=function(e,t){for(var o=0;o<obj.headers.length;o++)obj.headers[o].classList.remove("arrow-up"),obj.headers[o].classList.remove("arrow-down");obj.headers[e].classList.add(t?"arrow-up":"arrow-down")},obj.updateOrder=function(e){for(var t=[],o=0;o<e.length;o++)t[o]=obj.options.data[e[o]];for(obj.options.data=t,t=[],o=0;o<e.length;o++)t[o]=obj.records[e[o]];for(obj.records=t,t=[],o=0;o<e.length;o++)t[o]=obj.rows[e[o]];if(obj.rows=t,obj.updateTableReferences(),obj.results&&obj.results.length)obj.searchInput.value?obj.search(obj.searchInput.value):obj.closeFilter();else if(obj.results=null,obj.pageNumber=0,obj.options.pagination>0)obj.page(0);else if(1==obj.options.lazyLoading)obj.loadPage(0);else for(o=0;o<obj.rows.length;o++)obj.tbody.appendChild(obj.rows[o])},obj.moveRow=function(e,t,o){if(Object.keys(obj.options.mergeCells).length>0){if(e>t)var n=1;else n=0;if(obj.isRowMerged(e).length||obj.isRowMerged(t,n).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}}if(1==obj.options.search){if(obj.results&&obj.results.length!=obj.rows.length){if(!confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure))return!1;obj.resetSearch()}obj.results=null}o||(Array.prototype.indexOf.call(obj.tbody.children,obj.rows[t])>=0?obj.tbody.insertBefore(obj.rows[e],e>t?obj.rows[t]:obj.rows[t].nextSibling):obj.tbody.removeChild(obj.rows[e])),obj.rows.splice(t,0,obj.rows.splice(e,1)[0]),obj.records.splice(t,0,obj.records.splice(e,1)[0]),obj.options.data.splice(t,0,obj.options.data.splice(e,1)[0]),obj.options.pagination>0&&obj.tbody.children.length!=obj.options.pagination&&obj.page(obj.pageNumber),obj.setHistory({action:"moveRow",oldValue:e,newValue:t}),obj.updateTableReferences(),obj.dispatch("onmoverow",el,e,t)},obj.insertRow=function(e,t,o){if(1==obj.options.allowInsertRow){var n=[];if(e>0)var i=e;else i=1,e&&(n=e);o=!!o;var r=obj.options.data.length-1;if((null==t||t>=parseInt(r)||t<0)&&(t=r),!1===obj.dispatch("onbeforeinsertrow",el,t,i,o))return console.log("onbeforeinsertrow returned false"),!1;if(Object.keys(obj.options.mergeCells).length>0&&obj.isRowMerged(t,o).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}if(1==obj.options.search){if(obj.results&&obj.results.length!=obj.rows.length){if(!confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure))return!1;obj.resetSearch()}obj.results=null}for(var s=o?t:t+1,a=obj.records.splice(s),l=obj.options.data.splice(s),u=obj.rows.splice(s),c=[],d=[],h=[],p=s;p<i+s;p++){obj.options.data[p]=[];for(var f=0;f<obj.options.columns.length;f++)obj.options.data[p][f]=n[f]?n[f]:"";var v=obj.createRow(p,obj.options.data[p]);u[0]?Array.prototype.indexOf.call(obj.tbody.children,u[0])>=0&&obj.tbody.insertBefore(v,u[0]):Array.prototype.indexOf.call(obj.tbody.children,obj.rows[t])>=0&&obj.tbody.appendChild(v),c.push(obj.records[p]),d.push(obj.options.data[p]),h.push(v)}Array.prototype.push.apply(obj.records,a),Array.prototype.push.apply(obj.options.data,l),Array.prototype.push.apply(obj.rows,u),obj.options.pagination>0&&obj.page(obj.pageNumber),obj.setHistory({action:"insertRow",rowNumber:t,numOfRows:i,insertBefore:o,rowRecords:c,rowData:d,rowNode:h}),obj.updateTableReferences(),obj.dispatch("oninsertrow",el,t,i,c,o)}},obj.deleteRow=function(e,t){if(1==obj.options.allowDeleteRow)if(1==obj.options.allowDeletingAllRows||obj.options.data.length>1){if(null==e){var o=obj.getSelectedRows();o[0]?(e=parseInt(o[0].getAttribute("data-y")),t=o.length):(e=obj.options.data.length-1,t=1)}var n=obj.options.data.length-1;if((null==e||e>n||e<0)&&(e=n),t||(t=1),e+t>=obj.options.data.length&&(t=obj.options.data.length-e),!1===obj.dispatch("onbeforedeleterow",el,e,t))return console.log("onbeforedeleterow returned false"),!1;if(parseInt(e)>-1){var i=!1;if(Object.keys(obj.options.mergeCells).length>0)for(var r=e;r<e+t;r++)obj.isRowMerged(r,!1).length&&(i=!0);if(i){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}if(1==obj.options.search){if(obj.results&&obj.results.length!=obj.rows.length){if(!confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure))return!1;obj.resetSearch()}obj.results=null}for(0==obj.options.allowDeletingAllRows&&n+1===t&&(t--,console.error("JEXCEL. It is not possible to delete the last row")),r=e;r<e+t;r++)Array.prototype.indexOf.call(obj.tbody.children,obj.rows[r])>=0&&(obj.rows[r].className="",obj.rows[r].parentNode.removeChild(obj.rows[r]));var s=obj.records.splice(e,t),a=obj.options.data.splice(e,t),l=obj.rows.splice(e,t);obj.options.pagination>0&&obj.tbody.children.length!=obj.options.pagination&&obj.page(obj.pageNumber),obj.conditionalSelectionUpdate(1,e,e+t-1),obj.setHistory({action:"deleteRow",rowNumber:e,numOfRows:t,insertBefore:1,rowRecords:s,rowData:a,rowNode:l}),obj.updateTableReferences(),obj.dispatch("ondeleterow",el,e,t,s)}}else console.error("JEXCEL. It is not possible to delete the last row")},obj.moveColumn=function(e,t){if(Object.keys(obj.options.mergeCells).length>0){if(e>t)var o=1;else o=0;if(obj.isColMerged(e).length||obj.isColMerged(t,o).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}}if((e=parseInt(e))>(t=parseInt(t))){obj.headerContainer.insertBefore(obj.headers[e],obj.headers[t]),obj.colgroupContainer.insertBefore(obj.colgroup[e],obj.colgroup[t]);for(var n=0;n<obj.rows.length;n++)obj.rows[n].insertBefore(obj.records[n][e],obj.records[n][t])}else for(obj.headerContainer.insertBefore(obj.headers[e],obj.headers[t].nextSibling),obj.colgroupContainer.insertBefore(obj.colgroup[e],obj.colgroup[t].nextSibling),n=0;n<obj.rows.length;n++)obj.rows[n].insertBefore(obj.records[n][e],obj.records[n][t].nextSibling);for(obj.options.columns.splice(t,0,obj.options.columns.splice(e,1)[0]),obj.headers.splice(t,0,obj.headers.splice(e,1)[0]),obj.colgroup.splice(t,0,obj.colgroup.splice(e,1)[0]),n=0;n<obj.rows.length;n++)obj.options.data[n].splice(t,0,obj.options.data[n].splice(e,1)[0]),obj.records[n].splice(t,0,obj.records[n].splice(e,1)[0]);if(obj.options.footers)for(n=0;n<obj.options.footers.length;n++)obj.options.footers[n].splice(t,0,obj.options.footers[n].splice(e,1)[0]);obj.setHistory({action:"moveColumn",oldValue:e,newValue:t}),obj.updateTableReferences(),obj.dispatch("onmovecolumn",el,e,t)},obj.insertColumn=function(e,t,o,n){if(1==obj.options.allowInsertColumn){var i=[];if(e>0)var r=e;else r=1,e&&(i=e);o=!!o;var s=obj.options.columns.length-1;if((null==t||t>=parseInt(s)||t<0)&&(t=s),!1===obj.dispatch("onbeforeinsertcolumn",el,t,r,o))return console.log("onbeforeinsertcolumn returned false"),!1;if(Object.keys(obj.options.mergeCells).length>0&&obj.isColMerged(t,o).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}n||(n=[]);for(var a=0;a<r;a++)n[a]||(n[a]={type:"text",source:[],options:[],width:obj.options.defaultColWidth,align:obj.options.defaultColAlign});var l=o?t:t+1;obj.options.columns=jexcel.injectArray(obj.options.columns,l,n);for(var u=obj.headers.splice(l),c=obj.colgroup.splice(l),d=[],h=[],p=[],f=[],v=[],g=l;g<r+l;g++)obj.createCellHeader(g),obj.headerContainer.insertBefore(obj.headers[g],obj.headerContainer.children[g+1]),obj.colgroupContainer.insertBefore(obj.colgroup[g],obj.colgroupContainer.children[g+1]),d.push(obj.headers[g]),h.push(obj.colgroup[g]);if(obj.options.footers)for(var b=0;b<obj.options.footers.length;b++){for(v[b]=[],a=0;a<r;a++)v[b].push("");obj.options.footers[b].splice(l,0,v[b])}for(var m=0;m<obj.options.data.length;m++){var y=obj.options.data[m].splice(l),j=obj.records[m].splice(l);for(f[m]=[],p[m]=[],g=l;g<r+l;g++){var w=i[m]?i[m]:"";obj.options.data[m][g]=w;var x=obj.createCell(g,m,obj.options.data[m][g]);obj.records[m][g]=x,obj.rows[m]&&obj.rows[m].insertBefore(x,obj.rows[m].children[g+1]),f[m].push(w),p[m].push(x)}Array.prototype.push.apply(obj.options.data[m],y),Array.prototype.push.apply(obj.records[m],j)}if(Array.prototype.push.apply(obj.headers,u),Array.prototype.push.apply(obj.colgroup,c),obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(b=0;b<obj.options.nestedHeaders.length;b++){var C=parseInt(obj.options.nestedHeaders[b][obj.options.nestedHeaders[b].length-1].colspan)+r;obj.options.nestedHeaders[b][obj.options.nestedHeaders[b].length-1].colspan=C,obj.thead.children[b].children[obj.thead.children[b].children.length-1].setAttribute("colspan",C)}else C=parseInt(obj.options.nestedHeaders[0].colspan)+r,obj.options.nestedHeaders[0].colspan=C,obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute("colspan",C);obj.setHistory({action:"insertColumn",columnNumber:t,numOfColumns:r,insertBefore:o,columns:n,headers:d,colgroup:h,records:p,footers:v,data:f}),obj.updateTableReferences(),obj.dispatch("oninsertcolumn",el,t,r,p,o)}},obj.deleteColumn=function(e,t){if(1==obj.options.allowDeleteColumn)if(obj.headers.length>1){if(null==e){var o=obj.getSelectedColumns(!0);o.length?(e=parseInt(o[0]),t=parseInt(o.length)):(e=obj.headers.length-1,t=1)}var n=obj.options.data[0].length-1;if((null==e||e>n||e<0)&&(e=n),t||(t=1),t>obj.options.data[0].length-e&&(t=obj.options.data[0].length-e),!1===obj.dispatch("onbeforedeletecolumn",el,e,t))return console.log("onbeforedeletecolumn returned false"),!1;if(parseInt(e)>-1){var i=!1;if(Object.keys(obj.options.mergeCells).length>0)for(var r=e;r<e+t;r++)obj.isColMerged(r,!1).length&&(i=!0);if(i){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}var s=obj.options.columns.splice(e,t);for(r=e;r<e+t;r++)obj.colgroup[r].className="",obj.headers[r].className="",obj.colgroup[r].parentNode.removeChild(obj.colgroup[r]),obj.headers[r].parentNode.removeChild(obj.headers[r]);for(var a=obj.headers.splice(e,t),l=obj.colgroup.splice(e,t),u=[],c=[],d=[],h=0;h<obj.options.data.length;h++)for(r=e;r<e+t;r++)obj.records[h][r].className="",obj.records[h][r].parentNode.removeChild(obj.records[h][r]);for(h=0;h<obj.options.data.length;h++)c[h]=obj.options.data[h].splice(e,t),u[h]=obj.records[h].splice(e,t);if(obj.options.footers)for(h=0;h<obj.options.footers.length;h++)d[h]=obj.options.footers[h].splice(e,t);if(obj.conditionalSelectionUpdate(0,e,e+t-1),obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(var p=0;p<obj.options.nestedHeaders.length;p++){var f=parseInt(obj.options.nestedHeaders[p][obj.options.nestedHeaders[p].length-1].colspan)-t;obj.options.nestedHeaders[p][obj.options.nestedHeaders[p].length-1].colspan=f,obj.thead.children[p].children[obj.thead.children[p].children.length-1].setAttribute("colspan",f)}else f=parseInt(obj.options.nestedHeaders[0].colspan)-t,obj.options.nestedHeaders[0].colspan=f,obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute("colspan",f);obj.setHistory({action:"deleteColumn",columnNumber:e,numOfColumns:t,insertBefore:1,columns:s,headers:a,colgroup:l,records:u,footers:d,data:c}),obj.updateTableReferences(),obj.dispatch("ondeletecolumn",el,e,t,u)}}else console.error("JEXCEL. It is not possible to delete the last column")},obj.getSelectedRows=function(e){for(var t=[],o=0;o<obj.rows.length;o++)obj.rows[o].classList.contains("selected")&&t.push(e?o:obj.rows[o]);return t},obj.getSelectedColumns=function(){for(var e=[],t=0;t<obj.headers.length;t++)obj.headers[t].classList.contains("selected")&&e.push(t);return e},obj.getHighlighted=function(){return obj.highlighted},obj.updateTableReferences=function(){for(var e=0;e<obj.headers.length;e++)(r=obj.headers[e].getAttribute("data-x"))!=e&&(obj.headers[e].setAttribute("data-x",e),obj.headers[e].getAttribute("title")||(obj.headers[e].innerHTML=jexcel.getColumnName(e)));for(var t=0;t<obj.rows.length;t++)obj.rows[t]&&(s=obj.rows[t].getAttribute("data-y"))!=t&&(obj.rows[t].setAttribute("data-y",t),obj.rows[t].children[0].setAttribute("data-y",t),obj.rows[t].children[0].innerHTML=t+1);var o=[],n=[],i=function(e,t,n,i){if(e!=n&&obj.records[i][n].setAttribute("data-x",n),t!=i&&obj.records[i][n].setAttribute("data-y",i),e!=n||t!=i){var r=jexcel.getColumnNameFromId([e,t]),s=jexcel.getColumnNameFromId([n,i]);o[r]=s}};for(t=0;t<obj.records.length;t++)for(e=0;e<obj.records[0].length;e++)if(obj.records[t][e]){var r=obj.records[t][e].getAttribute("data-x"),s=obj.records[t][e].getAttribute("data-y");if(obj.records[t][e].getAttribute("data-merged")){var a=jexcel.getColumnNameFromId([r,s]),l=jexcel.getColumnNameFromId([e,t]);if(null==n[a])if(a==l)n[a]=!1;else{var u=parseInt(e-r),c=parseInt(t-s);n[a]=[l,u,c]}}else i(r,s,e,t)}var d=Object.keys(n);if(d.length)for(e=0;e<d.length;e++)if(n[d[e]]){var h=jexcel.getIdFromColumnName(d[e],!0);for(i(r=h[0],s=h[1],r+n[d[e]][1],s+n[d[e]][2]),a=d[e],l=n[d[e]][0],t=0;t<obj.options.mergeCells[a][2].length;t++)r=parseInt(obj.options.mergeCells[a][2][t].getAttribute("data-x")),s=parseInt(obj.options.mergeCells[a][2][t].getAttribute("data-y")),obj.options.mergeCells[a][2][t].setAttribute("data-x",r+n[d[e]][1]),obj.options.mergeCells[a][2][t].setAttribute("data-y",s+n[d[e]][2]);obj.options.mergeCells[l]=obj.options.mergeCells[a],delete obj.options.mergeCells[a]}obj.updateFormulas(o),obj.updateMeta(o),obj.refreshSelection(),obj.updateTable()},obj.updateTable=function(){if(obj.options.minSpareRows>0){for(var e=0,t=obj.rows.length-1;t>=0;t--){for(var o=!1,n=0;n<obj.headers.length;n++)obj.options.data[t][n]&&(o=!0);if(o)break;e++}obj.options.minSpareRows-e>0&&obj.insertRow(obj.options.minSpareRows-e)}if(obj.options.minSpareCols>0){var i=0;for(n=obj.headers.length-1;n>=0;n--){for(o=!1,t=0;t<obj.rows.length;t++)obj.options.data[t][n]&&(o=!0);if(o)break;i++}obj.options.minSpareCols-i>0&&obj.insertColumn(obj.options.minSpareCols-i)}if("function"==typeof obj.options.updateTable){for(obj.options.detachForUpdates&&el.removeChild(obj.content),t=0;t<obj.rows.length;t++)for(n=0;n<obj.headers.length;n++)obj.options.updateTable(el,obj.records[t][n],n,t,obj.options.data[t][n],obj.records[t][n].innerText,jexcel.getColumnNameFromId([n,t]));obj.options.detachForUpdates&&el.insertBefore(obj.content,obj.pagination)}obj.options.footers&&obj.setFooter(),setTimeout(function(){obj.updateCornerPosition()},0)},obj.isReadOnly=function(e){if(e=obj.getCell(e))return!!e.classList.contains("readonly")},obj.setReadOnly=function(e,t){(e=obj.getCell(e))&&(t?e.classList.add("readonly"):e.classList.remove("readonly"))},obj.showRow=function(e){obj.rows[e].style.display=""},obj.hideRow=function(e){obj.rows[e].style.display="none"},obj.showColumn=function(e){obj.headers[e].style.display="",obj.colgroup[e].style.display="";for(var t=0;t<obj.options.data.length;t++)obj.records[t][e].style.display=""},obj.hideColumn=function(e){obj.headers[e].style.display="none",obj.colgroup[e].style.display="none";for(var t=0;t<obj.options.data.length;t++)obj.records[t][e].style.display="none"},obj.showIndex=function(){obj.table.classList.remove("jexcel_hidden_index")},obj.hideIndex=function(){obj.table.classList.add("jexcel_hidden_index")};var chainLoopProtection=[];obj.updateFormulaChain=function(e,t,o){var n=jexcel.getColumnNameFromId([e,t]);if(obj.formula[n]&&obj.formula[n].length>0)if(chainLoopProtection[n])obj.records[t][e].innerHTML="#ERROR",obj.formula[n]="";else{chainLoopProtection[n]=!0;for(var i=0;i<obj.formula[n].length;i++){var r=jexcel.getIdFromColumnName(obj.formula[n][i],!0),s=""+obj.options.data[r[1]][r[0]];"="==s.substr(0,1)?o.push(obj.updateCell(r[0],r[1],s,!0)):Object.keys(obj.formula)[i]=null,obj.updateFormulaChain(r[0],r[1],o)}}chainLoopProtection=[]},obj.updateFormulas=function(e){for(var t=0;t<obj.options.data.length;t++)for(var o=0;o<obj.options.data[0].length;o++)if("="==(a=""+obj.options.data[t][o]).substr(0,1)){var n=obj.updateFormula(a,e);n!=a&&(obj.options.data[t][o]=n)}var i=[],r=Object.keys(obj.formula);for(t=0;t<r.length;t++){var s=r[t],a=obj.formula[s];for(e[s]&&(s=e[s]),i[s]=[],o=0;o<a.length;o++){var l=a[o];e[l]&&(l=e[l]),i[s].push(l)}}obj.formula=i},obj.updateFormula=function(e,t){for(var o=/[A-Z]/,n=/[0-9]/,i="",r=null,s=null,a="",l=0;l<e.length;l++)o.exec(e[l])?(r=1,s=0,a+=e[l]):n.exec(e[l])?(s=r?1:0,a+=e[l]):(r&&s&&(a=t[a]?t[a]:a),i+=a,i+=e[l],r=0,s=0,a="");return a&&(r&&s&&(a=t[a]?t[a]:a),i+=a),i};var secureFormula=function(e){for(var t="",o=0,n=0;n<e.length;n++)'"'==e[n]&&(o=0==o?1:0),t+=1==o?e[n]:e[n].toUpperCase();return t};obj.executeFormula=function(expression,x,y){var formulaResults=[],formulaLoopProtection=[],execute=function(expression,x,y){var parentId=jexcel.getColumnNameFromId([x,y]);if(formulaLoopProtection[parentId])return console.error("Reference loop detected"),"#ERROR";formulaLoopProtection[parentId]=!0;var tokensUpdate=function(e){for(var t=0;t<e.length;t++){var o=[],n=e[t].split(":"),i=jexcel.getIdFromColumnName(n[0],!0),r=jexcel.getIdFromColumnName(n[1],!0);if(i[0]<=r[0])var s=i[0],a=r[0];else s=r[0],a=i[0];if(i[1]<=r[1])var l=i[1],u=r[1];else l=r[1],u=i[1];for(var c=l;c<=u;c++)for(var d=s;d<=a;d++)o.push(jexcel.getColumnNameFromId([d,c]));expression=expression.replace(e[t],o.join(","))}};expression=expression.replace(/\$?([A-Z]+)\$?([0-9]+)/g,"$1$2");var tokens=expression.match(/([A-Z]+[0-9]+)\:([A-Z]+[0-9]+)/g);tokens&&tokens.length&&tokensUpdate(tokens);var evalstring="",tokens=expression.match(/([A-Z]+[0-9]+)/g);if(tokens&&tokens.indexOf(parentId)>-1)return console.error("Self Reference detected"),"#ERROR";if(tokens)for(var i=0;i<tokens.length;i++)if(obj.formula[tokens[i]]||(obj.formula[tokens[i]]=[]),obj.formula[tokens[i]].indexOf(parentId)<0&&obj.formula[tokens[i]].push(parentId),eval("typeof("+tokens[i]+') == "undefined"')){var position=jexcel.getIdFromColumnName(tokens[i],1);if(void 0!==obj.options.data[position[1]]&&void 0!==obj.options.data[position[1]][position[0]])var value=obj.options.data[position[1]][position[0]];else var value="";if("="==(""+value).substr(0,1)&&(formulaResults[tokens[i]]?value=formulaResults[tokens[i]]:(value=execute(value,position[0],position[1]),formulaResults[tokens[i]]=value)),""==(""+value).trim())evalstring+="var "+tokens[i]+" = null;";else if(value==Number(value)&&1==obj.options.autoCasting)evalstring+="var "+tokens[i]+" = "+Number(value)+";";else{var number=obj.parseNumber(value,position[0]);evalstring+=1==obj.options.autoCasting&&number?"var "+tokens[i]+" = "+number+";":"var "+tokens[i]+" = '"+value+"';"}}try{evalstring+="function COLUMN() { return parseInt(x) + 1; }; function ROW() { return parseInt(y) + 1; }; function CELL() { return parentId; }; function TABLE() { return obj; }; function VALUE(col, row) { return obj.records[row-1][col-1].innerHTML; }; function THISROWCELL(col) { var id = jexcel.getIdFromColumnName(col+(parseInt(y)+1), true); return obj.records[id[1]][id[0]].innerHTML; }";var res=eval(evalstring+expression.substr(1))}catch(e){var res="#ERROR"}return res};return execute(expression,x,y)},obj.parseNumber=function(e,t){var o=""+e;return(o=o.split(t&&obj.options.columns[t].decimal?obj.options.columns[t].decimal:"."))[0]=o[0].match(/[+-]?[0-9]/g),o[0]&&(o[0]=o[0].join("")),o[1]&&(o[1]=o[1].match(/[0-9]*/g).join("")),e=o[0]&&Number(o[0])>=0?Number(o[1]?o[0]+"."+o[1]:o[0]+".00"):null},obj.row=function(e){},obj.col=function(e){},obj.up=function(e,t){if(e?obj.selectedCell[3]>0&&obj.up.visible(1,t?0:1):(obj.selectedCell[1]>0&&obj.up.visible(0,t?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),1==obj.options.lazyLoading)if(0==obj.selectedCell[1]||0==obj.selectedCell[3])obj.loadPage(0),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]);else if(obj.loadValidation())obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]);else{var o=parseInt(obj.tbody.firstChild.getAttribute("data-y"));obj.selectedCell[1]-o<30&&(obj.loadUp(),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]))}else if(obj.options.pagination>0){var n=obj.whichPage(obj.selectedCell[3]);n!=obj.pageNumber&&obj.page(n)}obj.updateScroll(1)},obj.up.visible=function(e,t){if(0==e)var o=parseInt(obj.selectedCell[0]),n=parseInt(obj.selectedCell[1]);else o=parseInt(obj.selectedCell[2]),n=parseInt(obj.selectedCell[3]);if(0==t){for(var i=0;i<n;i++)if("none"!=obj.records[i][o].style.display&&"none"!=obj.rows[i].style.display){n=i;break}}else n=obj.up.get(o,n);0==e?(obj.selectedCell[0]=o,obj.selectedCell[1]=n):(obj.selectedCell[2]=o,obj.selectedCell[3]=n)},obj.up.get=function(e,t){e=parseInt(e);for(var o=(t=parseInt(t))-1;o>=0;o--)if("none"!=obj.records[o][e].style.display&&"none"!=obj.rows[o].style.display){if(obj.records[o][e].getAttribute("data-merged")&&obj.records[o][e]==obj.records[t][e])continue;t=o;break}return t},obj.down=function(e,t){if(e?obj.selectedCell[3]<obj.records.length-1&&obj.down.visible(1,t?0:1):(obj.selectedCell[1]<obj.records.length-1&&obj.down.visible(0,t?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),1==obj.options.lazyLoading)obj.selectedCell[1]==obj.records.length-1||obj.selectedCell[3]==obj.records.length-1?(obj.loadPage(-1),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])):obj.loadValidation()?obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]):parseInt(obj.tbody.lastChild.getAttribute("data-y"))-obj.selectedCell[3]<30&&(obj.loadDown(),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]));else if(obj.options.pagination>0){var o=obj.whichPage(obj.selectedCell[3]);o!=obj.pageNumber&&obj.page(o)}obj.updateScroll(3)},obj.down.visible=function(e,t){if(0==e)var o=parseInt(obj.selectedCell[0]),n=parseInt(obj.selectedCell[1]);else o=parseInt(obj.selectedCell[2]),n=parseInt(obj.selectedCell[3]);if(0==t){for(var i=obj.rows.length-1;i>n;i--)if("none"!=obj.records[i][o].style.display&&"none"!=obj.rows[i].style.display){n=i;break}}else n=obj.down.get(o,n);0==e?(obj.selectedCell[0]=o,obj.selectedCell[1]=n):(obj.selectedCell[2]=o,obj.selectedCell[3]=n)},obj.down.get=function(e,t){e=parseInt(e);for(var o=(t=parseInt(t))+1;o<obj.rows.length;o++)if("none"!=obj.records[o][e].style.display&&"none"!=obj.rows[o].style.display){if(obj.records[o][e].getAttribute("data-merged")&&obj.records[o][e]==obj.records[t][e])continue;t=o;break}return t},obj.right=function(e,t){e?obj.selectedCell[2]<obj.headers.length-1&&obj.right.visible(1,t?0:1):(obj.selectedCell[0]<obj.headers.length-1&&obj.right.visible(0,t?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(2)},obj.right.visible=function(e,t){if(0==e)var o=parseInt(obj.selectedCell[0]),n=parseInt(obj.selectedCell[1]);else o=parseInt(obj.selectedCell[2]),n=parseInt(obj.selectedCell[3]);if(0==t){for(var i=obj.headers.length-1;i>o;i--)if("none"!=obj.records[n][i].style.display){o=i;break}}else o=obj.right.get(o,n);0==e?(obj.selectedCell[0]=o,obj.selectedCell[1]=n):(obj.selectedCell[2]=o,obj.selectedCell[3]=n)},obj.right.get=function(e,t){e=parseInt(e),t=parseInt(t);for(var o=e+1;o<obj.headers.length;o++)if("none"!=obj.records[t][o].style.display){if(obj.records[t][o].getAttribute("data-merged")&&obj.records[t][o]==obj.records[t][e])continue;e=o;break}return e},obj.left=function(e,t){e?obj.selectedCell[2]>0&&obj.left.visible(1,t?0:1):(obj.selectedCell[0]>0&&obj.left.visible(0,t?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(0)},obj.left.visible=function(e,t){if(0==e)var o=parseInt(obj.selectedCell[0]),n=parseInt(obj.selectedCell[1]);else o=parseInt(obj.selectedCell[2]),n=parseInt(obj.selectedCell[3]);if(0==t){for(var i=0;i<o;i++)if("none"!=obj.records[n][i].style.display){o=i;break}}else o=obj.left.get(o,n);0==e?(obj.selectedCell[0]=o,obj.selectedCell[1]=n):(obj.selectedCell[2]=o,obj.selectedCell[3]=n)},obj.left.get=function(e,t){e=parseInt(e),t=parseInt(t);for(var o=e-1;o>=0;o--)if("none"!=obj.records[t][o].style.display){if(obj.records[t][o].getAttribute("data-merged")&&obj.records[t][o]==obj.records[t][e])continue;e=o;break}return e},obj.first=function(e,t){if(e?t?obj.selectedCell[3]=0:obj.left.visible(1,0):(t?obj.selectedCell[1]=0:obj.left.visible(0,0),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),1!=obj.options.lazyLoading||0!=obj.selectedCell[1]&&0!=obj.selectedCell[3]){if(obj.options.pagination>0){var o=obj.whichPage(obj.selectedCell[3]);o!=obj.pageNumber&&obj.page(o)}}else obj.loadPage(0);obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(1)},obj.last=function(e,t){if(e?t?obj.selectedCell[3]=obj.records.length-1:obj.right.visible(1,0):(t?obj.selectedCell[1]=obj.records.length-1:obj.right.visible(0,0),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),1!=obj.options.lazyLoading||obj.selectedCell[1]!=obj.records.length-1&&obj.selectedCell[3]!=obj.records.length-1){if(obj.options.pagination>0){var o=obj.whichPage(obj.selectedCell[3]);o!=obj.pageNumber&&obj.page(o)}}else obj.loadPage(-1);obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(3)},obj.selectAll=function(){obj.selectedCell||(obj.selectedCell=[]),obj.selectedCell[0]=0,obj.selectedCell[1]=0,obj.selectedCell[2]=obj.headers.length-1,obj.selectedCell[3]=obj.records.length-1,obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])},obj.loadPage=function(e){if(1==obj.options.search&&obj.results)var t=obj.results;else t=obj.rows;var o=100;null!=e&&-1!=e||(e=Math.ceil(t.length/o)-1);var n=e*o,i=e*o+o;i>t.length&&(i=t.length),(n=i-100)<0&&(n=0);for(var r=n;r<i;r++)obj.tbody.appendChild(1==obj.options.search&&obj.results?obj.rows[t[r]]:obj.rows[r]),obj.tbody.children.length>o&&obj.tbody.removeChild(obj.tbody.firstChild)},obj.loadUp=function(){if(1==obj.options.search&&obj.results)var e=obj.results;else e=obj.rows;var t=0;if(e.length>100){var o=parseInt(obj.tbody.firstChild.getAttribute("data-y"));if(1==obj.options.search&&obj.results&&(o=e.indexOf(o)),o>0)for(var n=0;n<30;n++)(o-=1)>-1&&(obj.tbody.insertBefore(1==obj.options.search&&obj.results?obj.rows[e[o]]:obj.rows[o],obj.tbody.firstChild),obj.tbody.children.length>100&&(obj.tbody.removeChild(obj.tbody.lastChild),t=1))}return t},obj.loadDown=function(){if(1==obj.options.search&&obj.results)var e=obj.results;else e=obj.rows;var t=0;if(e.length>100){var o=parseInt(obj.tbody.lastChild.getAttribute("data-y"));if(1==obj.options.search&&obj.results&&(o=e.indexOf(o)),o<obj.rows.length-1)for(var n=0;n<=30;n++)o<e.length&&(obj.tbody.appendChild(1==obj.options.search&&obj.results?obj.rows[e[o]]:obj.rows[o]),obj.tbody.children.length>100&&(obj.tbody.removeChild(obj.tbody.firstChild),t=1)),o+=1}return t},obj.loadValidation=function(){if(obj.selectedCell){var e=parseInt(obj.tbody.firstChild.getAttribute("data-y"))/100,t=parseInt(obj.selectedCell[3]/100),o=parseInt(obj.rows.length/100);if(e!=t&&t<=o&&!Array.prototype.indexOf.call(obj.tbody.children,obj.rows[obj.selectedCell[3]]))return obj.loadPage(t),!0}return!1},obj.resetSearch=function(){obj.searchInput.value="",obj.search(""),obj.results=null},obj.search=function(e){if(e&&(e=e.toLowerCase()),obj.options.filters&&obj.resetFilters(),obj.resetSelection(),obj.pageNumber=0,obj.results=[],e){var t=function(e){-1==obj.results.indexOf(e)&&obj.results.push(e)};obj.options.data.filter(function(o,n){if(function(e,t,o){for(var n=0;n<e.length;n++)if((""+e[n]).toLowerCase().search(t)>=0||(""+obj.records[o][n].innerHTML).toLowerCase().search(t)>=0)return!0;return!1}(o,e,n)){var i=obj.isRowMerged(n);if(i.length)for(var r=0;r<i.length;r++)for(var s=jexcel.getIdFromColumnName(i[r],!0),a=0;a<obj.options.mergeCells[i[r]][1];a++)t(s[1]+a);else t(n);return!0}return!1})}else obj.results=null;return obj.updateResult()},obj.updateResult=function(){var e,t=0;for(e=1==obj.options.lazyLoading?100:obj.options.pagination>0?obj.options.pagination:obj.results?obj.results.length:obj.rows.length;obj.tbody.firstChild;)obj.tbody.removeChild(obj.tbody.firstChild);for(var o=0;o<obj.rows.length;o++)!obj.results||obj.results.indexOf(o)>-1?(t<e&&(obj.tbody.appendChild(obj.rows[o]),t++),obj.rows[o].style.display=""):obj.rows[o].style.display="none";return obj.options.pagination>0&&obj.updatePagination(),obj.updateCornerPosition(),e},obj.whichPage=function(e){return 1==obj.options.search&&obj.results&&(e=obj.results.indexOf(e)),Math.ceil((parseInt(e)+1)/parseInt(obj.options.pagination))-1},obj.page=function(e){var t=obj.pageNumber;if(1==obj.options.search&&obj.results)var o=obj.results;else o=obj.rows;var n=parseInt(obj.options.pagination);null!=e&&-1!=e||(e=Math.ceil(o.length/n)-1),obj.pageNumber=e;var i=e*n,r=e*n+n;for(r>o.length&&(r=o.length),i<0&&(i=0);obj.tbody.firstChild;)obj.tbody.removeChild(obj.tbody.firstChild);for(var s=i;s<r;s++)obj.tbody.appendChild(1==obj.options.search&&obj.results?obj.rows[o[s]]:obj.rows[s]);obj.options.pagination>0&&obj.updatePagination(),obj.updateCornerPosition(),obj.dispatch("onchangepage",el,e,t)},obj.updatePagination=function(){if(obj.pagination.children[0].innerHTML="",obj.pagination.children[1].innerHTML="",obj.options.pagination){if(1==obj.options.search&&obj.results)var e=obj.results.length;else e=obj.rows.length;if(e){var t=Math.ceil(e/obj.options.pagination);if(obj.pageNumber<6)var o=1,n=t<10?t:10;else t-obj.pageNumber<5?(n=t,(o=t-9)<1&&(o=1)):(o=obj.pageNumber-4,n=obj.pageNumber+5);o>1&&((r=document.createElement("div")).className="jexcel_page",r.innerHTML="<",r.title=1,obj.pagination.children[1].appendChild(r));for(var i=o;i<=n;i++){var r;(r=document.createElement("div")).className="jexcel_page",r.innerHTML=i,obj.pagination.children[1].appendChild(r),obj.pageNumber==i-1&&r.classList.add("jexcel_page_selected")}n<t&&((r=document.createElement("div")).className="jexcel_page",r.innerHTML=">",r.title=t,obj.pagination.children[1].appendChild(r)),obj.pagination.children[0].innerHTML=function(e){var t=Array.prototype.slice.call(arguments,1);return e.replace(/{(\d+)}/g,function(e,o){return void 0!==t[o]?t[o]:e})}(obj.options.text.showingPage,obj.pageNumber+1,t)}else obj.pagination.children[0].innerHTML=obj.options.text.noRecordsFound}},obj.download=function(e){if(0==obj.options.allowExport)console.error("Export not allowed");else{var t="";1!=e&&1!=obj.options.includeHeadersOnDownload||(t+=obj.getHeaders().replace(/\s+/gm," "),t+="\r\n"),t+=obj.copy(!1,obj.options.csvDelimiter,!0);var o=new Blob(["\ufeff"+t],{type:"text/csv;charset=utf-8;"});if(window.navigator&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(o,obj.options.csvFileName+".csv");else{var n=document.createElement("a"),i=URL.createObjectURL(o);n.href=i,n.setAttribute("download",obj.options.csvFileName+".csv"),document.body.appendChild(n),n.click(),n.parentNode.removeChild(n)}}},obj.setHistory=function(e){if(1!=obj.ignoreHistory){var t=++obj.historyIndex;obj.history=obj.history=obj.history.slice(0,t+1),obj.history[t]=e}},obj.copy=function(e,t,o){t||(t="\t");var n=[],i=[],r=[],s=[],a=[],l=obj.options.data[0].length,u=obj.options.data.length,c="",d=obj.options.includeHeadersOnCopy;obj.style=[];for(var h=0;h<u;h++){i=[],r=[];for(var p=0;p<l;p++)if(!e||obj.records[h][p].classList.contains("highlight")){1==d&&n.push(obj.headers[p].innerText);var f=obj.options.data[h][p];if(f.match&&(f.match(/,/g)||f.match(/\n/)||f.match(/\"/))&&(f='"'+(f=f.replace(new RegExp('"',"g"),'""'))+'"'),i.push(f),"checkbox"==obj.options.columns[p].type||"radio"==obj.options.columns[p].type)var v=f;else(v=1==obj.options.stripHTMLOnCopy?obj.records[h][p].innerText:obj.records[h][p].innerHTML).match&&(v.match(/,/g)||v.match(/\n/)||v.match(/\"/))&&(v='"'+(v=v.replace(new RegExp('"',"g"),'""'))+'"');r.push(v),c=(c=obj.records[h][p].getAttribute("style")).replace("display: none;",""),obj.style.push(c||"")}i.length&&(d&&s.push(n.join(t)),s.push(i.join(t))),r.length&&(d&&a.push(n.join(t)),a.push(r.join(t))),d=!1}var g=s.join("\r\n"),b=a.join("\r\n");if(o||(obj.textarea.value=1==obj.options.copyCompatibility?b:g,obj.textarea.select(),document.execCommand("copy")),obj.data=1==obj.options.copyCompatibility?b:g,obj.hashString=obj.hash(obj.data),obj.removeCopyingSelection(),obj.highlighted)for(p=0;p<obj.highlighted.length;p++)obj.highlighted[p].classList.add("copying"),obj.highlighted[p].classList.contains("highlight-left")&&obj.highlighted[p].classList.add("copying-left"),obj.highlighted[p].classList.contains("highlight-right")&&obj.highlighted[p].classList.add("copying-right"),obj.highlighted[p].classList.contains("highlight-top")&&obj.highlighted[p].classList.add("copying-top"),obj.highlighted[p].classList.contains("highlight-bottom")&&obj.highlighted[p].classList.add("copying-bottom");return obj.dispatch("oncopy",el,1==obj.options.copyCompatibility?a:s,obj.hashString),obj.data},obj.paste=function(e,t,o){var n=obj.dispatch("onbeforepaste",el,o,e,t);if(!1===n)return!1;n&&(o=n);var i=obj.hash(o),r=i==obj.hashString?obj.style:null;if(1==obj.options.copyCompatibility&&i==obj.hashString&&(o=obj.data),o=obj.parseCSV(o,"\t"),null!=e&&null!=t&&o){for(var s=0,a=0,l=[],u={},c={},d=0,h=parseInt(e),p=parseInt(t),f=null;f=o[a];){for(s=0,h=parseInt(e);null!=f[s];){var v=obj.updateCell(h,p,f[s]);if(l.push(v),obj.updateFormulaChain(h,p,l),r&&r[d]){var g=jexcel.getColumnNameFromId([h,p]);u[g]=r[d],c[g]=obj.getStyle(g),obj.records[p][h].setAttribute("style",r[d]),d++}null!=f[++s]&&(h>=obj.headers.length-1&&obj.insertColumn(),h=obj.right.get(h,p))}o[++a]&&(p>=obj.rows.length-1&&obj.insertRow(),p=obj.down.get(e,p))}obj.updateSelectionFromCoords(e,t,h,p),obj.setHistory({action:"setValue",records:l,selection:obj.selectedCell,newStyle:u,oldStyle:c}),obj.updateTable(),obj.dispatch("onpaste",el,o),obj.onafterchanges(el,l)}obj.removeCopyingSelection()},obj.removeCopyingSelection=function(){for(var e=document.querySelectorAll(".jexcel .copying"),t=0;t<e.length;t++)e[t].classList.remove("copying"),e[t].classList.remove("copying-left"),e[t].classList.remove("copying-right"),e[t].classList.remove("copying-top"),e[t].classList.remove("copying-bottom")},obj.historyProcessRow=function(e,t){var o=t.insertBefore?t.rowNumber:t.rowNumber+1;if(1==obj.options.search&&obj.results&&obj.results.length!=obj.rows.length&&obj.resetSearch(),1==e){for(var n=t.numOfRows,i=o;i<n+o;i++)obj.rows[i].parentNode.removeChild(obj.rows[i]);obj.records.splice(o,n),obj.options.data.splice(o,n),obj.rows.splice(o,n),obj.conditionalSelectionUpdate(1,o,n+o-1)}else{obj.records=jexcel.injectArray(obj.records,o,t.rowRecords),obj.options.data=jexcel.injectArray(obj.options.data,o,t.rowData),obj.rows=jexcel.injectArray(obj.rows,o,t.rowNode);var r=0;for(i=o;i<t.numOfRows+o;i++)obj.tbody.insertBefore(t.rowNode[r],obj.tbody.children[i]),r++}obj.options.pagination>0&&obj.page(obj.pageNumber),obj.updateTableReferences()},obj.historyProcessColumn=function(e,t){var o=t.insertBefore?t.columnNumber:t.columnNumber+1;if(1==e){var n=t.numOfColumns;obj.options.columns.splice(o,n);for(var i=o;i<n+o;i++)obj.headers[i].parentNode.removeChild(obj.headers[i]),obj.colgroup[i].parentNode.removeChild(obj.colgroup[i]);obj.headers.splice(o,n),obj.colgroup.splice(o,n);for(var r=0;r<t.data.length;r++){for(i=o;i<n+o;i++)obj.records[r][i].parentNode.removeChild(obj.records[r][i]);obj.records[r].splice(o,n),obj.options.data[r].splice(o,n)}if(obj.options.footers)for(r=0;r<obj.options.footers.length;r++)obj.options.footers[r].splice(o,n)}else{obj.options.columns=jexcel.injectArray(obj.options.columns,o,t.columns),obj.headers=jexcel.injectArray(obj.headers,o,t.headers),obj.colgroup=jexcel.injectArray(obj.colgroup,o,t.colgroup);var s=0;for(i=o;i<t.numOfColumns+o;i++)obj.headerContainer.insertBefore(t.headers[s],obj.headerContainer.children[i+1]),obj.colgroupContainer.insertBefore(t.colgroup[s],obj.colgroupContainer.children[i+1]),s++;for(r=0;r<t.data.length;r++)for(obj.options.data[r]=jexcel.injectArray(obj.options.data[r],o,t.data[r]),obj.records[r]=jexcel.injectArray(obj.records[r],o,t.records[r]),s=0,i=o;i<t.numOfColumns+o;i++)obj.rows[r].insertBefore(t.records[r][s],obj.rows[r].children[i+1]),s++;if(obj.options.footers)for(r=0;r<obj.options.footers.length;r++)obj.options.footers[r]=jexcel.injectArray(obj.options.footers[r],o,t.footers[r])}if(obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(r=0;r<obj.options.nestedHeaders.length;r++){if(1==e)var a=parseInt(obj.options.nestedHeaders[r][obj.options.nestedHeaders[r].length-1].colspan)-t.numOfColumns;else a=parseInt(obj.options.nestedHeaders[r][obj.options.nestedHeaders[r].length-1].colspan)+t.numOfColumns;obj.options.nestedHeaders[r][obj.options.nestedHeaders[r].length-1].colspan=a,obj.thead.children[r].children[obj.thead.children[r].children.length-1].setAttribute("colspan",a)}else a=1==e?parseInt(obj.options.nestedHeaders[0].colspan)-t.numOfColumns:parseInt(obj.options.nestedHeaders[0].colspan)+t.numOfColumns,obj.options.nestedHeaders[0].colspan=a,obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute("colspan",a);obj.updateTableReferences()},obj.undo=function(){var e=!!obj.ignoreEvents,t=!!obj.ignoreHistory;obj.ignoreEvents=!0,obj.ignoreHistory=!0;var o=[];if(obj.historyIndex>=0){var n=obj.history[obj.historyIndex--];if("insertRow"==n.action)obj.historyProcessRow(1,n);else if("deleteRow"==n.action)obj.historyProcessRow(0,n);else if("insertColumn"==n.action)obj.historyProcessColumn(1,n);else if("deleteColumn"==n.action)obj.historyProcessColumn(0,n);else if("moveRow"==n.action)obj.moveRow(n.newValue,n.oldValue);else if("moveColumn"==n.action)obj.moveColumn(n.newValue,n.oldValue);else if("setMerge"==n.action)obj.removeMerge(n.column,n.data);else if("setStyle"==n.action)obj.setStyle(n.oldValue,null,null,1);else if("setWidth"==n.action)obj.setWidth(n.column,n.oldValue);else if("setHeight"==n.action)obj.setHeight(n.row,n.oldValue);else if("setHeader"==n.action)obj.setHeader(n.column,n.oldValue);else if("setComments"==n.action)obj.setComments(n.column,n.oldValue[0],n.oldValue[1]);else if("orderBy"==n.action){for(var i=[],r=0;r<n.rows.length;r++)i[n.rows[r]]=r;obj.updateOrderArrow(n.column,n.order?0:1),obj.updateOrder(i)}else if("setValue"==n.action){for(var s=0;s<n.records.length;s++)o.push({x:n.records[s].x,y:n.records[s].y,newValue:n.records[s].oldValue}),n.oldStyle&&obj.resetStyle(n.oldStyle);obj.setValue(o),n.selection&&obj.updateSelectionFromCoords(n.selection[0],n.selection[1],n.selection[2],n.selection[3])}}obj.ignoreEvents=e,obj.ignoreHistory=t,obj.dispatch("onundo",el,n)},obj.redo=function(){var e=!!obj.ignoreEvents,t=!!obj.ignoreHistory;if(obj.ignoreEvents=!0,obj.ignoreHistory=!0,obj.historyIndex<obj.history.length-1){var o=obj.history[++obj.historyIndex];if("insertRow"==o.action)obj.historyProcessRow(0,o);else if("deleteRow"==o.action)obj.historyProcessRow(1,o);else if("insertColumn"==o.action)obj.historyProcessColumn(0,o);else if("deleteColumn"==o.action)obj.historyProcessColumn(1,o);else if("moveRow"==o.action)obj.moveRow(o.oldValue,o.newValue);else if("moveColumn"==o.action)obj.moveColumn(o.oldValue,o.newValue);else if("setMerge"==o.action)obj.setMerge(o.column,o.colspan,o.rowspan,1);else if("setStyle"==o.action)obj.setStyle(o.newValue,null,null,1);else if("setWidth"==o.action)obj.setWidth(o.column,o.newValue);else if("setHeight"==o.action)obj.setHeight(o.row,o.newValue);else if("setHeader"==o.action)obj.setHeader(o.column,o.newValue);else if("setComments"==o.action)obj.setComments(o.column,o.newValue[0],o.newValue[1]);else if("orderBy"==o.action)obj.updateOrderArrow(o.column,o.order),obj.updateOrder(o.rows);else if("setValue"==o.action){obj.setValue(o.records);for(var n=0;n<o.records.length;n++)o.oldStyle&&obj.resetStyle(o.newStyle);o.selection&&obj.updateSelectionFromCoords(o.selection[0],o.selection[1],o.selection[2],o.selection[3])}}obj.ignoreEvents=e,obj.ignoreHistory=t,obj.dispatch("onredo",el,o)},obj.getDropDownValue=function(e,t){var o=[];if(obj.options.columns[e]&&obj.options.columns[e].source){for(var n=[],i=obj.options.columns[e].source,r=0;r<i.length;r++)"object"==typeof i[r]?n[i[r].id]=i[r].name:n[i[r]]=i[r];var s=Array.isArray(t)?t:(""+t).split(";");for(r=0;r<s.length;r++)"object"==typeof s[r]?o.push(n[s[r].id]):n[s[r]]&&o.push(n[s[r]])}else console.error("Invalid column");return o.length>0?o.join("; "):""},obj.parseCSV=function(e,t){9==(e=e.replace(/\r?\n$|\r$|\n$/g,"")).charCodeAt(e.length-1)&&(e+="\0"),t=t||",";for(var o=[],n=!1,i=0,r=0,s=0;s<e.length;s++){var a=e[s],l=e[s+1];o[i]=o[i]||[],o[i][r]=o[i][r]||"",'"'==a&&n&&'"'==l?(o[i][r]+=a,++s):'"'!=a?a!=t||n?"\r"!=a||"\n"!=l||n?"\n"==a&&!n||"\r"==a&&!n?(++i,r=0):o[i][r]+=a:(++i,r=0,++s):++r:n=!n}return o},obj.hash=function(e){var t,o=0;if(0===e.length)return o;for(t=0;t<e.length;t++)o=(o<<5)-o+e.charCodeAt(t),o|=0;return o},obj.onafterchanges=function(e,t){obj.dispatch("onafterchanges",e,t)},obj.destroy=function(){jexcel.destroy(el)},obj.init=function(){jexcel.current=obj,"function"==typeof jexcel.build&&(obj.options.root?jexcel.build(obj.options.root):(jexcel.build(document),jexcel.build=null)),el.setAttribute("tabindex",1),el.addEventListener("focus",function(e){jexcel.current&&!obj.selectedCell&&(obj.updateSelectionFromCoords(0,0,0,0),obj.left())}),obj.options.csv?(1==obj.options.loadingSpin&&jSuites.loading.show(),jSuites.ajax({url:obj.options.csv,method:obj.options.method,data:obj.options.requestVariables,dataType:"text",success:function(e){var t=obj.parseCSV(e,obj.options.csvDelimiter);if(1==obj.options.csvHeaders&&t.length>0)for(var o=t.shift(),n=0;n<o.length;n++)obj.options.columns[n]||(obj.options.columns[n]={type:"text",align:obj.options.defaultColAlign,width:obj.options.defaultColWidth}),void 0===obj.options.columns[n].title&&(obj.options.columns[n].title=o[n]);obj.options.data=t,obj.prepareTable(),1==obj.options.loadingSpin&&jSuites.loading.hide()}})):obj.options.url?(1==obj.options.loadingSpin&&jSuites.loading.show(),jSuites.ajax({url:obj.options.url,method:obj.options.method,data:obj.options.requestVariables,dataType:"json",success:function(e){obj.options.data=e.data?e.data:e,obj.prepareTable(),1==obj.options.loadingSpin&&jSuites.loading.hide()}})):obj.prepareTable()},obj.options.contextMenu=options&&null!=options.contextMenu?options.contextMenu:function(e,t,o,n){var i=[];if(null==o)1==obj.options.allowInsertColumn&&i.push({title:obj.options.text.insertANewColumnBefore,onclick:function(){obj.insertColumn(1,parseInt(t),1)}}),1==obj.options.allowInsertColumn&&i.push({title:obj.options.text.insertANewColumnAfter,onclick:function(){obj.insertColumn(1,parseInt(t),0)}}),1==obj.options.allowDeleteColumn&&i.push({title:obj.options.text.deleteSelectedColumns,onclick:function(){obj.deleteColumn(obj.getSelectedColumns().length?void 0:parseInt(t))}}),1==obj.options.allowRenameColumn&&i.push({title:obj.options.text.renameThisColumn,onclick:function(){obj.setHeader(t)}}),1==obj.options.columnSorting&&(i.push({type:"line"}),i.push({title:obj.options.text.orderAscending,onclick:function(){obj.orderBy(t,0)}}),i.push({title:obj.options.text.orderDescending,onclick:function(){obj.orderBy(t,1)}}));else if(1==obj.options.allowInsertRow&&(i.push({title:obj.options.text.insertANewRowBefore,onclick:function(){obj.insertRow(1,parseInt(o),1)}}),i.push({title:obj.options.text.insertANewRowAfter,onclick:function(){obj.insertRow(1,parseInt(o))}})),1==obj.options.allowDeleteRow&&i.push({title:obj.options.text.deleteSelectedRows,onclick:function(){obj.deleteRow(obj.getSelectedRows().length?void 0:parseInt(o))}}),t&&1==obj.options.allowComments){i.push({type:"line"});var r=obj.records[o][t].getAttribute("title")||"";i.push({title:r?obj.options.text.editComments:obj.options.text.addComments,onclick:function(){var e=prompt(obj.options.text.comments,r);e&&obj.setComments([t,o],e)}}),r&&i.push({title:obj.options.text.clearComments,onclick:function(){obj.setComments([t,o],"")}})}return i.push({type:"line"}),i.push({title:obj.options.text.copy,shortcut:"Ctrl + C",onclick:function(){obj.copy(!0)}}),navigator&&navigator.clipboard&&i.push({title:obj.options.text.paste,shortcut:"Ctrl + V",onclick:function(){obj.selectedCell&&navigator.clipboard.readText().then(function(e){e&&jexcel.current.paste(obj.selectedCell[0],obj.selectedCell[1],e)})}}),obj.options.allowExport&&i.push({title:obj.options.text.saveAs,shortcut:"Ctrl + S",onclick:function(){obj.download()}}),obj.options.about&&i.push({title:obj.options.text.about,onclick:function(){alert(obj.options.about)}}),i},obj.scrollControls=function(e){obj.wheelControls(),obj.options.freezeColumns>0&&obj.content.scrollLeft!=scrollLeft&&obj.updateFreezePosition(),1!=obj.options.lazyLoading&&1!=obj.options.tableOverflow||obj.edition&&"jdropdown"!=e.target.className.substr(0,9)&&obj.closeEditor(obj.edition[0],!0)},obj.wheelControls=function(e){1==obj.options.lazyLoading&&null==jexcel.timeControlLoading&&(jexcel.timeControlLoading=setTimeout(function(){obj.content.scrollTop+obj.content.clientHeight>=obj.content.scrollHeight?obj.loadDown()&&(obj.content.scrollTop+obj.content.clientHeight>obj.content.scrollHeight-10&&(obj.content.scrollTop=obj.content.scrollTop-obj.content.clientHeight),obj.updateCornerPosition()):obj.content.scrollTop<=obj.content.clientHeight&&obj.loadUp()&&(obj.content.scrollTop<10&&(obj.content.scrollTop=obj.content.scrollTop+obj.content.clientHeight),obj.updateCornerPosition()),jexcel.timeControlLoading=null},100))},obj.getFreezeWidth=function(){var e=0;if(obj.options.freezeColumns>0)for(var t=0;t<obj.options.freezeColumns;t++)e+=parseInt(obj.options.columns[t].width);return e};var scrollLeft=0;return obj.updateFreezePosition=function(){var e=0;if((scrollLeft=obj.content.scrollLeft)>50)for(var t=0;t<obj.options.freezeColumns;t++){t>0&&(e+=parseInt(obj.options.columns[t-1].width)),obj.headers[t].classList.add("jexcel_freezed"),obj.headers[t].style.left=e+"px";for(var o=0;o<obj.rows.length;o++)if(obj.rows[o]&&obj.records[o][t]){var n=scrollLeft+(t>0?obj.records[o][t-1].style.width:0)-51+"px";obj.records[o][t].classList.add("jexcel_freezed"),obj.records[o][t].style.left=n}}else for(t=0;t<obj.options.freezeColumns;t++)for(obj.headers[t].classList.remove("jexcel_freezed"),obj.headers[t].style.left="",o=0;o<obj.rows.length;o++)obj.records[o][t]&&(obj.records[o][t].classList.remove("jexcel_freezed"),obj.records[o][t].style.left="");obj.updateCornerPosition()},el.addEventListener("DOMMouseScroll",obj.wheelControls),el.addEventListener("mousewheel",obj.wheelControls),el.jexcel=obj,obj.init(),obj};jexcel.current=null,jexcel.timeControl=null,jexcel.timeControlLoading=null,jexcel.destroy=function(e,t){if(e.jexcel){var o=e.jexcel.options.root?e.jexcel.options.root:document;e.removeEventListener("DOMMouseScroll",e.jexcel.scrollControls),e.removeEventListener("mousewheel",e.jexcel.scrollControls),e.jexcel=null,e.innerHTML="",t&&(o.removeEventListener("mouseup",jexcel.mouseUpControls),o.removeEventListener("mousedown",jexcel.mouseDownControls),o.removeEventListener("mousemove",jexcel.mouseMoveControls),o.removeEventListener("mouseover",jexcel.mouseOverControls),o.removeEventListener("dblclick",jexcel.doubleClickControls),o.removeEventListener("paste",jexcel.pasteControls),o.removeEventListener("contextmenu",jexcel.contextMenuControls),o.removeEventListener("touchstart",jexcel.touchStartControls),o.removeEventListener("touchend",jexcel.touchEndControls),o.removeEventListener("touchcancel",jexcel.touchEndControls),document.removeEventListener("keydown",jexcel.keyDownControls),jexcel=null)}},jexcel.build=function(e){e.addEventListener("mouseup",jexcel.mouseUpControls),e.addEventListener("mousedown",jexcel.mouseDownControls),e.addEventListener("mousemove",jexcel.mouseMoveControls),e.addEventListener("mouseover",jexcel.mouseOverControls),e.addEventListener("dblclick",jexcel.doubleClickControls),e.addEventListener("paste",jexcel.pasteControls),e.addEventListener("contextmenu",jexcel.contextMenuControls),e.addEventListener("touchstart",jexcel.touchStartControls),e.addEventListener("touchend",jexcel.touchEndControls),e.addEventListener("touchcancel",jexcel.touchEndControls),e.addEventListener("touchmove",jexcel.touchEndControls),document.addEventListener("keydown",jexcel.keyDownControls)},jexcel.keyDownControls=function(e){if(jexcel.current){if(jexcel.current.edition)if(27==e.which)jexcel.current.edition&&jexcel.current.closeEditor(jexcel.current.edition[0],!1),e.preventDefault();else if(13==e.which)if("calendar"==jexcel.current.options.columns[jexcel.current.edition[2]].type)jexcel.current.closeEditor(jexcel.current.edition[0],!0);else if("dropdown"==jexcel.current.options.columns[jexcel.current.edition[2]].type||"autocomplete"==jexcel.current.options.columns[jexcel.current.edition[2]].type);else if((1==jexcel.current.options.wordWrap||1==jexcel.current.options.columns[jexcel.current.edition[2]].wordWrap||jexcel.current.options.data[jexcel.current.edition[3]][jexcel.current.edition[2]].length>200)&&e.altKey){var t=jexcel.current.edition[0].children[0],o=jexcel.current.edition[0].children[0].value,n=t.selectionStart;o=o.slice(0,n)+"\n"+o.slice(n),t.value=o,t.focus(),t.selectionStart=n+1,t.selectionEnd=n+1}else jexcel.current.edition[0].children[0].blur();else 9==e.which&&("calendar"==jexcel.current.options.columns[jexcel.current.edition[2]].type?jexcel.current.closeEditor(jexcel.current.edition[0],!0):jexcel.current.edition[0].children[0].blur());if(!jexcel.current.edition&&jexcel.current.selectedCell)if(37==e.which)jexcel.current.left(e.shiftKey,e.ctrlKey),e.preventDefault();else if(39==e.which)jexcel.current.right(e.shiftKey,e.ctrlKey),e.preventDefault();else if(38==e.which)jexcel.current.up(e.shiftKey,e.ctrlKey),e.preventDefault();else if(40==e.which)jexcel.current.down(e.shiftKey,e.ctrlKey),e.preventDefault();else if(36==e.which)jexcel.current.first(e.shiftKey,e.ctrlKey),e.preventDefault();else if(35==e.which)jexcel.current.last(e.shiftKey,e.ctrlKey),e.preventDefault();else if(32==e.which)1==jexcel.current.options.editable&&jexcel.current.setCheckRadioValue(),e.preventDefault();else if(46==e.which)1==jexcel.current.options.editable&&(jexcel.current.selectedRow?1==jexcel.current.options.allowDeleteRow&&confirm(jexcel.current.options.text.areYouSureToDeleteTheSelectedRows)&&jexcel.current.deleteRow():jexcel.current.selectedHeader?1==jexcel.current.options.allowDeleteColumn&&confirm(jexcel.current.options.text.areYouSureToDeleteTheSelectedColumns)&&jexcel.current.deleteColumn():jexcel.current.setValue(jexcel.current.highlighted,""));else if(13==e.which)e.shiftKey?jexcel.current.up():(1==jexcel.current.options.allowInsertRow&&1==jexcel.current.options.allowManualInsertRow&&jexcel.current.selectedCell[1]==jexcel.current.options.data.length-1&&jexcel.current.insertRow(),jexcel.current.down()),e.preventDefault();else if(9==e.which)e.shiftKey?jexcel.current.left():(1==jexcel.current.options.allowInsertColumn&&1==jexcel.current.options.allowManualInsertColumn&&jexcel.current.selectedCell[0]==jexcel.current.options.data[0].length-1&&jexcel.current.insertColumn(),jexcel.current.right()),e.preventDefault();else if(!e.ctrlKey&&!e.metaKey||e.shiftKey){if(jexcel.current.selectedCell&&1==jexcel.current.options.editable){var i=jexcel.current.selectedCell[1],r=jexcel.current.selectedCell[0];"readonly"!=jexcel.current.options.columns[r].type&&(32==e.keyCode?"checkbox"==jexcel.current.options.columns[r].type||"radio"==jexcel.current.options.columns[r].type?e.preventDefault():jexcel.current.openEditor(jexcel.current.records[i][r],!0):113==e.keyCode?jexcel.current.openEditor(jexcel.current.records[i][r],!1):(8==e.keyCode||e.keyCode>=48&&e.keyCode<=57||e.keyCode>=96&&e.keyCode<=111||e.keyCode>=187&&e.keyCode<=190||(String.fromCharCode(e.keyCode)==e.key||String.fromCharCode(e.keyCode).toLowerCase()==e.key.toLowerCase())&&jexcel.validLetter(String.fromCharCode(e.keyCode)))&&(jexcel.current.openEditor(jexcel.current.records[i][r],!0),"calendar"==jexcel.current.options.columns[r].type&&e.preventDefault()))}}else 65==e.which?(jexcel.current.selectAll(),e.preventDefault()):83==e.which?(jexcel.current.download(),e.preventDefault()):89==e.which?(jexcel.current.redo(),e.preventDefault()):90==e.which?(jexcel.current.undo(),e.preventDefault()):67==e.which||67==e.which?(jexcel.current.copy(!0),e.preventDefault()):88==e.which?(1==jexcel.current.options.editable?jexcel.cutControls():jexcel.copyControls(),e.preventDefault()):86==e.which&&jexcel.pasteControls();else e.target.classList.contains("jexcel_search")&&(jexcel.timeControl&&clearTimeout(jexcel.timeControl),jexcel.timeControl=setTimeout(function(){jexcel.current.search(e.target.value)},200))}},jexcel.isMouseAction=!1,jexcel.mouseDownControls=function(e){if((e=e||window.event).buttons)var t=e.buttons;else t=e.button?e.button:e.which;var o=jexcel.getElement(e.target);if(o[0]?jexcel.current!=o[0].jexcel&&(jexcel.current&&(jexcel.current.edition&&jexcel.current.closeEditor(jexcel.current.edition[0],!0),jexcel.current.resetSelection()),jexcel.current=o[0].jexcel):jexcel.current&&(jexcel.current.edition&&jexcel.current.closeEditor(jexcel.current.edition[0],!0),jexcel.current.resetSelection(!0),jexcel.current=null),jexcel.current&&1==t){if(e.target.classList.contains("jexcel_selectall"))jexcel.current&&jexcel.current.selectAll();else if(e.target.classList.contains("jexcel_corner"))1==jexcel.current.options.editable&&(jexcel.current.selectedCorner=!0);else{if(1==o[1]){if(p=e.target.getAttribute("data-x")){var n=e.target.getBoundingClientRect();if(1==jexcel.current.options.columnResize&&n.width-e.offsetX<6){jexcel.current.resizing={mousePosition:e.pageX,column:p,width:n.width},jexcel.current.headers[p].classList.add("resizing");for(var i=0;i<jexcel.current.records.length;i++)jexcel.current.records[i][p]&&jexcel.current.records[i][p].classList.add("resizing")}else if(1==jexcel.current.options.columnDrag&&n.height-e.offsetY<6)if(jexcel.current.isColMerged(p).length)console.error("JEXCEL: This column is part of a merged cell.");else for(jexcel.current.resetSelection(),jexcel.current.dragging={element:e.target,column:p,destination:p},jexcel.current.headers[p].classList.add("dragging"),i=0;i<jexcel.current.records.length;i++)jexcel.current.records[i][p]&&jexcel.current.records[i][p].classList.add("dragging");else{if(jexcel.current.selectedHeader&&(e.shiftKey||e.ctrlKey))var r=jexcel.current.selectedHeader,s=p;else jexcel.current.selectedHeader==p&&1==jexcel.current.options.allowRenameColumn&&(jexcel.timeControl=setTimeout(function(){jexcel.current.setHeader(p)},800)),jexcel.current.selectedHeader=p,r=p,s=p;jexcel.current.updateSelectionFromCoords(r,0,s,jexcel.current.options.data.length-1)}}else if(e.target.parentNode.classList.contains("jexcel_nested")){if(e.target.getAttribute("data-column"))var a=e.target.getAttribute("data-column").split(","),l=parseInt(a[0]),u=parseInt(a[a.length-1]);else l=0,u=jexcel.current.options.columns.length-1;jexcel.current.updateSelectionFromCoords(l,0,u,jexcel.current.options.data.length-1)}}else jexcel.current.selectedHeader=!1;if(2==o[1]){var c=e.target.getAttribute("data-y");if(e.target.classList.contains("jexcel_row"))n=e.target.getBoundingClientRect(),1==jexcel.current.options.rowResize&&n.height-e.offsetY<6?(jexcel.current.resizing={element:e.target.parentNode,mousePosition:e.pageY,row:c,height:n.height},e.target.parentNode.classList.add("resizing")):1==jexcel.current.options.rowDrag&&n.width-e.offsetX<6?jexcel.current.isRowMerged(c).length?console.error("JEXCEL: This row is part of a merged cell"):1==jexcel.current.options.search&&jexcel.current.results?console.error("JEXCEL: Please clear your search before perform this action"):(jexcel.current.resetSelection(),jexcel.current.dragging={element:e.target.parentNode,row:c,destination:c},e.target.parentNode.classList.add("dragging")):(jexcel.current.selectedRow&&(e.shiftKey||e.ctrlKey)?(r=jexcel.current.selectedRow,s=c):(jexcel.current.selectedRow=c,r=c,s=c),jexcel.current.updateSelectionFromCoords(0,r,jexcel.current.options.data[0].length-1,s));else if(e.target.classList.contains("jclose")&&e.target.clientWidth-e.offsetX<50&&e.offsetY<50)jexcel.current.closeEditor(jexcel.current.edition[0],!0);else{var d=function(e){var t=e.getAttribute("data-x"),o=e.getAttribute("data-y");return t&&o?[t,o]:e.parentNode?d(e.parentNode):void 0},h=d(e.target);if(h){var p=h[0];c=h[1],jexcel.current.edition&&(jexcel.current.edition[2]==p&&jexcel.current.edition[3]==c||jexcel.current.closeEditor(jexcel.current.edition[0],!0)),jexcel.current.edition||(e.shiftKey?jexcel.current.updateSelectionFromCoords(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],p,c):jexcel.current.updateSelectionFromCoords(p,c)),jexcel.current.selectedHeader=null,jexcel.current.selectedRow=null}}}else jexcel.current.selectedRow=!1;e.target.classList.contains("jexcel_page")&&jexcel.current.page("<"==e.target.innerText?0:">"==e.target.innerText?e.target.getAttribute("title")-1:e.target.innerText-1)}jexcel.isMouseAction=!jexcel.current.edition}else jexcel.isMouseAction=!1},jexcel.mouseUpControls=function(e){if(jexcel.current)if(jexcel.current.resizing){if(jexcel.current.resizing.column){var t=jexcel.current.colgroup[jexcel.current.resizing.column].getAttribute("width"),o=jexcel.current.getSelectedColumns();if(o.length>1){for(var n=[],i=0;i<o.length;i++)n.push(parseInt(jexcel.current.colgroup[o[i]].getAttribute("width")));n[o.indexOf(parseInt(jexcel.current.resizing.column))]=jexcel.current.resizing.width,jexcel.current.setWidth(o,t,n)}else jexcel.current.setWidth(jexcel.current.resizing.column,t,jexcel.current.resizing.width);jexcel.current.headers[jexcel.current.resizing.column].classList.remove("resizing");for(var r=0;r<jexcel.current.records.length;r++)jexcel.current.records[r][jexcel.current.resizing.column]&&jexcel.current.records[r][jexcel.current.resizing.column].classList.remove("resizing")}else{jexcel.current.rows[jexcel.current.resizing.row].children[0].classList.remove("resizing");var s=jexcel.current.rows[jexcel.current.resizing.row].getAttribute("height");jexcel.current.setHeight(jexcel.current.resizing.row,s,jexcel.current.resizing.height),jexcel.current.resizing.element.classList.remove("resizing")}jexcel.current.resizing=null}else if(jexcel.current.dragging){if(jexcel.current.dragging){if(jexcel.current.dragging.column){var a=e.target.getAttribute("data-x");for(jexcel.current.headers[jexcel.current.dragging.column].classList.remove("dragging"),r=0;r<jexcel.current.rows.length;r++)jexcel.current.records[r][jexcel.current.dragging.column]&&jexcel.current.records[r][jexcel.current.dragging.column].classList.remove("dragging");for(i=0;i<jexcel.current.headers.length;i++)jexcel.current.headers[i].classList.remove("dragging-left"),jexcel.current.headers[i].classList.remove("dragging-right");a&&jexcel.current.dragging.column!=jexcel.current.dragging.destination&&jexcel.current.moveColumn(jexcel.current.dragging.column,jexcel.current.dragging.destination)}else{if(jexcel.current.dragging.element.nextSibling){var l=parseInt(jexcel.current.dragging.element.nextSibling.getAttribute("data-y"));jexcel.current.dragging.row<l&&(l-=1)}else l=parseInt(jexcel.current.dragging.element.previousSibling.getAttribute("data-y"));jexcel.current.dragging.row!=jexcel.current.dragging.destination&&jexcel.current.moveRow(jexcel.current.dragging.row,l,!0),jexcel.current.dragging.element.classList.remove("dragging")}jexcel.current.dragging=null}}else jexcel.current.selectedCorner&&(jexcel.current.selectedCorner=!1,jexcel.current.selection.length>0&&(jexcel.current.copyData(jexcel.current.selection[0],jexcel.current.selection[jexcel.current.selection.length-1]),jexcel.current.removeCopySelection()));jexcel.timeControl&&(clearTimeout(jexcel.timeControl),jexcel.timeControl=null),jexcel.isMouseAction=!1},jexcel.mouseMoveControls=function(e){if((e=e||window.event).buttons)var t=e.buttons;else t=e.button?e.button:e.which;if(t||(jexcel.isMouseAction=!1),jexcel.current)if(1==jexcel.isMouseAction){if(jexcel.current.resizing)if(jexcel.current.resizing.column){var o=e.pageX-jexcel.current.resizing.mousePosition;jexcel.current.resizing.width+o>0&&(jexcel.current.colgroup[jexcel.current.resizing.column].setAttribute("width",jexcel.current.resizing.width+o),jexcel.current.updateCornerPosition())}else{var n=e.pageY-jexcel.current.resizing.mousePosition;jexcel.current.resizing.height+n>0&&(jexcel.current.rows[jexcel.current.resizing.row].setAttribute("height",jexcel.current.resizing.height+n),jexcel.current.updateCornerPosition())}}else{var i=e.target.getAttribute("data-x"),r=e.target.getAttribute("data-y"),s=e.target.getBoundingClientRect();jexcel.current.cursor&&(jexcel.current.cursor.style.cursor="",jexcel.current.cursor=null),e.target.parentNode.parentNode&&e.target.parentNode.parentNode.className&&(e.target.parentNode.parentNode.classList.contains("resizable")&&(e.target&&i&&!r&&s.width-(e.clientX-s.left)<6?(jexcel.current.cursor=e.target,jexcel.current.cursor.style.cursor="col-resize"):e.target&&!i&&r&&s.height-(e.clientY-s.top)<6&&(jexcel.current.cursor=e.target,jexcel.current.cursor.style.cursor="row-resize")),e.target.parentNode.parentNode.classList.contains("draggable")&&(e.target&&!i&&r&&s.width-(e.clientX-s.left)<6||e.target&&i&&!r&&s.height-(e.clientY-s.top)<6)&&(jexcel.current.cursor=e.target,jexcel.current.cursor.style.cursor="move"))}},jexcel.mouseOverControls=function(e){if((e=e||window.event).buttons)var t=e.buttons;else t=e.button?e.button:e.which;if(t||(jexcel.isMouseAction=!1),jexcel.current&&1==jexcel.isMouseAction){var o=jexcel.getElement(e.target);if(o[0]){if(jexcel.current!=o[0].jexcel&&jexcel.current)return!1;var n=e.target.getAttribute("data-x"),i=e.target.getAttribute("data-y");if(jexcel.current.dragging){if(jexcel.current.dragging.column){if(n)if(jexcel.current.isColMerged(n).length)console.error("JEXCEL: This column is part of a merged cell.");else{for(var r=0;r<jexcel.current.headers.length;r++)jexcel.current.headers[r].classList.remove("dragging-left"),jexcel.current.headers[r].classList.remove("dragging-right");jexcel.current.dragging.column==n?jexcel.current.dragging.destination=parseInt(n):e.target.clientWidth/2>e.offsetX?(jexcel.current.dragging.destination=jexcel.current.dragging.column<n?parseInt(n)-1:parseInt(n),jexcel.current.headers[n].classList.add("dragging-left")):(jexcel.current.dragging.destination=jexcel.current.dragging.column<n?parseInt(n):parseInt(n)+1,jexcel.current.headers[n].classList.add("dragging-right"))}}else if(i)if(jexcel.current.isRowMerged(i).length)console.error("JEXCEL: This row is part of a merged cell.");else{var s=e.target.clientHeight/2>e.offsetY?e.target.parentNode.nextSibling:e.target.parentNode;jexcel.current.dragging.element!=s&&(e.target.parentNode.parentNode.insertBefore(jexcel.current.dragging.element,s),jexcel.current.dragging.destination=Array.prototype.indexOf.call(jexcel.current.dragging.element.parentNode.children,jexcel.current.dragging.element))}}else jexcel.current.resizing||(1==o[1]&&jexcel.current.selectedHeader&&(n=e.target.getAttribute("data-x"),jexcel.current.updateSelectionFromCoords(jexcel.current.selectedHeader,0,n,jexcel.current.options.data.length-1)),2==o[1]&&(e.target.classList.contains("jexcel_row")?jexcel.current.selectedRow&&jexcel.current.updateSelectionFromCoords(0,jexcel.current.selectedRow,jexcel.current.options.data[0].length-1,i):jexcel.current.edition||n&&i&&(jexcel.current.selectedCorner?jexcel.current.updateCopySelection(n,i):jexcel.current.selectedCell&&jexcel.current.updateSelectionFromCoords(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],n,i))))}}jexcel.timeControl&&(clearTimeout(jexcel.timeControl),jexcel.timeControl=null)},jexcel.doubleClickControls=function(e){if(jexcel.current)if(e.target.classList.contains("jexcel_corner")){if(jexcel.current.highlighted.length>0){var t=jexcel.current.highlighted[0].getAttribute("data-x"),o=parseInt(jexcel.current.highlighted[jexcel.current.highlighted.length-1].getAttribute("data-y"))+1,n=jexcel.current.highlighted[jexcel.current.highlighted.length-1].getAttribute("data-x");jexcel.current.copyData(jexcel.current.records[o][t],jexcel.current.records[jexcel.current.records.length-1][n])}}else if(e.target.classList.contains("jexcel_column_filter")){var i=e.target.getAttribute("data-x");jexcel.current.openFilter(i)}else{var r=jexcel.getElement(e.target);if(1==r[1]&&1==jexcel.current.options.columnSorting&&(i=e.target.getAttribute("data-x"))&&jexcel.current.orderBy(i),2==r[1]&&1==jexcel.current.options.editable&&!jexcel.current.edition){var s=function(e){if(e.parentNode){var t=e.getAttribute("data-x"),o=e.getAttribute("data-y");return t&&o?e:s(e.parentNode)}},a=s(e.target);a&&a.classList.contains("highlight")&&jexcel.current.openEditor(a)}}},jexcel.copyControls=function(e){jexcel.current&&jexcel.copyControls.enabled&&(jexcel.current.edition||jexcel.current.copy(!0))},jexcel.cutControls=function(e){jexcel.current&&(jexcel.current.edition||(jexcel.current.copy(!0),1==jexcel.current.options.editable&&jexcel.current.setValue(jexcel.current.highlighted,"")))},jexcel.pasteControls=function(e){jexcel.current&&jexcel.current.selectedCell&&(jexcel.current.edition||1==jexcel.current.options.editable&&(e&&e.clipboardData?(jexcel.current.paste(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],e.clipboardData.getData("text")),e.preventDefault()):window.clipboardData&&jexcel.current.paste(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],window.clipboardData.getData("text"))))},jexcel.contextMenuControls=function(e){if(e=e||window.event,jexcel.current)if(jexcel.current.edition)e.preventDefault();else if(jexcel.current.options.contextMenu&&(jexcel.current.contextMenu.contextmenu.close(),jexcel.current)){var t=e.target.getAttribute("data-x"),o=e.target.getAttribute("data-y");if(t||o){(t<parseInt(jexcel.current.selectedCell[0])||t>parseInt(jexcel.current.selectedCell[2])||o<parseInt(jexcel.current.selectedCell[1])||o>parseInt(jexcel.current.selectedCell[3]))&&jexcel.current.updateSelectionFromCoords(t,o,t,o);var n=jexcel.current.options.contextMenu(jexcel.current,t,o,e);jexcel.current.contextMenu.contextmenu.open(e,n),e.preventDefault()}}},jexcel.touchStartControls=function(e){var t=jexcel.getElement(e.target);if(t[0]?jexcel.current!=t[0].jexcel&&(jexcel.current&&jexcel.current.resetSelection(),jexcel.current=t[0].jexcel):jexcel.current&&(jexcel.current.resetSelection(),jexcel.current=null),jexcel.current&&!jexcel.current.edition){var o=e.target.getAttribute("data-x"),n=e.target.getAttribute("data-y");o&&n&&(jexcel.current.updateSelectionFromCoords(o,n),jexcel.timeControl=setTimeout(function(){jexcel.tmpElement="color"==jexcel.current.options.columns[o].type?null:e.target,jexcel.current.openEditor(e.target,!1,e)},500))}},jexcel.touchEndControls=function(e){jexcel.timeControl&&(clearTimeout(jexcel.timeControl),jexcel.timeControl=null,jexcel.tmpElement&&"INPUT"==jexcel.tmpElement.children[0].tagName&&jexcel.tmpElement.children[0].focus(),jexcel.tmpElement=null)},jexcel.tabs=function(e,t){var o=[];if(e.classList.contains("jexcel_tabs"))i=e.children[0],r=e.children[1];else{e.innerHTML="",e.classList.add("jexcel_tabs"),e.jexcel=[];var n=document.createElement("div"),i=e.appendChild(n),r=(n=document.createElement("div"),e.appendChild(n))}for(var s=[],a=[],l=0;l<t.length;l++){s[l]=document.createElement("div"),s[l].classList.add("jexcel_tab");var u=jexcel(s[l],t[l]);r.appendChild(s[l]),o[l]=e.jexcel.push(u),a[l]=document.createElement("div"),a[l].classList.add("jexcel_tab_link"),a[l].setAttribute("data-spreadsheet",e.jexcel.length-1),a[l].innerHTML=t[l].sheetName,a[l].onclick=function(){for(var e=0;e<i.children.length;e++)i.children[e].classList.remove("selected"),r.children[e].style.display="none";var t=this.getAttribute("data-spreadsheet");r.children[t].style.display="block",i.children[t].classList.add("selected")},i.appendChild(a[l])}for(var c=0;c<i.children.length;c++)i.children[c].classList.remove("selected"),r.children[c].style.display="none";return i.children[i.children.length-1].classList.add("selected"),r.children[i.children.length-1].style.display="block",o},jexcel.createTabs=jexcel.tabs,jexcel.fromSpreadsheet=function(e,t){var o,n=function(e){var t=[];return e.SheetNames.forEach(function(o){var n={rows:[],columns:[],data:[],style:{}};if(n.sheetName=o,(h=e.Sheets[o]["!cols"])&&h.length)for(var i=0;i<h.length;i++)n.columns[i]={},h[i]&&h[i].wpx&&(n.columns[i].width=h[i].wpx+"px");if((h=e.Sheets[o]["!rows"])&&h.length)for(i=0;i<h.length;i++)h[i]&&h[i].hpx&&(n.rows[i]={},n.rows[i].height=h[i].hpx+"px");if((h=e.Sheets[o]["!merges"])&&h.length>0)for(n.mergeCells=[],i=0;i<h.length;i++){var r=h[i].s.c,s=h[i].s.r,a=h[i].e.c,l=h[i].e.r,u=jexcel.getColumnNameFromId([r,s]);n.mergeCells[u]=[a-r+1,l-s+1]}var c=0,d=0,h=Object.keys(e.Sheets[o]);for(i=0;i<h.length;i++)if("!"!=h[i].substr(0,1)){var p=e.Sheets[o][h[i]],f=jexcel.getIdFromColumnName(h[i],!0);n.data[f[1]]||(n.data[f[1]]=[]),n.data[f[1]][f[0]]=p.f?"="+p.f:p.w,c<f[0]&&(c=f[0]),d<f[1]&&(d=f[1]),p.style&&Object.keys(p.style).length>0&&(n.style[h[i]]=p.style),p.s&&p.s.fgColor&&(n.style[h[i]]&&(n.style[h[i]]+=";"),n.style[h[i]]+="background-color:#"+p.s.fgColor.rgb)}for(var v=n.columns,g=0;g<=d;g++)for(i=0;i<=c;i++)n.data[g]||(n.data[g]=[]),n.data[g][i]||v<i&&(n.data[g][i]="");t.push(n)}),t};(o=new XMLHttpRequest).open("GET",e,!0),"undefined"!=typeof Uint8Array?(o.responseType="arraybuffer",o.onload=function(e){var i=new Uint8Array(o.response),r=XLSX.read(i,{type:"array",cellFormula:!0,cellStyles:!0});t(n(r))}):(o.setRequestHeader("Accept-Charset","x-user-defined"),o.onreadystatechange=function(){if(4==o.readyState&&200==o.status){var e=convertResponseBodyToText(o.responseBody),i=XLSX.read(e,{type:"binary",cellFormula:!0,cellStyles:!0});t(n(i))}}),o.send()},jexcel.validLetter=function(e){return e.match(/([\u0041-\u005A\u0061-\u007A\u00AA\u00B5\u00BA\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u0527\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0\u08A2-\u08AC\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0977\u0979-\u097F\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C33\u0C35-\u0C39\u0C3D\u0C58\u0C59\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D60\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F4\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191C\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19C1-\u19C7\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FCC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA697\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA78E\uA790-\uA793\uA7A0-\uA7AA\uA7F8-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA80-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uABC0-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC-\u0400-\u04FF']+)/g)?1:0},jexcel.injectArray=function(e,t,o){return e.slice(0,t).concat(o).concat(e.slice(t))},jexcel.getColumnName=function(e){var t="";return e>701?(t+=String.fromCharCode(64+parseInt(e/676)),t+=String.fromCharCode(64+parseInt(e%676/26))):e>25&&(t+=String.fromCharCode(64+parseInt(e/26))),t+String.fromCharCode(65+e%26)},jexcel.getIdFromColumnName=function(e,t){var o=/^[a-zA-Z]+/.exec(e);if(o){for(var n=0,i=0;i<o[0].length;i++)n+=parseInt(o[0].charCodeAt(i)-64)*Math.pow(26,o[0].length-1-i);--n<0&&(n=0);var r=parseInt(/[0-9]+$/.exec(e));r>0&&r--,e=1==t?[n,r]:n+"-"+r}return e},jexcel.getColumnNameFromId=function(e){return Array.isArray(e)||(e=e.split("-")),jexcel.getColumnName(parseInt(e[0]))+(parseInt(e[1])+1)},jexcel.getElement=function(e){var t=0,o=0;return function e(n){n.className&&n.classList.contains("jexcel_container")&&(o=n),"THEAD"==n.tagName?t=1:"TBODY"==n.tagName&&(t=2),n.parentNode&&(o||e(n.parentNode))}(e),[o,t]},jexcel.doubleDigitFormat=function(e){return 1==(e=""+e).length&&(e="0"+e),e},jexcel.createFromTable=function(e,t){if("TABLE"==e.tagName){t||(t={}),t.columns=[],t.data=[];var o=e.querySelectorAll("colgroup > col");if(o.length)for(var n=0;n<o.length;n++){if(!(i=o[n].style.width))var i=o[n].getAttribute("width");i&&(t.columns[n]||(t.columns[n]={}),t.columns[n].width=i)}var r=function(e){var o=e.getBoundingClientRect(),i=o.width>50?o.width:50;t.columns[n]||(t.columns[n]={}),t.columns[n].type=e.getAttribute("data-celltype")?e.getAttribute("data-celltype"):"text",t.columns[n].width=i+"px",t.columns[n].title=e.innerHTML,t.columns[n].align=e.style.textAlign||"center"},s=e.querySelectorAll("thead > tr");if(s.length)for(s=s[s.length-1].children,n=0;n<s.length;n++)r(s[n]);for(var a=0,l={},u={},c={},d=e.querySelectorAll("table > tr, tbody tr"),h=0;h<d.length;h++)if(t.data[a]=[],1==t.parseTableFirstRowAsHeader&&0==h)for(n=0;n<d[h].children.length;n++)r(d[h].children[n]);else{for(n=0;n<d[h].children.length;n++){if(p=d[h].children[n].getAttribute("data-formula"))"="!=p.substr(0,1)&&(p="="+p);else var p=d[h].children[n].innerHTML;t.data[a].push(p);var f=jexcel.getColumnNameFromId([n,h]),v=parseInt(d[h].children[n].getAttribute("colspan"))||0,g=parseInt(d[h].children[n].getAttribute("rowspan"))||0;(v||g)&&(l[f]=[v||1,g||1]),d[h].children[n].style&&"none"==d[h].children[n].style.display&&(d[h].children[n].style.display="");var b=d[h].children[n].getAttribute("style");b&&(c[f]=b),d[h].children[n].classList.contains("styleBold")&&(c[f]?c[f]+="; font-weight:bold;":c[f]="font-weight:bold;")}d[h].style&&d[h].style.height&&(u[h]={height:d[h].style.height}),a++}if(Object.keys(c),Object.keys(l).length>0&&(t.mergeCells=l),Object.keys(u).length>0&&(t.rows=u),1==t.parseTableAutoCellType){var m=[];for(n=0;n<t.columns.length;n++){var y=!0,j=!0;for(m[n]=[],h=0;h<t.data.length;h++)m[n][p=t.data[h][n]]||(m[n][p]=0),m[n][p]++,p.length>25&&(y=!1),10==p.length&&"-"==p.substr(4,1)&&"-"==p.substr(7,1)||(j=!1);var w=Object.keys(m[n]).length;j?t.columns[n].type="calendar":1==y&&w>1&&w<=parseInt(.1*t.data.length)&&(t.columns[n].type="dropdown",t.columns[n].source=Object.keys(m[n]))}}return t}console.log("Element is not a table")},"undefined"!=typeof jQuery&&function(e){e.fn.jexcel=function(t){var o=e(this).get(0);return o.jexcel?o.jexcel[t].apply(this,Array.prototype.slice.call(arguments,1)):jexcel(e(this).get(0),arguments[0])}}(jQuery);var error=function(){var e={};return e.nil=new Error("#NULL!"),e.div0=new Error("#DIV/0!"),e.value=new Error("#VALUE!"),e.ref=new Error("#REF!"),e.name=new Error("#NAME?"),e.num=new Error("#NUM!"),e.na=new Error("#N/A"),e.error=new Error("#ERROR!"),e.data=new Error("#GETTING_DATA"),e}(),utils=function(){var e={flattenShallow:function(e){return e&&e.reduce?e.reduce(function(e,t){var o=Array.isArray(e),n=Array.isArray(t);return o&&n?e.concat(t):o?(e.push(t),e):n?[e].concat(t):[e,t]}):e},isFlat:function(e){if(!e)return!1;for(var t=0;t<e.length;++t)if(Array.isArray(e[t]))return!1;return!0},flatten:function(){for(var t=e.argsToArray.apply(null,arguments);!e.isFlat(t);)t=e.flattenShallow(t);return t},argsToArray:function(t){var o=[];return e.arrayEach(t,function(e){o.push(e)}),o},numbers:function(){var e=this.flatten.apply(null,arguments);return e.filter(function(e){return"number"==typeof e})},cleanFloat:function(e){var t=1e14;return Math.round(e*t)/t},parseBool:function(e){if("boolean"==typeof e)return e;if(e instanceof Error)return e;if("number"==typeof e)return 0!==e;if("string"==typeof e){var t=e.toUpperCase();if("TRUE"===t)return!0;if("FALSE"===t)return!1}return e instanceof Date&&!isNaN(e)||error.value},parseNumber:function(e){return void 0===e||""===e||isNaN(e)?error.value:parseFloat(e)},parseNumberArray:function(t){var o,n;if(!t||0===(o=t.length))return error.value;for(;o--;){if((n=e.parseNumber(t[o]))===error.value)return n;t[o]=n}return t},parseMatrix:function(t){var o;if(!t||0===t.length)return error.value;for(var n=0;n<t.length;n++)if(o=e.parseNumberArray(t[n]),t[n]=o,o instanceof Error)return o;return t}},t=new Date(Date.UTC(1900,0,1));return e.parseDate=function(e){if(!isNaN(e)){if(e instanceof Date)return new Date(e);var o=parseInt(e,10);return o<0?error.num:o<=60?new Date(t.getTime()+864e5*(o-1)):new Date(t.getTime()+864e5*(o-2))}return"string"!=typeof e||(e=new Date(e),isNaN(e))?error.value:e},e.parseDateArray=function(e){for(var t,o=e.length;o--;){if((t=this.parseDate(e[o]))===error.value)return t;e[o]=t}return e},e.anyIsError=function(){for(var e=arguments.length;e--;)if(arguments[e]instanceof Error)return!0;return!1},e.arrayValuesToNumbers=function(e){for(var t,o=e.length;o--;)if("number"!=typeof(t=e[o]))if(!0!==t)if(!1!==t){if("string"==typeof t){var n=this.parseNumber(t);e[o]=n instanceof Error?0:n}}else e[o]=0;else e[o]=1;return e},e.rest=function(e,t){return t=t||1,e&&"function"==typeof e.slice?e.slice(t):e},e.initial=function(e,t){return t=t||1,e&&"function"==typeof e.slice?e.slice(0,e.length-t):e},e.arrayEach=function(e,t){for(var o=-1,n=e.length;++o<n&&!1!==t(e[o],o,e););return e},e.transpose=function(e){return e?e[0].map(function(t,o){return e.map(function(e){return e[o]})}):error.value},e}();jexcel.methods={},jexcel.methods.datetime=function(){var e={},t=new Date(1900,0,1),o=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]];function n(e){return(e-t)/864e5+(e>-22038912e5?2:1)}return e.DATE=function(e,t,o){return e=utils.parseNumber(e),t=utils.parseNumber(t),o=utils.parseNumber(o),utils.anyIsError(e,t,o)?error.value:e<0||t<0||o<0?error.num:new Date(e,t-1,o)},e.DATEVALUE=function(e){if("string"!=typeof e)return error.value;var o=Date.parse(e);return isNaN(o)?error.value:o<=-22038912e5?(o-t)/864e5+1:(o-t)/864e5+2},e.DAY=function(e){var t=utils.parseDate(e);return t instanceof Error?t:t.getDate()},e.DAYS=function(e,t){return e=utils.parseDate(e),t=utils.parseDate(t),e instanceof Error?e:t instanceof Error?t:n(e)-n(t)},e.DAYS360=function(e,t,o){},e.EDATE=function(e,t){return(e=utils.parseDate(e))instanceof Error?e:isNaN(t)?error.value:(t=parseInt(t,10),e.setMonth(e.getMonth()+t),n(e))},e.EOMONTH=function(e,t){return(e=utils.parseDate(e))instanceof Error?e:isNaN(t)?error.value:(t=parseInt(t,10),n(new Date(e.getFullYear(),e.getMonth()+t+1,0)))},e.HOUR=function(e){return(e=utils.parseDate(e))instanceof Error?e:e.getHours()},e.INTERVAL=function(e){if("number"!=typeof e&&"string"!=typeof e)return error.value;e=parseInt(e,10);var t=Math.floor(e/94608e4);e%=94608e4;var o=Math.floor(e/2592e3);e%=2592e3;var n=Math.floor(e/86400);e%=86400;var i=Math.floor(e/3600);e%=3600;var r=Math.floor(e/60),s=e%=60;return"P"+(t=t>0?t+"Y":"")+(o=o>0?o+"M":"")+(n=n>0?n+"D":"")+"T"+(i=i>0?i+"H":"")+(r=r>0?r+"M":"")+(s>0?s+"S":"")},e.ISOWEEKNUM=function(e){if((e=utils.parseDate(e))instanceof Error)return e;e.setHours(0,0,0),e.setDate(e.getDate()+4-(e.getDay()||7));var t=new Date(e.getFullYear(),0,1);return Math.ceil(((e-t)/864e5+1)/7)},e.MINUTE=function(e){return(e=utils.parseDate(e))instanceof Error?e:e.getMinutes()},e.MONTH=function(e){return(e=utils.parseDate(e))instanceof Error?e:e.getMonth()+1},e.NETWORKDAYS=function(e,t,o){},e.NETWORKDAYS.INTL=function(e,t,o,n){},e.NOW=function(){return new Date},e.SECOND=function(e){return(e=utils.parseDate(e))instanceof Error?e:e.getSeconds()},e.TIME=function(e,t,o){return e=utils.parseNumber(e),t=utils.parseNumber(t),o=utils.parseNumber(o),utils.anyIsError(e,t,o)?error.value:e<0||t<0||o<0?error.num:(3600*e+60*t+o)/86400},e.TIMEVALUE=function(e){return(e=utils.parseDate(e))instanceof Error?e:(3600*e.getHours()+60*e.getMinutes()+e.getSeconds())/86400},e.TODAY=function(){return new Date},e.WEEKDAY=function(e,t){if((e=utils.parseDate(e))instanceof Error)return e;void 0===t&&(t=1);var n=e.getDay();return o[t][n]},e.WEEKNUM=function(e,t){},e.WORKDAY=function(e,t,o){},e.WORKDAY.INTL=function(e,t,o,n){},e.YEAR=function(e){return(e=utils.parseDate(e))instanceof Error?e:e.getFullYear()},e.YEARFRAC=function(e,t,o){},e}(),jexcel.methods.database=function(){var exports={};function compact(e){if(!e)return e;for(var t=[],o=0;o<e.length;++o)e[o]&&t.push(e[o]);return t}function findResultIndex(database,criterias){for(var matches={},i=1;i<database[0].length;++i)matches[i]=!0;var maxCriteriaLength=criterias[0].length;for(i=1;i<criterias.length;++i)criterias[i].length>maxCriteriaLength&&(maxCriteriaLength=criterias[i].length);for(var k=1;k<database.length;++k)for(var l=1;l<database[k].length;++l){for(var currentCriteriaResult=!1,hasMatchingCriteria=!1,j=0;j<criterias.length;++j){var criteria=criterias[j];if(!(criteria.length<maxCriteriaLength)){var criteriaField=criteria[0];if(database[k][0]===criteriaField){hasMatchingCriteria=!0;for(var p=1;p<criteria.length;++p)currentCriteriaResult=currentCriteriaResult||eval(database[k][l]+criteria[p])}}}hasMatchingCriteria&&(matches[l]=matches[l]&&currentCriteriaResult)}for(var result=[],n=0;n<database[0].length;++n)matches[n]&&result.push(n-1);return result}return exports.FINDFIELD=function(e,t){for(var o=null,n=0;n<e.length;n++)if(e[n][0]===t){o=n;break}return null==o?error.value:o},exports.DAVERAGE=function(e,t,o){if(isNaN(t)&&"string"!=typeof t)return error.value;var n=findResultIndex(e,o),i=[];if("string"==typeof t){var r=exports.FINDFIELD(e,t);i=utils.rest(e[r])}else i=utils.rest(e[t]);for(var s=0,a=0;a<n.length;a++)s+=i[n[a]];return 0===n.length?error.div0:s/n.length},exports.DCOUNT=function(e,t,o){},exports.DCOUNTA=function(e,t,o){},exports.DGET=function(e,t,o){if(isNaN(t)&&"string"!=typeof t)return error.value;var n=findResultIndex(e,o),i=[];if("string"==typeof t){var r=exports.FINDFIELD(e,t);i=utils.rest(e[r])}else i=utils.rest(e[t]);return 0===n.length?error.value:n.length>1?error.num:i[n[0]]},exports.DMAX=function(e,t,o){if(isNaN(t)&&"string"!=typeof t)return error.value;var n=findResultIndex(e,o),i=[];if("string"==typeof t){var r=exports.FINDFIELD(e,t);i=utils.rest(e[r])}else i=utils.rest(e[t]);for(var s=i[n[0]],a=1;a<n.length;a++)s<i[n[a]]&&(s=i[n[a]]);return s},exports.DMIN=function(e,t,o){if(isNaN(t)&&"string"!=typeof t)return error.value;var n=findResultIndex(e,o),i=[];if("string"==typeof t){var r=exports.FINDFIELD(e,t);i=utils.rest(e[r])}else i=utils.rest(e[t]);for(var s=i[n[0]],a=1;a<n.length;a++)s>i[n[a]]&&(s=i[n[a]]);return s},exports.DPRODUCT=function(e,t,o){if(isNaN(t)&&"string"!=typeof t)return error.value;var n=findResultIndex(e,o),i=[];if("string"==typeof t){var r=exports.FINDFIELD(e,t);i=utils.rest(e[r])}else i=utils.rest(e[t]);for(var s=[],a=0;a<n.length;a++)s[a]=i[n[a]];s=compact(s);var l=1;for(a=0;a<s.length;a++)l*=s[a];return l},exports.DSTDEV=function(e,t,o){},exports.DSTDEVP=function(e,t,o){},exports.DSUM=function(e,t,o){},exports.DVAR=function(e,t,o){},exports.DVARP=function(e,t,o){},exports.MATCH=function(e,t,o){if(!e&&!t)return error.na;if(2===arguments.length&&(o=1),!(t instanceof Array))return error.na;if(-1!==o&&0!==o&&1!==o)return error.na;for(var n,i,r=0;r<t.length;r++)if(1===o){if(t[r]===e)return r+1;t[r]<e&&(i?t[r]>i&&(n=r+1,i=t[r]):(n=r+1,i=t[r]))}else if(0===o){if("string"==typeof e){if(e=e.replace(/\?/g,"."),t[r].toLowerCase().match(e.toLowerCase()))return r+1}else if(t[r]===e)return r+1}else if(-1===o){if(t[r]===e)return r+1;t[r]>e&&(i?t[r]<i&&(n=r+1,i=t[r]):(n=r+1,i=t[r]))}return n||error.na},exports}(),jexcel.methods.engineering=function(){var e={};function t(e){return/^[01]{1,10}$/.test(e)}return e.BESSELI=function(e,t){},e.BESSELJ=function(e,t){},e.BESSELK=function(e,t){},e.BESSELY=function(e,t){},e.BIN2DEC=function(e){if(!t(e))return error.num;var o=parseInt(e,2),n=e.toString();return 10===n.length&&"1"===n.substring(0,1)?parseInt(n.substring(1),2)-512:o},e.BIN2HEX=function(e,o){if(!t(e))return error.num;var n=e.toString();if(10===n.length&&"1"===n.substring(0,1))return(0xfffffffe00+parseInt(n.substring(1),2)).toString(16);var i=parseInt(e,2).toString(16);return void 0===o?i:isNaN(o)?error.value:o<0?error.num:(o=Math.floor(o))>=i.length?REPT("0",o-i.length)+i:error.num},e.BIN2OCT=function(e,o){if(!t(e))return error.num;var n=e.toString();if(10===n.length&&"1"===n.substring(0,1))return(1073741312+parseInt(n.substring(1),2)).toString(8);var i=parseInt(e,2).toString(8);return void 0===o?i:isNaN(o)?error.value:o<0?error.num:(o=Math.floor(o))>=i.length?REPT("0",o-i.length)+i:error.num},e.BITAND=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:e<0||t<0||Math.floor(e)!==e||Math.floor(t)!==t||e>0xffffffffffff||t>0xffffffffffff?error.num:e&t},e.BITLSHIFT=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:e<0||Math.floor(e)!==e||e>0xffffffffffff||Math.abs(t)>53?error.num:t>=0?e<<t:e>>-t},e.BITOR=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:e<0||t<0||Math.floor(e)!==e||Math.floor(t)!==t||e>0xffffffffffff||t>0xffffffffffff?error.num:e|t},e.BITRSHIFT=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:e<0||Math.floor(e)!==e||e>0xffffffffffff||Math.abs(t)>53?error.num:t>=0?e>>t:e<<-t},e.BITXOR=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:e<0||t<0||Math.floor(e)!==e||Math.floor(t)!==t||e>0xffffffffffff||t>0xffffffffffff?error.num:e^t},e.COMPLEX=function(e,t,o){if(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t))return e;if("i"!==(o=void 0===o?"i":o)&&"j"!==o)return error.value;if(0===e&&0===t)return 0;if(0===e)return 1===t?o:t.toString()+o;if(0===t)return e.toString();var n=t>0?"+":"";return e.toString()+n+(1===t?o:t.toString()+o)},e.CONVERT=function(e,t,o){if((e=utils.parseNumber(e))instanceof Error)return e;for(var n,i=[["a.u. of action","?",null,"action",!1,!1,105457168181818e-48],["a.u. of charge","e",null,"electric_charge",!1,!1,160217653141414e-33],["a.u. of energy","Eh",null,"energy",!1,!1,435974417757576e-32],["a.u. of length","a?",null,"length",!1,!1,529177210818182e-25],["a.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["a.u. of time","?/Eh",null,"time",!1,!1,241888432650516e-31],["admiralty knot","admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["\xe5ngstr\xf6m","\xc5",["ang"],"length",!1,!0,1e-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,149597870691667e-25],["bar","bar",null,"pressure",!1,!1,1e5],["barn","b",null,"area",!1,!1,1e-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],"information",!1,!0,1],["btu","BTU",["btu"],"energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m?",null,"luminance",!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic \xe5ngstr\xf6m","ang3",["ang^3"],"volume",!1,!0,1e-30],["cubic foot","ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,16387064e-12],["cubic light-year","ly3",["ly^3"],"volume",!1,!0,846786664623715e-61],["cubic metre","m?",null,"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,4168181825.44058],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,7.58660370370369e-8],["cubic yard","yd3",["yd^3"],"volume",!1,!0,.764554857984],["cup","cup",null,"volume",!1,!0,.0002365882365],["dalton","Da",["u"],"mass",!1,!1,166053886282828e-41],["day","d",["day"],"time",!1,!0,86400],["degree","\xb0",null,"angle",!1,!1,.0174532925199433],["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1e-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell","ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1e-7],["farad","F",null,"electric_capacitance",!0,!1,1],["fluid ounce","oz",null,"volume",!1,!0,295735295625e-16],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],["gal","Gal",null,"acceleration",!1,!1,.01],["gallon","gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,647989e-10],["gram","g",null,"mass",!1,!0,.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],["hectare","ha",null,"area",!1,!0,1e4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",!1,!0,2684519.538],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule","J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],"volume",!1,!0,.001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1e-18],["measurement ton","MTON",null,"volume",!1,!0,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",!1,!0,.00027777777777778],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m?s??",null,"acceleration",!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,0x6da012f958ee1c],["meter squared per second","m?/s",null,"kinematic_viscosity",!0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",!1,!1,133.322],["minute","?",null,"angle",!1,!1,.000290888208665722],["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5e-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",null,"area",!1,!0,2500],["n.u. of action","?",null,"action",!1,!1,105457168181818e-48],["n.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["n.u. of speed","c?",null,"speed",!1,!1,299792458],["n.u. of time","?/(me?c??)",null,"time",!1,!1,128808866778687e-35],["nautical mile","M",["Nmi"],"length",!1,!0,1852],["newton","N",null,"force",!0,!0,1],["\u0153rsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","\u03a9",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa?s",null,"dynamic_viscosity",!0,!1,1],["pferdest\xe4rke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,1e-4],["pica (1/6 inch)","pica",null,"length",!1,!0,.00035277777777778],["pica (1/72 inch)","Pica",["Picapt"],"length",!1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,.000946352946],["radian","rad",null,"angle",!0,!1,1],["second","?",null,"angle",!1,!1,484813681109536e-20],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,!0,45.359237],["siemens","S",null,"electrical_conductance",!0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square \xe5ngstr\xf6m","ang2",["ang^2"],"area",!1,!0,1e-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,64516e-8],["square light-year","ly2",["ly^2"],"area",!1,!0,895054210748189e17],["square meter","m?",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988.110336],["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1792111111111e-17],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance",!1,!1,1e-4],["stokes","St",null,"kinematic_viscosity",!1,!1,1e-4],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,147868e-10],["teaspoon","tsp",null,"volume",!1,!0,492892e-11],["tesla","T",null,"magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne","t",null,"mass",!1,!1,1e3],["U.K. pint","uk_pt",null,"volume",!1,!0,.00056826125],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907],["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,.000473176473],["U.S. survey mile","survey_mi",null,"length",!1,!0,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],r={Yi:["yobi",80,12089258196146292e8,"Yi","yotta"],Zi:["zebi",70,11805916207174113e5,"Zi","zetta"],Ei:["exbi",60,0x1000000000000000,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},s={Y:["yotta",1e24,"Y"],Z:["zetta",1e21,"Z"],E:["exa",1e18,"E"],P:["peta",1e15,"P"],T:["tera",1e12,"T"],G:["giga",1e9,"G"],M:["mega",1e6,"M"],k:["kilo",1e3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1e-6,"u"],n:["nano",1e-9,"n"],p:["pico",1e-12,"p"],f:["femto",1e-15,"f"],a:["atto",1e-18,"a"],z:["zepto",1e-21,"z"],y:["yocto",1e-24,"y"]},a=null,l=null,u=t,c=o,d=1,h=1,p=0;p<i.length;p++)n=null===i[p][2]?[]:i[p][2],(i[p][1]===u||n.indexOf(u)>=0)&&(a=i[p]),(i[p][1]===c||n.indexOf(c)>=0)&&(l=i[p]);if(null===a){var f=r[t.substring(0,2)],v=s[t.substring(0,1)];"da"===t.substring(0,2)&&(v=["dekao",10,"da"]),f?(d=f[2],u=t.substring(2)):v&&(d=v[1],u=t.substring(v[2].length));for(var g=0;g<i.length;g++)n=null===i[g][2]?[]:i[g][2],(i[g][1]===u||n.indexOf(u)>=0)&&(a=i[g])}if(null===l){var b=r[o.substring(0,2)],m=s[o.substring(0,1)];"da"===o.substring(0,2)&&(m=["dekao",10,"da"]),b?(h=b[2],c=o.substring(2)):m&&(h=m[1],c=o.substring(m[2].length));for(var y=0;y<i.length;y++)n=null===i[y][2]?[]:i[y][2],(i[y][1]===c||n.indexOf(c)>=0)&&(l=i[y])}return null===a||null===l||a[3]!==l[3]?error.na:e*a[6]*d/(l[6]*h)},e.DEC2BIN=function(e,t){if((e=utils.parseNumber(e))instanceof Error)return e;if(!/^-?[0-9]{1,3}$/.test(e)||e<-512||e>511)return error.num;if(e<0)return"1"+REPT("0",9-(512+e).toString(2).length)+(512+e).toString(2);var o=parseInt(e,10).toString(2);return void 0===t?o:isNaN(t)?error.value:t<0?error.num:(t=Math.floor(t))>=o.length?REPT("0",t-o.length)+o:error.num},e.DEC2HEX=function(e,t){if((e=utils.parseNumber(e))instanceof Error)return e;if(!/^-?[0-9]{1,12}$/.test(e)||e<-549755813888||e>549755813887)return error.num;if(e<0)return(1099511627776+e).toString(16);var o=parseInt(e,10).toString(16);return void 0===t?o:isNaN(t)?error.value:t<0?error.num:(t=Math.floor(t))>=o.length?REPT("0",t-o.length)+o:error.num},e.DEC2OCT=function(e,t){if((e=utils.parseNumber(e))instanceof Error)return e;if(!/^-?[0-9]{1,9}$/.test(e)||e<-536870912||e>536870911)return error.num;if(e<0)return(1073741824+e).toString(8);var o=parseInt(e,10).toString(8);return void 0===t?o:isNaN(t)?error.value:t<0?error.num:(t=Math.floor(t))>=o.length?REPT("0",t-o.length)+o:error.num},e.DELTA=function(e,t){return t=void 0===t?0:t,e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:e===t?1:0},e.ERF=function(e,t){},e.ERF.PRECISE=function(){},e.ERFC=function(e){},e.ERFC.PRECISE=function(){},e.GESTEP=function(e,t){return t=t||0,e=utils.parseNumber(e),utils.anyIsError(t,e)?e:e>=t?1:0},e.HEX2BIN=function(e,t){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return error.num;var o=10===e.length&&"f"===e.substring(0,1).toLowerCase(),n=o?parseInt(e,16)-1099511627776:parseInt(e,16);if(n<-512||n>511)return error.num;if(o)return"1"+REPT("0",9-(512+n).toString(2).length)+(512+n).toString(2);var i=n.toString(2);return void 0===t?i:isNaN(t)?error.value:t<0?error.num:(t=Math.floor(t))>=i.length?REPT("0",t-i.length)+i:error.num},e.HEX2DEC=function(e){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return error.num;var t=parseInt(e,16);return t>=549755813888?t-1099511627776:t},e.HEX2OCT=function(e,t){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return error.num;var o=parseInt(e,16);if(o>536870911&&o<0xffe0000000)return error.num;if(o>=0xffe0000000)return(o-0xffc0000000).toString(8);var n=o.toString(8);return void 0===t?n:isNaN(t)?error.value:t<0?error.num:(t=Math.floor(t))>=n.length?REPT("0",t-n.length)+n:error.num},e.IMABS=function(t){var o=e.IMREAL(t),n=e.IMAGINARY(t);return utils.anyIsError(o,n)?error.value:Math.sqrt(Math.pow(o,2)+Math.pow(n,2))},e.IMAGINARY=function(e){if(void 0===e||!0===e||!1===e)return error.value;if(0===e||"0"===e)return 0;if(["i","j"].indexOf(e)>=0)return 1;var t=(e=e.replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j")).indexOf("+"),o=e.indexOf("-");0===t&&(t=e.indexOf("+",1)),0===o&&(o=e.indexOf("-",1));var n=e.substring(e.length-1,e.length),i="i"===n||"j"===n;return t>=0||o>=0?i?t>=0?isNaN(e.substring(0,t))||isNaN(e.substring(t+1,e.length-1))?error.num:Number(e.substring(t+1,e.length-1)):isNaN(e.substring(0,o))||isNaN(e.substring(o+1,e.length-1))?error.num:-Number(e.substring(o+1,e.length-1)):error.num:i?isNaN(e.substring(0,e.length-1))?error.num:e.substring(0,e.length-1):isNaN(e)?error.num:0},e.IMARGUMENT=function(t){var o=e.IMREAL(t),n=e.IMAGINARY(t);return utils.anyIsError(o,n)?error.value:0===o&&0===n?error.div0:0===o&&n>0?Math.PI/2:0===o&&n<0?-Math.PI/2:0===n&&o>0?0:0===n&&o<0?-Math.PI:o>0?Math.atan(n/o):o<0&&n>=0?Math.atan(n/o)+Math.PI:Math.atan(n/o)-Math.PI},e.IMCONJUGATE=function(t){var o=e.IMREAL(t),n=e.IMAGINARY(t);if(utils.anyIsError(o,n))return error.value;var i=t.substring(t.length-1);return i="i"===i||"j"===i?i:"i",0!==n?e.COMPLEX(o,-n,i):t},e.IMCOS=function(t){var o=e.IMREAL(t),n=e.IMAGINARY(t);if(utils.anyIsError(o,n))return error.value;var i=t.substring(t.length-1);return i="i"===i||"j"===i?i:"i",e.COMPLEX(Math.cos(o)*(Math.exp(n)+Math.exp(-n))/2,-Math.sin(o)*(Math.exp(n)-Math.exp(-n))/2,i)},e.IMCOSH=function(t){var o=e.IMREAL(t),n=e.IMAGINARY(t);if(utils.anyIsError(o,n))return error.value;var i=t.substring(t.length-1);return i="i"===i||"j"===i?i:"i",e.COMPLEX(Math.cos(n)*(Math.exp(o)+Math.exp(-o))/2,Math.sin(n)*(Math.exp(o)-Math.exp(-o))/2,i)},e.IMCOT=function(t){var o=e.IMREAL(t),n=e.IMAGINARY(t);return utils.anyIsError(o,n)?error.value:e.IMDIV(e.IMCOS(t),e.IMSIN(t))},e.IMDIV=function(t,o){var n=e.IMREAL(t),i=e.IMAGINARY(t),r=e.IMREAL(o),s=e.IMAGINARY(o);if(utils.anyIsError(n,i,r,s))return error.value;var a=t.substring(t.length-1),l=o.substring(o.length-1),u="i";if(("j"===a||"j"===l)&&(u="j"),0===r&&0===s)return error.num;var c=r*r+s*s;return e.COMPLEX((n*r+i*s)/c,(i*r-n*s)/c,u)},e.IMEXP=function(t){var o=e.IMREAL(t),n=e.IMAGINARY(t);if(utils.anyIsError(o,n))return error.value;var i=t.substring(t.length-1);i="i"===i||"j"===i?i:"i";var r=Math.exp(o);return e.COMPLEX(r*Math.cos(n),r*Math.sin(n),i)},e.IMLN=function(t){var o=e.IMREAL(t),n=e.IMAGINARY(t);if(utils.anyIsError(o,n))return error.value;var i=t.substring(t.length-1);return i="i"===i||"j"===i?i:"i",e.COMPLEX(Math.log(Math.sqrt(o*o+n*n)),Math.atan(n/o),i)},e.IMLOG10=function(t){var o=e.IMREAL(t),n=e.IMAGINARY(t);if(utils.anyIsError(o,n))return error.value;var i=t.substring(t.length-1);return i="i"===i||"j"===i?i:"i",e.COMPLEX(Math.log(Math.sqrt(o*o+n*n))/Math.log(10),Math.atan(n/o)/Math.log(10),i)},e.IMLOG2=function(t){var o=e.IMREAL(t),n=e.IMAGINARY(t);if(utils.anyIsError(o,n))return error.value;var i=t.substring(t.length-1);return i="i"===i||"j"===i?i:"i",e.COMPLEX(Math.log(Math.sqrt(o*o+n*n))/Math.log(2),Math.atan(n/o)/Math.log(2),i)},e.IMPOWER=function(t,o){o=utils.parseNumber(o);var n=e.IMREAL(t),i=e.IMAGINARY(t);if(utils.anyIsError(o,n,i))return error.value;var r=t.substring(t.length-1);r="i"===r||"j"===r?r:"i";var s=Math.pow(e.IMABS(t),o),a=e.IMARGUMENT(t);return e.COMPLEX(s*Math.cos(o*a),s*Math.sin(o*a),r)},e.IMPRODUCT=function(){for(var t=arguments[0],o=1;o<arguments.length;o++){var n=e.IMREAL(t),i=e.IMAGINARY(t),r=e.IMREAL(arguments[o]),s=e.IMAGINARY(arguments[o]);if(utils.anyIsError(n,i,r,s))return error.value;t=e.COMPLEX(n*r-i*s,n*s+i*r)}return t},e.IMREAL=function(e){if(void 0===e||!0===e||!1===e)return error.value;if(0===e||"0"===e)return 0;if(["i","+i","1i","+1i","-i","-1i","j","+j","1j","+1j","-j","-1j"].indexOf(e)>=0)return 0;var t=e.indexOf("+"),o=e.indexOf("-");0===t&&(t=e.indexOf("+",1)),0===o&&(o=e.indexOf("-",1));var n=e.substring(e.length-1,e.length),i="i"===n||"j"===n;return t>=0||o>=0?i?t>=0?isNaN(e.substring(0,t))||isNaN(e.substring(t+1,e.length-1))?error.num:Number(e.substring(0,t)):isNaN(e.substring(0,o))||isNaN(e.substring(o+1,e.length-1))?error.num:Number(e.substring(0,o)):error.num:i?isNaN(e.substring(0,e.length-1))?error.num:0:isNaN(e)?error.num:e},e.IMSEC=function(t){if(!0===t||!1===t)return error.value;var o=e.IMREAL(t),n=e.IMAGINARY(t);return utils.anyIsError(o,n)?error.value:e.IMDIV("1",e.IMCOS(t))},e.IMSECH=function(t){var o=e.IMREAL(t),n=e.IMAGINARY(t);return utils.anyIsError(o,n)?error.value:e.IMDIV("1",e.IMCOSH(t))},e.IMSIN=function(t){var o=e.IMREAL(t),n=e.IMAGINARY(t);if(utils.anyIsError(o,n))return error.value;var i=t.substring(t.length-1);return i="i"===i||"j"===i?i:"i",e.COMPLEX(Math.sin(o)*(Math.exp(n)+Math.exp(-n))/2,Math.cos(o)*(Math.exp(n)-Math.exp(-n))/2,i)},e.IMSINH=function(t){var o=e.IMREAL(t),n=e.IMAGINARY(t);if(utils.anyIsError(o,n))return error.value;var i=t.substring(t.length-1);return i="i"===i||"j"===i?i:"i",e.COMPLEX(Math.cos(n)*(Math.exp(o)-Math.exp(-o))/2,Math.sin(n)*(Math.exp(o)+Math.exp(-o))/2,i)},e.IMSQRT=function(t){var o=e.IMREAL(t),n=e.IMAGINARY(t);if(utils.anyIsError(o,n))return error.value;var i=t.substring(t.length-1);i="i"===i||"j"===i?i:"i";var r=Math.sqrt(e.IMABS(t)),s=e.IMARGUMENT(t);return e.COMPLEX(r*Math.cos(s/2),r*Math.sin(s/2),i)},e.IMCSC=function(t){if(!0===t||!1===t)return error.value;var o=e.IMREAL(t),n=e.IMAGINARY(t);return utils.anyIsError(o,n)?error.num:e.IMDIV("1",e.IMSIN(t))},e.IMCSCH=function(t){if(!0===t||!1===t)return error.value;var o=e.IMREAL(t),n=e.IMAGINARY(t);return utils.anyIsError(o,n)?error.num:e.IMDIV("1",e.IMSINH(t))},e.IMSUB=function(e,t){var o=this.IMREAL(e),n=this.IMAGINARY(e),i=this.IMREAL(t),r=this.IMAGINARY(t);if(utils.anyIsError(o,n,i,r))return error.value;var s=e.substring(e.length-1),a=t.substring(t.length-1),l="i";return("j"===s||"j"===a)&&(l="j"),this.COMPLEX(o-i,n-r,l)},e.IMSUM=function(){for(var e=utils.flatten(arguments),t=e[0],o=1;o<e.length;o++){var n=this.IMREAL(t),i=this.IMAGINARY(t),r=this.IMREAL(e[o]),s=this.IMAGINARY(e[o]);if(utils.anyIsError(n,i,r,s))return error.value;t=this.COMPLEX(n+r,i+s)}return t},e.IMTAN=function(t){if(!0===t||!1===t)return error.value;var o=e.IMREAL(t),n=e.IMAGINARY(t);return utils.anyIsError(o,n)?error.value:this.IMDIV(this.IMSIN(t),this.IMCOS(t))},e.OCT2BIN=function(e,t){if(!/^[0-7]{1,10}$/.test(e))return error.num;var o=10===e.length&&"7"===e.substring(0,1),n=o?parseInt(e,8)-1073741824:parseInt(e,8);if(n<-512||n>511)return error.num;if(o)return"1"+REPT("0",9-(512+n).toString(2).length)+(512+n).toString(2);var i=n.toString(2);return void 0===t?i:isNaN(t)?error.value:t<0?error.num:(t=Math.floor(t))>=i.length?REPT("0",t-i.length)+i:error.num},e.OCT2DEC=function(e){if(!/^[0-7]{1,10}$/.test(e))return error.num;var t=parseInt(e,8);return t>=536870912?t-1073741824:t},e.OCT2HEX=function(e,t){if(!/^[0-7]{1,10}$/.test(e))return error.num;var o=parseInt(e,8);if(o>=536870912)return"ff"+(o+3221225472).toString(16);var n=o.toString(16);return void 0===t?n:isNaN(t)?error.value:t<0?error.num:(t=Math.floor(t))>=n.length?REPT("0",t-n.length)+n:error.num},e}(),jexcel.methods.financial=function(){var e={};function t(e){return e&&e.getTime&&!isNaN(e.getTime())}function o(e){return e instanceof Date?e:new Date(e)}return e.ACCRINT=function(e,n,i,r,s,a,l){return e=o(e),n=o(n),i=o(i),t(e)&&t(n)&&t(i)?r<=0||s<=0||-1===[1,2,4].indexOf(a)||-1===[0,1,2,3,4].indexOf(l)||i<=e?"#NUM!":(l=l||0,(s=s||0)*r*YEARFRAC(e,i,l)):"#VALUE!"},e.ACCRINTM=null,e.AMORDEGRC=null,e.AMORLINC=null,e.COUPDAYBS=null,e.COUPDAYS=null,e.COUPDAYSNC=null,e.COUPNCD=null,e.COUPNUM=null,e.COUPPCD=null,e.CUMIPMT=function(t,o,n,i,r,s){if(t=utils.parseNumber(t),o=utils.parseNumber(o),n=utils.parseNumber(n),utils.anyIsError(t,o,n))return error.value;if(t<=0||o<=0||n<=0)return error.num;if(i<1||r<1||i>r)return error.num;if(0!==s&&1!==s)return error.num;var a=e.PMT(t,o,n,0,s),l=0;1===i&&0===s&&(l=-n,i++);for(var u=i;u<=r;u++)l+=1===s?e.FV(t,u-2,a,n,1)-a:e.FV(t,u-1,a,n,0);return l*t},e.CUMPRINC=function(t,o,n,i,r,s){if(t=utils.parseNumber(t),o=utils.parseNumber(o),n=utils.parseNumber(n),utils.anyIsError(t,o,n))return error.value;if(t<=0||o<=0||n<=0)return error.num;if(i<1||r<1||i>r)return error.num;if(0!==s&&1!==s)return error.num;var a=e.PMT(t,o,n,0,s),l=0;1===i&&(l=0===s?a+n*t:a,i++);for(var u=i;u<=r;u++)l+=s>0?a-(e.FV(t,u-2,a,n,1)-a)*t:a-e.FV(t,u-1,a,n,0)*t;return l},e.DB=function(e,t,o,n,i){if(i=void 0===i?12:i,e=utils.parseNumber(e),t=utils.parseNumber(t),o=utils.parseNumber(o),n=utils.parseNumber(n),i=utils.parseNumber(i),utils.anyIsError(e,t,o,n,i))return error.value;if(e<0||t<0||o<0||n<0)return error.num;if(-1===[1,2,3,4,5,6,7,8,9,10,11,12].indexOf(i))return error.num;if(n>o)return error.num;if(t>=e)return 0;for(var r=(1-Math.pow(t/e,1/o)).toFixed(3),s=e*r*i/12,a=s,l=0,u=n===o?o-1:n,c=2;c<=u;c++)a+=l=(e-a)*r;return 1===n?s:n===o?(e-a)*r:l},e.DDB=function(e,t,o,n,i){if(i=void 0===i?2:i,e=utils.parseNumber(e),t=utils.parseNumber(t),o=utils.parseNumber(o),n=utils.parseNumber(n),i=utils.parseNumber(i),utils.anyIsError(e,t,o,n,i))return error.value;if(e<0||t<0||o<0||n<0||i<=0)return error.num;if(n>o)return error.num;if(t>=e)return 0;for(var r=0,s=0,a=1;a<=n;a++)r+=s=Math.min(i/o*(e-r),e-t-r);return s},e.DISC=null,e.DOLLARDE=function(e,t){if(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t))return error.value;if(t<0)return error.num;if(t>=0&&t<1)return error.div0;t=parseInt(t,10);var o=parseInt(e,10);o+=e%1*Math.pow(10,Math.ceil(Math.log(t)/Math.LN10))/t;var n=Math.pow(10,Math.ceil(Math.log(t)/Math.LN2)+1);return Math.round(o*n)/n},e.DOLLARFR=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:t<0?error.num:t>=0&&t<1?error.div0:(t=parseInt(t,10),parseInt(e,10)+e%1*Math.pow(10,-Math.ceil(Math.log(t)/Math.LN10))*t)},e.DURATION=null,e.EFFECT=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:e<=0||t<1?error.num:(t=parseInt(t,10),Math.pow(1+e/t,t)-1)},e.FV=function(e,t,o,n,i){if(n=n||0,i=i||0,e=utils.parseNumber(e),t=utils.parseNumber(t),o=utils.parseNumber(o),n=utils.parseNumber(n),i=utils.parseNumber(i),utils.anyIsError(e,t,o,n,i))return error.value;var r;if(0===e)r=n+o*t;else{var s=Math.pow(1+e,t);r=1===i?n*s+o*(1+e)*(s-1)/e:n*s+o*(s-1)/e}return-r},e.FVSCHEDULE=function(e,t){if(e=utils.parseNumber(e),t=utils.parseNumberArray(utils.flatten(t)),utils.anyIsError(e,t))return error.value;for(var o=t.length,n=e,i=0;i<o;i++)n*=1+t[i];return n},e.INTRATE=null,e.IPMT=function(t,o,n,i,r,s){if(r=r||0,s=s||0,t=utils.parseNumber(t),o=utils.parseNumber(o),n=utils.parseNumber(n),i=utils.parseNumber(i),r=utils.parseNumber(r),s=utils.parseNumber(s),utils.anyIsError(t,o,n,i,r,s))return error.value;var a=e.PMT(t,n,i,r,s);return(1===o?1===s?0:-i:1===s?e.FV(t,o-2,a,i,1)-a:e.FV(t,o-1,a,i,0))*t},e.IRR=function(e,t){if(t=t||0,e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumber(t),utils.anyIsError(e,t))return error.value;for(var o=function(e,t,o){for(var n=o+1,i=e[0],r=1;r<e.length;r++)i+=e[r]/Math.pow(n,(t[r]-t[0])/365);return i},n=function(e,t,o){for(var n=o+1,i=0,r=1;r<e.length;r++){var s=(t[r]-t[0])/365;i-=s*e[r]/Math.pow(n,s+1)}return i},i=[],r=!1,s=!1,a=0;a<e.length;a++)i[a]=0===a?0:i[a-1]+365,e[a]>0&&(r=!0),e[a]<0&&(s=!0);if(!r||!s)return error.num;var l,u,c,d=t=void 0===t?.1:t,h=!0;do{l=d-(c=o(e,i,d))/n(e,i,d),u=Math.abs(l-d),d=l,h=u>1e-10&&Math.abs(c)>1e-10}while(h);return d},e.ISPMT=function(e,t,o,n){return e=utils.parseNumber(e),t=utils.parseNumber(t),o=utils.parseNumber(o),n=utils.parseNumber(n),utils.anyIsError(e,t,o,n)?error.value:n*e*(t/o-1)},e.MDURATION=null,e.MIRR=function(t,o,n){if(t=utils.parseNumberArray(utils.flatten(t)),o=utils.parseNumber(o),n=utils.parseNumber(n),utils.anyIsError(t,o,n))return error.value;for(var i=t.length,r=[],s=[],a=0;a<i;a++)t[a]<0?r.push(t[a]):s.push(t[a]);var l=-e.NPV(n,s)*Math.pow(1+n,i-1),u=e.NPV(o,r)*(1+o);return Math.pow(l/u,1/(i-1))-1},e.NOMINAL=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:e<=0||t<1?error.num:(t=parseInt(t,10),(Math.pow(e+1,1/t)-1)*t)},e.NPER=function(e,t,o,n,i){return i=void 0===i?0:i,n=void 0===n?0:n,e=utils.parseNumber(e),t=utils.parseNumber(t),o=utils.parseNumber(o),n=utils.parseNumber(n),i=utils.parseNumber(i),utils.anyIsError(e,t,o,n,i)?error.value:Math.log((t*(1+e*i)-n*e)/(o*e+t*(1+e*i)))/Math.log(1+e)},e.NPV=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error)return e;for(var t=e[0],o=0,n=1;n<e.length;n++)o+=e[n]/Math.pow(1+t,n);return o},e.ODDFPRICE=null,e.ODDFYIELD=null,e.ODDLPRICE=null,e.ODDLYIELD=null,e.PDURATION=function(e,t,o){return e=utils.parseNumber(e),t=utils.parseNumber(t),o=utils.parseNumber(o),utils.anyIsError(e,t,o)?error.value:e<=0?error.num:(Math.log(o)-Math.log(t))/Math.log(1+e)},e.PMT=function(e,t,o,n,i){if(n=n||0,i=i||0,e=utils.parseNumber(e),t=utils.parseNumber(t),o=utils.parseNumber(o),n=utils.parseNumber(n),i=utils.parseNumber(i),utils.anyIsError(e,t,o,n,i))return error.value;var r;if(0===e)r=(o+n)/t;else{var s=Math.pow(1+e,t);r=1===i?(n*e/(s-1)+o*e/(1-1/s))/(1+e):n*e/(s-1)+o*e/(1-1/s)}return-r},e.PPMT=function(t,o,n,i,r,s){return r=r||0,s=s||0,t=utils.parseNumber(t),n=utils.parseNumber(n),i=utils.parseNumber(i),r=utils.parseNumber(r),s=utils.parseNumber(s),utils.anyIsError(t,n,i,r,s)?error.value:e.PMT(t,n,i,r,s)-e.IPMT(t,o,n,i,r,s)},e.PRICE=null,e.PRICEDISC=null,e.PRICEMAT=null,e.PV=function(e,t,o,n,i){return n=n||0,i=i||0,e=utils.parseNumber(e),t=utils.parseNumber(t),o=utils.parseNumber(o),n=utils.parseNumber(n),i=utils.parseNumber(i),utils.anyIsError(e,t,o,n,i)?error.value:0===e?-o*t-n:((1-Math.pow(1+e,t))/e*o*(1+e*i)-n)/Math.pow(1+e,t)},e.RATE=function(e,t,o,n,i,r){if(r=void 0===r?.01:r,n=void 0===n?0:n,i=void 0===i?0:i,e=utils.parseNumber(e),t=utils.parseNumber(t),o=utils.parseNumber(o),n=utils.parseNumber(n),i=utils.parseNumber(i),r=utils.parseNumber(r),utils.anyIsError(e,t,o,n,i,r))return error.value;for(var s=0,a=!1,l=r;s<100&&!a;){var u=Math.pow(l+1,e),c=Math.pow(l+1,e-1),d=l-(n+u*o+t*(u-1)*(l*i+1)/l)/(e*c*o-t*(u-1)*(l*i+1)/Math.pow(l,2)+(e*t*c*(l*i+1)/l+t*(u-1)*i/l));Math.abs(d-l)<1e-6&&(a=!0),s++,l=d}return a?l:Number.NaN+l},e.RECEIVED=null,e.RRI=function(e,t,o){return e=utils.parseNumber(e),t=utils.parseNumber(t),o=utils.parseNumber(o),utils.anyIsError(e,t,o)?error.value:0===e||0===t?error.num:Math.pow(o/t,1/e)-1},e.SLN=function(e,t,o){return e=utils.parseNumber(e),t=utils.parseNumber(t),o=utils.parseNumber(o),utils.anyIsError(e,t,o)?error.value:0===o?error.num:(e-t)/o},e.SYD=function(e,t,o,n){return e=utils.parseNumber(e),t=utils.parseNumber(t),o=utils.parseNumber(o),n=utils.parseNumber(n),utils.anyIsError(e,t,o,n)?error.value:0===o||n<1||n>o?error.num:(e-t)*(o-(n=parseInt(n,10))+1)*2/(o*(o+1))},e.TBILLEQ=function(e,t,o){return e=utils.parseDate(e),t=utils.parseDate(t),o=utils.parseNumber(o),utils.anyIsError(e,t,o)?error.value:o<=0||e>t||t-e>31536e6?error.num:365*o/(360-o*DAYS360(e,t,!1))},e.TBILLPRICE=function(e,t,o){return e=utils.parseDate(e),t=utils.parseDate(t),o=utils.parseNumber(o),utils.anyIsError(e,t,o)?error.value:o<=0||e>t||t-e>31536e6?error.num:100*(1-o*DAYS360(e,t,!1)/360)},e.TBILLYIELD=function(e,t,o){return e=utils.parseDate(e),t=utils.parseDate(t),o=utils.parseNumber(o),utils.anyIsError(e,t,o)?error.value:o<=0||e>t||t-e>31536e6?error.num:360*(100-o)/(o*DAYS360(e,t,!1))},e.VDB=null,e.XIRR=function(e,t,o){if(e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseDateArray(utils.flatten(t)),o=utils.parseNumber(o),utils.anyIsError(e,t,o))return error.value;for(var n=function(e,t,o){for(var n=o+1,i=e[0],r=1;r<e.length;r++)i+=e[r]/Math.pow(n,DAYS(t[r],t[0])/365);return i},i=function(e,t,o){for(var n=o+1,i=0,r=1;r<e.length;r++){var s=DAYS(t[r],t[0])/365;i-=s*e[r]/Math.pow(n,s+1)}return i},r=!1,s=!1,a=0;a<e.length;a++)e[a]>0&&(r=!0),e[a]<0&&(s=!0);if(!r||!s)return error.num;var l,u,c,d=o=o||.1,h=!0;do{l=d-(c=n(e,t,d))/i(e,t,d),u=Math.abs(l-d),d=l,h=u>1e-10&&Math.abs(c)>1e-10}while(h);return d},e.XNPV=function(e,t,o){if(e=utils.parseNumber(e),t=utils.parseNumberArray(utils.flatten(t)),o=utils.parseDateArray(utils.flatten(o)),utils.anyIsError(e,t,o))return error.value;for(var n=0,i=0;i<t.length;i++)n+=t[i]/Math.pow(1+e,DAYS(o[i],o[0])/365);return n},e.YIELD=null,e.YIELDDISC=null,e.YIELDMAT=null,e}(),jexcel.methods.information=function(){var e={CELL:null,ERROR:{}};return e.ERROR.TYPE=function(e){switch(e){case error.nil:return 1;case error.div0:return 2;case error.value:return 3;case error.ref:return 4;case error.name:return 5;case error.num:return 6;case error.na:return 7;case error.data:return 8}return error.na},e.INFO=null,e.ISBLANK=function(e){return null===e},e.ISBINARY=function(e){return/^[01]{1,10}$/.test(e)},e.ISERR=function(e){return[error.value,error.ref,error.div0,error.num,error.name,error.nil].indexOf(e)>=0||"number"==typeof e&&(isNaN(e)||!isFinite(e))},e.ISERROR=function(t){return e.ISERR(t)||t===error.na},e.ISEVEN=function(e){return!(1&Math.floor(Math.abs(e)))},e.ISFORMULA=null,e.ISLOGICAL=function(e){return!0===e||!1===e},e.ISNA=function(e){return e===error.na},e.ISNONTEXT=function(e){return"string"!=typeof e},e.ISNUMBER=function(e){return"number"==typeof e&&!isNaN(e)&&isFinite(e)},e.ISODD=function(e){return!!(1&Math.floor(Math.abs(e)))},e.ISREF=null,e.ISTEXT=function(e){return"string"==typeof e},e.N=function(e){return this.ISNUMBER(e)?e:e instanceof Date?e.getTime():!0===e?1:!1===e?0:this.ISERROR(e)?e:0},e.NA=function(){return error.na},e.SHEET=null,e.SHEETS=null,e.TYPE=function(e){return this.ISNUMBER(e)?1:this.ISTEXT(e)?2:this.ISLOGICAL(e)?4:this.ISERROR(e)?16:Array.isArray(e)?64:void 0},e}(),jexcel.methods.logical={AND:function(){for(var e=utils.flatten(arguments),t=!0,o=0;o<e.length;o++)e[o]||(t=!1);return t},CHOOSE:function(){if(arguments.length<2)return error.na;var e=arguments[0];return e<1||e>254||arguments.length<e+1?error.value:arguments[e]},FALSE:function(){return!1},IF:function(e,t,o){return e?t:o},IFERROR:function(e,t){return ISERROR(e)?t:e},IFNA:function(e,t){return e===error.na?t:e},NOT:function(e){return!e},OR:function(){for(var e=utils.flatten(arguments),t=!1,o=0;o<e.length;o++)e[o]&&(t=!0);return t},TRUE:function(){return!0},XOR:function(){for(var e=utils.flatten(arguments),t=0,o=0;o<e.length;o++)e[o]&&t++;return!!(1&Math.floor(Math.abs(t)))},SWITCH:function(){var e;if(arguments.length>0){var t=arguments[0],o=arguments.length-1,n=Math.floor(o/2),i=!1,r=o%2==0?null:arguments[arguments.length-1];if(n)for(var s=0;s<n;s++)if(t===arguments[2*s+1]){e=arguments[2*s+2],i=!0;break}!i&&r&&(e=r)}return e}},jexcel.methods.math=function(){var exports={ABS:function(e){return(e=utils.parseNumber(e))instanceof Error?e:Math.abs(utils.parseNumber(e))},ACOS:function(e){return(e=utils.parseNumber(e))instanceof Error?e:Math.acos(e)},ACOSH:function(e){return(e=utils.parseNumber(e))instanceof Error?e:Math.log(e+Math.sqrt(e*e-1))},ACOT:function(e){return(e=utils.parseNumber(e))instanceof Error?e:Math.atan(1/e)},ACOTH:function(e){return(e=utils.parseNumber(e))instanceof Error?e:.5*Math.log((e+1)/(e-1))},AGGREGATE:null,ARABIC:function(e){if(!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(e))return error.value;var t=0;return e.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,function(e){t+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[e]}),t},ASIN:function(e){return(e=utils.parseNumber(e))instanceof Error?e:Math.asin(e)},ASINH:function(e){return(e=utils.parseNumber(e))instanceof Error?e:Math.log(e+Math.sqrt(e*e+1))},ATAN:function(e){return(e=utils.parseNumber(e))instanceof Error?e:Math.atan(e)},ATAN2:function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:Math.atan2(e,t)},ATANH:function(e){return(e=utils.parseNumber(e))instanceof Error?e:Math.log((1+e)/(1-e))/2},BASE:function(e,t,o){if(o=o||0,e=utils.parseNumber(e),t=utils.parseNumber(t),o=utils.parseNumber(o),utils.anyIsError(e,t,o))return error.value;o=void 0===o?0:o;var n=e.toString(t);return new Array(Math.max(o+1-n.length,0)).join("0")+n},CEILING:function(e,t,o){return t=void 0===t?1:t,o=void 0===o?0:o,e=utils.parseNumber(e),t=utils.parseNumber(t),o=utils.parseNumber(o),utils.anyIsError(e,t,o)?error.value:0===t?0:(t=Math.abs(t),e>=0?Math.ceil(e/t)*t:0===o?-1*Math.floor(Math.abs(e)/t)*t:-1*Math.ceil(Math.abs(e)/t)*t)}};exports.CEILING.MATH=exports.CEILING,exports.CEILING.PRECISE=exports.CEILING,exports.COMBIN=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:exports.FACT(e)/(exports.FACT(t)*exports.FACT(e-t))},exports.COMBINA=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:0===e&&0===t?1:exports.COMBIN(e+t-1,e-1)},exports.COS=function(e){return(e=utils.parseNumber(e))instanceof Error?e:Math.cos(e)},exports.COSH=function(e){return(e=utils.parseNumber(e))instanceof Error?e:(Math.exp(e)+Math.exp(-e))/2},exports.COT=function(e){return(e=utils.parseNumber(e))instanceof Error?e:1/Math.tan(e)},exports.COTH=function(e){if((e=utils.parseNumber(e))instanceof Error)return e;var t=Math.exp(2*e);return(t+1)/(t-1)},exports.CSC=function(e){return(e=utils.parseNumber(e))instanceof Error?e:1/Math.sin(e)},exports.CSCH=function(e){return(e=utils.parseNumber(e))instanceof Error?e:2/(Math.exp(e)-Math.exp(-e))},exports.DECIMAL=function(e,t){return arguments.length<1?error.value:parseInt(e,t)},exports.DEGREES=function(e){return(e=utils.parseNumber(e))instanceof Error?e:180*e/Math.PI},exports.EVEN=function(e){return(e=utils.parseNumber(e))instanceof Error?e:exports.CEILING(e,-2,-1)},exports.EXP=Math.exp;var MEMOIZED_FACT=[];return exports.FACT=function(e){if((e=utils.parseNumber(e))instanceof Error)return e;var t=Math.floor(e);return 0===t||1===t?1:(MEMOIZED_FACT[t]>0||(MEMOIZED_FACT[t]=exports.FACT(t-1)*t),MEMOIZED_FACT[t])},exports.FACTDOUBLE=function(e){if((e=utils.parseNumber(e))instanceof Error)return e;var t=Math.floor(e);return t<=0?1:t*exports.FACTDOUBLE(t-2)},exports.FLOOR=function(e,t,o){return t=void 0===t?1:t,o=void 0===o?0:o,e=utils.parseNumber(e),t=utils.parseNumber(t),o=utils.parseNumber(o),utils.anyIsError(e,t,o)?error.value:0===t?0:(t=Math.abs(t),e>=0?Math.floor(e/t)*t:0===o?-1*Math.ceil(Math.abs(e)/t)*t:-1*Math.floor(Math.abs(e)/t)*t)},exports.FLOOR.MATH=exports.FLOOR,exports.GCD=null,exports.INT=function(e){return(e=utils.parseNumber(e))instanceof Error?e:Math.floor(e)},exports.LCM=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error)return e;for(var t,o,n,i,r=1;void 0!==(n=e.pop());)for(;n>1;){if(n%2){for(t=3,o=Math.floor(Math.sqrt(n));t<=o&&n%t;t+=2);i=t<=o?t:n}else i=2;for(n/=i,r*=i,t=e.length;t;e[--t]%i==0&&1==(e[t]/=i)&&e.splice(t,1));}return r},exports.LN=function(e){return(e=utils.parseNumber(e))instanceof Error?e:Math.log(e)},exports.LOG=function(e,t){return e=utils.parseNumber(e),t=void 0===t?10:utils.parseNumber(t),utils.anyIsError(e,t)?error.value:Math.log(e)/Math.log(t)},exports.LOG10=function(e){return(e=utils.parseNumber(e))instanceof Error?e:Math.log(e)/Math.log(10)},exports.MDETERM=null,exports.MINVERSE=null,exports.MMULT=null,exports.MOD=function(e,t){if(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t))return error.value;if(0===t)return error.div0;var o=Math.abs(e%t);return t>0?o:-o},exports.MROUND=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:e*t<0?error.num:Math.round(e/t)*t},exports.MULTINOMIAL=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error)return e;for(var t=0,o=1,n=0;n<e.length;n++)t+=e[n],o*=exports.FACT(e[n]);return exports.FACT(t)/o},exports.MUNIT=null,exports.ODD=function(e){if((e=utils.parseNumber(e))instanceof Error)return e;var t=Math.ceil(Math.abs(e));return t=1&t?t:t+1,e>0?t:-t},exports.PI=function(){return Math.PI},exports.POWER=function(e,t){if(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t))return error.value;var o=Math.pow(e,t);return isNaN(o)?error.num:o},exports.PRODUCT=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error)return e;for(var t=1,o=0;o<e.length;o++)t*=e[o];return t},exports.QUOTIENT=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:parseInt(e/t,10)},exports.RADIANS=function(e){return(e=utils.parseNumber(e))instanceof Error?e:e*Math.PI/180},exports.RAND=function(){return Math.random()},exports.RANDBETWEEN=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:e+Math.ceil((t-e+1)*Math.random())-1},exports.ROMAN=null,exports.ROUND=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:Math.round(e*Math.pow(10,t))/Math.pow(10,t)},exports.ROUNDDOWN=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:(e>0?1:-1)*Math.floor(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},exports.ROUNDUP=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:(e>0?1:-1)*Math.ceil(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},exports.SEC=function(e){return(e=utils.parseNumber(e))instanceof Error?e:1/Math.cos(e)},exports.SECH=function(e){return(e=utils.parseNumber(e))instanceof Error?e:2/(Math.exp(e)+Math.exp(-e))},exports.SERIESSUM=function(e,t,o,n){if(e=utils.parseNumber(e),t=utils.parseNumber(t),o=utils.parseNumber(o),n=utils.parseNumberArray(n),utils.anyIsError(e,t,o,n))return error.value;for(var i=n[0]*Math.pow(e,t),r=1;r<n.length;r++)i+=n[r]*Math.pow(e,t+r*o);return i},exports.SIGN=function(e){return(e=utils.parseNumber(e))instanceof Error?e:e<0?-1:0===e?0:1},exports.SIN=function(e){return(e=utils.parseNumber(e))instanceof Error?e:Math.sin(e)},exports.SINH=function(e){return(e=utils.parseNumber(e))instanceof Error?e:(Math.exp(e)-Math.exp(-e))/2},exports.SQRT=function(e){return(e=utils.parseNumber(e))instanceof Error?e:e<0?error.num:Math.sqrt(e)},exports.SQRTPI=function(e){return(e=utils.parseNumber(e))instanceof Error?e:Math.sqrt(e*Math.PI)},exports.SUBTOTAL=null,exports.ADD=function(e,t){return 2!==arguments.length?error.na:(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:e+t)},exports.MINUS=function(e,t){return 2!==arguments.length?error.na:(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:e-t)},exports.DIVIDE=function(e,t){return 2!==arguments.length?error.na:(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:0===t?error.div0:e/t)},exports.MULTIPLY=function(e,t){return 2!==arguments.length?error.na:(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:e*t)},exports.GTE=function(e,t){return 2!==arguments.length?error.na:(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.error:e>=t)},exports.LT=function(e,t){return 2!==arguments.length?error.na:(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.error:e<t)},exports.LTE=function(e,t){return 2!==arguments.length?error.na:(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.error:e<=t)},exports.EQ=function(e,t){return 2!==arguments.length?error.na:e===t},exports.NE=function(e,t){return 2!==arguments.length?error.na:e!==t},exports.POW=function(e,t){return 2!==arguments.length?error.na:(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.error:exports.POWER(e,t))},exports.SUM=function(){for(var e=0,t=Object.keys(arguments),o=0;o<t.length;++o){var n=arguments[t[o]];if("number"==typeof n)e+=n;else if("string"==typeof n){var i=parseFloat(n);!isNaN(i)&&(e+=i)}else Array.isArray(n)&&(e+=exports.SUM.apply(null,n))}return e},exports.SUMIF=function(range,criteria){if(range=utils.parseNumberArray(utils.flatten(range)),range instanceof Error)return range;for(var result=0,i=0;i<range.length;i++)result+=eval(range[i]+criteria)?range[i]:0;return result},exports.SUMIFS=function(){var args=utils.argsToArray(arguments),range=utils.parseNumberArray(utils.flatten(args.shift()));if(range instanceof Error)return range;for(var criteria=args,n_range_elements=range.length,n_criterias=criteria.length,result=0,i=0;i<n_range_elements;i++){for(var el=range[i],condition="",c=0;c<n_criterias;c++)condition+=el+criteria[c],c!==n_criterias-1&&(condition+="&&");eval(condition)&&(result+=el)}return result},exports.SUMPRODUCT=null,exports.SUMSQ=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error)return e;for(var t=0,o=e.length,n=0;n<o;n++)t+=ISNUMBER(e[n])?e[n]*e[n]:0;return t},exports.SUMX2MY2=function(e,t){if(e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumberArray(utils.flatten(t)),utils.anyIsError(e,t))return error.value;for(var o=0,n=0;n<e.length;n++)o+=e[n]*e[n]-t[n]*t[n];return o},exports.SUMX2PY2=function(e,t){if(e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumberArray(utils.flatten(t)),utils.anyIsError(e,t))return error.value;var o=0;e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumberArray(utils.flatten(t));for(var n=0;n<e.length;n++)o+=e[n]*e[n]+t[n]*t[n];return o},exports.SUMXMY2=function(e,t){if(e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumberArray(utils.flatten(t)),utils.anyIsError(e,t))return error.value;var o=0;e=utils.flatten(e),t=utils.flatten(t);for(var n=0;n<e.length;n++)o+=Math.pow(e[n]-t[n],2);return o},exports.TAN=function(e){return(e=utils.parseNumber(e))instanceof Error?e:Math.tan(e)},exports.TANH=function(e){if((e=utils.parseNumber(e))instanceof Error)return e;var t=Math.exp(2*e);return(t-1)/(t+1)},exports.TRUNC=function(e,t){return t=void 0===t?0:t,e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:(e>0?1:-1)*Math.floor(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},exports}(),jexcel.methods.misc=function(){var e={UNIQUE:function(){for(var e=[],t=0;t<arguments.length;++t){for(var o=!1,n=arguments[t],i=0;i<e.length&&!(o=e[i]===n);++i);o||e.push(n)}return e}};return e.FLATTEN=utils.flatten,e.ARGS2ARRAY=function(){return Array.prototype.slice.call(arguments,0)},e.REFERENCE=function(e,t){try{for(var o=t.split("."),n=e,i=0;i<o.length;++i){var r=o[i];if("]"===r[r.length-1]){var s=r.indexOf("["),a=r.substring(s+1,r.length-1);n=n[r.substring(0,s)][a]}else n=n[r]}return n}catch(error){}},e.JOIN=function(e,t){return e.join(t)},e.NUMBERS=function(){var e=utils.flatten(arguments);return e.filter(function(e){return"number"==typeof e})},e.NUMERAL=null,e}(),jexcel.methods.text=function(){var e={ASC:null,BAHTTEXT:null,CHAR:function(e){return(e=utils.parseNumber(e))instanceof Error?e:String.fromCharCode(e)},CLEAN:function(e){return(e=e||"").replace(/[\0-\x1F]/g,"")},CODE:function(e){return(e=e||"").charCodeAt(0)},CONCATENATE:function(){for(var e=utils.flatten(arguments),t=0;(t=e.indexOf(!0))>-1;)e[t]="TRUE";for(var o=0;(o=e.indexOf(!1))>-1;)e[o]="FALSE";return e.join("")},DBCS:null,DOLLAR:null,EXACT:function(e,t){return e===t},FIND:function(e,t,o){return o=void 0===o?0:o,t?t.indexOf(e,o-1)+1:null},FIXED:null,HTML2TEXT:function(e){var t="";return e&&(e instanceof Array?e.forEach(function(e){""!==t&&(t+="\n"),t+=e.replace(/<(?:.|\n)*?>/gm,"")}):t=e.replace(/<(?:.|\n)*?>/gm,"")),t},LEFT:function(e,t){return(t=utils.parseNumber(t=void 0===t?1:t))instanceof Error||"string"!=typeof e?error.value:e?e.substring(0,t):null},LEN:function(e){return 0===arguments.length?error.error:"string"==typeof e?e?e.length:0:e.length?e.length:error.value},LOWER:function(e){return"string"!=typeof e?error.value:e?e.toLowerCase():e},MID:function(e,t,o){if(t=utils.parseNumber(t),o=utils.parseNumber(o),utils.anyIsError(t,o)||"string"!=typeof e)return o;var n=t-1;return e.substring(n,n+o)},NUMBERVALUE:null,PRONETIC:null,PROPER:function(e){return void 0===e||0===e.length?error.value:(!0===e&&(e="TRUE"),!1===e&&(e="FALSE"),isNaN(e)&&"number"==typeof e?error.value:("number"==typeof e&&(e=""+e),e.replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()})))},REGEXEXTRACT:function(e,t){var o=e.match(new RegExp(t));return o?o[o.length>1?o.length-1:0]:null},REGEXMATCH:function(e,t,o){var n=e.match(new RegExp(t));return o?n:!!n},REGEXREPLACE:function(e,t,o){return e.replace(new RegExp(t),o)},REPLACE:function(e,t,o,n){return t=utils.parseNumber(t),o=utils.parseNumber(o),utils.anyIsError(t,o)||"string"!=typeof e||"string"!=typeof n?error.value:e.substr(0,t-1)+n+e.substr(t-1+o)},REPT:function(e,t){return(t=utils.parseNumber(t))instanceof Error?t:new Array(t+1).join(e)},RIGHT:function(e,t){return(t=utils.parseNumber(t=void 0===t?1:t))instanceof Error?t:e?e.substring(e.length-t):null},SEARCH:function(e,t,o){var n;return"string"!=typeof e||"string"!=typeof t?error.value:(o=void 0===o?0:o,0===(n=t.toLowerCase().indexOf(e.toLowerCase(),o-1)+1)?error.value:n)},SPLIT:function(e,t){return e.split(t)},SUBSTITUTE:function(e,t,o,n){if(!(e&&t&&o))return e;if(void 0===n)return e.replace(new RegExp(t,"g"),o);for(var i=0,r=0;e.indexOf(t,i)>0;)if(i=e.indexOf(t,i+1),++r===n)return e.substring(0,i)+o+e.substring(i+t.length)},T:function(e){return"string"==typeof e?e:""},TEXT:null,TRIM:function(e){return"string"!=typeof e?error.value:e.replace(/ +/g," ").trim()}};return e.UNICHAR=e.CHAR,e.UNICODE=e.CODE,e.UPPER=function(e){return"string"!=typeof e?error.value:e.toUpperCase()},e.VALUE=null,e}(),jexcel.methods.stats=function(){var exports={},SQRT2PI=2.5066282746310002;return exports.AVEDEV=null,exports.AVERAGE=function(){for(var e=utils.numbers(utils.flatten(arguments)),t=e.length,o=0,n=0,i=0;i<t;i++)o+=e[i],n+=1;return o/n},exports.AVERAGEA=function(){for(var e=utils.flatten(arguments),t=e.length,o=0,n=0,i=0;i<t;i++){var r=e[i];"number"==typeof r&&(o+=r),!0===r&&o++,null!==r&&n++}return o/n},exports.AVERAGEIF=function(range,criteria,average_range){if(average_range=average_range||range,range=utils.flatten(range),average_range=utils.parseNumberArray(utils.flatten(average_range)),average_range instanceof Error)return average_range;for(var average_count=0,result=0,i=0;i<range.length;i++)eval(range[i]+criteria)&&(result+=average_range[i],average_count++);return result/average_count},exports.AVERAGEIFS=null,exports.COUNT=function(){return utils.numbers(utils.flatten(arguments)).length},exports.COUNTA=function(){var e=utils.flatten(arguments);return e.length-exports.COUNTBLANK(e)},exports.COUNTIN=function(e,t){for(var o=0,n=0;n<e.length;n++)e[n]===t&&o++;return o},exports.COUNTBLANK=function(){for(var e,t=utils.flatten(arguments),o=0,n=0;n<t.length;n++)null!==(e=t[n])&&""!==e||o++;return o},exports.COUNTIF=function(range,criteria){range=utils.flatten(range),/[<>=!]/.test(criteria)||(criteria='=="'+criteria+'"');for(var matches=0,i=0;i<range.length;i++)"string"!=typeof range[i]?eval(range[i]+criteria)&&matches++:eval('"'+range[i]+'"'+criteria)&&matches++;return matches},exports.COUNTIFS=function(){for(var args=utils.argsToArray(arguments),results=new Array(utils.flatten(args[0]).length),i=0;i<results.length;i++)results[i]=!0;for(i=0;i<args.length;i+=2){var range=utils.flatten(args[i]),criteria=args[i+1];/[<>=!]/.test(criteria)||(criteria='=="'+criteria+'"');for(var j=0;j<range.length;j++)results[j]="string"!=typeof range[j]?results[j]&&eval(range[j]+criteria):results[j]&&eval('"'+range[j]+'"'+criteria)}var result=0;for(i=0;i<results.length;i++)results[i]&&result++;return result},exports.COUNTUNIQUE=function(){return UNIQUE.apply(null,utils.flatten(arguments)).length},exports.FISHER=function(e){return(e=utils.parseNumber(e))instanceof Error?e:Math.log((1+e)/(1-e))/2},exports.FISHERINV=function(e){if((e=utils.parseNumber(e))instanceof Error)return e;var t=Math.exp(2*e);return(t-1)/(t+1)},exports.FREQUENCY=function(e,t){if(e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumberArray(utils.flatten(t)),utils.anyIsError(e,t))return error.value;for(var o=e.length,n=t.length,i=[],r=0;r<=n;r++){i[r]=0;for(var s=0;s<o;s++)0===r?e[s]<=t[0]&&(i[0]+=1):r<n?e[s]>t[r-1]&&e[s]<=t[r]&&(i[r]+=1):r===n&&e[s]>t[n-1]&&(i[n]+=1)}return i},exports.LARGE=function(e,t){return e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumber(t),utils.anyIsError(e,t)?e:e.sort(function(e,t){return t-e})[t-1]},exports.MAX=function(){var e=utils.numbers(utils.flatten(arguments));return 0===e.length?0:Math.max.apply(Math,e)},exports.MAXA=function(){var e=utils.arrayValuesToNumbers(utils.flatten(arguments));return 0===e.length?0:Math.max.apply(Math,e)},exports.MIN=function(){var e=utils.numbers(utils.flatten(arguments));return 0===e.length?0:Math.min.apply(Math,e)},exports.MINA=function(){var e=utils.arrayValuesToNumbers(utils.flatten(arguments));return 0===e.length?0:Math.min.apply(Math,e)},exports.MODE={},exports.MODE.MULT=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error)return e;for(var t,o=e.length,n={},i=[],r=0,s=0;s<o;s++)n[t=e[s]]=n[t]?n[t]+1:1,n[t]>r&&(r=n[t],i=[]),n[t]===r&&(i[i.length]=t);return i},exports.MODE.SNGL=function(){var e=utils.parseNumberArray(utils.flatten(arguments));return e instanceof Error?e:exports.MODE.MULT(e).sort(function(e,t){return e-t})[0]},exports.PERCENTILE={},exports.PERCENTILE.EXC=function(e,t){if(e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumber(t),utils.anyIsError(e,t))return error.value;var o=(e=e.sort(function(e,t){return e-t})).length;if(t<1/(o+1)||t>1-1/(o+1))return error.num;var n=t*(o+1)-1,i=Math.floor(n);return utils.cleanFloat(n===i?e[n]:e[i]+(n-i)*(e[i+1]-e[i]))},exports.PERCENTILE.INC=function(e,t){if(e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumber(t),utils.anyIsError(e,t))return error.value;var o=t*((e=e.sort(function(e,t){return e-t})).length-1),n=Math.floor(o);return utils.cleanFloat(o===n?e[o]:e[n]+(o-n)*(e[n+1]-e[n]))},exports.PERCENTRANK={},exports.PERCENTRANK.EXC=function(e,t,o){if(o=void 0===o?3:o,e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumber(t),o=utils.parseNumber(o),utils.anyIsError(e,t,o))return error.value;e=e.sort(function(e,t){return e-t});for(var n=UNIQUE.apply(null,e),i=e.length,r=n.length,s=Math.pow(10,o),a=0,l=!1,u=0;!l&&u<r;)t===n[u]?(a=(e.indexOf(n[u])+1)/(i+1),l=!0):t>=n[u]&&(t<n[u+1]||u===r-1)&&(a=(e.indexOf(n[u])+1+(t-n[u])/(n[u+1]-n[u]))/(i+1),l=!0),u++;return Math.floor(a*s)/s},exports.PERCENTRANK.INC=function(e,t,o){if(o=void 0===o?3:o,e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumber(t),o=utils.parseNumber(o),utils.anyIsError(e,t,o))return error.value;e=e.sort(function(e,t){return e-t});for(var n=UNIQUE.apply(null,e),i=e.length,r=n.length,s=Math.pow(10,o),a=0,l=!1,u=0;!l&&u<r;)t===n[u]?(a=e.indexOf(n[u])/(i-1),l=!0):t>=n[u]&&(t<n[u+1]||u===r-1)&&(a=(e.indexOf(n[u])+(t-n[u])/(n[u+1]-n[u]))/(i-1),l=!0),u++;return Math.floor(a*s)/s},exports.PERMUT=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:FACT(e)/FACT(e-t)},exports.PERMUTATIONA=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:Math.pow(e,t)},exports.PHI=function(e){return(e=utils.parseNumber(e))instanceof Error?error.value:Math.exp(-.5*e*e)/SQRT2PI},exports.PROB=function(e,t,o,n){if(void 0===o)return 0;if(n=void 0===n?o:n,e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumberArray(utils.flatten(t)),o=utils.parseNumber(o),n=utils.parseNumber(n),utils.anyIsError(e,t,o,n))return error.value;if(o===n)return e.indexOf(o)>=0?t[e.indexOf(o)]:0;for(var i=e.sort(function(e,t){return e-t}),r=i.length,s=0,a=0;a<r;a++)i[a]>=o&&i[a]<=n&&(s+=t[e.indexOf(i[a])]);return s},exports.QUARTILE={},exports.QUARTILE.EXC=function(e,t){if(e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumber(t),utils.anyIsError(e,t))return error.value;switch(t){case 1:return exports.PERCENTILE.EXC(e,.25);case 2:return exports.PERCENTILE.EXC(e,.5);case 3:return exports.PERCENTILE.EXC(e,.75);default:return error.num}},exports.QUARTILE.INC=function(e,t){if(e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumber(t),utils.anyIsError(e,t))return error.value;switch(t){case 1:return exports.PERCENTILE.INC(e,.25);case 2:return exports.PERCENTILE.INC(e,.5);case 3:return exports.PERCENTILE.INC(e,.75);default:return error.num}},exports.RANK={},exports.RANK.AVG=function(e,t,o){if(e=utils.parseNumber(e),t=utils.parseNumberArray(utils.flatten(t)),utils.anyIsError(e,t))return error.value;for(var n=(t=(t=utils.flatten(t)).sort((o=o||!1)?function(e,t){return e-t}:function(e,t){return t-e})).length,i=0,r=0;r<n;r++)t[r]===e&&i++;return i>1?(2*t.indexOf(e)+i+1)/2:t.indexOf(e)+1},exports.RANK.EQ=function(e,t,o){return e=utils.parseNumber(e),t=utils.parseNumberArray(utils.flatten(t)),utils.anyIsError(e,t)?error.value:(t=t.sort((o=o||!1)?function(e,t){return e-t}:function(e,t){return t-e})).indexOf(e)+1},exports.RSQ=function(e,t){return e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumberArray(utils.flatten(t)),utils.anyIsError(e,t)?error.value:Math.pow(exports.PEARSON(e,t),2)},exports.SMALL=function(e,t){return e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumber(t),utils.anyIsError(e,t)?e:e.sort(function(e,t){return e-t})[t-1]},exports.STANDARDIZE=function(e,t,o){return e=utils.parseNumber(e),t=utils.parseNumber(t),o=utils.parseNumber(o),utils.anyIsError(e,t,o)?error.value:(e-t)/o},exports.STDEV={},exports.STDEV.P=function(){var e=exports.VAR.P.apply(this,arguments);return Math.sqrt(e)},exports.STDEV.S=function(){var e=exports.VAR.S.apply(this,arguments);return Math.sqrt(e)},exports.STDEVA=function(){var e=exports.VARA.apply(this,arguments);return Math.sqrt(e)},exports.STDEVPA=function(){var e=exports.VARPA.apply(this,arguments);return Math.sqrt(e)},exports.VAR={},exports.VAR.P=function(){for(var e=utils.numbers(utils.flatten(arguments)),t=e.length,o=0,n=exports.AVERAGE(e),i=0;i<t;i++)o+=Math.pow(e[i]-n,2);return o/t},exports.VAR.S=function(){for(var e=utils.numbers(utils.flatten(arguments)),t=e.length,o=0,n=exports.AVERAGE(e),i=0;i<t;i++)o+=Math.pow(e[i]-n,2);return o/(t-1)},exports.VARA=function(){for(var e=utils.flatten(arguments),t=e.length,o=0,n=0,i=exports.AVERAGEA(e),r=0;r<t;r++){var s=e[r];o+="number"==typeof s?Math.pow(s-i,2):!0===s?Math.pow(1-i,2):Math.pow(0-i,2),null!==s&&n++}return o/(n-1)},exports.VARPA=function(){for(var e=utils.flatten(arguments),t=e.length,o=0,n=0,i=exports.AVERAGEA(e),r=0;r<t;r++){var s=e[r];o+="number"==typeof s?Math.pow(s-i,2):!0===s?Math.pow(1-i,2):Math.pow(0-i,2),null!==s&&n++}return o/n},exports.WEIBULL={},exports.WEIBULL.DIST=function(e,t,o,n){return e=utils.parseNumber(e),t=utils.parseNumber(t),o=utils.parseNumber(o),utils.anyIsError(e,t,o)?error.value:n?1-Math.exp(-Math.pow(e/o,t)):Math.pow(e,t-1)*Math.exp(-Math.pow(e/o,t))*t/Math.pow(o,t)},exports.Z={},exports.Z.TEST=function(e,t,o){if(e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumber(t),utils.anyIsError(e,t))return error.value;o=o||exports.STDEV.S(e);var n=e.length;return 1-exports.NORM.S.DIST((exports.AVERAGE(e)-t)/(o/Math.sqrt(n)),!0)},exports}(),jexcel.methods.utils={PROGRESS:function(e,t){return'<div style="width:'+(e||"0")+"%;height:4px;background-color:"+(t||"red")+';margin-top:1px;"></div>'},RATING:function(e){for(var t='<div class="jrating">',o=0;o<5;o++)t+=o<e?'<div class="jrating-selected"></div>':"<div></div>";return t+"</div>"}};for(var i=0;i<Object.keys(jexcel.methods).length;i++)for(var methods=jexcel.methods[Object.keys(jexcel.methods)[i]],j=0;j<Object.keys(methods).length;j++)"function"==typeof methods[Object.keys(methods)[j]]?window[Object.keys(methods)[j]]=methods[Object.keys(methods)[j]]:window[Object.keys(methods)[j]]=function(){return Object.keys(methods)[j]+"Not implemented"};return jexcel}),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).vis=e.vis||{})}(this,function(e){"use strict";var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function o(e,t){return e(t={exports:{}},t.exports),t.exports}var n=function(e){return e&&e.Math==Math&&e},i=n("object"==typeof globalThis&&globalThis)||n("object"==typeof window&&window)||n("object"==typeof self&&self)||n("object"==typeof t&&t)||function(){return this}()||Function("return this")(),r=function(e){try{return!!e()}catch(e){return!0}},s=!r(function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}),a={}.propertyIsEnumerable,l=Object.getOwnPropertyDescriptor,u={f:l&&!a.call({1:2},1)?function(e){var t=l(this,e);return!!t&&t.enumerable}:a},c=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},d={}.toString,h=function(e){return d.call(e).slice(8,-1)},p="".split,f=r(function(){return!Object("z").propertyIsEnumerable(0)})?function(e){return"String"==h(e)?p.call(e,""):Object(e)}:Object,v=function(e){if(null==e)throw TypeError("Can't call method on "+e);return e},g=function(e){return f(v(e))},b=function(e){return"object"==typeof e?null!==e:"function"==typeof e},m=function(e,t){if(!b(e))return e;var o,n;if(t&&"function"==typeof(o=e.toString)&&!b(n=o.call(e)))return n;if("function"==typeof(o=e.valueOf)&&!b(n=o.call(e)))return n;if(!t&&"function"==typeof(o=e.toString)&&!b(n=o.call(e)))return n;throw TypeError("Can't convert object to primitive value")},y={}.hasOwnProperty,j=function(e,t){return y.call(e,t)},w=i.document,x=b(w)&&b(w.createElement),C=function(e){return x?w.createElement(e):{}},E=!s&&!r(function(){return 7!=Object.defineProperty(C("div"),"a",{get:function(){return 7}}).a}),k=Object.getOwnPropertyDescriptor,_={f:s?k:function(e,t){if(e=g(e),t=m(t,!0),E)try{return k(e,t)}catch(e){}if(j(e,t))return c(!u.f.call(e,t),e[t])}},A=/#|\.prototype\./,O=function(e,t){var o=I[M(e)];return o==S||o!=N&&("function"==typeof t?r(t):!!t)},M=O.normalize=function(e){return String(e).replace(A,".").toLowerCase()},I=O.data={},N=O.NATIVE="N",S=O.POLYFILL="P",T=O,D={},L=function(e){if("function"!=typeof e)throw TypeError(String(e)+" is not a function");return e},F=function(e,t,o){if(L(e),void 0===t)return e;switch(o){case 0:return function(){return e.call(t)};case 1:return function(o){return e.call(t,o)};case 2:return function(o,n){return e.call(t,o,n)};case 3:return function(o,n,i){return e.call(t,o,n,i)}}return function(){return e.apply(t,arguments)}},R=function(e){if(!b(e))throw TypeError(String(e)+" is not an object");return e},P=Object.defineProperty,B={f:s?P:function(e,t,o){if(R(e),t=m(t,!0),R(o),E)try{return P(e,t,o)}catch(e){}if("get"in o||"set"in o)throw TypeError("Accessors not supported");return"value"in o&&(e[t]=o.value),e}},z=s?function(e,t,o){return B.f(e,t,c(1,o))}:function(e,t,o){return e[t]=o,e},H=_.f,W=function(e){var t=function(t,o,n){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,o)}return new e(t,o,n)}return e.apply(this,arguments)};return t.prototype=e.prototype,t},V=function(e,t){var o,n,r,s,a,l,u,c,d=e.target,h=e.global,p=e.stat,f=e.proto,v=h?i:p?i[d]:(i[d]||{}).prototype,g=h?D:D[d]||(D[d]={}),b=g.prototype;for(r in t)o=!T(h?r:d+(p?".":"#")+r,e.forced)&&v&&j(v,r),a=g[r],o&&(l=e.noTargetGet?(c=H(v,r))&&c.value:v[r]),s=o&&l?l:t[r],o&&typeof a==typeof s||(u=e.bind&&o?F(s,i):e.wrap&&o?W(s):f&&"function"==typeof s?F(Function.call,s):s,(e.sham||s&&s.sham||a&&a.sham)&&z(u,"sham",!0),g[r]=u,f&&(j(D,n=d+"Prototype")||z(D,n,{}),D[n][r]=s,e.real&&b&&!b[r]&&z(b,r,s)))},U=[].slice,Y={},q=function(e,t,o){if(!(t in Y)){for(var n=[],i=0;i<t;i++)n[i]="a["+i+"]";Y[t]=Function("C,a","return new C("+n.join(",")+")")}return Y[t](e,o)},X=Function.bind||function(e){var t=L(this),o=U.call(arguments,1),n=function(){var i=o.concat(U.call(arguments));return this instanceof n?q(t,i.length,i):t.apply(e,i)};return b(t.prototype)&&(n.prototype=t.prototype),n};V({target:"Function",proto:!0},{bind:X});var G=function(e){return D[e+"Prototype"]},K=G("Function").bind,J=Function.prototype,$=function(e){var t=e.bind;return e===J||e instanceof Function&&t===J.bind?K:t},Q=Math.ceil,Z=Math.floor,ee=function(e){return isNaN(e=+e)?0:(e>0?Z:Q)(e)},te=Math.min,oe=function(e){return e>0?te(ee(e),9007199254740991):0},ne=Math.max,ie=Math.min,re=function(e,t){var o=ee(e);return o<0?ne(o+t,0):ie(o,t)},se=function(e){return function(t,o,n){var i,r=g(t),s=oe(r.length),a=re(n,s);if(e&&o!=o){for(;s>a;)if((i=r[a++])!=i)return!0}else for(;s>a;a++)if((e||a in r)&&r[a]===o)return e||a||0;return!e&&-1}},ae={includes:se(!0),indexOf:se(!1)},le={},ue=ae.indexOf,ce=function(e,t){var o,n=g(e),i=0,r=[];for(o in n)!j(le,o)&&j(n,o)&&r.push(o);for(;t.length>i;)j(n,o=t[i++])&&(~ue(r,o)||r.push(o));return r},de=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],he=Object.keys||function(e){return ce(e,de)},pe={f:Object.getOwnPropertySymbols},fe=function(e){return Object(v(e))},ve=Object.assign,ge=Object.defineProperty,be=!ve||r(function(){if(s&&1!==ve({b:1},ve(ge({},"a",{enumerable:!0,get:function(){ge(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},t={},o=Symbol(),n="abcdefghijklmnopqrst";return e[o]=7,n.split("").forEach(function(e){t[e]=e}),7!=ve({},e)[o]||he(ve({},t)).join("")!=n})?function(e,t){for(var o=fe(e),n=arguments.length,i=1,r=pe.f,a=u.f;n>i;)for(var l,c=f(arguments[i++]),d=r?he(c).concat(r(c)):he(c),h=d.length,p=0;h>p;)l=d[p++],s&&!a.call(c,l)||(o[l]=c[l]);return o}:ve;V({target:"Object",stat:!0,forced:Object.assign!==be},{assign:be});var me=D.Object.assign;function ye(e,t,o,n){e.beginPath(),e.arc(t,o,n,0,2*Math.PI,!1),e.closePath()}function je(e,t,o,n,i,r){var s=Math.PI/180;n-2*r<0&&(r=n/2),i-2*r<0&&(r=i/2),e.beginPath(),e.moveTo(t+r,o),e.lineTo(t+n-r,o),e.arc(t+n-r,o+r,r,270*s,360*s,!1),e.lineTo(t+n,o+i-r),e.arc(t+n-r,o+i-r,r,0,90*s,!1),e.lineTo(t+r,o+i),e.arc(t+r,o+i-r,r,90*s,180*s,!1),e.lineTo(t,o+r),e.arc(t+r,o+r,r,180*s,270*s,!1),e.closePath()}function we(e,t,o,n,i){var r=.5522848,s=n/2*r,a=i/2*r,l=t+n,u=o+i,c=t+n/2,d=o+i/2;e.beginPath(),e.moveTo(t,d),e.bezierCurveTo(t,d-a,c-s,o,c,o),e.bezierCurveTo(c+s,o,l,d-a,l,d),e.bezierCurveTo(l,d+a,c+s,u,c,u),e.bezierCurveTo(c-s,u,t,d+a,t,d),e.closePath()}function xe(e,t,o,n,i){var r=i*(1/3),s=.5522848,a=n/2*s,l=r/2*s,u=t+n,c=o+r,d=t+n/2,h=o+r/2,p=o+(i-r/2),f=o+i;e.beginPath(),e.moveTo(u,h),e.bezierCurveTo(u,h+l,d+a,c,d,c),e.bezierCurveTo(d-a,c,t,h+l,t,h),e.bezierCurveTo(t,h-l,d-a,o,d,o),e.bezierCurveTo(d+a,o,u,h-l,u,h),e.lineTo(u,p),e.bezierCurveTo(u,p+l,d+a,f,d,f),e.bezierCurveTo(d-a,f,t,p+l,t,p),e.lineTo(t,h)}function Ce(e,t,o,n,i,r){e.beginPath(),e.moveTo(t,o);for(var s=r.length,a=n-t,l=i-o,u=l/a,c=Math.sqrt(a*a+l*l),d=0,h=!0,p=0,f=+r[0];c>=.1;)(f=+r[d++%s])>c&&(f=c),p=Math.sqrt(f*f/(1+u*u)),t+=p=a<0?-p:p,o+=u*p,!0===h?e.lineTo(t,o):e.moveTo(t,o),c-=f,h=!h}var Ee={circle:ye,dashedLine:Ce,database:xe,diamond:function(e,t,o,n){e.beginPath(),e.lineTo(t,o+n),e.lineTo(t+n,o),e.lineTo(t,o-n),e.lineTo(t-n,o),e.closePath()},ellipse:we,ellipse_vis:we,hexagon:function(e,t,o,n){e.beginPath();var i=2*Math.PI/6;e.moveTo(t+n,o);for(var r=1;r<6;r++)e.lineTo(t+n*Math.cos(i*r),o+n*Math.sin(i*r));e.closePath()},roundRect:je,square:function(e,t,o,n){e.beginPath(),e.rect(t-n,o-n,2*n,2*n),e.closePath()},star:function(e,t,o,n){e.beginPath(),o+=.1*(n*=.82);for(var i=0;i<10;i++){var r=i%2==0?1.3*n:.5*n;e.lineTo(t+r*Math.sin(2*i*Math.PI/10),o-r*Math.cos(2*i*Math.PI/10))}e.closePath()},triangle:function(e,t,o,n){e.beginPath(),o+=.275*(n*=1.15);var i=2*n,r=i/2,s=Math.sqrt(3)/6*i,a=Math.sqrt(i*i-r*r);e.moveTo(t,o-(a-s)),e.lineTo(t+r,o+s),e.lineTo(t-r,o+s),e.lineTo(t,o-(a-s)),e.closePath()},triangleDown:function(e,t,o,n){e.beginPath(),o-=.275*(n*=1.15);var i=2*n,r=i/2,s=Math.sqrt(3)/6*i,a=Math.sqrt(i*i-r*r);e.moveTo(t,o+(a-s)),e.lineTo(t+r,o-s),e.lineTo(t-r,o-s),e.lineTo(t,o+(a-s)),e.closePath()}},ke=o(function(e){function t(e){if(e)return function(e){for(var o in t.prototype)e[o]=t.prototype[o];return e}(e)}e.exports=t,t.prototype.on=t.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},t.prototype.once=function(e,t){function o(){this.off(e,o),t.apply(this,arguments)}return o.fn=t,this.on(e,o),this},t.prototype.off=t.prototype.removeListener=t.prototype.removeAllListeners=t.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var o,n=this._callbacks["$"+e];if(!n)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var i=0;i<n.length;i++)if((o=n[i])===t||o.fn===t){n.splice(i,1);break}return 0===n.length&&delete this._callbacks["$"+e],this},t.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),o=this._callbacks["$"+e],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(o){n=0;for(var i=(o=o.slice(0)).length;n<i;++n)o[n].apply(this,t)}return this},t.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},t.prototype.hasListeners=function(e){return!!this.listeners(e).length}});V({target:"Object",stat:!0,forced:!s,sham:!s},{defineProperty:B.f});var _e=o(function(e){var t=D.Object,o=e.exports=function(e,o,n){return t.defineProperty(e,o,n)};t.defineProperty.sham&&(o.sham=!0)}),Ae=_e,Oe=s?Object.defineProperties:function(e,t){R(e);for(var o,n=he(t),i=n.length,r=0;i>r;)B.f(e,o=n[r++],t[o]);return e};V({target:"Object",stat:!0,forced:!s,sham:!s},{defineProperties:Oe});var Me=o(function(e){var t=D.Object,o=e.exports=function(e,o){return t.defineProperties(e,o)};t.defineProperties.sham&&(o.sham=!0)}),Ie=function(e){return"function"==typeof e?e:void 0},Ne=function(e,t){return arguments.length<2?Ie(D[e])||Ie(i[e]):D[e]&&D[e][t]||i[e]&&i[e][t]},Se=de.concat("length","prototype"),Te={f:Object.getOwnPropertyNames||function(e){return ce(e,Se)}},De=Ne("Reflect","ownKeys")||function(e){var t=Te.f(R(e)),o=pe.f;return o?t.concat(o(e)):t},Le=function(e,t,o){var n=m(t);n in e?B.f(e,n,c(0,o)):e[n]=o};V({target:"Object",stat:!0,sham:!s},{getOwnPropertyDescriptors:function(e){for(var t,o,n=g(e),i=_.f,r=De(n),s={},a=0;r.length>a;)void 0!==(o=i(n,t=r[a++]))&&Le(s,t,o);return s}});var Fe=D.Object.getOwnPropertyDescriptors,Re=_.f,Pe=r(function(){Re(1)});V({target:"Object",stat:!0,forced:!s||Pe,sham:!s},{getOwnPropertyDescriptor:function(e,t){return Re(g(e),t)}});var Be,ze=o(function(e){var t=D.Object,o=e.exports=function(e,o){return t.getOwnPropertyDescriptor(e,o)};t.getOwnPropertyDescriptor.sham&&(o.sham=!0)}),He=ze,We=!!Object.getOwnPropertySymbols&&!r(function(){return!String(Symbol())}),Ve=We&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,Ue=Array.isArray||function(e){return"Array"==h(e)},Ye=Ne("document","documentElement"),qe="__core-js_shared__",Xe=i[qe]||function(e,t){try{z(i,e,t)}catch(o){i[e]=t}return t}(qe,{}),Ge=o(function(e){(e.exports=function(e,t){return Xe[e]||(Xe[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.8.1",mode:"pure",copyright:"\xa9 2020 Denis Pushkarev (zloirock.ru)"})}),Ke=0,Je=Math.random(),$e=function(e){return"Symbol("+String(void 0===e?"":e)+")_"+(++Ke+Je).toString(36)},Qe=Ge("keys"),Ze=function(e){return Qe[e]||(Qe[e]=$e(e))},et=Ze("IE_PROTO"),tt=function(){},ot=function(e){return"<script>"+e+"<\/script>"},nt=function(){try{Be=document.domain&&new ActiveXObject("htmlfile")}catch(e){}var e,t;nt=Be?function(e){e.write(ot("")),e.close();var t=e.parentWindow.Object;return e=null,t}(Be):((t=C("iframe")).style.display="none",Ye.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write(ot("document.F=Object")),e.close(),e.F);for(var o=de.length;o--;)delete nt.prototype[de[o]];return nt()};le[et]=!0;var it=Object.create||function(e,t){var o;return null!==e?(tt.prototype=R(e),o=new tt,tt.prototype=null,o[et]=e):o=nt(),void 0===t?o:Oe(o,t)},rt=Te.f,st={}.toString,at="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],lt={f:function(e){return at&&"[object Window]"==st.call(e)?function(e){try{return rt(e)}catch(e){return at.slice()}}(e):rt(g(e))}},ut=function(e,t,o,n){n&&n.enumerable?e[t]=o:z(e,t,o)},ct=Ge("wks"),dt=i.Symbol,ht=Ve?dt:dt&&dt.withoutSetter||$e,pt=function(e){return j(ct,e)||(ct[e]=We&&j(dt,e)?dt[e]:ht("Symbol."+e)),ct[e]},ft={f:pt},vt=B.f,gt=function(e){var t=D.Symbol||(D.Symbol={});j(t,e)||vt(t,e,{value:ft.f(e)})},bt={};bt[pt("toStringTag")]="z";var mt="[object z]"===String(bt),yt=pt("toStringTag"),jt="Arguments"==h(function(){return arguments}()),wt=mt?h:function(e){var t,o,n;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(o=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),yt))?o:jt?h(t):"Object"==(n=h(t))&&"function"==typeof t.callee?"Arguments":n},xt=mt?{}.toString:function(){return"[object "+wt(this)+"]"},Ct=B.f,Et=pt("toStringTag"),kt=function(e,t,o,n){if(e){var i=o?e:e.prototype;j(i,Et)||Ct(i,Et,{configurable:!0,value:t}),n&&!mt&&z(i,"toString",xt)}},_t=Function.toString;"function"!=typeof Xe.inspectSource&&(Xe.inspectSource=function(e){return _t.call(e)});var At,Ot,Mt,It=i.WeakMap,Nt="function"==typeof It&&/native code/.test((0,Xe.inspectSource)(It));if(Nt){var St=Xe.state||(Xe.state=new(0,i.WeakMap)),Tt=St.get,Dt=St.has,Lt=St.set;At=function(e,t){return t.facade=e,Lt.call(St,e,t),t},Ot=function(e){return Tt.call(St,e)||{}},Mt=function(e){return Dt.call(St,e)}}else{var Ft=Ze("state");le[Ft]=!0,At=function(e,t){return t.facade=e,z(e,Ft,t),t},Ot=function(e){return j(e,Ft)?e[Ft]:{}},Mt=function(e){return j(e,Ft)}}var Rt={set:At,get:Ot,has:Mt,enforce:function(e){return Mt(e)?Ot(e):At(e,{})},getterFor:function(e){return function(t){var o;if(!b(t)||(o=Ot(t)).type!==e)throw TypeError("Incompatible receiver, "+e+" required");return o}}},Pt=pt("species"),Bt=function(e,t){var o;return Ue(e)&&("function"!=typeof(o=e.constructor)||o!==Array&&!Ue(o.prototype)?b(o)&&null===(o=o[Pt])&&(o=void 0):o=void 0),new(void 0===o?Array:o)(0===t?0:t)},zt=[].push,Ht=function(e){var t=1==e,o=2==e,n=3==e,i=4==e,r=6==e,s=7==e,a=5==e||r;return function(l,u,c,d){for(var h,p,v=fe(l),g=f(v),b=F(u,c,3),m=oe(g.length),y=0,j=d||Bt,w=t?j(l,m):o||s?j(l,0):void 0;m>y;y++)if((a||y in g)&&(p=b(h=g[y],y,v),e))if(t)w[y]=p;else if(p)switch(e){case 3:return!0;case 5:return h;case 6:return y;case 2:zt.call(w,h)}else switch(e){case 4:return!1;case 7:zt.call(w,h)}return r?-1:n||i?i:w}},Wt={forEach:Ht(0),map:Ht(1),filter:Ht(2),some:Ht(3),every:Ht(4),find:Ht(5),findIndex:Ht(6),filterOut:Ht(7)},Vt=Wt.forEach,Ut=Ze("hidden"),Yt="Symbol",qt=pt("toPrimitive"),Xt=Rt.set,Gt=Rt.getterFor(Yt),Kt=Object.prototype,Jt=i.Symbol,$t=Ne("JSON","stringify"),Qt=_.f,Zt=B.f,eo=lt.f,to=u.f,oo=Ge("symbols"),no=Ge("op-symbols"),io=Ge("string-to-symbol-registry"),ro=Ge("symbol-to-string-registry"),so=Ge("wks"),ao=i.QObject,lo=!ao||!ao.prototype||!ao.prototype.findChild,uo=s&&r(function(){return 7!=it(Zt({},"a",{get:function(){return Zt(this,"a",{value:7}).a}})).a})?function(e,t,o){var n=Qt(Kt,t);n&&delete Kt[t],Zt(e,t,o),n&&e!==Kt&&Zt(Kt,t,n)}:Zt,co=function(e,t){var o=oo[e]=it(Jt.prototype);return Xt(o,{type:Yt,tag:e,description:t}),s||(o.description=t),o},ho=Ve?function(e){return"symbol"==typeof e}:function(e){return Object(e)instanceof Jt},po=function(e,t,o){e===Kt&&po(no,t,o),R(e);var n=m(t,!0);return R(o),j(oo,n)?(o.enumerable?(j(e,Ut)&&e[Ut][n]&&(e[Ut][n]=!1),o=it(o,{enumerable:c(0,!1)})):(j(e,Ut)||Zt(e,Ut,c(1,{})),e[Ut][n]=!0),uo(e,n,o)):Zt(e,n,o)},fo=function(e,t){R(e);var o=g(t),n=he(o).concat(mo(o));return Vt(n,function(t){s&&!vo.call(o,t)||po(e,t,o[t])}),e},vo=function(e){var t=m(e,!0),o=to.call(this,t);return!(this===Kt&&j(oo,t)&&!j(no,t))&&(!(o||!j(this,t)||!j(oo,t)||j(this,Ut)&&this[Ut][t])||o)},go=function(e,t){var o=g(e),n=m(t,!0);if(o!==Kt||!j(oo,n)||j(no,n)){var i=Qt(o,n);return!i||!j(oo,n)||j(o,Ut)&&o[Ut][n]||(i.enumerable=!0),i}},bo=function(e){var t=eo(g(e)),o=[];return Vt(t,function(e){j(oo,e)||j(le,e)||o.push(e)}),o},mo=function(e){var t=e===Kt,o=eo(t?no:g(e)),n=[];return Vt(o,function(e){!j(oo,e)||t&&!j(Kt,e)||n.push(oo[e])}),n};if(We||(ut((Jt=function(){if(this instanceof Jt)throw TypeError("Symbol is not a constructor");var e=arguments.length&&void 0!==arguments[0]?String(arguments[0]):void 0,t=$e(e),o=function(e){this===Kt&&o.call(no,e),j(this,Ut)&&j(this[Ut],t)&&(this[Ut][t]=!1),uo(this,t,c(1,e))};return s&&lo&&uo(Kt,t,{configurable:!0,set:o}),co(t,e)}).prototype,"toString",function(){return Gt(this).tag}),ut(Jt,"withoutSetter",function(e){return co($e(e),e)}),u.f=vo,B.f=po,_.f=go,Te.f=lt.f=bo,pe.f=mo,ft.f=function(e){return co(pt(e),e)},s&&Zt(Jt.prototype,"description",{configurable:!0,get:function(){return Gt(this).description}})),V({global:!0,wrap:!0,forced:!We,sham:!We},{Symbol:Jt}),Vt(he(so),function(e){gt(e)}),V({target:Yt,stat:!0,forced:!We},{for:function(e){var t=String(e);if(j(io,t))return io[t];var o=Jt(t);return io[t]=o,ro[o]=t,o},keyFor:function(e){if(!ho(e))throw TypeError(e+" is not a symbol");if(j(ro,e))return ro[e]},useSetter:function(){lo=!0},useSimple:function(){lo=!1}}),V({target:"Object",stat:!0,forced:!We,sham:!s},{create:function(e,t){return void 0===t?it(e):fo(it(e),t)},defineProperty:po,defineProperties:fo,getOwnPropertyDescriptor:go}),V({target:"Object",stat:!0,forced:!We},{getOwnPropertyNames:bo,getOwnPropertySymbols:mo}),V({target:"Object",stat:!0,forced:r(function(){pe.f(1)})},{getOwnPropertySymbols:function(e){return pe.f(fe(e))}}),$t){var yo=!We||r(function(){var e=Jt();return"[null]"!=$t([e])||"{}"!=$t({a:e})||"{}"!=$t(Object(e))});V({target:"JSON",stat:!0,forced:yo},{stringify:function(e,t,o){for(var n,i=[e],r=1;arguments.length>r;)i.push(arguments[r++]);if(n=t,(b(t)||void 0!==e)&&!ho(e))return Ue(t)||(t=function(e,t){if("function"==typeof n&&(t=n.call(this,e,t)),!ho(t))return t}),i[1]=t,$t.apply(null,i)}})}Jt.prototype[qt]||z(Jt.prototype,qt,Jt.prototype.valueOf),kt(Jt,Yt),le[Ut]=!0;var jo,wo,xo,Co=D.Object.getOwnPropertySymbols,Eo={},ko=!r(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),_o=Ze("IE_PROTO"),Ao=Object.prototype,Oo=ko?Object.getPrototypeOf:function(e){return e=fe(e),j(e,_o)?e[_o]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?Ao:null},Mo=(pt("iterator"),!1);[].keys&&("next"in(xo=[].keys())?(wo=Oo(Oo(xo)))!==Object.prototype&&(jo=wo):Mo=!0),null==jo&&(jo={});var Io={IteratorPrototype:jo,BUGGY_SAFARI_ITERATORS:Mo},No=Io.IteratorPrototype,So=function(){return this},To=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,o={};try{(e=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(o,[]),t=o instanceof Array}catch(e){}return function(o,n){return R(o),function(e){if(!b(e)&&null!==e)throw TypeError("Can't set "+String(e)+" as a prototype")}(n),t?e.call(o,n):o.__proto__=n,o}}():void 0),Do=Io.IteratorPrototype,Lo=Io.BUGGY_SAFARI_ITERATORS,Fo=pt("iterator"),Ro="keys",Po="values",Bo="entries",zo=function(){return this},Ho=function(e,t,o,n,i,r,s){!function(e,t,o){var n=t+" Iterator";e.prototype=it(No,{next:c(1,o)}),kt(e,n,!1,!0),Eo[n]=So}(o,t,n);var a,l,u,d=function(e){if(e===i&&g)return g;if(!Lo&&e in f)return f[e];switch(e){case Ro:case Po:case Bo:return function(){return new o(this,e)}}return function(){return new o(this)}},h=t+" Iterator",p=!1,f=e.prototype,v=f[Fo]||f["@@iterator"]||i&&f[i],g=!Lo&&v||d(i),b="Array"==t&&f.entries||v;if(b&&(a=Oo(b.call(new e)),Do!==Object.prototype&&a.next&&(kt(a,h,!0,!0),Eo[h]=zo)),i==Po&&v&&v.name!==Po&&(p=!0,g=function(){return v.call(this)}),s&&f[Fo]!==g&&z(f,Fo,g),Eo[t]=g,i)if(l={values:d(Po),keys:r?g:d(Ro),entries:d(Bo)},s)for(u in l)(Lo||p||!(u in f))&&ut(f,u,l[u]);else V({target:t,proto:!0,forced:Lo||p},l);return l},Wo="Array Iterator",Vo=Rt.set,Uo=Rt.getterFor(Wo);Ho(Array,"Array",function(e,t){Vo(this,{type:Wo,target:g(e),index:0,kind:t})},function(){var e=Uo(this),t=e.target,o=e.kind,n=e.index++;return!t||n>=t.length?(e.target=void 0,{value:void 0,done:!0}):"keys"==o?{value:n,done:!1}:"values"==o?{value:t[n],done:!1}:{value:[n,t[n]],done:!1}},"values"),Eo.Arguments=Eo.Array;var Yo=pt("toStringTag");for(var qo in{CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}){var Xo=i[qo],Go=Xo&&Xo.prototype;Go&&wt(Go)!==Yo&&z(Go,Yo,qo),Eo[qo]=Eo.Array}var Ko=function(e){return function(t,o){var n,i,r=String(v(t)),s=ee(o),a=r.length;return s<0||s>=a?e?"":void 0:(n=r.charCodeAt(s))<55296||n>56319||s+1===a||(i=r.charCodeAt(s+1))<56320||i>57343?e?r.charAt(s):n:e?r.slice(s,s+2):i-56320+(n-55296<<10)+65536}},Jo=(Ko(!1),Ko(!0)),$o="String Iterator",Qo=Rt.set,Zo=Rt.getterFor($o);Ho(String,"String",function(e){Qo(this,{type:$o,string:String(e),index:0})},function(){var e,t=Zo(this),o=t.string,n=t.index;return n>=o.length?{value:void 0,done:!0}:(e=Jo(o,n),t.index+=e.length,{value:e,done:!1})});var en=pt("iterator"),tn=function(e){if(null!=e)return e[en]||e["@@iterator"]||Eo[wt(e)]},on=function(e){var t=tn(e);if("function"!=typeof t)throw TypeError(String(e)+" is not iterable");return R(t.call(e))},nn=tn,rn=function(e){var t=e.return;if(void 0!==t)return R(t.call(e)).value},sn=function(e,t,o,n){try{return n?t(R(o)[0],o[1]):t(o)}catch(t){throw rn(e),t}},an=pt("iterator"),ln=Array.prototype,un=function(e){return void 0!==e&&(Eo.Array===e||ln[an]===e)},cn=pt("iterator"),dn=!1;try{var hn=0,pn={next:function(){return{done:!!hn++}},return:function(){dn=!0}};pn[cn]=function(){return this},Array.from(pn,function(){throw 2})}catch(e){}var fn=!function(e,t){if(!dn)return!1;var o=!1;try{var n={};n[cn]=function(){return{next:function(){return{done:o=!0}}}},function(e){Array.from(e)}(n)}catch(e){}return o}();V({target:"Array",stat:!0,forced:fn},{from:function(e){var t,o,n,i,r,s,a=fe(e),l="function"==typeof this?this:Array,u=arguments.length,c=u>1?arguments[1]:void 0,d=void 0!==c,h=tn(a),p=0;if(d&&(c=F(c,u>2?arguments[2]:void 0,2)),null==h||l==Array&&un(h))for(o=new l(t=oe(a.length));t>p;p++)s=d?c(a[p],p):a[p],Le(o,p,s);else for(r=(i=h.call(a)).next,o=new l;!(n=r.call(i)).done;p++)s=d?sn(i,c,[n.value,p],!0):n.value,Le(o,p,s);return o.length=p,o}});var vn=D.Array.from,gn=vn;V({target:"Array",proto:!0},{fill:function(e){for(var t=fe(this),o=oe(t.length),n=arguments.length,i=re(n>1?arguments[1]:void 0,o),r=n>2?arguments[2]:void 0,s=void 0===r?o:re(r,o);s>i;)t[i++]=e;return t}});var bn=G("Array").fill,mn=Array.prototype,yn=function(e){var t=e.fill;return e===mn||e instanceof Array&&t===mn.fill?bn:t},jn=Ne("navigator","userAgent")||"",wn=[].slice,xn=/MSIE .\./.test(jn),Cn=function(e){return function(t,o){var n=arguments.length>2,i=n?wn.call(arguments,2):void 0;return e(n?function(){("function"==typeof t?t:Function(t)).apply(this,i)}:t,o)}};V({global:!0,bind:!0,forced:xn},{setTimeout:Cn(i.setTimeout),setInterval:Cn(i.setInterval)});var En=D.setTimeout,kn=Ne("JSON","stringify"),_n=/[\uD800-\uDFFF]/g,An=/^[\uD800-\uDBFF]$/,On=/^[\uDC00-\uDFFF]$/,Mn=function(e,t,o){var n=o.charAt(t-1),i=o.charAt(t+1);return An.test(e)&&!On.test(i)||On.test(e)&&!An.test(n)?"\\u"+e.charCodeAt(0).toString(16):e},In=r(function(){return'"\\udf06\\ud834"'!==kn("\udf06\ud834")||'"\\udead"'!==kn("\udead")});kn&&V({target:"JSON",stat:!0,forced:In},{stringify:function(e,t,o){var n=kn.apply(null,arguments);return"string"==typeof n?n.replace(_n,Mn):n}}),D.JSON||(D.JSON={stringify:JSON.stringify});var Nn=function(e,t,o){return D.JSON.stringify.apply(null,arguments)},Sn=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},Tn=_e;function Dn(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Tn(e,n.key,n)}}var Ln=function(e,t,o){return t&&Dn(e.prototype,t),o&&Dn(e,o),e};V({target:"Object",stat:!0,sham:!s},{create:it});var Fn,Rn=D.Object,Pn=function(e,t){return Rn.create(e,t)},Bn=Pn,zn=function(e,t,o){return t in e?Tn(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e},Hn="\t\n\v\f\r \xa0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff",Wn="["+Hn+"]",Vn=RegExp("^"+Wn+Wn+"*"),Un=RegExp(Wn+Wn+"*$"),Yn=function(e){return function(t){var o=String(v(t));return 1&e&&(o=o.replace(Vn,"")),2&e&&(o=o.replace(Un,"")),o}},qn={start:Yn(1),end:Yn(2),trim:Yn(3)},Xn=qn.trim;V({target:"String",proto:!0,forced:(Fn="trim",r(function(){return!!Hn[Fn]()||"\u200b\x85\u180e"!="\u200b\x85\u180e"[Fn]()||Hn[Fn].name!==Fn}))},{trim:function(){return Xn(this)}});var Gn=G("String").trim,Kn=String.prototype,Jn=function(e){var t=e.trim;return"string"==typeof e||e===Kn||e instanceof String&&t===Kn.trim?Gn:t},$n=function(e,t){var o=[][e];return!!o&&r(function(){o.call(null,t||function(){throw 1},1)})},Qn=Object.defineProperty,Zn={},ei=function(e){throw e},ti=function(e,t){if(j(Zn,e))return Zn[e];t||(t={});var o=[][e],n=!!j(t,"ACCESSORS")&&t.ACCESSORS,i=j(t,0)?t[0]:ei,a=j(t,1)?t[1]:void 0;return Zn[e]=!!o&&!r(function(){if(n&&!s)return!0;var e={length:-1};n?Qn(e,1,{enumerable:!0,get:ei}):e[1]=1,o.call(e,i,a)})},oi=ae.indexOf,ni=[].indexOf,ii=!!ni&&1/[1].indexOf(1,-0)<0,ri=$n("indexOf"),si=ti("indexOf",{ACCESSORS:!0,1:0});V({target:"Array",proto:!0,forced:ii||!ri||!si},{indexOf:function(e){return ii?ni.apply(this,arguments)||0:oi(this,e,arguments.length>1?arguments[1]:void 0)}});var ai=G("Array").indexOf,li=Array.prototype,ui=function(e){var t=e.indexOf;return e===li||e instanceof Array&&t===li.indexOf?ai:t},ci=qn.trim,di=i.parseInt,hi=/^[+-]?0[Xx]/,pi=8!==di(Hn+"08")||22!==di(Hn+"0x16")?function(e,t){var o=ci(String(e));return di(o,t>>>0||(hi.test(o)?16:10))}:di;V({global:!0,forced:parseInt!=pi},{parseInt:pi});var fi=D.parseInt,vi=u.f,gi=function(e){return function(t){for(var o,n=g(t),i=he(n),r=i.length,a=0,l=[];r>a;)o=i[a++],s&&!vi.call(n,o)||l.push(e?[o,n[o]]:n[o]);return l}},bi=(gi(!0),gi(!1));V({target:"Object",stat:!0},{values:function(e){return bi(e)}});var mi,yi,ji=D.Object.values,wi=i.process,xi=wi&&wi.versions,Ci=xi&&xi.v8;Ci?yi=(mi=Ci.split("."))[0]+mi[1]:jn&&(!(mi=jn.match(/Edge\/(\d+)/))||mi[1]>=74)&&(mi=jn.match(/Chrome\/(\d+)/))&&(yi=mi[1]);var Ei=yi&&+yi,ki=pt("species"),_i=function(e){return Ei>=51||!r(function(){var t=[];return(t.constructor={})[ki]=function(){return{foo:1}},1!==t[e](Boolean).foo})},Ai=Wt.filter,Oi=_i("filter"),Mi=ti("filter");V({target:"Array",proto:!0,forced:!Oi||!Mi},{filter:function(e){return Ai(this,e,arguments.length>1?arguments[1]:void 0)}});var Ii=G("Array").filter,Ni=Array.prototype,Si=function(e){var t=e.filter;return e===Ni||e instanceof Array&&t===Ni.filter?Ii:t},Ti=r(function(){Oo(1)});V({target:"Object",stat:!0,forced:Ti,sham:!ko},{getPrototypeOf:function(e){return Oo(fe(e))}});var Di=D.Object.getPrototypeOf,Li=Di,Fi=ae.includes,Ri=ti("indexOf",{ACCESSORS:!0,1:0});V({target:"Array",proto:!0,forced:!Ri},{includes:function(e){return Fi(this,e,arguments.length>1?arguments[1]:void 0)}});var Pi=G("Array").includes,Bi=pt("match"),zi=function(e){if(function(e){var t;return b(e)&&(void 0!==(t=e[Bi])?!!t:"RegExp"==h(e))}(e))throw TypeError("The method doesn't accept regular expressions");return e},Hi=pt("match");V({target:"String",proto:!0,forced:!function(e){var t=/./;try{"/./"[e](t)}catch(o){try{return t[Hi]=!1,"/./"[e](t)}catch(e){}}return!1}("includes")},{includes:function(e){return!!~String(v(this)).indexOf(zi(e),arguments.length>1?arguments[1]:void 0)}});var Wi=G("String").includes,Vi=Array.prototype,Ui=String.prototype,Yi=function(e){var t=e.includes;return e===Vi||e instanceof Array&&t===Vi.includes?Pi:"string"==typeof e||e===Ui||e instanceof String&&t===Ui.includes?Wi:t},qi=_i("splice"),Xi=ti("splice",{ACCESSORS:!0,0:0,1:2}),Gi=Math.max,Ki=Math.min,Ji=9007199254740991,$i="Maximum allowed length exceeded";V({target:"Array",proto:!0,forced:!qi||!Xi},{splice:function(e,t){var o,n,i,r,s,a,l=fe(this),u=oe(l.length),c=re(e,u),d=arguments.length;if(0===d?o=n=0:1===d?(o=0,n=u-c):(o=d-2,n=Ki(Gi(ee(t),0),u-c)),u+o-n>Ji)throw TypeError($i);for(i=Bt(l,n),r=0;r<n;r++)(s=c+r)in l&&Le(i,r,l[s]);if(i.length=n,o<n){for(r=c;r<u-n;r++)a=r+o,(s=r+n)in l?l[a]=l[s]:delete l[a];for(r=u;r>u-n+o;r--)delete l[r-1]}else if(o>n)for(r=u-n;r>c;r--)a=r+o-1,(s=r+n-1)in l?l[a]=l[s]:delete l[a];for(r=0;r<o;r++)l[r+c]=arguments[r+2];return l.length=u-n+o,i}});var Qi=G("Array").splice,Zi=Array.prototype,er=function(e){var t=e.splice;return e===Zi||e instanceof Array&&t===Zi.splice?Qi:t},tr=[].reverse,or=[1,2];V({target:"Array",proto:!0,forced:String(or)===String(or.reverse())},{reverse:function(){return Ue(this)&&(this.length=this.length),tr.call(this)}});var nr=G("Array").reverse,ir=Array.prototype,rr=function(e){var t=e.reverse;return e===ir||e instanceof Array&&t===ir.reverse?nr:t},sr=Wt.forEach,ar=$n("forEach"),lr=ti("forEach"),ur=ar&&lr?[].forEach:function(e){return sr(this,e,arguments.length>1?arguments[1]:void 0)};V({target:"Array",proto:!0,forced:[].forEach!=ur},{forEach:ur});var cr=G("Array").forEach,dr=Array.prototype,hr={DOMTokenList:!0,NodeList:!0},pr=function(e){var t=e.forEach;return e===dr||e instanceof Array&&t===dr.forEach||hr.hasOwnProperty(wt(e))?cr:t};V({target:"Array",stat:!0},{isArray:Ue});var fr=D.Array.isArray,vr=fr,gr=pt("iterator"),br=function(e){var t=Object(e);return void 0!==t[gr]||"@@iterator"in t||Eo.hasOwnProperty(wt(t))},mr=pt("isConcatSpreadable"),yr=9007199254740991,jr="Maximum allowed index exceeded",wr=Ei>=51||!r(function(){var e=[];return e[mr]=!1,e.concat()[0]!==e}),xr=_i("concat"),Cr=function(e){if(!b(e))return!1;var t=e[mr];return void 0!==t?!!t:Ue(e)};V({target:"Array",proto:!0,forced:!wr||!xr},{concat:function(e){var t,o,n,i,r,s=fe(this),a=Bt(s,0),l=0;for(t=-1,n=arguments.length;t<n;t++)if(Cr(r=-1===t?s:arguments[t])){if(l+(i=oe(r.length))>yr)throw TypeError(jr);for(o=0;o<i;o++,l++)o in r&&Le(a,l,r[o])}else{if(l>=yr)throw TypeError(jr);Le(a,l++,r)}return a.length=l,a}}),gt("asyncIterator"),gt("hasInstance"),gt("isConcatSpreadable"),gt("iterator"),gt("match"),gt("matchAll"),gt("replace"),gt("search"),gt("species"),gt("split"),gt("toPrimitive"),gt("toStringTag"),gt("unscopables"),kt(i.JSON,"JSON",!0);var Er=D.Symbol;gt("asyncDispose"),gt("dispose"),gt("observable"),gt("patternMatch"),gt("replaceAll");var kr=Er,_r=vn,Ar=_i("slice"),Or=ti("slice",{ACCESSORS:!0,0:0,1:2}),Mr=pt("species"),Ir=[].slice,Nr=Math.max;V({target:"Array",proto:!0,forced:!Ar||!Or},{slice:function(e,t){var o,n,i,r=g(this),s=oe(r.length),a=re(e,s),l=re(void 0===t?s:t,s);if(Ue(r)&&("function"!=typeof(o=r.constructor)||o!==Array&&!Ue(o.prototype)?b(o)&&null===(o=o[Mr])&&(o=void 0):o=void 0,o===Array||void 0===o))return Ir.call(r,a,l);for(n=new(void 0===o?Array:o)(Nr(l-a,0)),i=0;a<l;a++,i++)a in r&&Le(n,i,r[a]);return n.length=i,n}});var Sr=G("Array").slice,Tr=Array.prototype,Dr=function(e){var t=e.slice;return e===Tr||e instanceof Array&&t===Tr.slice?Sr:t},Lr=Dr,Fr=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n},Rr=function(e,t){var o;if(e){if("string"==typeof e)return Fr(e,t);var n=Lr(o=Object.prototype.toString.call(e)).call(o,8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?_r(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Fr(e,t):void 0}},Pr=function(e,t){return function(e){if(vr(e))return e}(e)||function(e,t){if(void 0!==kr&&br(Object(e))){var o=[],n=!0,i=!1,r=void 0;try{for(var s,a=on(e);!(n=(s=a.next()).done)&&(o.push(s.value),!t||o.length!==t);n=!0);}catch(e){i=!0,r=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw r}}return o}}(e,t)||Rr(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()};V({target:"Date",stat:!0},{now:function(){return(new Date).getTime()}});var Br=D.Date.now,zr=r(function(){he(1)});V({target:"Object",stat:!0,forced:zr},{keys:function(e){return he(fe(e))}});var Hr=D.Object.keys,Wr=Wt.map,Vr=_i("map"),Ur=ti("map");V({target:"Array",proto:!0,forced:!Vr||!Ur},{map:function(e){return Wr(this,e,arguments.length>1?arguments[1]:void 0)}});var Yr=G("Array").map,qr=Array.prototype,Xr=function(e){var t=e.map;return e===qr||e instanceof Array&&t===qr.map?Yr:t},Gr=fr,Kr=ft.f("iterator"),Jr=Kr,$r=o(function(e){function t(o){return e.exports=t="function"==typeof kr&&"symbol"==typeof Jr?function(e){return typeof e}:function(e){return e&&"function"==typeof kr&&e.constructor===kr&&e!==kr.prototype?"symbol":typeof e},t(o)}e.exports=t});V({target:"Reflect",stat:!0},{ownKeys:De});var Qr=D.Reflect.ownKeys,Zr=Dr,es=function(e){return function(e){if(vr(e))return Fr(e)}(e)||function(e){if(void 0!==kr&&br(Object(e)))return _r(e)}(e)||Rr(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()},ts=G("Array").concat,os=Array.prototype,ns=function(e){var t=e.concat;return e===os||e instanceof Array&&t===os.concat?ts:t},is=Er;function rs(){return(rs=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e}).apply(this,arguments)}function ss(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}function as(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var ls,us="function"!=typeof Object.assign?function(e){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),o=1;o<arguments.length;o++){var n=arguments[o];if(null!=n)for(var i in n)n.hasOwnProperty(i)&&(t[i]=n[i])}return t}:Object.assign,cs=["","webkit","Moz","MS","ms","o"],ds="undefined"==typeof document?{style:{}}:document.createElement("div"),hs=Math.round,ps=Math.abs,fs=Date.now;function vs(e,t){for(var o,n,i=t[0].toUpperCase()+t.slice(1),r=0;r<cs.length;){if((n=(o=cs[r])?o+i:t)in e)return n;r++}}ls="undefined"==typeof window?{}:window;var gs=vs(ds.style,"touchAction"),bs=void 0!==gs,ms="compute",ys="auto",js="manipulation",ws="none",xs="pan-x",Cs="pan-y",Es=function(){if(!bs)return!1;var e={},t=ls.CSS&&ls.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(o){return e[o]=!t||ls.CSS.supports("touch-action",o)}),e}(),ks="ontouchstart"in ls,_s=void 0!==vs(ls,"PointerEvent"),As=ks&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),Os="touch",Ms="mouse",Is=["x","y"],Ns=["clientX","clientY"];function Ss(e,t,o){var n;if(e)if(e.forEach)e.forEach(t,o);else if(void 0!==e.length)for(n=0;n<e.length;)t.call(o,e[n],n,e),n++;else for(n in e)e.hasOwnProperty(n)&&t.call(o,e[n],n,e)}function Ts(e,t){return"function"==typeof e?e.apply(t&&t[0]||void 0,t):e}function Ds(e,t){return e.indexOf(t)>-1}var Ls=function(){function e(e,t){this.manager=e,this.set(t)}var t=e.prototype;return t.set=function(e){e===ms&&(e=this.compute()),bs&&this.manager.element.style&&Es[e]&&(this.manager.element.style[gs]=e),this.actions=e.toLowerCase().trim()},t.update=function(){this.set(this.manager.options.touchAction)},t.compute=function(){var e=[];return Ss(this.manager.recognizers,function(t){Ts(t.options.enable,[t])&&(e=e.concat(t.getTouchAction()))}),function(e){if(Ds(e,ws))return ws;var t=Ds(e,xs),o=Ds(e,Cs);return t&&o?ws:t||o?t?xs:Cs:Ds(e,js)?js:ys}(e.join(" "))},t.preventDefaults=function(e){var t=e.srcEvent,o=e.offsetDirection;if(this.manager.session.prevented)t.preventDefault();else{var n=this.actions,i=Ds(n,ws)&&!Es.none,r=Ds(n,Cs)&&!Es["pan-y"],s=Ds(n,xs)&&!Es["pan-x"];if(i&&1===e.pointers.length&&e.distance<2&&e.deltaTime<250)return;if(!s||!r)return i||r&&6&o||s&&24&o?this.preventSrc(t):void 0}},t.preventSrc=function(e){this.manager.session.prevented=!0,e.preventDefault()},e}();function Fs(e,t){for(;e;){if(e===t)return!0;e=e.parentNode}return!1}function Rs(e){var t=e.length;if(1===t)return{x:hs(e[0].clientX),y:hs(e[0].clientY)};for(var o=0,n=0,i=0;i<t;)o+=e[i].clientX,n+=e[i].clientY,i++;return{x:hs(o/t),y:hs(n/t)}}function Ps(e){for(var t=[],o=0;o<e.pointers.length;)t[o]={clientX:hs(e.pointers[o].clientX),clientY:hs(e.pointers[o].clientY)},o++;return{timeStamp:fs(),pointers:t,center:Rs(t),deltaX:e.deltaX,deltaY:e.deltaY}}function Bs(e,t,o){o||(o=Is);var n=t[o[0]]-e[o[0]],i=t[o[1]]-e[o[1]];return Math.sqrt(n*n+i*i)}function zs(e,t,o){return o||(o=Is),180*Math.atan2(t[o[1]]-e[o[1]],t[o[0]]-e[o[0]])/Math.PI}function Hs(e,t){return e===t?1:ps(e)>=ps(t)?e<0?2:4:t<0?8:16}function Ws(e,t,o){return{x:t/e||0,y:o/e||0}}function Vs(e,t,o){var n=o.pointers.length,i=o.changedPointers.length,r=1&t&&n-i==0,s=12&t&&n-i==0;o.isFirst=!!r,o.isFinal=!!s,r&&(e.session={}),o.eventType=t,function(e,t){var o=e.session,n=t.pointers,i=n.length;o.firstInput||(o.firstInput=Ps(t)),i>1&&!o.firstMultiple?o.firstMultiple=Ps(t):1===i&&(o.firstMultiple=!1);var r=o.firstInput,s=o.firstMultiple,a=s?s.center:r.center,l=t.center=Rs(n);t.timeStamp=fs(),t.deltaTime=t.timeStamp-r.timeStamp,t.angle=zs(a,l),t.distance=Bs(a,l),function(e,t){var o=t.center,n=e.offsetDelta||{},i=e.prevDelta||{},r=e.prevInput||{};1!==t.eventType&&4!==r.eventType||(i=e.prevDelta={x:r.deltaX||0,y:r.deltaY||0},n=e.offsetDelta={x:o.x,y:o.y}),t.deltaX=i.x+(o.x-n.x),t.deltaY=i.y+(o.y-n.y)}(o,t),t.offsetDirection=Hs(t.deltaX,t.deltaY);var u,c,d=Ws(t.deltaTime,t.deltaX,t.deltaY);t.overallVelocityX=d.x,t.overallVelocityY=d.y,t.overallVelocity=ps(d.x)>ps(d.y)?d.x:d.y,t.scale=s?(u=s.pointers,Bs((c=n)[0],c[1],Ns)/Bs(u[0],u[1],Ns)):1,t.rotation=s?function(e,t){return zs(t[1],t[0],Ns)+zs(e[1],e[0],Ns)}(s.pointers,n):0,t.maxPointers=o.prevInput?t.pointers.length>o.prevInput.maxPointers?t.pointers.length:o.prevInput.maxPointers:t.pointers.length,function(e,t){var o,n,i,r,s=e.lastInterval||t,a=t.timeStamp-s.timeStamp;if(8!==t.eventType&&(a>25||void 0===s.velocity)){var l=t.deltaX-s.deltaX,u=t.deltaY-s.deltaY,c=Ws(a,l,u);n=c.x,i=c.y,o=ps(c.x)>ps(c.y)?c.x:c.y,r=Hs(l,u),e.lastInterval=t}else o=s.velocity,n=s.velocityX,i=s.velocityY,r=s.direction;t.velocity=o,t.velocityX=n,t.velocityY=i,t.direction=r}(o,t);var h,p=e.element,f=t.srcEvent;Fs(h=f.composedPath?f.composedPath()[0]:f.path?f.path[0]:f.target,p)&&(p=h),t.target=p}(e,o),e.emit("hammer.input",o),e.recognize(o),e.session.prevInput=o}function Us(e){return e.trim().split(/\s+/g)}function Ys(e,t,o){Ss(Us(t),function(t){e.addEventListener(t,o,!1)})}function qs(e,t,o){Ss(Us(t),function(t){e.removeEventListener(t,o,!1)})}function Xs(e){var t=e.ownerDocument||e;return t.defaultView||t.parentWindow||window}var Gs=function(){function e(e,t){var o=this;this.manager=e,this.callback=t,this.element=e.element,this.target=e.options.inputTarget,this.domHandler=function(t){Ts(e.options.enable,[e])&&o.handler(t)},this.init()}var t=e.prototype;return t.handler=function(){},t.init=function(){this.evEl&&Ys(this.element,this.evEl,this.domHandler),this.evTarget&&Ys(this.target,this.evTarget,this.domHandler),this.evWin&&Ys(Xs(this.element),this.evWin,this.domHandler)},t.destroy=function(){this.evEl&&qs(this.element,this.evEl,this.domHandler),this.evTarget&&qs(this.target,this.evTarget,this.domHandler),this.evWin&&qs(Xs(this.element),this.evWin,this.domHandler)},e}();function Ks(e,t,o){if(e.indexOf&&!o)return e.indexOf(t);for(var n=0;n<e.length;){if(o&&e[n][o]==t||!o&&e[n]===t)return n;n++}return-1}var Js={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},$s={2:Os,3:"pen",4:Ms,5:"kinect"},Qs="pointerdown",Zs="pointermove pointerup pointercancel";ls.MSPointerEvent&&!ls.PointerEvent&&(Qs="MSPointerDown",Zs="MSPointerMove MSPointerUp MSPointerCancel");var ea=function(e){function t(){var o,n=t.prototype;return n.evEl=Qs,n.evWin=Zs,(o=e.apply(this,arguments)||this).store=o.manager.session.pointerEvents=[],o}return ss(t,e),t.prototype.handler=function(e){var t=this.store,o=!1,n=e.type.toLowerCase().replace("ms",""),i=Js[n],r=$s[e.pointerType]||e.pointerType,s=r===Os,a=Ks(t,e.pointerId,"pointerId");1&i&&(0===e.button||s)?a<0&&(t.push(e),a=t.length-1):12&i&&(o=!0),a<0||(t[a]=e,this.callback(this.manager,i,{pointers:t,changedPointers:[e],pointerType:r,srcEvent:e}),o&&t.splice(a,1))},t}(Gs);function ta(e){return Array.prototype.slice.call(e,0)}function oa(e,t,o){for(var n=[],i=[],r=0;r<e.length;){var s=t?e[r][t]:e[r];Ks(i,s)<0&&n.push(e[r]),i[r]=s,r++}return o&&(n=t?n.sort(function(e,o){return e[t]>o[t]}):n.sort()),n}var na={touchstart:1,touchmove:2,touchend:4,touchcancel:8},ia="touchstart touchmove touchend touchcancel",ra=function(e){function t(){var o;return t.prototype.evTarget=ia,(o=e.apply(this,arguments)||this).targetIds={},o}return ss(t,e),t.prototype.handler=function(e){var t=na[e.type],o=sa.call(this,e,t);o&&this.callback(this.manager,t,{pointers:o[0],changedPointers:o[1],pointerType:Os,srcEvent:e})},t}(Gs);function sa(e,t){var o,n,i=ta(e.touches),r=this.targetIds;if(3&t&&1===i.length)return r[i[0].identifier]=!0,[i,i];var s=ta(e.changedTouches),a=[],l=this.target;if(n=i.filter(function(e){return Fs(e.target,l)}),1===t)for(o=0;o<n.length;)r[n[o].identifier]=!0,o++;for(o=0;o<s.length;)r[s[o].identifier]&&a.push(s[o]),12&t&&delete r[s[o].identifier],o++;return a.length?[oa(n.concat(a),"identifier",!0),a]:void 0}var aa={mousedown:1,mousemove:2,mouseup:4},la="mousedown",ua="mousemove mouseup",ca=function(e){function t(){var o,n=t.prototype;return n.evEl=la,n.evWin=ua,(o=e.apply(this,arguments)||this).pressed=!1,o}return ss(t,e),t.prototype.handler=function(e){var t=aa[e.type];1&t&&0===e.button&&(this.pressed=!0),2&t&&1!==e.which&&(t=4),this.pressed&&(4&t&&(this.pressed=!1),this.callback(this.manager,t,{pointers:[e],changedPointers:[e],pointerType:Ms,srcEvent:e}))},t}(Gs);function da(e){var t=e.changedPointers[0];if(t.identifier===this.primaryTouch){var o={x:t.clientX,y:t.clientY},n=this.lastTouches;this.lastTouches.push(o),setTimeout(function(){var e=n.indexOf(o);e>-1&&n.splice(e,1)},2500)}}function ha(e,t){1&e?(this.primaryTouch=t.changedPointers[0].identifier,da.call(this,t)):12&e&&da.call(this,t)}function pa(e){for(var t=e.srcEvent.clientX,o=e.srcEvent.clientY,n=0;n<this.lastTouches.length;n++){var i=this.lastTouches[n],r=Math.abs(t-i.x),s=Math.abs(o-i.y);if(r<=25&&s<=25)return!0}return!1}var fa=function(e){function t(t,o){var n;return(n=e.call(this,t,o)||this).handler=function(e,t,o){var i=o.pointerType===Ms;if(!(i&&o.sourceCapabilities&&o.sourceCapabilities.firesTouchEvents)){if(o.pointerType===Os)ha.call(as(as(n)),t,o);else if(i&&pa.call(as(as(n)),o))return;n.callback(e,t,o)}},n.touch=new ra(n.manager,n.handler),n.mouse=new ca(n.manager,n.handler),n.primaryTouch=null,n.lastTouches=[],n}return ss(t,e),t.prototype.destroy=function(){this.touch.destroy(),this.mouse.destroy()},t}(Gs);function va(e,t,o){return!!Array.isArray(e)&&(Ss(e,o[t],o),!0)}var ga=32,ba=1;function ma(e,t){var o=t.manager;return o?o.get(e):e}function ya(e){return 16&e?"cancel":8&e?"end":4&e?"move":2&e?"start":""}var ja=function(){function e(e){void 0===e&&(e={}),this.options=rs({enable:!0},e),this.id=ba++,this.manager=null,this.state=1,this.simultaneous={},this.requireFail=[]}var t=e.prototype;return t.set=function(e){return us(this.options,e),this.manager&&this.manager.touchAction.update(),this},t.recognizeWith=function(e){if(va(e,"recognizeWith",this))return this;var t=this.simultaneous;return t[(e=ma(e,this)).id]||(t[e.id]=e,e.recognizeWith(this)),this},t.dropRecognizeWith=function(e){return va(e,"dropRecognizeWith",this)||(e=ma(e,this),delete this.simultaneous[e.id]),this},t.requireFailure=function(e){if(va(e,"requireFailure",this))return this;var t=this.requireFail;return-1===Ks(t,e=ma(e,this))&&(t.push(e),e.requireFailure(this)),this},t.dropRequireFailure=function(e){if(va(e,"dropRequireFailure",this))return this;e=ma(e,this);var t=Ks(this.requireFail,e);return t>-1&&this.requireFail.splice(t,1),this},t.hasRequireFailures=function(){return this.requireFail.length>0},t.canRecognizeWith=function(e){return!!this.simultaneous[e.id]},t.emit=function(e){var t=this,o=this.state;function n(o){t.manager.emit(o,e)}o<8&&n(t.options.event+ya(o)),n(t.options.event),e.additionalEvent&&n(e.additionalEvent),o>=8&&n(t.options.event+ya(o))},t.tryEmit=function(e){if(this.canEmit())return this.emit(e);this.state=ga},t.canEmit=function(){for(var e=0;e<this.requireFail.length;){if(!(33&this.requireFail[e].state))return!1;e++}return!0},t.recognize=function(e){var t=us({},e);if(!Ts(this.options.enable,[this,t]))return this.reset(),void(this.state=ga);56&this.state&&(this.state=1),this.state=this.process(t),30&this.state&&this.tryEmit(t)},t.process=function(e){},t.getTouchAction=function(){},t.reset=function(){},e}(),wa=function(e){function t(t){var o;return void 0===t&&(t={}),(o=e.call(this,rs({event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},t))||this).pTime=!1,o.pCenter=!1,o._timer=null,o._input=null,o.count=0,o}ss(t,e);var o=t.prototype;return o.getTouchAction=function(){return[js]},o.process=function(e){var t=this,o=this.options,n=e.pointers.length===o.pointers,i=e.distance<o.threshold,r=e.deltaTime<o.time;if(this.reset(),1&e.eventType&&0===this.count)return this.failTimeout();if(i&&r&&n){if(4!==e.eventType)return this.failTimeout();var s=!this.pTime||e.timeStamp-this.pTime<o.interval,a=!this.pCenter||Bs(this.pCenter,e.center)<o.posThreshold;if(this.pTime=e.timeStamp,this.pCenter=e.center,a&&s?this.count+=1:this.count=1,this._input=e,0==this.count%o.taps)return this.hasRequireFailures()?(this._timer=setTimeout(function(){t.state=8,t.tryEmit()},o.interval),2):8}return ga},o.failTimeout=function(){var e=this;return this._timer=setTimeout(function(){e.state=ga},this.options.interval),ga},o.reset=function(){clearTimeout(this._timer)},o.emit=function(){8===this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))},t}(ja),xa=function(e){function t(t){return void 0===t&&(t={}),e.call(this,rs({pointers:1},t))||this}ss(t,e);var o=t.prototype;return o.attrTest=function(e){var t=this.options.pointers;return 0===t||e.pointers.length===t},o.process=function(e){var t=this.state,o=e.eventType,n=6&t,i=this.attrTest(e);return n&&(8&o||!i)?16|t:n||i?4&o?8|t:2&t?4|t:2:ga},t}(ja);function Ca(e){return 16===e?"down":8===e?"up":2===e?"left":4===e?"right":""}var Ea=function(e){function t(t){var o;return void 0===t&&(t={}),(o=e.call(this,rs({event:"pan",threshold:10,pointers:1,direction:30},t))||this).pX=null,o.pY=null,o}ss(t,e);var o=t.prototype;return o.getTouchAction=function(){var e=this.options.direction,t=[];return 6&e&&t.push(Cs),24&e&&t.push(xs),t},o.directionTest=function(e){var t=this.options,o=!0,n=e.distance,i=e.direction,r=e.deltaX,s=e.deltaY;return i&t.direction||(6&t.direction?(i=0===r?1:r<0?2:4,o=r!==this.pX,n=Math.abs(e.deltaX)):(i=0===s?1:s<0?8:16,o=s!==this.pY,n=Math.abs(e.deltaY))),e.direction=i,o&&n>t.threshold&&i&t.direction},o.attrTest=function(e){return xa.prototype.attrTest.call(this,e)&&(2&this.state||!(2&this.state)&&this.directionTest(e))},o.emit=function(t){this.pX=t.deltaX,this.pY=t.deltaY;var o=Ca(t.direction);o&&(t.additionalEvent=this.options.event+o),e.prototype.emit.call(this,t)},t}(xa),ka=function(e){function t(t){return void 0===t&&(t={}),e.call(this,rs({event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},t))||this}ss(t,e);var o=t.prototype;return o.getTouchAction=function(){return Ea.prototype.getTouchAction.call(this)},o.attrTest=function(t){var o,n=this.options.direction;return 30&n?o=t.overallVelocity:6&n?o=t.overallVelocityX:24&n&&(o=t.overallVelocityY),e.prototype.attrTest.call(this,t)&&n&t.offsetDirection&&t.distance>this.options.threshold&&t.maxPointers===this.options.pointers&&ps(o)>this.options.velocity&&4&t.eventType},o.emit=function(e){var t=Ca(e.offsetDirection);t&&this.manager.emit(this.options.event+t,e),this.manager.emit(this.options.event,e)},t}(xa),_a=function(e){function t(t){return void 0===t&&(t={}),e.call(this,rs({event:"pinch",threshold:0,pointers:2},t))||this}ss(t,e);var o=t.prototype;return o.getTouchAction=function(){return[ws]},o.attrTest=function(t){return e.prototype.attrTest.call(this,t)&&(Math.abs(t.scale-1)>this.options.threshold||2&this.state)},o.emit=function(t){1!==t.scale&&(t.additionalEvent=this.options.event+(t.scale<1?"in":"out")),e.prototype.emit.call(this,t)},t}(xa),Aa=function(e){function t(t){return void 0===t&&(t={}),e.call(this,rs({event:"rotate",threshold:0,pointers:2},t))||this}ss(t,e);var o=t.prototype;return o.getTouchAction=function(){return[ws]},o.attrTest=function(t){return e.prototype.attrTest.call(this,t)&&(Math.abs(t.rotation)>this.options.threshold||2&this.state)},t}(xa),Oa=function(e){function t(t){var o;return void 0===t&&(t={}),(o=e.call(this,rs({event:"press",pointers:1,time:251,threshold:9},t))||this)._timer=null,o._input=null,o}ss(t,e);var o=t.prototype;return o.getTouchAction=function(){return[ys]},o.process=function(e){var t=this,o=this.options,n=e.pointers.length===o.pointers,i=e.distance<o.threshold,r=e.deltaTime>o.time;if(this._input=e,!i||!n||12&e.eventType&&!r)this.reset();else if(1&e.eventType)this.reset(),this._timer=setTimeout(function(){t.state=8,t.tryEmit()},o.time);else if(4&e.eventType)return 8;return ga},o.reset=function(){clearTimeout(this._timer)},o.emit=function(e){8===this.state&&(e&&4&e.eventType?this.manager.emit(this.options.event+"up",e):(this._input.timeStamp=fs(),this.manager.emit(this.options.event,this._input)))},t}(ja),Ma={domEvents:!1,touchAction:ms,enable:!0,inputTarget:null,inputClass:null,cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},Ia=[[Aa,{enable:!1}],[_a,{enable:!1},["rotate"]],[ka,{direction:6}],[Ea,{direction:6},["swipe"]],[wa],[wa,{event:"doubletap",taps:2},["tap"]],[Oa]];function Na(e,t){var o,n=e.element;n.style&&(Ss(e.options.cssProps,function(i,r){o=vs(n.style,r),t?(e.oldCssProps[o]=n.style[o],n.style[o]=i):n.style[o]=e.oldCssProps[o]||""}),t||(e.oldCssProps={}))}var Sa=function(){function e(e,t){var o=this;this.options=us({},Ma,t||{}),this.options.inputTarget=this.options.inputTarget||e,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=e,this.input=new(this.options.inputClass||(_s?ea:As?ra:ks?fa:ca))(this,Vs),this.touchAction=new Ls(this,this.options.touchAction),Na(this,!0),Ss(this.options.recognizers,function(e){var t=o.add(new e[0](e[1]));e[2]&&t.recognizeWith(e[2]),e[3]&&t.requireFailure(e[3])},this)}var t=e.prototype;return t.set=function(e){return us(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this},t.stop=function(e){this.session.stopped=e?2:1},t.recognize=function(e){var t=this.session;if(!t.stopped){var o;this.touchAction.preventDefaults(e);var n=this.recognizers,i=t.curRecognizer;(!i||i&&8&i.state)&&(t.curRecognizer=null,i=null);for(var r=0;r<n.length;)o=n[r],2===t.stopped||i&&o!==i&&!o.canRecognizeWith(i)?o.reset():o.recognize(e),!i&&14&o.state&&(t.curRecognizer=o,i=o),r++}},t.get=function(e){if(e instanceof ja)return e;for(var t=this.recognizers,o=0;o<t.length;o++)if(t[o].options.event===e)return t[o];return null},t.add=function(e){if(va(e,"add",this))return this;var t=this.get(e.options.event);return t&&this.remove(t),this.recognizers.push(e),e.manager=this,this.touchAction.update(),e},t.remove=function(e){if(va(e,"remove",this))return this;var t=this.get(e);if(e){var o=this.recognizers,n=Ks(o,t);-1!==n&&(o.splice(n,1),this.touchAction.update())}return this},t.on=function(e,t){if(void 0===e||void 0===t)return this;var o=this.handlers;return Ss(Us(e),function(e){o[e]=o[e]||[],o[e].push(t)}),this},t.off=function(e,t){if(void 0===e)return this;var o=this.handlers;return Ss(Us(e),function(e){t?o[e]&&o[e].splice(Ks(o[e],t),1):delete o[e]}),this},t.emit=function(e,t){this.options.domEvents&&function(e,t){var o=document.createEvent("Event");o.initEvent(e,!0,!0),o.gesture=t,t.target.dispatchEvent(o)}(e,t);var o=this.handlers[e]&&this.handlers[e].slice();if(o&&o.length){t.type=e,t.preventDefault=function(){t.srcEvent.preventDefault()};for(var n=0;n<o.length;)o[n](t),n++}},t.destroy=function(){this.element&&Na(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null},e}(),Ta={touchstart:1,touchmove:2,touchend:4,touchcancel:8},Da="touchstart",La="touchstart touchmove touchend touchcancel",Fa=function(e){function t(){var o,n=t.prototype;return n.evTarget=Da,n.evWin=La,(o=e.apply(this,arguments)||this).started=!1,o}return ss(t,e),t.prototype.handler=function(e){var t=Ta[e.type];if(1===t&&(this.started=!0),this.started){var o=Ra.call(this,e,t);12&t&&o[0].length-o[1].length==0&&(this.started=!1),this.callback(this.manager,t,{pointers:o[0],changedPointers:o[1],pointerType:Os,srcEvent:e})}},t}(Gs);function Ra(e,t){var o=ta(e.touches),n=ta(e.changedTouches);return 12&t&&(o=oa(o.concat(n),"identifier",!0)),[o,n]}function Pa(e,t,o){var n="DEPRECATED METHOD: "+t+"\n"+o+" AT \n";return function(){var t=new Error("get-stack-trace"),o=t&&t.stack?t.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",i=window.console&&(window.console.warn||window.console.log);return i&&i.call(window.console,n,o),e.apply(this,arguments)}}var Ba=Pa(function(e,t,o){for(var n=Object.keys(t),i=0;i<n.length;)(!o||o&&void 0===e[n[i]])&&(e[n[i]]=t[n[i]]),i++;return e},"extend","Use `assign`."),za=Pa(function(e,t){return Ba(e,t,!0)},"merge","Use `assign`.");function Ha(e,t,o){var n,i=t.prototype;(n=e.prototype=Object.create(i)).constructor=e,n._super=i,o&&us(n,o)}function Wa(e,t){return function(){return e.apply(t,arguments)}}var Va=function(){var e=function(e,t){return void 0===t&&(t={}),new Sa(e,rs({recognizers:Ia.concat()},t))};return e.VERSION="2.0.17-rc",e.DIRECTION_ALL=30,e.DIRECTION_DOWN=16,e.DIRECTION_LEFT=2,e.DIRECTION_RIGHT=4,e.DIRECTION_UP=8,e.DIRECTION_HORIZONTAL=6,e.DIRECTION_VERTICAL=24,e.DIRECTION_NONE=1,e.DIRECTION_DOWN=16,e.INPUT_START=1,e.INPUT_MOVE=2,e.INPUT_END=4,e.INPUT_CANCEL=8,e.STATE_POSSIBLE=1,e.STATE_BEGAN=2,e.STATE_CHANGED=4,e.STATE_ENDED=8,e.STATE_RECOGNIZED=8,e.STATE_CANCELLED=16,e.STATE_FAILED=ga,e.Manager=Sa,e.Input=Gs,e.TouchAction=Ls,e.TouchInput=ra,e.MouseInput=ca,e.PointerEventInput=ea,e.TouchMouseInput=fa,e.SingleTouchInput=Fa,e.Recognizer=ja,e.AttrRecognizer=xa,e.Tap=wa,e.Pan=Ea,e.Swipe=ka,e.Pinch=_a,e.Rotate=Aa,e.Press=Oa,e.on=Ys,e.off=qs,e.each=Ss,e.merge=za,e.extend=Ba,e.bindFn=Wa,e.assign=us,e.inherit=Ha,e.bindFn=Wa,e.prefixed=vs,e.toArray=ta,e.inArray=Ks,e.uniqueArray=oa,e.splitStr=Us,e.boolOrFn=Ts,e.hasParent=Fs,e.addEventListeners=Ys,e.removeEventListeners=qs,e.defaults=us({},Ma,{preset:Ia}),e}();function Ua(e,t){var o=Hr(e);if(Co){var n=Co(e);t&&(n=Si(n).call(n,function(t){return He(e,t).enumerable})),o.push.apply(o,n)}return o}function Ya(e){for(var t=1;t<arguments.length;t++){var o,n=null!=arguments[t]?arguments[t]:{};if(t%2)pr(o=Ua(Object(n),!0)).call(o,function(t){zn(e,t,n[t])});else if(Fe)Me(e,Fe(n));else{var i;pr(i=Ua(Object(n))).call(i,function(t){Ae(e,t,He(n,t))})}}return e}function qa(e,t){var o;if(void 0===is||null==nn(e)){if(Gr(e)||(o=function(e,t){var o;if(e){if("string"==typeof e)return Xa(e,t);var n=Zr(o=Object.prototype.toString.call(e)).call(o,8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?gn(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Xa(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){o&&(e=o);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){o=on(e)},n:function(){var e=o.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==o.return||o.return()}finally{if(a)throw r}}}}function Xa(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}var Ga=is("DELETE");function Ka(e){for(var t,o=arguments.length,n=new Array(o>1?o-1:0),i=1;i<o;i++)n[i-1]=arguments[i];return Ja.apply(void 0,ns(t=[{},e]).call(t,n))}function Ja(){var e=$a.apply(void 0,arguments);return Za(e),e}function $a(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];if(t.length<2)return t[0];var n;if(t.length>2)return $a.apply(void 0,ns(n=[Ja(t[0],t[1])]).call(n,es(Zr(t).call(t,2))));var i,r=t[0],s=t[1],a=qa(Qr(s));try{for(a.s();!(i=a.n()).done;){var l=i.value;Object.prototype.propertyIsEnumerable.call(s,l)&&(s[l]===Ga?delete r[l]:r[l]=null===r[l]||null===s[l]||"object"!==$r(r[l])||"object"!==$r(s[l])||Gr(r[l])||Gr(s[l])?Qa(s[l]):$a(r[l],s[l]))}}catch(e){a.e(e)}finally{a.f()}return r}function Qa(e){return Gr(e)?Xr(e).call(e,function(e){return Qa(e)}):"object"===$r(e)&&null!==e?$a({},e):e}function Za(e){for(var t=0,o=Hr(e);t<o.length;t++){var n=o[t];e[n]===Ga?delete e[n]:"object"===$r(e[n])&&null!==e[n]&&Za(e[n])}}function el(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return tl(t.length?t:[Br()])}function tl(e){var t=function(){for(var e=ol(),t=e(" "),o=e(" "),n=e(" "),i=0;i<arguments.length;i++)(t-=e(i<0||arguments.length<=i?void 0:arguments[i]))<0&&(t+=1),(o-=e(i<0||arguments.length<=i?void 0:arguments[i]))<0&&(o+=1),(n-=e(i<0||arguments.length<=i?void 0:arguments[i]))<0&&(n+=1);return[t,o,n]}(e),o=Pr(t,3),n=o[0],i=o[1],r=o[2],s=1,a=function(){var e=2091639*n+2.3283064365386963e-10*s;return n=i,i=r,r=e-(s=0|e)};return a.uint32=function(){return 4294967296*a()},a.fract53=function(){return a()+11102230246251565e-32*(2097152*a()|0)},a.algorithm="Alea",a.seed=e,a.version="0.9",a}function ol(){var e=4022871197;return function(t){for(var o=t.toString(),n=0;n<o.length;n++){var i=.02519603282416938*(e+=o.charCodeAt(n));i-=e=i>>>0,e=(i*=e)>>>0,e+=4294967296*(i-=e)}return 2.3283064365386963e-10*(e>>>0)}}var nl="undefined"!=typeof window?window.Hammer||Va:function(){return{on:e=function(){},off:e,destroy:e,emit:e,get:function(){return{set:e}}};var e};function il(e){var t,o=this;this._cleanupQueue=[],this.active=!1,this._dom={container:e,overlay:document.createElement("div")},this._dom.overlay.classList.add("vis-overlay"),this._dom.container.appendChild(this._dom.overlay),this._cleanupQueue.push(function(){o._dom.overlay.parentNode.removeChild(o._dom.overlay)});var n=nl(this._dom.overlay);n.on("tap",$(t=this._onTapOverlay).call(t,this)),this._cleanupQueue.push(function(){n.destroy()});var i=["tap","doubletap","press","pinch","pan","panstart","panmove","panend"];pr(i).call(i,function(e){n.on(e,function(e){e.srcEvent.stopPropagation()})}),document&&document.body&&(this._onClick=function(t){(function(e,t){for(;e;){if(e===t)return!0;e=e.parentNode}return!1})(t.target,e)||o.deactivate()},document.body.addEventListener("click",this._onClick),this._cleanupQueue.push(function(){document.body.removeEventListener("click",o._onClick)})),this._escListener=function(e){("key"in e?"Escape"===e.key:27===e.keyCode)&&o.deactivate()}}ke(il.prototype),il.current=null,il.prototype.destroy=function(){var e,t;this.deactivate();var o,n=qa(rr(e=er(t=this._cleanupQueue).call(t,0)).call(e));try{for(n.s();!(o=n.n()).done;)(0,o.value)()}catch(e){n.e(e)}finally{n.f()}},il.prototype.activate=function(){il.current&&il.current.deactivate(),il.current=this,this.active=!0,this._dom.overlay.style.display="none",this._dom.container.classList.add("vis-active"),this.emit("change"),this.emit("activate"),document.body.addEventListener("keydown",this._escListener)},il.prototype.deactivate=function(){this.active=!1,this._dom.overlay.style.display="block",this._dom.container.classList.remove("vis-active"),document.body.removeEventListener("keydown",this._escListener),this.emit("change"),this.emit("deactivate")},il.prototype._onTapOverlay=function(e){this.activate(),e.srcEvent.stopPropagation()};var rl=/^\/?Date\((-?\d+)/i,sl=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,al=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,ll=/^rgb\( *(1?\d{1,2}|2[0-4]\d|25[0-5]) *, *(1?\d{1,2}|2[0-4]\d|25[0-5]) *, *(1?\d{1,2}|2[0-4]\d|25[0-5]) *\)$/i,ul=/^rgba\( *(1?\d{1,2}|2[0-4]\d|25[0-5]) *, *(1?\d{1,2}|2[0-4]\d|25[0-5]) *, *(1?\d{1,2}|2[0-4]\d|25[0-5]) *, *([01]|0?\.\d+) *\)$/i;function cl(e){return e instanceof Number||"number"==typeof e}function dl(e){if(e)for(;!0===e.hasChildNodes();){var t=e.firstChild;t&&(dl(t),e.removeChild(t))}}function hl(e){return e instanceof String||"string"==typeof e}function pl(e){return"object"===$r(e)&&null!==e}function fl(e,t,o,n){var i=!1;!0===n&&(i=null===t[o]&&void 0!==e[o]),i?delete e[o]:e[o]=t[o]}function vl(e,t){var o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];for(var n in e)if(void 0!==t[n])if(null===t[n]||"object"!==$r(t[n]))fl(e,t,n,o);else{var i=e[n],r=t[n];pl(i)&&pl(r)&&vl(i,r,o)}}var gl=me;function bl(e,t,o){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(Gr(o))throw new TypeError("Arrays are not supported by deepExtend");for(var i=0;i<e.length;i++){var r=e[i];if(Object.prototype.hasOwnProperty.call(o,r))if(o[r]&&o[r].constructor===Object)void 0===t[r]&&(t[r]={}),t[r].constructor===Object?yl(t[r],o[r],!1,n):fl(t,o,r,n);else{if(Gr(o[r]))throw new TypeError("Arrays are not supported by deepExtend");fl(t,o,r,n)}}return t}function ml(e,t,o){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(Gr(o))throw new TypeError("Arrays are not supported by deepExtend");for(var i in o)if(Object.prototype.hasOwnProperty.call(o,i)&&!Yi(e).call(e,i))if(o[i]&&o[i].constructor===Object)void 0===t[i]&&(t[i]={}),t[i].constructor===Object?yl(t[i],o[i]):fl(t,o,i,n);else if(Gr(o[i])){t[i]=[];for(var r=0;r<o[i].length;r++)t[i].push(o[i][r])}else fl(t,o,i,n);return t}function yl(e,t){var o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)||!0===o)if("object"===$r(t[i])&&null!==t[i]&&Li(t[i])===Object.prototype)void 0===e[i]?e[i]=yl({},t[i],o):"object"===$r(e[i])&&null!==e[i]&&Li(e[i])===Object.prototype?yl(e[i],t[i],o):fl(e,t,i,n);else if(Gr(t[i])){var r;e[i]=Zr(r=t[i]).call(r)}else fl(e,t,i,n);return e}function jl(e,t){var o;return ns(o=[]).call(o,es(e),[t])}function wl(e){return Zr(e).call(e)}function xl(e){return e.getBoundingClientRect().left}function Cl(e){return e.getBoundingClientRect().top}function El(e,t){if(Gr(e))for(var o=e.length,n=0;n<o;n++)t(e[n],n,e);else for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t(e[i],i,e)}var kl=ji;function _l(e,t,o,n){var i;e.addEventListener?(void 0===n&&(n=!1),"mousewheel"===t&&Yi(i=navigator.userAgent).call(i,"Firefox")&&(t="DOMMouseScroll"),e.addEventListener(t,o,n)):e.attachEvent("on"+t,o)}function Al(e,t,o,n){var i;e.removeEventListener?(void 0===n&&(n=!1),"mousewheel"===t&&Yi(i=navigator.userAgent).call(i,"Firefox")&&(t="DOMMouseScroll"),e.removeEventListener(t,o,n)):e.detachEvent("on"+t,o)}var Ol={asBoolean:function(e,t){return"function"==typeof e&&(e=e()),null!=e?0!=e:t||null},asNumber:function(e,t){return"function"==typeof e&&(e=e()),null!=e?Number(e)||t||null:t||null},asString:function(e,t){return"function"==typeof e&&(e=e()),null!=e?String(e):t||null},asSize:function(e,t){return"function"==typeof e&&(e=e()),hl(e)?e:cl(e)?e+"px":t||null},asElement:function(e,t){return"function"==typeof e&&(e=e()),e||t||null}};function Ml(e){var t;switch(e.length){case 3:case 4:return(t=al.exec(e))?{r:fi(t[1]+t[1],16),g:fi(t[2]+t[2],16),b:fi(t[3]+t[3],16)}:null;case 6:case 7:return(t=sl.exec(e))?{r:fi(t[1],16),g:fi(t[2],16),b:fi(t[3],16)}:null;default:return null}}function Il(e,t){if(Yi(e).call(e,"rgba"))return e;if(Yi(e).call(e,"rgb")){var o=e.substr(ui(e).call(e,"(")+1).replace(")","").split(",");return"rgba("+o[0]+","+o[1]+","+o[2]+","+t+")"}var n=Ml(e);return null==n?e:"rgba("+n.r+","+n.g+","+n.b+","+t+")"}function Nl(e,t,o){var n;return"#"+Zr(n=((1<<24)+(e<<16)+(t<<8)+o).toString(16)).call(n,1)}function Sl(e,t){if(hl(e)){var o=e;if(zl(o)){var n,i=Xr(n=o.substr(4).substr(0,o.length-5).split(",")).call(n,function(e){return fi(e)});o=Nl(i[0],i[1],i[2])}if(!0===Bl(o)){var r=Pl(o),s={h:r.h,s:.8*r.s,v:Math.min(1,1.02*r.v)},a={h:r.h,s:Math.min(1,1.25*r.s),v:.8*r.v},l=Rl(a.h,a.s,a.v),u=Rl(s.h,s.s,s.v);return{background:o,border:l,highlight:{background:u,border:l},hover:{background:u,border:l}}}return{background:o,border:o,highlight:{background:o,border:o},hover:{background:o,border:o}}}return t?{background:e.background||t.background,border:e.border||t.border,highlight:hl(e.highlight)?{border:e.highlight,background:e.highlight}:{background:e.highlight&&e.highlight.background||t.highlight.background,border:e.highlight&&e.highlight.border||t.highlight.border},hover:hl(e.hover)?{border:e.hover,background:e.hover}:{border:e.hover&&e.hover.border||t.hover.border,background:e.hover&&e.hover.background||t.hover.background}}:{background:e.background||void 0,border:e.border||void 0,highlight:hl(e.highlight)?{border:e.highlight,background:e.highlight}:{background:e.highlight&&e.highlight.background||void 0,border:e.highlight&&e.highlight.border||void 0},hover:hl(e.hover)?{border:e.hover,background:e.hover}:{border:e.hover&&e.hover.border||void 0,background:e.hover&&e.hover.background||void 0}}}function Tl(e,t,o){e/=255,t/=255,o/=255;var n=Math.min(e,Math.min(t,o)),i=Math.max(e,Math.max(t,o));return n===i?{h:0,s:0,v:n}:{h:60*((e===n?3:o===n?1:5)-(e===n?t-o:o===n?e-t:o-e)/(i-n))/360,s:(i-n)/i,v:i}}var Dl=function(e){var t,o={};return pr(t=e.split(";")).call(t,function(e){if(""!=Jn(e).call(e)){var t,n,i=e.split(":"),r=Jn(t=i[0]).call(t),s=Jn(n=i[1]).call(n);o[r]=s}}),o},Ll=function(e){var t;return Xr(t=Hr(e)).call(t,function(t){return t+": "+e[t]}).join("; ")};function Fl(e,t,o){var n,i,r,s=Math.floor(6*e),a=6*e-s,l=o*(1-t),u=o*(1-a*t),c=o*(1-(1-a)*t);switch(s%6){case 0:n=o,i=c,r=l;break;case 1:n=u,i=o,r=l;break;case 2:n=l,i=o,r=c;break;case 3:n=l,i=u,r=o;break;case 4:n=c,i=l,r=o;break;case 5:n=o,i=l,r=u}return{r:Math.floor(255*n),g:Math.floor(255*i),b:Math.floor(255*r)}}function Rl(e,t,o){var n=Fl(e,t,o);return Nl(n.r,n.g,n.b)}function Pl(e){var t=Ml(e);if(!t)throw new TypeError("'".concat(e,"' is not a valid color."));return Tl(t.r,t.g,t.b)}function Bl(e){return/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(e)}function zl(e){return ll.test(e)}function Hl(e){return ul.test(e)}function Wl(e){if(null===e||"object"!==$r(e))return null;if(e instanceof Element)return e;var t=Bn(e);for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&"object"==$r(e[o])&&(t[o]=Wl(e[o]));return t}function Vl(e,t,o){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=function(e){return null!=e},r=function(e){return null!==e&&"object"===$r(e)},s=function(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0};if(!r(e))throw new Error("Parameter mergeTarget must be an object");if(!r(t))throw new Error("Parameter options must be an object");if(!i(o))throw new Error("Parameter option must have a value");if(!r(n))throw new Error("Parameter globalOptions must be an object");var a=function(e,t,o){r(e[o])||(e[o]={});var n=t[o],i=e[o];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(i[s]=n[s])},l=t[o],u=r(n)&&!s(n),c=u?n[o]:void 0,d=c?c.enabled:void 0;if(void 0!==l){if("boolean"==typeof l)return r(e[o])||(e[o]={}),void(e[o].enabled=l);if(null===l&&!r(e[o])){if(!i(c))return;e[o]=Bn(c)}if(r(l)){var h=!0;void 0!==l.enabled?h=l.enabled:void 0!==d&&(h=c.enabled),a(e,t,o),e[o].enabled=h}}}var Ul={linear:function(e){return e},easeInQuad:function(e){return e*e},easeOutQuad:function(e){return e*(2-e)},easeInOutQuad:function(e){return e<.5?2*e*e:(4-2*e)*e-1},easeInCubic:function(e){return e*e*e},easeOutCubic:function(e){return--e*e*e+1},easeInOutCubic:function(e){return e<.5?4*e*e*e:(e-1)*(2*e-2)*(2*e-2)+1},easeInQuart:function(e){return e*e*e*e},easeOutQuart:function(e){return 1- --e*e*e*e},easeInOutQuart:function(e){return e<.5?8*e*e*e*e:1-8*--e*e*e*e},easeInQuint:function(e){return e*e*e*e*e},easeOutQuint:function(e){return 1+--e*e*e*e*e},easeInOutQuint:function(e){return e<.5?16*e*e*e*e*e:1+16*--e*e*e*e*e}};function Yl(e,t){var o;Gr(t)||(t=[t]);var n,i=qa(e);try{for(i.s();!(n=i.n()).done;){var r=n.value;if(r){o=r[t[0]];for(var s=1;s<t.length;s++)o&&(o=o[t[s]]);if(void 0!==o)break}}}catch(e){i.e(e)}finally{i.f()}return o}var ql={black:"#000000",navy:"#000080",darkblue:"#00008B",mediumblue:"#0000CD",blue:"#0000FF",darkgreen:"#006400",green:"#008000",teal:"#008080",darkcyan:"#008B8B",deepskyblue:"#00BFFF",darkturquoise:"#00CED1",mediumspringgreen:"#00FA9A",lime:"#00FF00",springgreen:"#00FF7F",aqua:"#00FFFF",cyan:"#00FFFF",midnightblue:"#191970",dodgerblue:"#1E90FF",lightseagreen:"#20B2AA",forestgreen:"#228B22",seagreen:"#2E8B57",darkslategray:"#2F4F4F",limegreen:"#32CD32",mediumseagreen:"#3CB371",turquoise:"#40E0D0",royalblue:"#4169E1",steelblue:"#4682B4",darkslateblue:"#483D8B",mediumturquoise:"#48D1CC",indigo:"#4B0082",darkolivegreen:"#556B2F",cadetblue:"#5F9EA0",cornflowerblue:"#6495ED",mediumaquamarine:"#66CDAA",dimgray:"#696969",slateblue:"#6A5ACD",olivedrab:"#6B8E23",slategray:"#708090",lightslategray:"#778899",mediumslateblue:"#7B68EE",lawngreen:"#7CFC00",chartreuse:"#7FFF00",aquamarine:"#7FFFD4",maroon:"#800000",purple:"#800080",olive:"#808000",gray:"#808080",skyblue:"#87CEEB",lightskyblue:"#87CEFA",blueviolet:"#8A2BE2",darkred:"#8B0000",darkmagenta:"#8B008B",saddlebrown:"#8B4513",darkseagreen:"#8FBC8F",lightgreen:"#90EE90",mediumpurple:"#9370D8",darkviolet:"#9400D3",palegreen:"#98FB98",darkorchid:"#9932CC",yellowgreen:"#9ACD32",sienna:"#A0522D",brown:"#A52A2A",darkgray:"#A9A9A9",lightblue:"#ADD8E6",greenyellow:"#ADFF2F",paleturquoise:"#AFEEEE",lightsteelblue:"#B0C4DE",powderblue:"#B0E0E6",firebrick:"#B22222",darkgoldenrod:"#B8860B",mediumorchid:"#BA55D3",rosybrown:"#BC8F8F",darkkhaki:"#BDB76B",silver:"#C0C0C0",mediumvioletred:"#C71585",indianred:"#CD5C5C",peru:"#CD853F",chocolate:"#D2691E",tan:"#D2B48C",lightgrey:"#D3D3D3",palevioletred:"#D87093",thistle:"#D8BFD8",orchid:"#DA70D6",goldenrod:"#DAA520",crimson:"#DC143C",gainsboro:"#DCDCDC",plum:"#DDA0DD",burlywood:"#DEB887",lightcyan:"#E0FFFF",lavender:"#E6E6FA",darksalmon:"#E9967A",violet:"#EE82EE",palegoldenrod:"#EEE8AA",lightcoral:"#F08080",khaki:"#F0E68C",aliceblue:"#F0F8FF",honeydew:"#F0FFF0",azure:"#F0FFFF",sandybrown:"#F4A460",wheat:"#F5DEB3",beige:"#F5F5DC",whitesmoke:"#F5F5F5",mintcream:"#F5FFFA",ghostwhite:"#F8F8FF",salmon:"#FA8072",antiquewhite:"#FAEBD7",linen:"#FAF0E6",lightgoldenrodyellow:"#FAFAD2",oldlace:"#FDF5E6",red:"#FF0000",fuchsia:"#FF00FF",magenta:"#FF00FF",deeppink:"#FF1493",orangered:"#FF4500",tomato:"#FF6347",hotpink:"#FF69B4",coral:"#FF7F50",darkorange:"#FF8C00",lightsalmon:"#FFA07A",orange:"#FFA500",lightpink:"#FFB6C1",pink:"#FFC0CB",gold:"#FFD700",peachpuff:"#FFDAB9",navajowhite:"#FFDEAD",moccasin:"#FFE4B5",bisque:"#FFE4C4",mistyrose:"#FFE4E1",blanchedalmond:"#FFEBCD",papayawhip:"#FFEFD5",lavenderblush:"#FFF0F5",seashell:"#FFF5EE",cornsilk:"#FFF8DC",lemonchiffon:"#FFFACD",floralwhite:"#FFFAF0",snow:"#FFFAFA",yellow:"#FFFF00",lightyellow:"#FFFFE0",ivory:"#FFFFF0",white:"#FFFFFF"},Xl=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;Sn(this,e),this.pixelRatio=t,this.generated=!1,this.centerCoordinates={x:144.5,y:144.5},this.r=289*.49,this.color={r:255,g:255,b:255,a:1},this.hueCircle=void 0,this.initialColor={r:255,g:255,b:255,a:1},this.previousColor=void 0,this.applied=!1,this.updateCallback=function(){},this.closeCallback=function(){},this._create()}return Ln(e,[{key:"insertTo",value:function(e){void 0!==this.hammer&&(this.hammer.destroy(),this.hammer=void 0),this.container=e,this.container.appendChild(this.frame),this._bindHammer(),this._setSize()}},{key:"setUpdateCallback",value:function(e){if("function"!=typeof e)throw new Error("Function attempted to set as colorPicker update callback is not a function.");this.updateCallback=e}},{key:"setCloseCallback",value:function(e){if("function"!=typeof e)throw new Error("Function attempted to set as colorPicker closing callback is not a function.");this.closeCallback=e}},{key:"_isColorString",value:function(e){if("string"==typeof e)return ql[e]}},{key:"setColor",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("none"!==e){var o,n=this._isColorString(e);if(void 0!==n&&(e=n),!0===hl(e)){if(!0===zl(e)){var i=e.substr(4).substr(0,e.length-5).split(",");o={r:i[0],g:i[1],b:i[2],a:1}}else if(!0===Hl(e)){var r=e.substr(5).substr(0,e.length-6).split(",");o={r:r[0],g:r[1],b:r[2],a:r[3]}}else if(!0===Bl(e)){var s=Ml(e);o={r:s.r,g:s.g,b:s.b,a:1}}}else if(e instanceof Object&&void 0!==e.r&&void 0!==e.g&&void 0!==e.b){var a=void 0!==e.a?e.a:"1.0";o={r:e.r,g:e.g,b:e.b,a:a}}if(void 0===o)throw new Error("Unknown color passed to the colorPicker. Supported are strings: rgb, hex, rgba. Object: rgb ({r:r,g:g,b:b,[a:a]}). Supplied: "+Nn(e));this._setColor(o,t)}}},{key:"show",value:function(){void 0!==this.closeCallback&&(this.closeCallback(),this.closeCallback=void 0),this.applied=!1,this.frame.style.display="block",this._generateHueCircle()}},{key:"_hide",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];!0===t&&(this.previousColor=me({},this.color)),!0===this.applied&&this.updateCallback(this.initialColor),this.frame.style.display="none",En(function(){void 0!==e.closeCallback&&(e.closeCallback(),e.closeCallback=void 0)},0)}},{key:"_save",value:function(){this.updateCallback(this.color),this.applied=!1,this._hide()}},{key:"_apply",value:function(){this.applied=!0,this.updateCallback(this.color),this._updatePicker(this.color)}},{key:"_loadLast",value:function(){void 0!==this.previousColor?this.setColor(this.previousColor,!1):alert("There is no last color to load...")}},{key:"_setColor",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];!0===t&&(this.initialColor=me({},e)),this.color=e;var o=Tl(e.r,e.g,e.b),n=2*Math.PI,i=this.r*o.s,r=this.centerCoordinates.x+i*Math.sin(n*o.h),s=this.centerCoordinates.y+i*Math.cos(n*o.h);this.colorPickerSelector.style.left=r-.5*this.colorPickerSelector.clientWidth+"px",this.colorPickerSelector.style.top=s-.5*this.colorPickerSelector.clientHeight+"px",this._updatePicker(e)}},{key:"_setOpacity",value:function(e){this.color.a=e/100,this._updatePicker(this.color)}},{key:"_setBrightness",value:function(e){var t=Tl(this.color.r,this.color.g,this.color.b);t.v=e/100;var o=Fl(t.h,t.s,t.v);o.a=this.color.a,this.color=o,this._updatePicker()}},{key:"_updatePicker",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.color,t=Tl(e.r,e.g,e.b),o=this.colorPickerCanvas.getContext("2d");void 0===this.pixelRation&&(this.pixelRatio=(window.devicePixelRatio||1)/(o.webkitBackingStorePixelRatio||o.mozBackingStorePixelRatio||o.msBackingStorePixelRatio||o.oBackingStorePixelRatio||o.backingStorePixelRatio||1)),o.setTransform(this.pixelRatio,0,0,this.pixelRatio,0,0);var n=this.colorPickerCanvas.clientWidth,i=this.colorPickerCanvas.clientHeight;o.clearRect(0,0,n,i),o.putImageData(this.hueCircle,0,0),o.fillStyle="rgba(0,0,0,"+(1-t.v)+")",o.circle(this.centerCoordinates.x,this.centerCoordinates.y,this.r),yn(o).call(o),this.brightnessRange.value=100*t.v,this.opacityRange.value=100*e.a,this.initialColorDiv.style.backgroundColor="rgba("+this.initialColor.r+","+this.initialColor.g+","+this.initialColor.b+","+this.initialColor.a+")",this.newColorDiv.style.backgroundColor="rgba("+this.color.r+","+this.color.g+","+this.color.b+","+this.color.a+")"}},{key:"_setSize",value:function(){this.colorPickerCanvas.style.width="100%",this.colorPickerCanvas.style.height="100%",this.colorPickerCanvas.width=289*this.pixelRatio,this.colorPickerCanvas.height=289*this.pixelRatio}},{key:"_create",value:function(){var e,t,o,n;if(this.frame=document.createElement("div"),this.frame.className="vis-color-picker",this.colorPickerDiv=document.createElement("div"),this.colorPickerSelector=document.createElement("div"),this.colorPickerSelector.className="vis-selector",this.colorPickerDiv.appendChild(this.colorPickerSelector),this.colorPickerCanvas=document.createElement("canvas"),this.colorPickerDiv.appendChild(this.colorPickerCanvas),this.colorPickerCanvas.getContext){var i=this.colorPickerCanvas.getContext("2d");this.pixelRatio=(window.devicePixelRatio||1)/(i.webkitBackingStorePixelRatio||i.mozBackingStorePixelRatio||i.msBackingStorePixelRatio||i.oBackingStorePixelRatio||i.backingStorePixelRatio||1),this.colorPickerCanvas.getContext("2d").setTransform(this.pixelRatio,0,0,this.pixelRatio,0,0)}else{var r=document.createElement("DIV");r.style.color="red",r.style.fontWeight="bold",r.style.padding="10px",r.innerText="Error: your browser does not support HTML canvas",this.colorPickerCanvas.appendChild(r)}this.colorPickerDiv.className="vis-color",this.opacityDiv=document.createElement("div"),this.opacityDiv.className="vis-opacity",this.brightnessDiv=document.createElement("div"),this.brightnessDiv.className="vis-brightness",this.arrowDiv=document.createElement("div"),this.arrowDiv.className="vis-arrow",this.opacityRange=document.createElement("input");try{this.opacityRange.type="range",this.opacityRange.min="0",this.opacityRange.max="100"}catch(e){}this.opacityRange.value="100",this.opacityRange.className="vis-range",this.brightnessRange=document.createElement("input");try{this.brightnessRange.type="range",this.brightnessRange.min="0",this.brightnessRange.max="100"}catch(e){}this.brightnessRange.value="100",this.brightnessRange.className="vis-range",this.opacityDiv.appendChild(this.opacityRange),this.brightnessDiv.appendChild(this.brightnessRange);var s=this;this.opacityRange.onchange=function(){s._setOpacity(this.value)},this.opacityRange.oninput=function(){s._setOpacity(this.value)},this.brightnessRange.onchange=function(){s._setBrightness(this.value)},this.brightnessRange.oninput=function(){s._setBrightness(this.value)},this.brightnessLabel=document.createElement("div"),this.brightnessLabel.className="vis-label vis-brightness",this.brightnessLabel.innerText="brightness:",this.opacityLabel=document.createElement("div"),this.opacityLabel.className="vis-label vis-opacity",this.opacityLabel.innerText="opacity:",this.newColorDiv=document.createElement("div"),this.newColorDiv.className="vis-new-color",this.newColorDiv.innerText="new",this.initialColorDiv=document.createElement("div"),this.initialColorDiv.className="vis-initial-color",this.initialColorDiv.innerText="initial",this.cancelButton=document.createElement("div"),this.cancelButton.className="vis-button vis-cancel",this.cancelButton.innerText="cancel",this.cancelButton.onclick=$(e=this._hide).call(e,this,!1),this.applyButton=document.createElement("div"),this.applyButton.className="vis-button vis-apply",this.applyButton.innerText="apply",this.applyButton.onclick=$(t=this._apply).call(t,this),this.saveButton=document.createElement("div"),this.saveButton.className="vis-button vis-save",this.saveButton.innerText="save",this.saveButton.onclick=$(o=this._save).call(o,this),this.loadButton=document.createElement("div"),this.loadButton.className="vis-button vis-load",this.loadButton.innerText="load last",this.loadButton.onclick=$(n=this._loadLast).call(n,this),this.frame.appendChild(this.colorPickerDiv),this.frame.appendChild(this.arrowDiv),this.frame.appendChild(this.brightnessLabel),this.frame.appendChild(this.brightnessDiv),this.frame.appendChild(this.opacityLabel),this.frame.appendChild(this.opacityDiv),this.frame.appendChild(this.newColorDiv),this.frame.appendChild(this.initialColorDiv),this.frame.appendChild(this.cancelButton),this.frame.appendChild(this.applyButton),this.frame.appendChild(this.saveButton),this.frame.appendChild(this.loadButton)}},{key:"_bindHammer",value:function(){var e=this;this.drag={},this.pinch={},this.hammer=new nl(this.colorPickerCanvas),this.hammer.get("pinch").set({enable:!0}),this.hammer.on("hammer.input",function(t){t.isFirst&&e._moveSelector(t)}),this.hammer.on("tap",function(t){e._moveSelector(t)}),this.hammer.on("panstart",function(t){e._moveSelector(t)}),this.hammer.on("panmove",function(t){e._moveSelector(t)}),this.hammer.on("panend",function(t){e._moveSelector(t)})}},{key:"_generateHueCircle",value:function(){if(!1===this.generated){var e=this.colorPickerCanvas.getContext("2d");void 0===this.pixelRation&&(this.pixelRatio=(window.devicePixelRatio||1)/(e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1)),e.setTransform(this.pixelRatio,0,0,this.pixelRatio,0,0);var t,o,n,i,r=this.colorPickerCanvas.clientWidth,s=this.colorPickerCanvas.clientHeight;e.clearRect(0,0,r,s),this.centerCoordinates={x:.5*r,y:.5*s},this.r=.49*r;var a,l=2*Math.PI/360,u=1/this.r;for(n=0;n<360;n++)for(i=0;i<this.r;i++)t=this.centerCoordinates.x+i*Math.sin(l*n),o=this.centerCoordinates.y+i*Math.cos(l*n),a=Fl(.002777777777777778*n,i*u,1),e.fillStyle="rgb("+a.r+","+a.g+","+a.b+")",e.fillRect(t-.5,o-.5,2,2);e.strokeStyle="rgba(0,0,0,1)",e.circle(this.centerCoordinates.x,this.centerCoordinates.y,this.r),e.stroke(),this.hueCircle=e.getImageData(0,0,r,s)}this.generated=!0}},{key:"_moveSelector",value:function(e){var t=this.colorPickerDiv.getBoundingClientRect(),o=.5*this.colorPickerDiv.clientHeight,n=.5*this.colorPickerDiv.clientWidth,i=e.center.x-t.left-n,r=e.center.y-t.top-o,s=Math.atan2(i,r),a=.98*Math.min(Math.sqrt(i*i+r*r),n),l=Math.cos(s)*a+o,u=Math.sin(s)*a+n;this.colorPickerSelector.style.top=l-.5*this.colorPickerSelector.clientHeight+"px",this.colorPickerSelector.style.left=u-.5*this.colorPickerSelector.clientWidth+"px";var c=s/(2*Math.PI);c=c<0?c+1:c;var d=a/this.r,h=Tl(this.color.r,this.color.g,this.color.b);h.h=c,h.s=d;var p=Fl(h.h,h.s,h.v);p.a=this.color.a,this.color=p,this.initialColorDiv.style.backgroundColor="rgba("+this.initialColor.r+","+this.initialColor.g+","+this.initialColor.b+","+this.initialColor.a+")",this.newColorDiv.style.backgroundColor="rgba("+this.color.r+","+this.color.g+","+this.color.b+","+this.color.a+")"}}]),e}();function Gl(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];if(t.length<1)throw new TypeError("Invalid arguments.");if(1===t.length)return document.createTextNode(t[0]);var n=document.createElement(t[0]);return n.appendChild(Gl.apply(void 0,es(Zr(t).call(t,1)))),n}var Kl,Jl=function(){function e(t,o,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){return!1};Sn(this,e),this.parent=t,this.changedOptions=[],this.container=o,this.allowCreation=!1,this.hideOption=r,this.options={},this.initialized=!1,this.popupCounter=0,this.defaultOptions={enabled:!1,filter:!0,container:void 0,showButton:!0},me(this.options,this.defaultOptions),this.configureOptions=n,this.moduleOptions={},this.domElements=[],this.popupDiv={},this.popupLimit=5,this.popupHistory={},this.colorPicker=new Xl(i),this.wrapper=void 0}return Ln(e,[{key:"setOptions",value:function(e){if(void 0!==e){this.popupHistory={},this._removePopup();var t=!0;if("string"==typeof e)this.options.filter=e;else if(Gr(e))this.options.filter=e.join();else if("object"===$r(e)){if(null==e)throw new TypeError("options cannot be null");void 0!==e.container&&(this.options.container=e.container),void 0!==Si(e)&&(this.options.filter=Si(e)),void 0!==e.showButton&&(this.options.showButton=e.showButton),void 0!==e.enabled&&(t=e.enabled)}else"boolean"==typeof e?(this.options.filter=!0,t=e):"function"==typeof e&&(this.options.filter=e,t=!0);!1===Si(this.options)&&(t=!1),this.options.enabled=t}this._clean()}},{key:"setModuleOptions",value:function(e){this.moduleOptions=e,!0===this.options.enabled&&(this._clean(),void 0!==this.options.container&&(this.container=this.options.container),this._create())}},{key:"_create",value:function(){this._clean(),this.changedOptions=[];var e=Si(this.options),t=0,o=!1;for(var n in this.configureOptions)Object.prototype.hasOwnProperty.call(this.configureOptions,n)&&(this.allowCreation=!1,o=!1,"function"==typeof e?o=(o=e(n,[]))||this._handleObject(this.configureOptions[n],[n],!0):!0!==e&&-1===ui(e).call(e,n)||(o=!0),!1!==o&&(this.allowCreation=!0,t>0&&this._makeItem([]),this._makeHeader(n),this._handleObject(this.configureOptions[n],[n])),t++);this._makeButton(),this._push()}},{key:"_push",value:function(){this.wrapper=document.createElement("div"),this.wrapper.className="vis-configuration-wrapper",this.container.appendChild(this.wrapper);for(var e=0;e<this.domElements.length;e++)this.wrapper.appendChild(this.domElements[e]);this._showPopupIfNeeded()}},{key:"_clean",value:function(){for(var e=0;e<this.domElements.length;e++)this.wrapper.removeChild(this.domElements[e]);void 0!==this.wrapper&&(this.container.removeChild(this.wrapper),this.wrapper=void 0),this.domElements=[],this._removePopup()}},{key:"_getValue",value:function(e){for(var t=this.moduleOptions,o=0;o<e.length;o++){if(void 0===t[e[o]]){t=void 0;break}t=t[e[o]]}return t}},{key:"_makeItem",value:function(e){if(!0===this.allowCreation){var t=document.createElement("div");t.className="vis-configuration vis-config-item vis-config-s"+e.length;for(var o=arguments.length,n=new Array(o>1?o-1:0),i=1;i<o;i++)n[i-1]=arguments[i];return pr(n).call(n,function(e){t.appendChild(e)}),this.domElements.push(t),this.domElements.length}return 0}},{key:"_makeHeader",value:function(e){var t=document.createElement("div");t.className="vis-configuration vis-config-header",t.innerText=e,this._makeItem([],t)}},{key:"_makeLabel",value:function(e,t){var o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=document.createElement("div");if(n.className="vis-configuration vis-config-label vis-config-s"+t.length,!0===o){for(;n.firstChild;)n.removeChild(n.firstChild);n.appendChild(Gl("i","b",e))}else n.innerText=e+":";return n}},{key:"_makeDropdown",value:function(e,t,o){var n=document.createElement("select");n.className="vis-configuration vis-config-select";var i=0;void 0!==t&&-1!==ui(e).call(e,t)&&(i=ui(e).call(e,t));for(var r=0;r<e.length;r++){var s=document.createElement("option");s.value=e[r],r===i&&(s.selected="selected"),s.innerText=e[r],n.appendChild(s)}var a=this;n.onchange=function(){a._update(this.value,o)};var l=this._makeLabel(o[o.length-1],o);this._makeItem(o,l,n)}},{key:"_makeRange",value:function(e,t,o){var n=e[0],i=e[1],r=e[2],s=e[3],a=document.createElement("input");a.className="vis-configuration vis-config-range";try{a.type="range",a.min=i,a.max=r}catch(e){}a.step=s;var l="",u=0;if(void 0!==t){var c=1.2;t<0&&t*c<i?(a.min=Math.ceil(t*c),u=a.min,l="range increased"):t/c<i&&(a.min=Math.ceil(t/c),u=a.min,l="range increased"),t*c>r&&1!==r&&(a.max=Math.ceil(t*c),u=a.max,l="range increased"),a.value=t}else a.value=n;var d=document.createElement("input");d.className="vis-configuration vis-config-rangeinput",d.value=a.value;var h=this;a.onchange=function(){d.value=this.value,h._update(Number(this.value),o)},a.oninput=function(){d.value=this.value};var p=this._makeLabel(o[o.length-1],o),f=this._makeItem(o,p,a,d);""!==l&&this.popupHistory[f]!==u&&(this.popupHistory[f]=u,this._setupPopup(l,f))}},{key:"_makeButton",value:function(){var e=this;if(!0===this.options.showButton){var t=document.createElement("div");t.className="vis-configuration vis-config-button",t.innerText="generate options",t.onclick=function(){e._printOptions()},t.onmouseover=function(){t.className="vis-configuration vis-config-button hover"},t.onmouseout=function(){t.className="vis-configuration vis-config-button"},this.optionsContainer=document.createElement("div"),this.optionsContainer.className="vis-configuration vis-config-option-container",this.domElements.push(this.optionsContainer),this.domElements.push(t)}}},{key:"_setupPopup",value:function(e,t){var o=this;if(!0===this.initialized&&!0===this.allowCreation&&this.popupCounter<this.popupLimit){var n=document.createElement("div");n.id="vis-configuration-popup",n.className="vis-configuration-popup",n.innerText=e,n.onclick=function(){o._removePopup()},this.popupCounter+=1,this.popupDiv={html:n,index:t}}}},{key:"_removePopup",value:function(){void 0!==this.popupDiv.html&&(this.popupDiv.html.parentNode.removeChild(this.popupDiv.html),clearTimeout(this.popupDiv.hideTimeout),clearTimeout(this.popupDiv.deleteTimeout),this.popupDiv={})}},{key:"_showPopupIfNeeded",value:function(){var e=this;if(void 0!==this.popupDiv.html){var t=this.domElements[this.popupDiv.index].getBoundingClientRect();this.popupDiv.html.style.left=t.left+"px",this.popupDiv.html.style.top=t.top-30+"px",document.body.appendChild(this.popupDiv.html),this.popupDiv.hideTimeout=En(function(){e.popupDiv.html.style.opacity=0},1500),this.popupDiv.deleteTimeout=En(function(){e._removePopup()},1800)}}},{key:"_makeCheckbox",value:function(e,t,o){var n=document.createElement("input");n.type="checkbox",n.className="vis-configuration vis-config-checkbox",n.checked=e,void 0!==t&&(n.checked=t,t!==e&&("object"===$r(e)?t!==e.enabled&&this.changedOptions.push({path:o,value:t}):this.changedOptions.push({path:o,value:t})));var i=this;n.onchange=function(){i._update(this.checked,o)};var r=this._makeLabel(o[o.length-1],o);this._makeItem(o,r,n)}},{key:"_makeTextInput",value:function(e,t,o){var n=document.createElement("input");n.type="text",n.className="vis-configuration vis-config-text",n.value=t,t!==e&&this.changedOptions.push({path:o,value:t});var i=this;n.onchange=function(){i._update(this.value,o)};var r=this._makeLabel(o[o.length-1],o);this._makeItem(o,r,n)}},{key:"_makeColorField",value:function(e,t,o){var n=this,i=e[1],r=document.createElement("div");"none"!==(t=void 0===t?i:t)?(r.className="vis-configuration vis-config-colorBlock",r.style.backgroundColor=t):r.className="vis-configuration vis-config-colorBlock none",t=void 0===t?i:t,r.onclick=function(){n._showColorPicker(t,r,o)};var s=this._makeLabel(o[o.length-1],o);this._makeItem(o,s,r)}},{key:"_showColorPicker",value:function(e,t,o){var n=this;t.onclick=function(){},this.colorPicker.insertTo(t),this.colorPicker.show(),this.colorPicker.setColor(e),this.colorPicker.setUpdateCallback(function(e){var i="rgba("+e.r+","+e.g+","+e.b+","+e.a+")";t.style.backgroundColor=i,n._update(i,o)}),this.colorPicker.setCloseCallback(function(){t.onclick=function(){n._showColorPicker(e,t,o)}})}},{key:"_handleObject",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=!1,i=Si(this.options),r=!1;for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){n=!0;var a=e[s],l=jl(t,s);if("function"==typeof i&&!1===(n=i(s,t))&&!Gr(a)&&"string"!=typeof a&&"boolean"!=typeof a&&a instanceof Object&&(this.allowCreation=!1,n=this._handleObject(a,l,!0),this.allowCreation=!1===o),!1!==n){r=!0;var u=this._getValue(l);if(Gr(a))this._handleArray(a,u,l);else if("string"==typeof a)this._makeTextInput(a,u,l);else if("boolean"==typeof a)this._makeCheckbox(a,u,l);else if(a instanceof Object){if(!this.hideOption(t,s,this.moduleOptions))if(void 0!==a.enabled){var c=jl(l,"enabled"),d=this._getValue(c);if(!0===d){var h=this._makeLabel(s,l,!0);this._makeItem(l,h),r=this._handleObject(a,l)||r}else this._makeCheckbox(a,d,l)}else{var p=this._makeLabel(s,l,!0);this._makeItem(l,p),r=this._handleObject(a,l)||r}}else console.error("dont know how to handle",a,s,l)}}return r}},{key:"_handleArray",value:function(e,t,o){"string"==typeof e[0]&&"color"===e[0]?(this._makeColorField(e,t,o),e[1]!==t&&this.changedOptions.push({path:o,value:t})):"string"==typeof e[0]?(this._makeDropdown(e,t,o),e[0]!==t&&this.changedOptions.push({path:o,value:t})):"number"==typeof e[0]&&(this._makeRange(e,t,o),e[0]!==t&&this.changedOptions.push({path:o,value:Number(t)}))}},{key:"_update",value:function(e,t){var o=this._constructOptions(e,t);this.parent.body&&this.parent.body.emitter&&this.parent.body.emitter.emit&&this.parent.body.emitter.emit("configChange",o),this.initialized=!0,this.parent.setOptions(o)}},{key:"_constructOptions",value:function(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=o;e="false"!==(e="true"===e||e)&&e;for(var i=0;i<t.length;i++)"global"!==t[i]&&(void 0===n[t[i]]&&(n[t[i]]={}),i!==t.length-1?n=n[t[i]]:n[t[i]]=e);return o}},{key:"_printOptions",value:function(){for(var e=this.getOptions();this.optionsContainer.firstChild;)this.optionsContainer.removeChild(this.optionsContainer.firstChild);this.optionsContainer.appendChild(Gl("pre","const options = "+Nn(e,null,2)))}},{key:"getOptions",value:function(){for(var e={},t=0;t<this.changedOptions.length;t++)this._constructOptions(this.changedOptions[t].value,this.changedOptions[t].path,e);return e}}]),e}(),$l=!1,Ql="background: #FFeeee; color: #dd0000",Zl=il,eu=Xl,tu=Jl,ou=nl,nu=function(){function e(t,o){Sn(this,e),this.container=t,this.overflowMethod=o||"cap",this.x=0,this.y=0,this.padding=5,this.hidden=!1,this.frame=document.createElement("div"),this.frame.className="vis-tooltip",this.container.appendChild(this.frame)}return Ln(e,[{key:"setPosition",value:function(e,t){this.x=fi(e),this.y=fi(t)}},{key:"setText",value:function(e){if(e instanceof Element){for(;this.frame.firstChild;)this.frame.removeChild(this.frame.firstChild);this.frame.appendChild(e)}else this.frame.innerText=e}},{key:"show",value:function(e){if(void 0===e&&(e=!0),!0===e){var t=this.frame.clientHeight,o=this.frame.clientWidth,n=this.frame.parentNode.clientHeight,i=this.frame.parentNode.clientWidth,r=0,s=0;if("flip"==this.overflowMethod){var a=!1,l=!0;this.y-t<this.padding&&(l=!1),this.x+o>i-this.padding&&(a=!0),r=a?this.x-o:this.x,s=l?this.y-t:this.y}else(s=this.y-t)+t+this.padding>n&&(s=n-t-this.padding),s<this.padding&&(s=this.padding),(r=this.x)+o+this.padding>i&&(r=i-o-this.padding),r<this.padding&&(r=this.padding);this.frame.style.left=r+"px",this.frame.style.top=s+"px",this.frame.style.visibility="visible",this.hidden=!1}else this.hide()}},{key:"hide",value:function(){this.hidden=!0,this.frame.style.left="0",this.frame.style.top="0",this.frame.style.visibility="hidden"}},{key:"destroy",value:function(){this.frame.parentNode.removeChild(this.frame)}}]),e}(),iu=Ql,ru=function(){function e(){Sn(this,e)}return Ln(e,null,[{key:"validate",value:function(t,o,n){$l=!1,Kl=o;var i=o;return void 0!==n&&(i=o[n]),e.parse(t,i,[]),$l}},{key:"parse",value:function(t,o,n){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.check(i,t,o,n)}},{key:"check",value:function(t,o,n,i){if(void 0!==n[t]||void 0!==n.__any__){var r=t,s=!0;void 0===n[t]&&void 0!==n.__any__&&(r="__any__",s="object"===e.getType(o[t]));var a=n[r];s&&void 0!==a.__type__&&(a=a.__type__),e.checkFields(t,o,n,r,a,i)}else e.getSuggestion(t,n,i)}},{key:"checkFields",value:function(t,o,n,i,r,s){var a=function(o){console.error("%c"+o+e.printLocation(s,t),Ql)},l=e.getType(o[t]),u=r[l];void 0!==u?"array"===e.getType(u)&&-1===ui(u).call(u,o[t])?(a('Invalid option detected in "'+t+'". Allowed values are:'+e.print(u)+' not "'+o[t]+'". '),$l=!0):"object"===l&&"__any__"!==i&&(s=jl(s,t),e.parse(o[t],n[i],s)):void 0===r.any&&(a('Invalid type received for "'+t+'". Expected: '+e.print(Hr(r))+". Received ["+l+'] "'+o[t]+'"'),$l=!0)}},{key:"getType",value:function(e){var t=$r(e);return"object"===t?null===e?"null":e instanceof Boolean?"boolean":e instanceof Number?"number":e instanceof String?"string":Gr(e)?"array":e instanceof Date?"date":void 0!==e.nodeType?"dom":!0===e._isAMomentObject?"moment":"object":"number"===t?"number":"boolean"===t?"boolean":"string"===t?"string":void 0===t?"undefined":t}},{key:"getSuggestion",value:function(t,o,n){var i,r=e.findInOptions(t,o,n,!1),s=e.findInOptions(t,Kl,[],!0);i=void 0!==r.indexMatch?" in "+e.printLocation(r.path,t,"")+'Perhaps it was incomplete? Did you mean: "'+r.indexMatch+'"?\n\n':s.distance<=4&&r.distance>s.distance?" in "+e.printLocation(r.path,t,"")+"Perhaps it was misplaced? Matching option found at: "+e.printLocation(s.path,s.closestMatch,""):r.distance<=8?'. Did you mean "'+r.closestMatch+'"?'+e.printLocation(r.path,t):". Did you mean one of these: "+e.print(Hr(o))+e.printLocation(n,t),console.error('%cUnknown option detected: "'+t+'"'+i,Ql),$l=!0}},{key:"findInOptions",value:function(t,o,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=1e9,s="",a=[],l=t.toLowerCase(),u=void 0;for(var c in o){var d=void 0;if(void 0!==o[c].__type__&&!0===i){var h=e.findInOptions(t,o[c],jl(n,c));r>h.distance&&(s=h.closestMatch,a=h.path,r=h.distance,u=h.indexMatch)}else{var p;-1!==ui(p=c.toLowerCase()).call(p,l)&&(u=c),r>(d=e.levenshteinDistance(t,c))&&(s=c,a=wl(n),r=d)}}return{closestMatch:s,path:a,distance:r,indexMatch:u}}},{key:"printLocation",value:function(e,t){for(var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Problem value found at: \n",n="\n\n"+o+"options = {\n",i=0;i<e.length;i++){for(var r=0;r<i+1;r++)n+="  ";n+=e[i]+": {\n"}for(var s=0;s<e.length+1;s++)n+="  ";n+=t+"\n";for(var a=0;a<e.length+1;a++){for(var l=0;l<e.length-a;l++)n+="  ";n+="}\n"}return n+"\n\n"}},{key:"print",value:function(e){return Nn(e).replace(/(")|(\[)|(\])|(,"__type__")/g,"").replace(/(,)/g,", ")}},{key:"levenshteinDistance",value:function(e,t){if(0===e.length)return t.length;if(0===t.length)return e.length;var o,n,i=[];for(o=0;o<=t.length;o++)i[o]=[o];for(n=0;n<=e.length;n++)i[0][n]=n;for(o=1;o<=t.length;o++)for(n=1;n<=e.length;n++)i[o][n]=t.charAt(o-1)==e.charAt(n-1)?i[o-1][n-1]:Math.min(i[o-1][n-1]+1,Math.min(i[o][n-1]+1,i[o-1][n]+1));return i[t.length][e.length]}}]),e}(),su=Object.freeze({__proto__:null,Activator:Zl,Alea:el,ColorPicker:eu,Configurator:tu,DELETE:Ga,HSVToHex:Rl,HSVToRGB:Fl,Hammer:ou,Popup:nu,RGBToHSV:Tl,RGBToHex:Nl,VALIDATOR_PRINT_STYLE:iu,Validator:ru,addClassName:function(e,t){var o=e.className.split(" "),n=t.split(" ");o=ns(o).call(o,Si(n).call(n,function(e){return!Yi(o).call(o,e)})),e.className=o.join(" ")},addCssText:function(e,t){var o=Dl(e.style.cssText),n=Dl(t),i=Ya(Ya({},o),n);e.style.cssText=Ll(i)},addEventListener:_l,binarySearchCustom:function(e,t,o,n){for(var i=0,r=0,s=e.length-1;r<=s&&i<1e4;){var a=Math.floor((r+s)/2),l=e[a],u=t(void 0===n?l[o]:l[o][n]);if(0==u)return a;-1==u?r=a+1:s=a-1,i++}return-1},binarySearchValue:function(e,t,o,n,i){var r,s,a,l,u=0,c=0,d=e.length-1;for(i=null!=i?i:function(e,t){return e==t?0:e<t?-1:1};c<=d&&u<1e4;){if(l=Math.floor(.5*(d+c)),r=e[Math.max(0,l-1)][o],s=e[l][o],a=e[Math.min(e.length-1,l+1)][o],0==i(s,t))return l;if(i(r,t)<0&&i(s,t)>0)return"before"==n?Math.max(0,l-1):l;if(i(s,t)<0&&i(a,t)>0)return"before"==n?l:Math.min(e.length-1,l+1);i(s,t)<0?c=l+1:d=l-1,u++}return-1},bridgeObject:Wl,copyAndExtendArray:jl,copyArray:wl,deepExtend:yl,deepObjectAssign:Ja,easingFunctions:Ul,equalArray:function(e,t){if(e.length!==t.length)return!1;for(var o=0,n=e.length;o<n;o++)if(e[o]!=t[o])return!1;return!0},extend:gl,fillIfDefined:vl,forEach:El,getAbsoluteLeft:xl,getAbsoluteRight:function(e){return e.getBoundingClientRect().right},getAbsoluteTop:Cl,getScrollBarWidth:function(){var e=document.createElement("p");e.style.width="100%",e.style.height="200px";var t=document.createElement("div");t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.visibility="hidden",t.style.width="200px",t.style.height="150px",t.style.overflow="hidden",t.appendChild(e),document.body.appendChild(t);var o=e.offsetWidth;t.style.overflow="scroll";var n=e.offsetWidth;return o==n&&(n=t.clientWidth),document.body.removeChild(t),o-n},getTarget:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.event,t=null;return e&&(e.target?t=e.target:e.srcElement&&(t=e.srcElement)),t instanceof Element&&(null==t.nodeType||3!=t.nodeType||(t=t.parentNode)instanceof Element)?t:null},getType:function(e){var t=$r(e);return"object"===t?null===e?"null":e instanceof Boolean?"Boolean":e instanceof Number?"Number":e instanceof String?"String":Gr(e)?"Array":e instanceof Date?"Date":"Object":"number"===t?"Number":"boolean"===t?"Boolean":"string"===t?"String":void 0===t?"undefined":t},hasParent:function(e,t){for(var o=e;o;){if(o===t)return!0;if(!o.parentNode)return!1;o=o.parentNode}return!1},hexToHSV:Pl,hexToRGB:Ml,insertSort:function(e,t){for(var o=0;o<e.length;o++){var n=e[o],i=void 0;for(i=o;i>0&&t(n,e[i-1])<0;i--)e[i]=e[i-1];e[i]=n}return e},isDate:function(e){if(e instanceof Date)return!0;if(hl(e)){if(rl.exec(e))return!0;if(!isNaN(Date.parse(e)))return!0}return!1},isNumber:cl,isObject:pl,isString:hl,isValidHex:Bl,isValidRGB:zl,isValidRGBA:Hl,mergeOptions:Vl,option:Ol,overrideOpacity:Il,parseColor:Sl,preventDefault:function(e){e||(e=window.event),e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},pureDeepObjectAssign:Ka,recursiveDOMDelete:dl,removeClassName:function(e,t){var o=e.className.split(" "),n=t.split(" ");o=Si(o).call(o,function(e){return!Yi(n).call(n,e)}),e.className=o.join(" ")},removeCssText:function(e,t){var o=Dl(e.style.cssText),n=Dl(t);for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&delete o[i];e.style.cssText=Ll(o)},removeEventListener:Al,selectiveBridgeObject:function(e,t){if(null!==t&&"object"===$r(t)){for(var o=Bn(t),n=0;n<e.length;n++)Object.prototype.hasOwnProperty.call(t,e[n])&&"object"==$r(t[e[n]])&&(o[e[n]]=Wl(t[e[n]]));return o}return null},selectiveDeepExtend:bl,selectiveExtend:function(e,t){if(!Gr(e))throw new Error("Array with property names expected as first argument");for(var o=arguments.length,n=new Array(o>2?o-2:0),i=2;i<o;i++)n[i-2]=arguments[i];for(var r=0,s=n;r<s.length;r++)for(var a=s[r],l=0;l<e.length;l++){var u=e[l];a&&Object.prototype.hasOwnProperty.call(a,u)&&(t[u]=a[u])}return t},selectiveNotDeepExtend:ml,throttle:function(e){var t=!1;return function(){t||(t=!0,requestAnimationFrame(function(){t=!1,e()}))}},toArray:kl,topMost:Yl,updateProperty:function(e,t,o){return e[t]!==o&&(e[t]=o,!0)}});function au(e){return hu=e,function(){var e={};if(pu=0,fu=hu.charAt(0),_u(),"strict"===vu&&(e.strict=!0,_u()),"graph"!==vu&&"digraph"!==vu||(e.type=vu,_u()),gu===cu&&(e.id=vu,_u()),"{"!=vu)throw Su("Angle bracket { expected");if(_u(),Au(e),"}"!=vu)throw Su("Angle bracket } expected");if(_u(),""!==vu)throw Su("End of file expected");return _u(),delete e.node,delete e.edge,delete e.graph,e}()}var lu={fontsize:"font.size",fontcolor:"font.color",labelfontcolor:"font.color",fontname:"font.face",color:["color.border","color.background"],fillcolor:"color.background",tooltip:"title",labeltooltip:"title"},uu=Bn(lu);uu.color="color.color",uu.style="dashes";var cu=2,du={"{":!0,"}":!0,"[":!0,"]":!0,";":!0,"=":!0,",":!0,"->":!0,"--":!0},hu="",pu=0,fu="",vu="",gu=0;function bu(){pu++,fu=hu.charAt(pu)}function mu(){return hu.charAt(pu+1)}var yu=/[a-zA-Z_0-9.:#]/;function ju(e){return yu.test(e)}function wu(e,t){if(e||(e={}),t)for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);return e}function xu(e,t,o){for(var n=t.split("."),i=e;n.length;){var r=n.shift();n.length?(i[r]||(i[r]={}),i=i[r]):i[r]=o}}function Cu(e,t){for(var o,n,i=null,r=[e],s=e;s.parent;)r.push(s.parent),s=s.parent;if(s.nodes)for(o=0,n=s.nodes.length;o<n;o++)if(t.id===s.nodes[o].id){i=s.nodes[o];break}for(i||(i={id:t.id},e.node&&(i.attr=wu(i.attr,e.node))),o=r.length-1;o>=0;o--){var a,l=r[o];l.nodes||(l.nodes=[]),-1===ui(a=l.nodes).call(a,i)&&l.nodes.push(i)}t.attr&&(i.attr=wu(i.attr,t.attr))}function Eu(e,t){if(e.edges||(e.edges=[]),e.edges.push(t),e.edge){var o=wu({},e.edge);t.attr=wu(o,t.attr)}}function ku(e,t,o,n,i){var r={from:t,to:o,type:n};return e.edge&&(r.attr=wu({},e.edge)),r.attr=wu(r.attr||{},i),null!=i&&i.hasOwnProperty("arrows")&&null!=i.arrows&&(r.arrows={to:{enabled:!0,type:i.arrows.type}},i.arrows=null),r}function _u(){for(gu=0,vu="";" "===fu||"\t"===fu||"\n"===fu||"\r"===fu;)bu();do{var e=!1;if("#"===fu){for(var t=pu-1;" "===hu.charAt(t)||"\t"===hu.charAt(t);)t--;if("\n"===hu.charAt(t)||""===hu.charAt(t)){for(;""!=fu&&"\n"!=fu;)bu();e=!0}}if("/"===fu&&"/"===mu()){for(;""!=fu&&"\n"!=fu;)bu();e=!0}if("/"===fu&&"*"===mu()){for(;""!=fu;){if("*"===fu&&"/"===mu()){bu(),bu();break}bu()}e=!0}for(;" "===fu||"\t"===fu||"\n"===fu||"\r"===fu;)bu()}while(e);if(""!==fu){var o=fu+mu();if(du[o])return gu=1,vu=o,bu(),void bu();if(du[fu])return gu=1,vu=fu,void bu();if(ju(fu)||"-"===fu){for(vu+=fu,bu();ju(fu);)vu+=fu,bu();return"false"===vu?vu=!1:"true"===vu?vu=!0:isNaN(Number(vu))||(vu=Number(vu)),void(gu=cu)}if('"'===fu){for(bu();""!=fu&&('"'!=fu||'"'===fu&&'"'===mu());)'"'===fu?(vu+=fu,bu()):"\\"===fu&&"n"===mu()?(vu+="\n",bu()):vu+=fu,bu();if('"'!=fu)throw Su('End of string " expected');return bu(),void(gu=cu)}for(gu=3;""!=fu;)vu+=fu,bu();throw new SyntaxError('Syntax error in part "'+Tu(vu,30)+'"')}gu=1}function Au(e){for(;""!==vu&&"}"!=vu;)Ou(e),";"===vu&&_u()}function Ou(e){var t=Mu(e);if(t)Iu(e,t);else if(!function(e){return"node"===vu?(_u(),e.node=Nu(),"node"):"edge"===vu?(_u(),e.edge=Nu(),"edge"):"graph"===vu?(_u(),e.graph=Nu(),"graph"):null}(e)){if(gu!=cu)throw Su("Identifier expected");var o=vu;if(_u(),"="===vu){if(_u(),gu!=cu)throw Su("Identifier expected");e[o]=vu,_u()}else!function(e,t){var o={id:t},n=Nu();n&&(o.attr=n),Cu(e,o),Iu(e,t)}(e,o)}}function Mu(e){var t=null;if("subgraph"===vu&&((t={}).type="subgraph",_u(),gu===cu&&(t.id=vu,_u())),"{"===vu){if(_u(),t||(t={}),t.parent=e,t.node=e.node,t.edge=e.edge,t.graph=e.graph,Au(t),"}"!=vu)throw Su("Angle bracket } expected");_u(),delete t.node,delete t.edge,delete t.graph,delete t.parent,e.subgraphs||(e.subgraphs=[]),e.subgraphs.push(t)}return t}function Iu(e,t){for(;"->"===vu||"--"===vu;){var o,n=vu;_u();var i=Mu(e);if(i)o=i;else{if(gu!=cu)throw Su("Identifier or subgraph expected");Cu(e,{id:o=vu}),_u()}Eu(e,ku(e,t,o,n,Nu())),t=o}}function Nu(){for(var e,t,o=null,n={dashed:!0,solid:!1,dotted:[1,5]},i={dot:"circle",box:"box",crow:"crow",curve:"curve",icurve:"inv_curve",normal:"triangle",inv:"inv_triangle",diamond:"diamond",tee:"bar",vee:"vee"},r=new Array,s=new Array;"["===vu;){for(_u(),o={};""!==vu&&"]"!=vu;){if(gu!=cu)throw Su("Attribute name expected");var a=vu;if(_u(),"="!=vu)throw Su("Equal sign = expected");if(_u(),gu!=cu)throw Su("Attribute value expected");var l=vu;"style"===a&&(l=n[l]),"arrowhead"===a&&(a="arrows",l={to:{enabled:!0,type:i[l]}}),"arrowtail"===a&&(a="arrows",l={from:{enabled:!0,type:i[l]}}),r.push({attr:o,name:a,value:l}),s.push(a),_u(),","==vu&&_u()}if("]"!=vu)throw Su("Bracket ] expected");_u()}if(Yi(s).call(s,"dir")){var u={arrows:{}};for(e=0;e<r.length;e++)if("arrows"===r[e].name)if(null!=r[e].value.to)u.arrows.to=e;else{if(null==r[e].value.from)throw Su("Invalid value of arrows");u.arrows.from=e}else"dir"===r[e].name&&(u.dir=e);var c,d,h=r[u.dir].value;if(!Yi(s).call(s,"arrows"))if("both"===h)r.push({attr:r[u.dir].attr,name:"arrows",value:{to:{enabled:!0}}}),u.arrows.to=r.length-1,r.push({attr:r[u.dir].attr,name:"arrows",value:{from:{enabled:!0}}}),u.arrows.from=r.length-1;else if("forward"===h)r.push({attr:r[u.dir].attr,name:"arrows",value:{to:{enabled:!0}}}),u.arrows.to=r.length-1;else if("back"===h)r.push({attr:r[u.dir].attr,name:"arrows",value:{from:{enabled:!0}}}),u.arrows.from=r.length-1;else{if("none"!==h)throw Su('Invalid dir type "'+h+'"');r.push({attr:r[u.dir].attr,name:"arrows",value:""}),u.arrows.to=r.length-1}if("both"===h)u.arrows.to&&u.arrows.from?(r[u.arrows.to]={attr:r[u.arrows.to].attr,name:r[u.arrows.to].name,value:{to:{enabled:!0,type:d=r[u.arrows.to].value.to.type},from:{enabled:!0,type:c=r[u.arrows.from].value.from.type}}},er(r).call(r,u.arrows.from,1)):u.arrows.to?r[u.arrows.to]={attr:r[u.arrows.to].attr,name:r[u.arrows.to].name,value:{to:{enabled:!0,type:d=r[u.arrows.to].value.to.type},from:{enabled:!0,type:c="arrow"}}}:u.arrows.from&&(r[u.arrows.from]={attr:r[u.arrows.from].attr,name:r[u.arrows.from].name,value:{to:{enabled:!0,type:d="arrow"},from:{enabled:!0,type:c=r[u.arrows.from].value.from.type}}});else if("back"===h)u.arrows.to&&u.arrows.from?r[u.arrows.from]={attr:r[u.arrows.from].attr,name:r[u.arrows.from].name,value:{to:{enabled:!0,type:d=""},from:{enabled:!0,type:c=r[u.arrows.from].value.from.type}}}:u.arrows.to?(d="",c="arrow",u.arrows.from=u.arrows.to,r[u.arrows.from]={attr:r[u.arrows.from].attr,name:r[u.arrows.from].name,value:{to:{enabled:!0,type:d},from:{enabled:!0,type:c}}}):u.arrows.from&&(r[u.arrows.to]={attr:r[u.arrows.from].attr,name:r[u.arrows.from].name,value:{to:{enabled:!0,type:d=""},from:{enabled:!0,type:c=r[u.arrows.from].value.from.type}}}),r[u.arrows.from]={attr:r[u.arrows.from].attr,name:r[u.arrows.from].name,value:{from:{enabled:!0,type:r[u.arrows.from].value.from.type}}};else if("none"===h){var p;r[p=u.arrows.to?u.arrows.to:u.arrows.from]={attr:r[p].attr,name:r[p].name,value:""}}else{if("forward"!==h)throw Su('Invalid dir type "'+h+'"');u.arrows.to&&u.arrows.from||u.arrows.to?r[u.arrows.to]={attr:r[u.arrows.to].attr,name:r[u.arrows.to].name,value:{to:{enabled:!0,type:d=r[u.arrows.to].value.to.type},from:{enabled:!0,type:c=""}}}:u.arrows.from&&(d="arrow",c="",u.arrows.to=u.arrows.from,r[u.arrows.to]={attr:r[u.arrows.to].attr,name:r[u.arrows.to].name,value:{to:{enabled:!0,type:d},from:{enabled:!0,type:c}}}),r[u.arrows.to]={attr:r[u.arrows.to].attr,name:r[u.arrows.to].name,value:{to:{enabled:!0,type:r[u.arrows.to].value.to.type}}}}er(r).call(r,u.dir,1)}if(Yi(s).call(s,"penwidth")){var f=[];for(t=r.length,e=0;e<t;e++)"width"!==r[e].name&&("penwidth"===r[e].name&&(r[e].name="width"),f.push(r[e]));r=f}for(t=r.length,e=0;e<t;e++)xu(r[e].attr,r[e].name,r[e].value);return o}function Su(e){return new SyntaxError(e+', got "'+Tu(vu,30)+'" (char '+pu+")")}function Tu(e,t){return e.length<=t?e:e.substr(0,27)+"..."}function Du(e,t,o){for(var n=t.split("."),i=n.pop(),r=e,s=0;s<n.length;s++){var a=n[s];a in r||(r[a]={}),r=r[a]}return r[i]=o,e}function Lu(e,t){var o={};for(var n in e)if(e.hasOwnProperty(n)){var i=t[n];Gr(i)?pr(i).call(i,function(t){Du(o,t,e[n])}):Du(o,"string"==typeof i?i:n,e[n])}return o}function Fu(e){var t,o=au(e),n={nodes:[],edges:[],options:{}};if(o.nodes&&pr(t=o.nodes).call(t,function(e){var t={id:e.id,label:String(e.label||e.id)};wu(t,Lu(e.attr,lu)),t.image&&(t.shape="image"),n.nodes.push(t)}),o.edges){var i,r=function(e){var t={from:e.from,to:e.to};return wu(t,Lu(e.attr,uu)),null==t.arrows&&"->"===e.type&&(t.arrows="to"),t};pr(i=o.edges).call(i,function(e){var t,o,i,s,a,l,u;t=e.from instanceof Object?e.from.nodes:{id:e.from},o=e.to instanceof Object?e.to.nodes:{id:e.to},e.from instanceof Object&&e.from.edges&&pr(i=e.from.edges).call(i,function(e){var t=r(e);n.edges.push(t)}),a=o,l=function(t,o){var i=ku(n,t.id,o.id,e.type,e.attr),s=r(i);n.edges.push(s)},Gr(s=t)?pr(s).call(s,function(e){Gr(a)?pr(a).call(a,function(t){l(e,t)}):l(e,a)}):Gr(a)?pr(a).call(a,function(e){l(s,e)}):l(s,a),e.to instanceof Object&&e.to.edges&&pr(u=e.to.edges).call(u,function(e){var t=r(e);n.edges.push(t)})})}return o.attr&&(n.options=o.attr),n}var Ru=Object.freeze({__proto__:null,parseDOT:au,DOTToGraph:Fu});function Pu(e,t){var o,n={edges:{inheritColor:!1},nodes:{fixed:!1,parseColor:!1}};null!=t&&(null!=t.fixed&&(n.nodes.fixed=t.fixed),null!=t.parseColor&&(n.nodes.parseColor=t.parseColor),null!=t.inheritColor&&(n.edges.inheritColor=t.inheritColor));var i=e.edges,r=Xr(i).call(i,function(e){var t={from:e.source,id:e.id,to:e.target};return null!=e.attributes&&(t.attributes=e.attributes),null!=e.label&&(t.label=e.label),null!=e.attributes&&null!=e.attributes.title&&(t.title=e.attributes.title),"Directed"===e.type&&(t.arrows="to"),e.color&&!1===n.edges.inheritColor&&(t.color=e.color),t});return{nodes:Xr(o=e.nodes).call(o,function(e){var t={id:e.id,fixed:n.nodes.fixed&&null!=e.x&&null!=e.y};return null!=e.attributes&&(t.attributes=e.attributes),null!=e.label&&(t.label=e.label),null!=e.size&&(t.size=e.size),null!=e.attributes&&null!=e.attributes.title&&(t.title=e.attributes.title),null!=e.title&&(t.title=e.title),null!=e.x&&(t.x=e.x),null!=e.y&&(t.y=e.y),null!=e.color&&(t.color=!0===n.nodes.parseColor?e.color:{background:e.color,border:e.color,highlight:{background:e.color,border:e.color},hover:{background:e.color,border:e.color}}),t}),edges:r}}var Bu=Object.freeze({__proto__:null,parseGephi:Pu}),zu=Object.freeze({__proto__:null,en:{addDescription:"Click in an empty space to place a new node.",addEdge:"Add Edge",addNode:"Add Node",back:"Back",close:"Close",createEdgeError:"Cannot link edges to a cluster.",del:"Delete selected",deleteClusterError:"Clusters cannot be deleted.",edgeDescription:"Click on a node and drag the edge to another node to connect them.",edit:"Edit",editClusterError:"Clusters cannot be edited.",editEdge:"Edit Edge",editEdgeDescription:"Click on the control points and drag them to a node to connect to it.",editNode:"Edit Node"},de:{addDescription:"Klicke auf eine freie Stelle, um einen neuen Knoten zu plazieren.",addEdge:"Kante hinzuf\xfcgen",addNode:"Knoten hinzuf\xfcgen",back:"Zur\xfcck",close:"Schlie\xdfen",createEdgeError:"Es ist nicht m\xf6glich, Kanten mit Clustern zu verbinden.",del:"L\xf6sche Auswahl",deleteClusterError:"Cluster k\xf6nnen nicht gel\xf6scht werden.",edgeDescription:"Klicke auf einen Knoten und ziehe die Kante zu einem anderen Knoten, um diese zu verbinden.",edit:"Editieren",editClusterError:"Cluster k\xf6nnen nicht editiert werden.",editEdge:"Kante editieren",editEdgeDescription:"Klicke auf die Verbindungspunkte und ziehe diese auf einen Knoten, um sie zu verbinden.",editNode:"Knoten editieren"},es:{addDescription:"Haga clic en un lugar vac\xedo para colocar un nuevo nodo.",addEdge:"A\xf1adir arista",addNode:"A\xf1adir nodo",back:"Atr\xe1s",close:"Cerrar",createEdgeError:"No se puede conectar una arista a un grupo.",del:"Eliminar selecci\xf3n",deleteClusterError:"No es posible eliminar grupos.",edgeDescription:"Haga clic en un nodo y arrastre la arista hacia otro nodo para conectarlos.",edit:"Editar",editClusterError:"No es posible editar grupos.",editEdge:"Editar arista",editEdgeDescription:"Haga clic en un punto de control y arrastrelo a un nodo para conectarlo.",editNode:"Editar nodo"},it:{addDescription:"Clicca per aggiungere un nuovo nodo",addEdge:"Aggiungi un vertice",addNode:"Aggiungi un nodo",back:"Indietro",close:"Chiudere",createEdgeError:"Non si possono collegare vertici ad un cluster",del:"Cancella la selezione",deleteClusterError:"I cluster non possono essere cancellati",edgeDescription:"Clicca su un nodo e trascinalo ad un altro nodo per connetterli.",edit:"Modifica",editClusterError:"I clusters non possono essere modificati.",editEdge:"Modifica il vertice",editEdgeDescription:"Clicca sui Punti di controllo e trascinali ad un nodo per connetterli.",editNode:"Modifica il nodo"},nl:{addDescription:"Klik op een leeg gebied om een nieuwe node te maken.",addEdge:"Link toevoegen",addNode:"Node toevoegen",back:"Terug",close:"Sluiten",createEdgeError:"Kan geen link maken naar een cluster.",del:"Selectie verwijderen",deleteClusterError:"Clusters kunnen niet worden verwijderd.",edgeDescription:"Klik op een node en sleep de link naar een andere node om ze te verbinden.",edit:"Wijzigen",editClusterError:"Clusters kunnen niet worden aangepast.",editEdge:"Link wijzigen",editEdgeDescription:"Klik op de verbindingspunten en sleep ze naar een node om daarmee te verbinden.",editNode:"Node wijzigen"},pt:{addDescription:"Clique em um espa\xe7o em branco para adicionar um novo n\xf3",addEdge:"Adicionar aresta",addNode:"Adicionar n\xf3",back:"Voltar",close:"Fechar",createEdgeError:"N\xe3o foi poss\xedvel linkar arestas a um cluster.",del:"Remover selecionado",deleteClusterError:"Clusters n\xe3o puderam ser removidos.",edgeDescription:"Clique em um n\xf3 e arraste a aresta at\xe9 outro n\xf3 para conect\xe1-los",edit:"Editar",editClusterError:"Clusters n\xe3o puderam ser editados.",editEdge:"Editar aresta",editEdgeDescription:"Clique nos pontos de controle e os arraste para um n\xf3 para conect\xe1-los",editNode:"Editar n\xf3"},ru:{addDescription:"\u041a\u043b\u0438\u043a\u043d\u0438\u0442\u0435 \u0432 \u0441\u0432\u043e\u0431\u043e\u0434\u043d\u043e\u0435 \u043c\u0435\u0441\u0442\u043e, \u0447\u0442\u043e\u0431\u044b \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043d\u043e\u0432\u044b\u0439 \u0443\u0437\u0435\u043b.",addEdge:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0440\u0435\u0431\u0440\u043e",addNode:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0443\u0437\u0435\u043b",back:"\u041d\u0430\u0437\u0430\u0434",close:"\u0417\u0430\u043a\u0440\u044b\u0432\u0430\u0442\u044c",createEdgeError:"\u041d\u0435\u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e \u0441\u043e\u0435\u0434\u0438\u043d\u0438\u0442\u044c \u0440\u0435\u0431\u0440\u0430 \u0432 \u043a\u043b\u0430\u0441\u0442\u0435\u0440.",del:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u043e\u0435",deleteClusterError:"\u041a\u043b\u0430\u0441\u0442\u0435\u0440\u044b \u043d\u0435 \u043c\u043e\u0433\u0443\u0442 \u0431\u044b\u0442\u044c \u0443\u0434\u0430\u043b\u0435\u043d\u044b",edgeDescription:"\u041a\u043b\u0438\u043a\u043d\u0438\u0442\u0435 \u043d\u0430 \u0443\u0437\u0435\u043b \u0438 \u043f\u0440\u043e\u0442\u044f\u043d\u0438\u0442\u0435 \u0440\u0435\u0431\u0440\u043e \u043a \u0434\u0440\u0443\u0433\u043e\u043c\u0443 \u0443\u0437\u043b\u0443, \u0447\u0442\u043e\u0431\u044b \u0441\u043e\u0435\u0434\u0438\u043d\u0438\u0442\u044c \u0438\u0445.",edit:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c",editClusterError:"\u041a\u043b\u0430\u0441\u0442\u0435\u0440\u044b \u043d\u0435\u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b \u0434\u043b\u044f \u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f.",editEdge:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0440\u0435\u0431\u0440\u043e",editEdgeDescription:"\u041a\u043b\u0438\u043a\u043d\u0438\u0442\u0435 \u043d\u0430 \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u044c\u043d\u044b\u0435 \u0442\u043e\u0447\u043a\u0438 \u0438 \u043f\u0435\u0440\u0435\u0442\u0430\u0449\u0438\u0442\u0435 \u0438\u0445 \u0432 \u0443\u0437\u0435\u043b, \u0447\u0442\u043e\u0431\u044b \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u0442\u044c\u0441\u044f \u043a \u043d\u0435\u043c\u0443.",editNode:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0443\u0437\u0435\u043b"},cn:{addDescription:"\u5355\u51fb\u7a7a\u767d\u5904\u653e\u7f6e\u65b0\u8282\u70b9\u3002",addEdge:"\u6dfb\u52a0\u8fde\u63a5\u7ebf",addNode:"\u6dfb\u52a0\u8282\u70b9",back:"\u8fd4\u56de",close:"\u95dc\u9589",createEdgeError:"\u65e0\u6cd5\u5c06\u8fde\u63a5\u7ebf\u8fde\u63a5\u5230\u7fa4\u96c6\u3002",del:"\u5220\u9664\u9009\u5b9a",deleteClusterError:"\u65e0\u6cd5\u5220\u9664\u7fa4\u96c6\u3002",edgeDescription:"\u5355\u51fb\u67d0\u4e2a\u8282\u70b9\u5e76\u5c06\u8be5\u8fde\u63a5\u7ebf\u62d6\u52a8\u5230\u53e6\u4e00\u4e2a\u8282\u70b9\u4ee5\u8fde\u63a5\u5b83\u4eec\u3002",edit:"\u7f16\u8f91",editClusterError:"\u65e0\u6cd5\u7f16\u8f91\u7fa4\u96c6\u3002",editEdge:"\u7f16\u8f91\u8fde\u63a5\u7ebf",editEdgeDescription:"\u5355\u51fb\u63a7\u5236\u8282\u70b9\u5e76\u5c06\u5b83\u4eec\u62d6\u5230\u8282\u70b9\u4e0a\u8fde\u63a5\u3002",editNode:"\u7f16\u8f91\u8282\u70b9"},uk:{addDescription:"K\u043b\u0456\u043a\u043d\u0456\u0442\u044c \u043d\u0430 \u0432\u0456\u043b\u044c\u043d\u0435 \u043c\u0456\u0441\u0446\u0435, \u0449\u043e\u0431 \u0434\u043e\u0434\u0430\u0442\u0438 \u043d\u043e\u0432\u0438\u0439 \u0432\u0443\u0437\u043e\u043b.",addEdge:"\u0414\u043e\u0434\u0430\u0442\u0438 \u043a\u0440\u0430\u0439",addNode:"\u0414\u043e\u0434\u0430\u0442\u0438 \u0432\u0443\u0437\u043e\u043b",back:"\u041d\u0430\u0437\u0430\u0434",close:"\u0417\u0430\u043a\u0440\u0438\u0442\u0438",createEdgeError:"\u041d\u0435 \u043c\u043e\u0436\u043b\u0438\u0432\u043e \u043e\u0431'\u0454\u0434\u043d\u0430\u0442\u0438 \u043a\u0440\u0430\u0457 \u0432 \u0433\u0440\u0443\u043f\u0443.",del:"\u0412\u0438\u0434\u0430\u043b\u0438\u0442\u0438 \u043e\u0431\u0440\u0430\u043d\u0435",deleteClusterError:"\u0413\u0440\u0443\u043f\u0438 \u043d\u0435 \u043c\u043e\u0436\u0443\u0442\u044c \u0431\u0443\u0442\u0438 \u0432\u0438\u0434\u0430\u043b\u0435\u043d\u0456.",edgeDescription:"\u041a\u043b\u0456\u043a\u043d\u0456\u0442\u044c \u043d\u0430 \u0432\u0443\u0437\u043e\u043b \u0456 \u043f\u0435\u0440\u0435\u0442\u044f\u0433\u043d\u0456\u0442\u044c \u043a\u0440\u0430\u0439 \u0434\u043e \u0456\u043d\u0448\u043e\u0433\u043e \u0432\u0443\u0437\u043b\u0430, \u0449\u043e\u0431 \u0457\u0445 \u0437'\u0454\u0434\u043d\u0430\u0442\u0438.",edit:"\u0420\u0435\u0434\u0430\u0433\u0443\u0432\u0430\u0442\u0438",editClusterError:"\u0413\u0440\u0443\u043f\u0438 \u043d\u0435\u0434\u043e\u0441\u0442\u0443\u043f\u043d\u0456 \u0434\u043b\u044f \u0440\u0435\u0434\u0430\u0433\u0443\u0432\u0430\u043d\u043d\u044f.",editEdge:"\u0420\u0435\u0434\u0430\u0433\u0443\u0432\u0430\u0442\u0438 \u043a\u0440\u0430\u0439",editEdgeDescription:"\u041a\u043b\u0456\u043a\u043d\u0456\u0442\u044c \u043d\u0430 \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u044c\u043d\u0456 \u0442\u043e\u0447\u043a\u0438 \u0456 \u043f\u0435\u0440\u0435\u0442\u044f\u0433\u043d\u0456\u0442\u044c \u0457\u0445 \u0443 \u0432\u0443\u0437\u043e\u043b, \u0449\u043e\u0431 \u043f\u0456\u0434\u043a\u043b\u044e\u0447\u0438\u0442\u0438\u0441\u044f \u0434\u043e \u043d\u044c\u043e\u0433\u043e.",editNode:"\u0420\u0435\u0434\u0430\u0433\u0443\u0432\u0430\u0442\u0438 \u0432\u0443\u0437\u043e\u043b"},fr:{addDescription:"Cliquez dans un endroit vide pour placer un n\u0153ud.",addEdge:"Ajouter un lien",addNode:"Ajouter un n\u0153ud",back:"Retour",close:"Fermer",createEdgeError:"Impossible de cr\xe9er un lien vers un cluster.",del:"Effacer la s\xe9lection",deleteClusterError:"Les clusters ne peuvent pas \xeatre effac\xe9s.",edgeDescription:"Cliquez sur un n\u0153ud et glissez le lien vers un autre n\u0153ud pour les connecter.",edit:"\xc9diter",editClusterError:"Les clusters ne peuvent pas \xeatre \xe9dit\xe9s.",editEdge:"\xc9diter le lien",editEdgeDescription:"Cliquez sur les points de contr\xf4le et glissez-les pour connecter un n\u0153ud.",editNode:"\xc9diter le n\u0153ud"},cs:{addDescription:"Kluknut\xedm do pr\xe1zdn\xe9ho prostoru m\u016f\u017eete p\u0159idat nov\xfd vrchol.",addEdge:"P\u0159idat hranu",addNode:"P\u0159idat vrchol",back:"Zp\u011bt",close:"Zav\u0159\xedt",createEdgeError:"Nelze p\u0159ipojit hranu ke shluku.",del:"Smazat v\xfdb\u011br",deleteClusterError:"Nelze mazat shluky.",edgeDescription:"P\u0159eta\u017een\xedm z jednoho vrcholu do druh\xe9ho m\u016f\u017eete spojit tyto vrcholy novou hranou.",edit:"Upravit",editClusterError:"Nelze upravovat shluky.",editEdge:"Upravit hranu",editEdgeDescription:"P\u0159eta\u017een\xedm kontroln\xedho vrcholu hrany ji m\u016f\u017eete p\u0159ipojit k jin\xe9mu vrcholu.",editNode:"Upravit vrchol"}}),Hu=function(){function e(){Sn(this,e),this.NUM_ITERATIONS=4,this.image=new Image,this.canvas=document.createElement("canvas")}return Ln(e,[{key:"init",value:function(){if(!this.initialized()){this.src=this.image.src;var e=this.image.width,t=this.image.height;this.width=e,this.height=t;var o=Math.floor(t/2),n=Math.floor(t/4),i=Math.floor(t/8),r=Math.floor(t/16),s=Math.floor(e/2),a=Math.floor(e/4),l=Math.floor(e/8),u=Math.floor(e/16);this.canvas.width=3*a,this.canvas.height=o,this.coordinates=[[0,0,s,o],[s,0,a,n],[s,n,l,i],[5*l,n,u,r]],this._fillMipMap()}}},{key:"initialized",value:function(){return void 0!==this.coordinates}},{key:"_fillMipMap",value:function(){var e=this.canvas.getContext("2d"),t=this.coordinates[0];e.drawImage(this.image,t[0],t[1],t[2],t[3]);for(var o=1;o<this.NUM_ITERATIONS;o++){var n=this.coordinates[o-1],i=this.coordinates[o];e.drawImage(this.canvas,n[0],n[1],n[2],n[3],i[0],i[1],i[2],i[3])}}},{key:"drawImageAtPosition",value:function(e,t,o,n,i,r){if(this.initialized())if(t>2){t*=.5;for(var s=0;t>2&&s<this.NUM_ITERATIONS;)t*=.5,s+=1;s>=this.NUM_ITERATIONS&&(s=this.NUM_ITERATIONS-1);var a=this.coordinates[s];e.drawImage(this.canvas,a[0],a[1],a[2],a[3],o,n,i,r)}else e.drawImage(this.image,o,n,i,r)}}]),e}(),Wu=function(){function e(t){Sn(this,e),this.images={},this.imageBroken={},this.callback=t}return Ln(e,[{key:"_tryloadBrokenUrl",value:function(e,t,o){void 0!==e&&void 0!==o&&(void 0!==t?(o.image.onerror=function(){console.error("Could not load brokenImage:",t)},o.image.src=t):console.warn("No broken url image defined"))}},{key:"_redrawWithImage",value:function(e){this.callback&&this.callback(e)}},{key:"load",value:function(e,t){var o=this,n=this.images[e];if(n)return n;var i=new Hu;return this.images[e]=i,i.image.onload=function(){o._fixImageCoordinates(i.image),i.init(),o._redrawWithImage(i)},i.image.onerror=function(){console.error("Could not load image:",e),o._tryloadBrokenUrl(e,t,i)},i.image.src=e,i}},{key:"_fixImageCoordinates",value:function(e){0===e.width&&(document.body.appendChild(e),e.width=e.offsetWidth,e.height=e.offsetHeight,document.body.removeChild(e))}}]),e}(),Vu=!r(function(){return Object.isExtensible(Object.preventExtensions({}))}),Uu=o(function(e){var t=B.f,o=$e("meta"),n=0,i=Object.isExtensible||function(){return!0},r=function(e){t(e,o,{value:{objectID:"O"+ ++n,weakData:{}}})},s=e.exports={REQUIRED:!1,fastKey:function(e,t){if(!b(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!j(e,o)){if(!i(e))return"F";if(!t)return"E";r(e)}return e[o].objectID},getWeakData:function(e,t){if(!j(e,o)){if(!i(e))return!0;if(!t)return!1;r(e)}return e[o].weakData},onFreeze:function(e){return Vu&&s.REQUIRED&&i(e)&&!j(e,o)&&r(e),e}};le[o]=!0}),Yu=function(e,t){this.stopped=e,this.result=t},qu=function(e,t,o){var n,i,r,s,a,l,u,c=!(!o||!o.AS_ENTRIES),d=!(!o||!o.IS_ITERATOR),h=!(!o||!o.INTERRUPTED),p=F(t,o&&o.that,1+c+h),f=function(e){return n&&rn(n),new Yu(!0,e)},v=function(e){return c?(R(e),h?p(e[0],e[1],f):p(e[0],e[1])):h?p(e,f):p(e)};if(d)n=e;else{if("function"!=typeof(i=tn(e)))throw TypeError("Target is not iterable");if(un(i)){for(r=0,s=oe(e.length);s>r;r++)if((a=v(e[r]))&&a instanceof Yu)return a;return new Yu(!1)}n=i.call(e)}for(l=n.next;!(u=l.call(n)).done;){try{a=v(u.value)}catch(e){throw rn(n),e}if("object"==typeof a&&a&&a instanceof Yu)return a}return new Yu(!1)},Xu=function(e,t,o){if(!(e instanceof t))throw TypeError("Incorrect "+(o?o+" ":"")+"invocation");return e},Gu=B.f,Ku=Wt.forEach,Ju=Rt.set,$u=Rt.getterFor,Qu=function(e,t,o){var n,a=-1!==e.indexOf("Map"),l=-1!==e.indexOf("Weak"),u=a?"set":"add",c=i[e],d=c&&c.prototype,h={};if(s&&"function"==typeof c&&(l||d.forEach&&!r(function(){(new c).entries().next()}))){n=t(function(t,o){Ju(Xu(t,n,e),{type:e,collection:new c}),null!=o&&qu(o,t[u],{that:t,AS_ENTRIES:a})});var p=$u(e);Ku(["add","clear","delete","forEach","get","has","set","keys","values","entries"],function(e){var t="add"==e||"set"==e;!(e in d)||l&&"clear"==e||z(n.prototype,e,function(o,n){var i=p(this).collection;if(!t&&l&&!b(o))return"get"==e&&void 0;var r=i[e](0===o?0:o,n);return t?this:r})}),l||Gu(n.prototype,"size",{configurable:!0,get:function(){return p(this).collection.size}})}else n=o.getConstructor(t,e,a,u),Uu.REQUIRED=!0;return kt(n,e,!1,!0),h[e]=n,V({global:!0,forced:!0},h),l||o.setStrong(n,e,a),n},Zu=function(e,t,o){for(var n in t)o&&o.unsafe&&e[n]?e[n]=t[n]:ut(e,n,t[n],o);return e},ec=pt("species"),tc=B.f,oc=Uu.fastKey,nc=Rt.set,ic=Rt.getterFor,rc={getConstructor:function(e,t,o,n){var i=e(function(e,r){Xu(e,i,t),nc(e,{type:t,index:it(null),first:void 0,last:void 0,size:0}),s||(e.size=0),null!=r&&qu(r,e[n],{that:e,AS_ENTRIES:o})}),r=ic(t),a=function(e,t,o){var n,i,a=r(e),u=l(e,t);return u?u.value=o:(a.last=u={index:i=oc(t,!0),key:t,value:o,previous:n=a.last,next:void 0,removed:!1},a.first||(a.first=u),n&&(n.next=u),s?a.size++:e.size++,"F"!==i&&(a.index[i]=u)),e},l=function(e,t){var o,n=r(e),i=oc(t);if("F"!==i)return n.index[i];for(o=n.first;o;o=o.next)if(o.key==t)return o};return Zu(i.prototype,{clear:function(){for(var e=r(this),t=e.index,o=e.first;o;)o.removed=!0,o.previous&&(o.previous=o.previous.next=void 0),delete t[o.index],o=o.next;e.first=e.last=void 0,s?e.size=0:this.size=0},delete:function(e){var t=this,o=r(t),n=l(t,e);if(n){var i=n.next,a=n.previous;delete o.index[n.index],n.removed=!0,a&&(a.next=i),i&&(i.previous=a),o.first==n&&(o.first=i),o.last==n&&(o.last=a),s?o.size--:t.size--}return!!n},forEach:function(e){for(var t,o=r(this),n=F(e,arguments.length>1?arguments[1]:void 0,3);t=t?t.next:o.first;)for(n(t.value,t.key,this);t&&t.removed;)t=t.previous},has:function(e){return!!l(this,e)}}),Zu(i.prototype,o?{get:function(e){var t=l(this,e);return t&&t.value},set:function(e,t){return a(this,0===e?0:e,t)}}:{add:function(e){return a(this,e=0===e?0:e,e)}}),s&&tc(i.prototype,"size",{get:function(){return r(this).size}}),i},setStrong:function(e,t,o){var n=t+" Iterator",i=ic(t),r=ic(n);Ho(e,t,function(e,t){nc(this,{type:n,target:e,state:i(e),kind:t,last:void 0})},function(){for(var e=r(this),t=e.kind,o=e.last;o&&o.removed;)o=o.previous;return e.target&&(e.last=o=o?o.next:e.state.first)?"keys"==t?{value:o.key,done:!1}:"values"==t?{value:o.value,done:!1}:{value:[o.key,o.value],done:!1}:(e.target=void 0,{value:void 0,done:!0})},o?"entries":"values",!o,!0),function(e){var t=Ne(e);s&&t&&!t[ec]&&(0,B.f)(t,ec,{configurable:!0,get:function(){return this}})}(t)}},sc=(Qu("Map",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},rc),D.Map),ac=function(){function e(){Sn(this,e),this.clear(),this._defaultIndex=0,this._groupIndex=0,this._defaultGroups=[{border:"#2B7CE9",background:"#97C2FC",highlight:{border:"#2B7CE9",background:"#D2E5FF"},hover:{border:"#2B7CE9",background:"#D2E5FF"}},{border:"#FFA500",background:"#FFFF00",highlight:{border:"#FFA500",background:"#FFFFA3"},hover:{border:"#FFA500",background:"#FFFFA3"}},{border:"#FA0A10",background:"#FB7E81",highlight:{border:"#FA0A10",background:"#FFAFB1"},hover:{border:"#FA0A10",background:"#FFAFB1"}},{border:"#41A906",background:"#7BE141",highlight:{border:"#41A906",background:"#A1EC76"},hover:{border:"#41A906",background:"#A1EC76"}},{border:"#E129F0",background:"#EB7DF4",highlight:{border:"#E129F0",background:"#F0B3F5"},hover:{border:"#E129F0",background:"#F0B3F5"}},{border:"#7C29F0",background:"#AD85E4",highlight:{border:"#7C29F0",background:"#D3BDF0"},hover:{border:"#7C29F0",background:"#D3BDF0"}},{border:"#C37F00",background:"#FFA807",highlight:{border:"#C37F00",background:"#FFCA66"},hover:{border:"#C37F00",background:"#FFCA66"}},{border:"#4220FB",background:"#6E6EFD",highlight:{border:"#4220FB",background:"#9B9BFD"},hover:{border:"#4220FB",background:"#9B9BFD"}},{border:"#FD5A77",background:"#FFC0CB",highlight:{border:"#FD5A77",background:"#FFD1D9"},hover:{border:"#FD5A77",background:"#FFD1D9"}},{border:"#4AD63A",background:"#C2FABC",highlight:{border:"#4AD63A",background:"#E6FFE3"},hover:{border:"#4AD63A",background:"#E6FFE3"}},{border:"#990000",background:"#EE0000",highlight:{border:"#BB0000",background:"#FF3333"},hover:{border:"#BB0000",background:"#FF3333"}},{border:"#FF6000",background:"#FF6000",highlight:{border:"#FF6000",background:"#FF6000"},hover:{border:"#FF6000",background:"#FF6000"}},{border:"#97C2FC",background:"#2B7CE9",highlight:{border:"#D2E5FF",background:"#2B7CE9"},hover:{border:"#D2E5FF",background:"#2B7CE9"}},{border:"#399605",background:"#255C03",highlight:{border:"#399605",background:"#255C03"},hover:{border:"#399605",background:"#255C03"}},{border:"#B70054",background:"#FF007E",highlight:{border:"#B70054",background:"#FF007E"},hover:{border:"#B70054",background:"#FF007E"}},{border:"#AD85E4",background:"#7C29F0",highlight:{border:"#D3BDF0",background:"#7C29F0"},hover:{border:"#D3BDF0",background:"#7C29F0"}},{border:"#4557FA",background:"#000EA1",highlight:{border:"#6E6EFD",background:"#000EA1"},hover:{border:"#6E6EFD",background:"#000EA1"}},{border:"#FFC0CB",background:"#FD5A77",highlight:{border:"#FFD1D9",background:"#FD5A77"},hover:{border:"#FFD1D9",background:"#FD5A77"}},{border:"#C2FABC",background:"#74D66A",highlight:{border:"#E6FFE3",background:"#74D66A"},hover:{border:"#E6FFE3",background:"#74D66A"}},{border:"#EE0000",background:"#990000",highlight:{border:"#FF3333",background:"#BB0000"},hover:{border:"#FF3333",background:"#BB0000"}}],this.options={},this.defaultOptions={useDefaultGroups:!0},me(this.options,this.defaultOptions)}return Ln(e,[{key:"setOptions",value:function(e){var t=["useDefaultGroups"];if(void 0!==e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&-1===ui(t).call(t,o)&&this.add(o,e[o])}},{key:"clear",value:function(){this._groups=new sc,this._groupNames=[]}},{key:"get",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=this._groups.get(e);if(void 0===o&&t)if(!1===this.options.useDefaultGroups&&this._groupNames.length>0){var n=this._groupIndex%this._groupNames.length;++this._groupIndex,(o={}).color=this._groups.get(this._groupNames[n]),this._groups.set(e,o)}else{var i=this._defaultIndex%this._defaultGroups.length;this._defaultIndex++,(o={}).color=this._defaultGroups[i],this._groups.set(e,o)}return o}},{key:"add",value:function(e,t){return this._groups.has(e)||this._groupNames.push(e),this._groups.set(e,t),t}}]),e}(),lc=Wt.some,uc=$n("some"),cc=ti("some");V({target:"Array",proto:!0,forced:!uc||!cc},{some:function(e){return lc(this,e,arguments.length>1?arguments[1]:void 0)}});var dc=G("Array").some,hc=Array.prototype,pc=function(e){var t=e.some;return e===hc||e instanceof Array&&t===hc.some?dc:t},fc=i.isFinite;V({target:"Number",stat:!0},{isFinite:Number.isFinite||function(e){return"number"==typeof e&&fc(e)}});var vc=D.Number.isFinite;V({target:"Number",stat:!0},{isNaN:function(e){return e!=e}});var gc=D.Number.isNaN,bc=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e},mc=Ne("Reflect","construct"),yc=r(function(){function e(){}return!(mc(function(){},[],e)instanceof e)}),jc=!r(function(){mc(function(){})}),wc=yc||jc;V({target:"Reflect",stat:!0,forced:wc,sham:wc},{construct:function(e,t){L(e),R(t);var o=arguments.length<3?e:L(arguments[2]);if(jc&&!yc)return mc(e,t,o);if(e==o){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3])}var n=[null];return n.push.apply(n,t),new(X.apply(e,n))}var i=o.prototype,r=it(b(i)?i:Object.prototype),s=Function.apply.call(e,r,t);return b(s)?s:r}});var xc=D.Reflect.construct,Cc=G("Array").entries,Ec=Array.prototype,kc={DOMTokenList:!0,NodeList:!0},_c=G("Array").values,Ac=Array.prototype,Oc={DOMTokenList:!0,NodeList:!0},Mc=function(e){var t=e.values;return e===Ac||e instanceof Array&&t===Ac.values||Oc.hasOwnProperty(wt(e))?_c:t},Ic=G("Array").keys,Nc=Array.prototype,Sc={DOMTokenList:!0,NodeList:!0},Tc=function(e){var t=e.keys;return e===Nc||e instanceof Array&&t===Nc.keys||Sc.hasOwnProperty(wt(e))?Ic:t},Dc=Pn;V({target:"Object",stat:!0},{setPrototypeOf:To});var Lc=D.Object.setPrototypeOf,Fc=o(function(e){function t(o,n){return e.exports=t=Lc||function(e,t){return e.__proto__=t,e},t(o,n)}e.exports=t}),Rc=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Dc(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Fc(e,t)},Pc=function(e,t){return!t||"object"!==$r(t)&&"function"!=typeof t?bc(e):t},Bc=Di,zc=o(function(e){function t(o){return e.exports=t=Lc?Bc:function(e){return e.__proto__||Bc(e)},t(o)}e.exports=t}),Hc=[],Wc=Hc.sort,Vc=r(function(){Hc.sort(void 0)}),Uc=r(function(){Hc.sort(null)}),Yc=$n("sort");V({target:"Array",proto:!0,forced:Vc||!Uc||!Yc},{sort:function(e){return void 0===e?Wc.call(fe(this)):Wc.call(fe(this),L(e))}});var qc=G("Array").sort,Xc=Array.prototype,Gc=function(e){var t=e.sort;return e===Xc||e instanceof Array&&t===Xc.sort?qc:t},Kc=(Qu("Set",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},rc),D.Set),Jc=o(function(e){var t=function(e){var t,o=Object.prototype,n=o.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},r=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function l(e,t,o){return Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,o){return e[t]=o}}function u(e,t,o,n){var i=Object.create((t&&t.prototype instanceof g?t:g).prototype),r=new O(n||[]);return i._invoke=function(e,t,o){var n=d;return function(i,r){if(n===p)throw new Error("Generator is already running");if(n===f){if("throw"===i)throw r;return I()}for(o.method=i,o.arg=r;;){var s=o.delegate;if(s){var a=k(s,o);if(a){if(a===v)continue;return a}}if("next"===o.method)o.sent=o._sent=o.arg;else if("throw"===o.method){if(n===d)throw n=f,o.arg;o.dispatchException(o.arg)}else"return"===o.method&&o.abrupt("return",o.arg);n=p;var l=c(e,t,o);if("normal"===l.type){if(n=o.done?f:h,l.arg===v)continue;return{value:l.arg,done:o.done}}"throw"===l.type&&(n=f,o.method="throw",o.arg=l.arg)}}}(e,o,r),i}function c(e,t,o){try{return{type:"normal",arg:e.call(t,o)}}catch(e){return{type:"throw",arg:e}}}e.wrap=u;var d="suspendedStart",h="suspendedYield",p="executing",f="completed",v={};function g(){}function b(){}function m(){}var y={};y[r]=function(){return this};var j=Object.getPrototypeOf,w=j&&j(j(M([])));w&&w!==o&&n.call(w,r)&&(y=w);var x=m.prototype=g.prototype=Object.create(y);function C(e){["next","throw","return"].forEach(function(t){l(e,t,function(e){return this._invoke(t,e)})})}function E(e,t){function o(i,r,s,a){var l=c(e[i],e,r);if("throw"!==l.type){var u=l.arg,d=u.value;return d&&"object"==typeof d&&n.call(d,"__await")?t.resolve(d.__await).then(function(e){o("next",e,s,a)},function(e){o("throw",e,s,a)}):t.resolve(d).then(function(e){u.value=e,s(u)},function(e){return o("throw",e,s,a)})}a(l.arg)}var i;this._invoke=function(e,n){function r(){return new t(function(t,i){o(e,n,t,i)})}return i=i?i.then(r,r):r()}}function k(e,o){var n=e.iterator[o.method];if(n===t){if(o.delegate=null,"throw"===o.method){if(e.iterator.return&&(o.method="return",o.arg=t,k(e,o),"throw"===o.method))return v;o.method="throw",o.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var i=c(n,e.iterator,o.arg);if("throw"===i.type)return o.method="throw",o.arg=i.arg,o.delegate=null,v;var r=i.arg;return r?r.done?(o[e.resultName]=r.value,o.next=e.nextLoc,"return"!==o.method&&(o.method="next",o.arg=t),o.delegate=null,v):r:(o.method="throw",o.arg=new TypeError("iterator result is not an object"),o.delegate=null,v)}function _(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function A(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(_,this),this.reset(!0)}function M(e){if(e){var o=e[r];if(o)return o.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,s=function o(){for(;++i<e.length;)if(n.call(e,i))return o.value=e[i],o.done=!1,o;return o.value=t,o.done=!0,o};return s.next=s}}return{next:I}}function I(){return{value:t,done:!0}}return b.prototype=x.constructor=m,m.constructor=b,b.displayName=l(m,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===b||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,l(e,a,"GeneratorFunction")),e.prototype=Object.create(x),e},e.awrap=function(e){return{__await:e}},C(E.prototype),E.prototype[s]=function(){return this},e.AsyncIterator=E,e.async=function(t,o,n,i,r){void 0===r&&(r=Promise);var s=new E(u(t,o,n,i),r);return e.isGeneratorFunction(o)?s:s.next().then(function(e){return e.done?e.value:s.next()})},C(x),l(x,a,"Generator"),x[r]=function(){return this},x.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var o in e)t.push(o);return t.reverse(),function o(){for(;t.length;){var n=t.pop();if(n in e)return o.value=n,o.done=!1,o}return o.done=!0,o}},e.values=M,O.prototype={constructor:O,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(A),!e)for(var o in this)"t"===o.charAt(0)&&n.call(this,o)&&!isNaN(+o.slice(1))&&(this[o]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var o=this;function i(n,i){return a.type="throw",a.arg=e,o.next=n,i&&(o.method="next",o.arg=t),!!i}for(var r=this.tryEntries.length-1;r>=0;--r){var s=this.tryEntries[r],a=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var l=n.call(s,"catchLoc"),u=n.call(s,"finallyLoc");if(l&&u){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(e,t){for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var r=i;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var s=r?r.completion:{};return s.type=e,s.arg=t,r?(this.method="next",this.next=r.finallyLoc,v):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var o=this.tryEntries[t];if(o.finallyLoc===e)return this.complete(o.completion,o.afterLoc),A(o),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var o=this.tryEntries[t];if(o.tryLoc===e){var n=o.completion;if("throw"===n.type){var i=n.arg;A(o)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,o,n){return this.delegate={iterator:M(e),resultName:o,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}(e.exports);try{regeneratorRuntime=t}catch(e){Function("r","regeneratorRuntime = r")(t)}}),$c=Kr,Qc=function(e,t,o,n,i,r,s,a){for(var l,u=i,c=0,d=!!s&&F(s,a,3);c<n;){if(c in o){if(l=d?d(o[c],c,t):o[c],r>0&&Ue(l))u=Qc(e,t,l,oe(l.length),u,r-1)-1;else{if(u>=9007199254740991)throw TypeError("Exceed the acceptable array length");e[u]=l}u++}c++}return u},Zc=Qc;V({target:"Array",proto:!0},{flatMap:function(e){var t,o=fe(this),n=oe(o.length);return L(e),(t=Bt(o,0)).length=Zc(t,o,o,n,0,1,e,arguments.length>1?arguments[1]:void 0),t}});var ed=G("Array").flatMap,td=Array.prototype,od=function(e){return function(t,o,n,i){L(o);var r=fe(t),s=f(r),a=oe(r.length),l=e?a-1:0,u=e?-1:1;if(n<2)for(;;){if(l in s){i=s[l],l+=u;break}if(l+=u,e?l<0:a<=l)throw TypeError("Reduce of empty array with no initial value")}for(;e?l>=0:a>l;l+=u)l in s&&(i=o(i,s[l],l,r));return i}},nd={left:od(!1),right:od(!0)},id="process"==h(i.process),rd=nd.left,sd=$n("reduce"),ad=ti("reduce",{1:0});V({target:"Array",proto:!0,forced:!sd||!ad||!id&&Ei>79&&Ei<83},{reduce:function(e){return rd(this,e,arguments.length,arguments.length>1?arguments[1]:void 0)}});var ld,ud=G("Array").reduce,cd=Array.prototype,dd=function(e){var t=e.reduce;return e===cd||e instanceof Array&&t===cd.reduce?ud:t},hd=new Uint8Array(16);function pd(){if(!ld&&!(ld="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return ld(hd)}var fd=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function vd(e){return"string"==typeof e&&fd.test(e)}for(var gd=[],bd=0;bd<256;++bd)gd.push((bd+256).toString(16).substr(1));function md(e,t,o){var n=(e=e||{}).random||(e.rng||pd)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){o=o||0;for(var i=0;i<16;++i)t[o+i]=n[i];return t}return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=(gd[e[t+0]]+gd[e[t+1]]+gd[e[t+2]]+gd[e[t+3]]+"-"+gd[e[t+4]]+gd[e[t+5]]+"-"+gd[e[t+6]]+gd[e[t+7]]+"-"+gd[e[t+8]]+gd[e[t+9]]+"-"+gd[e[t+10]]+gd[e[t+11]]+gd[e[t+12]]+gd[e[t+13]]+gd[e[t+14]]+gd[e[t+15]]).toLowerCase();if(!vd(o))throw TypeError("Stringified UUID is invalid");return o}(n)}function yd(e,t){var o=Hr(e);if(Co){var n=Co(e);t&&(n=Si(n).call(n,function(t){return He(e,t).enumerable})),o.push.apply(o,n)}return o}function jd(e){for(var t=1;t<arguments.length;t++){var o,n=null!=arguments[t]?arguments[t]:{};if(t%2)pr(o=yd(Object(n),!0)).call(o,function(t){zn(e,t,n[t])});else if(Fe)Me(e,Fe(n));else{var i;pr(i=yd(Object(n))).call(i,function(t){Ae(e,t,He(n,t))})}}return e}function wd(e){var t=function(){if("undefined"==typeof Reflect||!xc)return!1;if(xc.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(xc(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var o,n=zc(e);if(t){var i=zc(this).constructor;o=xc(n,arguments,i)}else o=n.apply(this,arguments);return Pc(this,o)}}function xd(e,t){var o;if(void 0===is||null==nn(e)){if(Gr(e)||(o=function(e,t){var o;if(e){if("string"==typeof e)return Cd(e,t);var n=Zr(o=Object.prototype.toString.call(e)).call(o,8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?gn(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Cd(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){o&&(e=o);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){o=on(e)},n:function(){var e=o.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==o.return||o.return()}finally{if(a)throw r}}}}function Cd(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}var Ed=function(){function e(t,o,n){var i,r,s;Sn(this,e),this._source=t,this._transformers=o,this._target=n,this._listeners={add:$(i=this._add).call(i,this),remove:$(r=this._remove).call(r,this),update:$(s=this._update).call(s,this)}}return Ln(e,[{key:"all",value:function(){return this._target.update(this._transformItems(this._source.get())),this}},{key:"start",value:function(){return this._source.on("add",this._listeners.add),this._source.on("remove",this._listeners.remove),this._source.on("update",this._listeners.update),this}},{key:"stop",value:function(){return this._source.off("add",this._listeners.add),this._source.off("remove",this._listeners.remove),this._source.off("update",this._listeners.update),this}},{key:"_transformItems",value:function(e){var t;return dd(t=this._transformers).call(t,function(e,t){return t(e)},e)}},{key:"_add",value:function(e,t){null!=t&&this._target.add(this._transformItems(this._source.get(t.items)))}},{key:"_update",value:function(e,t){null!=t&&this._target.update(this._transformItems(this._source.get(t.items)))}},{key:"_remove",value:function(e,t){null!=t&&this._target.remove(this._transformItems(t.oldData))}}]),e}(),kd=function(){function e(t){Sn(this,e),this._source=t,this._transformers=[]}return Ln(e,[{key:"filter",value:function(e){return this._transformers.push(function(t){return Si(t).call(t,e)}),this}},{key:"map",value:function(e){return this._transformers.push(function(t){return Xr(t).call(t,e)}),this}},{key:"flatMap",value:function(e){return this._transformers.push(function(t){return function(e){var t=e.flatMap;return e===td||e instanceof Array&&t===td.flatMap?ed:t}(t).call(t,e)}),this}},{key:"to",value:function(e){return new Ed(this._source,this._transformers,e)}}]),e}();function _d(e){return"string"==typeof e||"number"==typeof e}var Ad=function(){function e(t){Sn(this,e),this._queue=[],this._timeout=null,this._extended=null,this.delay=null,this.max=1/0,this.setOptions(t)}return Ln(e,[{key:"setOptions",value:function(e){e&&void 0!==e.delay&&(this.delay=e.delay),e&&void 0!==e.max&&(this.max=e.max),this._flushIfNeeded()}},{key:"destroy",value:function(){if(this.flush(),this._extended){for(var e=this._extended.object,t=this._extended.methods,o=0;o<t.length;o++){var n=t[o];n.original?e[n.name]=n.original:delete e[n.name]}this._extended=null}}},{key:"replace",value:function(e,t){var o=this,n=e[t];if(!n)throw new Error("Method "+t+" undefined");e[t]=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];o.queue({args:t,fn:n,context:this})}}},{key:"queue",value:function(e){this._queue.push("function"==typeof e?{fn:e}:e),this._flushIfNeeded()}},{key:"_flushIfNeeded",value:function(){var e=this;this._queue.length>this.max&&this.flush(),null!=this._timeout&&(clearTimeout(this._timeout),this._timeout=null),this.queue.length>0&&"number"==typeof this.delay&&(this._timeout=En(function(){e.flush()},this.delay))}},{key:"flush",value:function(){var e,t;pr(e=er(t=this._queue).call(t,0)).call(e,function(e){e.fn.apply(e.context||e.fn,e.args||[])})}}],[{key:"extend",value:function(t,o){var n=new e(o);if(void 0!==t.flush)throw new Error("Target object already has a property flush");t.flush=function(){n.flush()};var i=[{name:"flush",original:void 0}];if(o&&o.replace)for(var r=0;r<o.replace.length;r++){var s=o.replace[r];i.push({name:s,original:t[s]}),n.replace(t,s)}return n._extended={object:t,methods:i},n}}]),e}(),Od=function(){function e(){Sn(this,e),this._subscribers={"*":[],add:[],remove:[],update:[]},this.subscribe=e.prototype.on,this.unsubscribe=e.prototype.off}return Ln(e,[{key:"_trigger",value:function(e,t,o){var n,i;if("*"===e)throw new Error("Cannot trigger event *");pr(n=ns(i=[]).call(i,es(this._subscribers[e]),es(this._subscribers["*"]))).call(n,function(n){n(e,t,null!=o?o:null)})}},{key:"on",value:function(e,t){"function"==typeof t&&this._subscribers[e].push(t)}},{key:"off",value:function(e,t){var o;this._subscribers[e]=Si(o=this._subscribers[e]).call(o,function(e){return e!==t})}}]),e}(),Md=function(){function e(t){Sn(this,e),this._pairs=t}return Ln(e,[{key:$c,value:Jc.mark(function e(){var t,o,n,i,r;return Jc.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=xd(this._pairs),e.prev=1,t.s();case 3:if((o=t.n()).done){e.next=9;break}return n=Pr(o.value,2),i=n[0],r=n[1],e.next=7,[i,r];case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),t.e(e.t0);case 14:return e.prev=14,t.f(),e.finish(14);case 17:case"end":return e.stop()}},e,this,[[1,11,14,17]])})},{key:"entries",value:Jc.mark(function e(){var t,o,n,i,r;return Jc.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=xd(this._pairs),e.prev=1,t.s();case 3:if((o=t.n()).done){e.next=9;break}return n=Pr(o.value,2),i=n[0],r=n[1],e.next=7,[i,r];case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),t.e(e.t0);case 14:return e.prev=14,t.f(),e.finish(14);case 17:case"end":return e.stop()}},e,this,[[1,11,14,17]])})},{key:"keys",value:Jc.mark(function e(){var t,o,n,i;return Jc.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=xd(this._pairs),e.prev=1,t.s();case 3:if((o=t.n()).done){e.next=9;break}return n=Pr(o.value,1),i=n[0],e.next=7,i;case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),t.e(e.t0);case 14:return e.prev=14,t.f(),e.finish(14);case 17:case"end":return e.stop()}},e,this,[[1,11,14,17]])})},{key:"values",value:Jc.mark(function e(){var t,o,n,i;return Jc.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=xd(this._pairs),e.prev=1,t.s();case 3:if((o=t.n()).done){e.next=9;break}return n=Pr(o.value,2),i=n[1],e.next=7,i;case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),t.e(e.t0);case 14:return e.prev=14,t.f(),e.finish(14);case 17:case"end":return e.stop()}},e,this,[[1,11,14,17]])})},{key:"toIdArray",value:function(){var e;return Xr(e=es(this._pairs)).call(e,function(e){return e[0]})}},{key:"toItemArray",value:function(){var e;return Xr(e=es(this._pairs)).call(e,function(e){return e[1]})}},{key:"toEntryArray",value:function(){return es(this._pairs)}},{key:"toObjectMap",value:function(){var e,t=Bn(null),o=xd(this._pairs);try{for(o.s();!(e=o.n()).done;){var n=Pr(e.value,2);t[n[0]]=n[1]}}catch(e){o.e(e)}finally{o.f()}return t}},{key:"toMap",value:function(){return new sc(this._pairs)}},{key:"toIdSet",value:function(){return new Kc(this.toIdArray())}},{key:"toItemSet",value:function(){return new Kc(this.toItemArray())}},{key:"cache",value:function(){return new e(es(this._pairs))}},{key:"distinct",value:function(e){var t,o=new Kc,n=xd(this._pairs);try{for(n.s();!(t=n.n()).done;){var i=Pr(t.value,2);o.add(e(i[1],i[0]))}}catch(e){n.e(e)}finally{n.f()}return o}},{key:"filter",value:function(t){var o=this._pairs;return new e(zn({},$c,Jc.mark(function e(){var n,i,r,s,a;return Jc.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=xd(o),e.prev=1,n.s();case 3:if((i=n.n()).done){e.next=10;break}if(r=Pr(i.value,2),!t(a=r[1],s=r[0])){e.next=8;break}return e.next=8,[s,a];case 8:e.next=3;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),n.e(e.t0);case 15:return e.prev=15,n.f(),e.finish(15);case 18:case"end":return e.stop()}},e,null,[[1,12,15,18]])})))}},{key:"forEach",value:function(e){var t,o=xd(this._pairs);try{for(o.s();!(t=o.n()).done;){var n=Pr(t.value,2);e(n[1],n[0])}}catch(e){o.e(e)}finally{o.f()}}},{key:"map",value:function(t){var o=this._pairs;return new e(zn({},$c,Jc.mark(function e(){var n,i,r,s,a;return Jc.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=xd(o),e.prev=1,n.s();case 3:if((i=n.n()).done){e.next=9;break}return r=Pr(i.value,2),s=r[0],a=r[1],e.next=7,[s,t(a,s)];case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),n.e(e.t0);case 14:return e.prev=14,n.f(),e.finish(14);case 17:case"end":return e.stop()}},e,null,[[1,11,14,17]])})))}},{key:"max",value:function(e){var t=on(this._pairs),o=t.next();if(o.done)return null;for(var n=o.value[1],i=e(o.value[1],o.value[0]);!(o=t.next()).done;){var r=Pr(o.value,2),s=r[1],a=e(s,r[0]);a>i&&(i=a,n=s)}return n}},{key:"min",value:function(e){var t=on(this._pairs),o=t.next();if(o.done)return null;for(var n=o.value[1],i=e(o.value[1],o.value[0]);!(o=t.next()).done;){var r=Pr(o.value,2),s=r[1],a=e(s,r[0]);a<i&&(i=a,n=s)}return n}},{key:"reduce",value:function(e,t){var o,n=xd(this._pairs);try{for(n.s();!(o=n.n()).done;){var i=Pr(o.value,2);t=e(t,i[1],i[0])}}catch(e){n.e(e)}finally{n.f()}return t}},{key:"sort",value:function(t){var o=this;return new e(zn({},$c,function(){var e;return on(Gc(e=es(o._pairs)).call(e,function(e,o){var n=Pr(e,2),i=n[0],r=n[1],s=Pr(o,2);return t(r,s[1],i,s[0])}))}))}}]),e}(),Id=function(e){Rc(o,e);var t=wd(o);function o(e,n){var i;return Sn(this,o),(i=t.call(this))._queue=null,e&&!Gr(e)&&(n=e,e=[]),i._options=n||{},i._data=new sc,i.length=0,i._idProp=i._options.fieldId||"id",e&&e.length&&i.add(e),i.setOptions(n),i}return Ln(o,[{key:"setOptions",value:function(e){e&&void 0!==e.queue&&(!1===e.queue?this._queue&&(this._queue.destroy(),this._queue=null):(this._queue||(this._queue=Ad.extend(this,{replace:["add","update","remove"]})),e.queue&&"object"===$r(e.queue)&&this._queue.setOptions(e.queue)))}},{key:"add",value:function(e,t){var o,n=this,i=[];if(Gr(e)){var r=Xr(e).call(e,function(e){return e[n._idProp]});if(pc(r).call(r,function(e){return n._data.has(e)}))throw new Error("A duplicate id was found in the parameter array.");for(var s=0,a=e.length;s<a;s++)o=this._addItem(e[s]),i.push(o)}else{if(!e||"object"!==$r(e))throw new Error("Unknown dataType");o=this._addItem(e),i.push(o)}return i.length&&this._trigger("add",{items:i},t),i}},{key:"update",value:function(e,t){var o=this,n=[],i=[],r=[],s=[],a=this._idProp,l=function(e){var t=e[a];if(null!=t&&o._data.has(t)){var l=e,u=me({},o._data.get(t)),c=o._updateItem(l);i.push(c),s.push(l),r.push(u)}else{var d=o._addItem(e);n.push(d)}};if(Gr(e))for(var u=0,c=e.length;u<c;u++)e[u]&&"object"===$r(e[u])?l(e[u]):console.warn("Ignoring input item, which is not an object at index "+u);else{if(!e||"object"!==$r(e))throw new Error("Unknown dataType");l(e)}return n.length&&this._trigger("add",{items:n},t),i.length&&this._trigger("update",{items:i,oldData:r,data:s},t),ns(n).call(n,i)}},{key:"updateOnly",value:function(e,t){var o,n=this;Gr(e)||(e=[e]);var i=Xr(o=Xr(e).call(e,function(e){var t=n._data.get(e[n._idProp]);if(null==t)throw new Error("Updating non-existent items is not allowed.");return{oldData:t,update:e}})).call(o,function(e){var t=e.oldData,o=t[n._idProp],i=Ka(t,e.update);return n._data.set(o,i),{id:o,oldData:t,updatedData:i}});if(i.length){var r={items:Xr(i).call(i,function(e){return e.id}),oldData:Xr(i).call(i,function(e){return e.oldData}),data:Xr(i).call(i,function(e){return e.updatedData})};return this._trigger("update",r,t),r.items}return[]}},{key:"get",value:function(e,t){var o=void 0,n=void 0,i=void 0;_d(e)?(o=e,i=t):Gr(e)?(n=e,i=t):i=e;var r,s=i&&"Object"===i.returnType?"Object":"Array",a=i&&Si(i),l=[],u=void 0,c=void 0;if(null!=o)(u=this._data.get(o))&&a&&!a(u)&&(u=void 0);else if(null!=n)for(var d=0,h=n.length;d<h;d++)null==(u=this._data.get(n[d]))||a&&!a(u)||l.push(u);else for(var p,f=0,v=(c=es(Tc(p=this._data).call(p))).length;f<v;f++)null==(u=this._data.get(c[f]))||a&&!a(u)||l.push(u);if(i&&i.order&&null==o&&this._sort(l,i.order),i&&i.fields){var g=i.fields;if(null!=o&&null!=u)u=this._filterFields(u,g);else for(var b=0,m=l.length;b<m;b++)l[b]=this._filterFields(l[b],g)}if("Object"==s){for(var y={},j=0,w=l.length;j<w;j++){var x=l[j];y[x[this._idProp]]=x}return y}return null!=o?null!==(r=u)&&void 0!==r?r:null:l}},{key:"getIds",value:function(e){var t=this._data,o=e&&Si(e),n=e&&e.order,i=es(Tc(t).call(t)),r=[];if(o)if(n){for(var s=[],a=0,l=i.length;a<l;a++){var u=this._data.get(i[a]);null!=u&&o(u)&&s.push(u)}this._sort(s,n);for(var c=0,d=s.length;c<d;c++)r.push(s[c][this._idProp])}else for(var h=0,p=i.length;h<p;h++){var f=this._data.get(i[h]);null!=f&&o(f)&&r.push(f[this._idProp])}else if(n){for(var v=[],g=0,b=i.length;g<b;g++)v.push(t.get(i[g]));this._sort(v,n);for(var m=0,y=v.length;m<y;m++)r.push(v[m][this._idProp])}else for(var j=0,w=i.length;j<w;j++){var x=t.get(i[j]);null!=x&&r.push(x[this._idProp])}return r}},{key:"getDataSet",value:function(){return this}},{key:"forEach",value:function(e,t){var o=t&&Si(t),n=this._data,i=es(Tc(n).call(n));if(t&&t.order)for(var r=this.get(t),s=0,a=r.length;s<a;s++){var l=r[s];e(l,l[this._idProp])}else for(var u=0,c=i.length;u<c;u++){var d=i[u],h=this._data.get(d);null==h||o&&!o(h)||e(h,d)}}},{key:"map",value:function(e,t){for(var o=t&&Si(t),n=[],i=this._data,r=es(Tc(i).call(i)),s=0,a=r.length;s<a;s++){var l=r[s],u=this._data.get(l);null==u||o&&!o(u)||n.push(e(u,l))}return t&&t.order&&this._sort(n,t.order),n}},{key:"_filterFields",value:function(e,t){var o;return e?dd(o=Gr(t)?t:Hr(t)).call(o,function(t,o){return t[o]=e[o],t},{}):e}},{key:"_sort",value:function(e,t){if("string"==typeof t){var o=t;Gc(e).call(e,function(e,t){var n=e[o],i=t[o];return n>i?1:n<i?-1:0})}else{if("function"!=typeof t)throw new TypeError("Order must be a function or a string");Gc(e).call(e,t)}}},{key:"remove",value:function(e,t){for(var o=[],n=[],i=Gr(e)?e:[e],r=0,s=i.length;r<s;r++){var a=this._remove(i[r]);if(a){var l=a[this._idProp];null!=l&&(o.push(l),n.push(a))}}return o.length&&this._trigger("remove",{items:o,oldData:n},t),o}},{key:"_remove",value:function(e){var t;if(_d(e)?t=e:e&&"object"===$r(e)&&(t=e[this._idProp]),null!=t&&this._data.has(t)){var o=this._data.get(t)||null;return this._data.delete(t),--this.length,o}return null}},{key:"clear",value:function(e){for(var t,o=es(Tc(t=this._data).call(t)),n=[],i=0,r=o.length;i<r;i++)n.push(this._data.get(o[i]));return this._data.clear(),this.length=0,this._trigger("remove",{items:o,oldData:n},e),o}},{key:"max",value:function(e){var t,o,n=null,i=null,r=xd(Mc(t=this._data).call(t));try{for(r.s();!(o=r.n()).done;){var s=o.value,a=s[e];"number"==typeof a&&(null==i||a>i)&&(n=s,i=a)}}catch(e){r.e(e)}finally{r.f()}return n||null}},{key:"min",value:function(e){var t,o,n=null,i=null,r=xd(Mc(t=this._data).call(t));try{for(r.s();!(o=r.n()).done;){var s=o.value,a=s[e];"number"==typeof a&&(null==i||a<i)&&(n=s,i=a)}}catch(e){r.e(e)}finally{r.f()}return n||null}},{key:"distinct",value:function(e){for(var t=this._data,o=es(Tc(t).call(t)),n=[],i=0,r=0,s=o.length;r<s;r++){for(var a=t.get(o[r])[e],l=!1,u=0;u<i;u++)if(n[u]==a){l=!0;break}l||void 0===a||(n[i]=a,i++)}return n}},{key:"_addItem",value:function(e){var t=function(e,t){return null==e[t]&&(e[t]=md()),e}(e,this._idProp),o=t[this._idProp];if(this._data.has(o))throw new Error("Cannot add item: item with id "+o+" already exists");return this._data.set(o,t),++this.length,o}},{key:"_updateItem",value:function(e){var t=e[this._idProp];if(null==t)throw new Error("Cannot update item: item has no id (item: "+Nn(e)+")");var o=this._data.get(t);if(!o)throw new Error("Cannot update item: no item with id "+t+" found");return this._data.set(t,jd(jd({},o),e)),t}},{key:"stream",value:function(e){if(e){var t=this._data;return new Md(zn({},$c,Jc.mark(function o(){var n,i,r,s;return Jc.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:n=xd(e),o.prev=1,n.s();case 3:if((i=n.n()).done){o.next=11;break}if(null==(s=t.get(r=i.value))){o.next=9;break}return o.next=9,[r,s];case 9:o.next=3;break;case 11:o.next=16;break;case 13:o.prev=13,o.t0=o.catch(1),n.e(o.t0);case 16:return o.prev=16,n.f(),o.finish(16);case 19:case"end":return o.stop()}},o,null,[[1,13,16,19]])})))}var o;return new Md(zn({},$c,$(o=function(e){var t=e.entries;return e===Ec||e instanceof Array&&t===Ec.entries||kc.hasOwnProperty(wt(e))?Cc:t}(this._data)).call(o,this._data)))}},{key:"idProp",get:function(){return this._idProp}}]),o}(Od),Nd=function(e){Rc(o,e);var t=wd(o);function o(e,n){var i,r;return Sn(this,o),(r=t.call(this)).length=0,r._ids=new Kc,r._options=n||{},r._listener=$(i=r._onEvent).call(i,bc(r)),r.setData(e),r}return Ln(o,[{key:"setData",value:function(e){if(this._data){this._data.off&&this._data.off("*",this._listener);var t=this._data.getIds({filter:Si(this._options)}),o=this._data.get(t);this._ids.clear(),this.length=0,this._trigger("remove",{items:t,oldData:o})}if(null!=e){this._data=e;for(var n=this._data.getIds({filter:Si(this._options)}),i=0,r=n.length;i<r;i++)this._ids.add(n[i]);this.length=n.length,this._trigger("add",{items:n})}else this._data=new Id;this._data.on&&this._data.on("*",this._listener)}},{key:"refresh",value:function(){for(var e=this._data.getIds({filter:Si(this._options)}),t=es(this._ids),o={},n=[],i=[],r=[],s=0,a=e.length;s<a;s++){var l=e[s];o[l]=!0,this._ids.has(l)||(n.push(l),this._ids.add(l))}for(var u=0,c=t.length;u<c;u++){var d=t[u],h=this._data.get(d);null==h?console.error("If you see this, report it please."):o[d]||(i.push(d),r.push(h),this._ids.delete(d))}this.length+=n.length-i.length,n.length&&this._trigger("add",{items:n}),i.length&&this._trigger("remove",{items:i,oldData:r})}},{key:"get",value:function(e,t){if(null==this._data)return null;var o,n=null;_d(e)||Gr(e)?(n=e,o=t):o=e;var i=me({},this._options,o),r=Si(this._options),s=o&&Si(o);return r&&s&&(i.filter=function(e){return r(e)&&s(e)}),null==n?this._data.get(i):this._data.get(n,i)}},{key:"getIds",value:function(e){if(this._data.length){var t=Si(this._options),o=null!=e?Si(e):null;return this._data.getIds({filter:o?t?function(e){return t(e)&&o(e)}:o:t,order:e&&e.order})}return[]}},{key:"forEach",value:function(e,t){if(this._data){var o,n,i=Si(this._options),r=t&&Si(t);n=r?i?function(e){return i(e)&&r(e)}:r:i,pr(o=this._data).call(o,e,{filter:n,order:t&&t.order})}}},{key:"map",value:function(e,t){if(this._data){var o,n,i=Si(this._options),r=t&&Si(t);return n=r?i?function(e){return i(e)&&r(e)}:r:i,Xr(o=this._data).call(o,e,{filter:n,order:t&&t.order})}return[]}},{key:"getDataSet",value:function(){return this._data.getDataSet()}},{key:"stream",value:function(e){var t;return this._data.stream(e||zn({},$c,$(t=Tc(this._ids)).call(t,this._ids)))}},{key:"dispose",value:function(){var e;null!==(e=this._data)&&void 0!==e&&e.off&&this._data.off("*",this._listener);var t,n="This data view has already been disposed of.",i={get:function(){throw new Error(n)},set:function(){throw new Error(n)},configurable:!1},r=xd(Qr(o.prototype));try{for(r.s();!(t=r.n()).done;)Ae(this,t.value,i)}catch(e){r.e(e)}finally{r.f()}}},{key:"_onEvent",value:function(e,t,o){if(t&&t.items&&this._data){var n=t.items,i=[],r=[],s=[],a=[],l=[],u=[];switch(e){case"add":for(var c=0,d=n.length;c<d;c++){var h=n[c];this.get(h)&&(this._ids.add(h),i.push(h))}break;case"update":for(var p=0,f=n.length;p<f;p++){var v=n[p];this.get(v)?this._ids.has(v)?(r.push(v),l.push(t.data[p]),a.push(t.oldData[p])):(this._ids.add(v),i.push(v)):this._ids.has(v)&&(this._ids.delete(v),s.push(v),u.push(t.oldData[p]))}break;case"remove":for(var g=0,b=n.length;g<b;g++){var m=n[g];this._ids.has(m)&&(this._ids.delete(m),s.push(m),u.push(t.oldData[g]))}}this.length+=i.length-s.length,i.length&&this._trigger("add",{items:i},o),r.length&&this._trigger("update",{items:r,oldData:a,data:l},o),s.length&&this._trigger("remove",{items:s,oldData:u},o)}}},{key:"idProp",get:function(){return this.getDataSet().idProp}}]),o}(Od);function Sd(e,t){return"object"===$r(t)&&null!==t&&e===t.idProp&&"function"==typeof t.add&&"function"==typeof t.clear&&"function"==typeof t.distinct&&"function"==typeof pr(t)&&"function"==typeof t.get&&"function"==typeof t.getDataSet&&"function"==typeof t.getIds&&"number"==typeof t.length&&"function"==typeof Xr(t)&&"function"==typeof t.max&&"function"==typeof t.min&&"function"==typeof t.off&&"function"==typeof t.on&&"function"==typeof t.remove&&"function"==typeof t.setOptions&&"function"==typeof t.stream&&"function"==typeof t.update&&"function"==typeof t.updateOnly}function Td(e,t){return"object"===$r(t)&&null!==t&&e===t.idProp&&"function"==typeof pr(t)&&"function"==typeof t.get&&"function"==typeof t.getDataSet&&"function"==typeof t.getIds&&"number"==typeof t.length&&"function"==typeof Xr(t)&&"function"==typeof t.off&&"function"==typeof t.on&&"function"==typeof t.stream&&Sd(e,t.getDataSet())}var Dd=Object.freeze({__proto__:null,DELETE:Ga,DataSet:Id,DataStream:Md,DataView:Nd,Queue:Ad,createNewDataPipeFrom:function(e){return new kd(e)},isDataSetLike:Sd,isDataViewLike:Td}),Ld=lt.f,Fd=r(function(){return!Object.getOwnPropertyNames(1)});V({target:"Object",stat:!0,forced:Fd},{getOwnPropertyNames:Ld});var Rd=D.Object,Pd=qn.trim,Bd=i.parseFloat,zd=1/Bd(Hn+"-0")!=-1/0?function(e){var t=Pd(String(e)),o=Bd(t);return 0===o&&"-"==t.charAt(0)?-0:o}:Bd;V({global:!0,forced:parseFloat!=zd},{parseFloat:zd});var Hd=D.parseFloat;function Wd(e,t){var o=["node","edge","label"],n=!0,i=Yl(t,"chosen");if("boolean"==typeof i)n=i;else if("object"===$r(i)){if(-1===ui(o).call(o,e))throw new Error("choosify: subOption '"+e+"' should be one of '"+o.join("', '")+"'");var r=Yl(t,["chosen",e]);"boolean"!=typeof r&&"function"!=typeof r||(n=r)}return n}function Vd(e,t,o){if(e.width<=0||e.height<=0)return!1;if(void 0!==o){var n={x:t.x-o.x,y:t.y-o.y};if(0!==o.angle){var i=-o.angle;t={x:Math.cos(i)*n.x-Math.sin(i)*n.y,y:Math.sin(i)*n.x+Math.cos(i)*n.y}}else t=n}return e.left<t.x&&e.x+e.width>t.x&&e.top<t.y&&e.y+e.width>t.y}function Ud(e){return"string"==typeof e&&""!==e}function Yd(e,t,o,n){var i=n.x,r=n.y;if("function"==typeof n.distanceToBorder){var s=n.distanceToBorder(e,t),a=Math.sin(t)*s,l=Math.cos(t)*s;l===s?(i+=s,r=n.y):a===s?(i=n.x,r-=s):(i+=l,r-=a)}else n.shape.width>n.shape.height?(i=n.x+.5*n.shape.width,r=n.y-o):(i=n.x+o,r=n.y-.5*n.shape.height);return{x:i,y:r}}var qd=function(){function e(t){Sn(this,e),this.measureText=t,this.current=0,this.width=0,this.height=0,this.lines=[]}return Ln(e,[{key:"_add",value:function(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"normal";void 0===this.lines[e]&&(this.lines[e]={width:0,height:0,blocks:[]});var n=t;void 0!==t&&""!==t||(n=" ");var i=this.measureText(n,o),r=me({},Mc(i));r.text=t,r.width=i.width,r.mod=o,void 0!==t&&""!==t||(r.width=0),this.lines[e].blocks.push(r),this.lines[e].width+=r.width}},{key:"curWidth",value:function(){var e=this.lines[this.current];return void 0===e?0:e.width}},{key:"append",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"normal";this._add(this.current,e,t)}},{key:"newLine",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"normal";this._add(this.current,e,t),this.current++}},{key:"determineLineHeights",value:function(){for(var e=0;e<this.lines.length;e++){var t=this.lines[e],o=0;if(void 0!==t.blocks)for(var n=0;n<t.blocks.length;n++){var i=t.blocks[n];o<i.height&&(o=i.height)}t.height=o}}},{key:"determineLabelSize",value:function(){for(var e=0,t=0,o=0;o<this.lines.length;o++){var n=this.lines[o];n.width>e&&(e=n.width),t+=n.height}this.width=e,this.height=t}},{key:"removeEmptyBlocks",value:function(){for(var e=[],t=0;t<this.lines.length;t++){var o=this.lines[t];if(0!==o.blocks.length&&(t!==this.lines.length-1||0!==o.width)){var n={};me(n,o),n.blocks=[];for(var i=void 0,r=[],s=0;s<o.blocks.length;s++){var a=o.blocks[s];0!==a.width?r.push(a):void 0===i&&(i=a)}0===r.length&&void 0!==i&&r.push(i),n.blocks=r,e.push(n)}}return e}},{key:"finalize",value:function(){this.determineLineHeights(),this.determineLabelSize();var e=this.removeEmptyBlocks();return{width:this.width,height:this.height,lines:e}}}]),e}(),Xd={"<b>":/<b>/,"<i>":/<i>/,"<code>":/<code>/,"</b>":/<\/b>/,"</i>":/<\/i>/,"</code>":/<\/code>/,"*":/\*/,_:/_/,"`":/`/,afterBold:/[^*]/,afterItal:/[^_]/,afterMono:/[^`]/},Gd=function(){function e(t){Sn(this,e),this.text=t,this.bold=!1,this.ital=!1,this.mono=!1,this.spacing=!1,this.position=0,this.buffer="",this.modStack=[],this.blocks=[]}return Ln(e,[{key:"mod",value:function(){return 0===this.modStack.length?"normal":this.modStack[0]}},{key:"modName",value:function(){return 0===this.modStack.length?"normal":"mono"===this.modStack[0]?"mono":this.bold&&this.ital?"boldital":this.bold?"bold":this.ital?"ital":void 0}},{key:"emitBlock",value:function(){this.spacing&&(this.add(" "),this.spacing=!1),this.buffer.length>0&&(this.blocks.push({text:this.buffer,mod:this.modName()}),this.buffer="")}},{key:"add",value:function(e){" "===e&&(this.spacing=!0),this.spacing&&(this.buffer+=" ",this.spacing=!1)," "!=e&&(this.buffer+=e)}},{key:"parseWS",value:function(e){return!!/[ \t]/.test(e)&&(this.mono?this.add(e):this.spacing=!0,!0)}},{key:"setTag",value:function(e){this.emitBlock(),this[e]=!0,this.modStack.unshift(e)}},{key:"unsetTag",value:function(e){this.emitBlock(),this[e]=!1,this.modStack.shift()}},{key:"parseStartTag",value:function(e,t){return!(this.mono||this[e]||!this.match(t)||(this.setTag(e),0))}},{key:"match",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=this.prepareRegExp(e),n=Pr(o,2),i=n[0],r=n[1],s=i.test(this.text.substr(this.position,r));return s&&t&&(this.position+=r-1),s}},{key:"parseEndTag",value:function(e,t,o){var n=this.mod()===e;return!(!(n="mono"===e?n&&this.mono:n&&!this.mono)||!this.match(t)||(void 0!==o?(this.position===this.text.length-1||this.match(o,!1))&&this.unsetTag(e):this.unsetTag(e),0))}},{key:"replace",value:function(e,t){return!!this.match(e)&&(this.add(t),this.position+=length-1,!0)}},{key:"prepareRegExp",value:function(e){var t,o;if(e instanceof RegExp)o=e,t=1;else{var n=Xd[e];o=void 0!==n?n:new RegExp(e),t=e.length}return[o,t]}}]),e}(),Kd=function(){function e(t,o,n,i){var r=this;Sn(this,e),this.ctx=t,this.parent=o,this.selected=n,this.hover=i,this.lines=new qd(function(e,o){if(void 0===e)return 0;var s=r.parent.getFormattingValues(t,n,i,o),a=0;return""!==e&&(a=r.ctx.measureText(e).width),{width:a,values:s}})}return Ln(e,[{key:"process",value:function(e){if(!Ud(e))return this.lines.finalize();var t=this.parent.fontOptions;e=(e=e.replace(/\r\n/g,"\n")).replace(/\r/g,"\n");var o=String(e).split("\n"),n=o.length;if(t.multi)for(var i=0;i<n;i++){var r=this.splitBlocks(o[i],t.multi);if(void 0!==r)if(0!==r.length){if(t.maxWdt>0)for(var s=0;s<r.length;s++)this.splitStringIntoLines(r[s].text,r[s].mod,!0);else for(var a=0;a<r.length;a++)this.lines.append(r[a].text,r[a].mod);this.lines.newLine()}else this.lines.newLine("")}else if(t.maxWdt>0)for(var l=0;l<n;l++)this.splitStringIntoLines(o[l]);else for(var u=0;u<n;u++)this.lines.newLine(o[u]);return this.lines.finalize()}},{key:"decodeMarkupSystem",value:function(e){var t="none";return"markdown"===e||"md"===e?t="markdown":!0!==e&&"html"!==e||(t="html"),t}},{key:"splitHtmlBlocks",value:function(e){for(var t=new Gd(e),o=function(e){return!!/&/.test(e)&&(t.replace(t.text,"&lt;","<")||t.replace(t.text,"&amp;","&")||t.add("&"),!0)};t.position<t.text.length;){var n=t.text.charAt(t.position);t.parseWS(n)||/</.test(n)&&(t.parseStartTag("bold","<b>")||t.parseStartTag("ital","<i>")||t.parseStartTag("mono","<code>")||t.parseEndTag("bold","</b>")||t.parseEndTag("ital","</i>")||t.parseEndTag("mono","</code>"))||o(n)||t.add(n),t.position++}return t.emitBlock(),t.blocks}},{key:"splitMarkdownBlocks",value:function(e){for(var t=this,o=new Gd(e),n=!0,i=function(e){return!!/\\/.test(e)&&(o.position<t.text.length+1&&(o.position++,e=t.text.charAt(o.position),/ \t/.test(e)?o.spacing=!0:(o.add(e),n=!1)),!0)};o.position<o.text.length;){var r=o.text.charAt(o.position);o.parseWS(r)||i(r)||(n||o.spacing)&&(o.parseStartTag("bold","*")||o.parseStartTag("ital","_")||o.parseStartTag("mono","`"))||o.parseEndTag("bold","*","afterBold")||o.parseEndTag("ital","_","afterItal")||o.parseEndTag("mono","`","afterMono")||(o.add(r),n=!1),o.position++}return o.emitBlock(),o.blocks}},{key:"splitBlocks",value:function(e,t){var o=this.decodeMarkupSystem(t);return"none"===o?[{text:e,mod:"normal"}]:"markdown"===o?this.splitMarkdownBlocks(e):"html"===o?this.splitHtmlBlocks(e):void 0}},{key:"overMaxWidth",value:function(e){var t=this.ctx.measureText(e).width;return this.lines.curWidth()+t>this.parent.fontOptions.maxWdt}},{key:"getLongestFit",value:function(e){for(var t="",o=0;o<e.length;){var n=t+(""===t?"":" ")+e[o];if(this.overMaxWidth(n))break;t=n,o++}return o}},{key:"getLongestFitWord",value:function(e){for(var t=0;t<e.length&&!this.overMaxWidth(Zr(e).call(e,0,t));)t++;return t}},{key:"splitStringIntoLines",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"normal",o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.parent.getFormattingValues(this.ctx,this.selected,this.hover,t);for(var n=(e=(e=e.replace(/^( +)/g,"$1\r")).replace(/([^\r][^ ]*)( +)/g,"$1\r$2\r")).split("\r");n.length>0;){var i=this.getLongestFit(n);if(0===i){var r=n[0],s=this.getLongestFitWord(r);this.lines.newLine(Zr(r).call(r,0,s),t),n[0]=Zr(r).call(r,s)}else{var a=i;" "===n[i-1]?i--:" "===n[a]&&a++;var l=Zr(n).call(n,0,i).join("");i==n.length&&o?this.lines.append(l,t):this.lines.newLine(l,t),n=Zr(n).call(n,a)}}}}]),e}(),Jd=["bold","ital","boldital","mono"],$d=function(){function e(t,o){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];Sn(this,e),this.body=t,this.pointToSelf=!1,this.baseSize=void 0,this.fontOptions={},this.setOptions(o),this.size={top:0,left:0,width:0,height:0,yLine:0},this.isEdgeLabel=n}return Ln(e,[{key:"setOptions",value:function(e){if(this.elementOptions=e,this.initFontOptions(e.font),Ud(e.label)?this.labelDirty=!0:e.label=void 0,null!=e.font)if("string"==typeof e.font)this.baseSize=this.fontOptions.size;else if("object"===$r(e.font)){var t=e.font.size;void 0!==t&&(this.baseSize=t)}}},{key:"initFontOptions",value:function(t){var o=this;El(Jd,function(e){o.fontOptions[e]={}}),e.parseFontString(this.fontOptions,t)?this.fontOptions.vadjust=0:El(t,function(e,t){null!=e&&"object"!==$r(e)&&(o.fontOptions[t]=e)})}},{key:"constrain",value:function(e){var t={constrainWidth:!1,maxWdt:-1,minWdt:-1,constrainHeight:!1,minHgt:-1,valign:"middle"},o=Yl(e,"widthConstraint");if("number"==typeof o)t.maxWdt=Number(o),t.minWdt=Number(o);else if("object"===$r(o)){var n=Yl(e,["widthConstraint","maximum"]);"number"==typeof n&&(t.maxWdt=Number(n));var i=Yl(e,["widthConstraint","minimum"]);"number"==typeof i&&(t.minWdt=Number(i))}var r=Yl(e,"heightConstraint");if("number"==typeof r)t.minHgt=Number(r);else if("object"===$r(r)){var s=Yl(e,["heightConstraint","minimum"]);"number"==typeof s&&(t.minHgt=Number(s));var a=Yl(e,["heightConstraint","valign"]);"string"==typeof a&&("top"!==a&&"bottom"!==a||(t.valign=a))}return t}},{key:"update",value:function(e,t){this.setOptions(e,!0),this.propagateFonts(t),yl(this.fontOptions,this.constrain(t)),this.fontOptions.chooser=Wd("label",t)}},{key:"adjustSizes",value:function(e){var t=e?e.right+e.left:0;this.fontOptions.constrainWidth&&(this.fontOptions.maxWdt-=t,this.fontOptions.minWdt-=t),this.fontOptions.constrainHeight&&(this.fontOptions.minHgt-=e?e.top+e.bottom:0)}},{key:"addFontOptionsToPile",value:function(e,t){for(var o=0;o<t.length;++o)this.addFontToPile(e,t[o])}},{key:"addFontToPile",value:function(e,t){void 0!==t&&null!=t.font&&e.push(t.font)}},{key:"getBasicOptions",value:function(t){for(var o={},n=0;n<t.length;++n){var i=t[n],r={};e.parseFontString(r,i)&&(i=r),El(i,function(e,t){void 0!==e&&(Object.prototype.hasOwnProperty.call(o,t)||(o[t]=-1!==ui(Jd).call(Jd,t)?{}:e))})}return o}},{key:"getFontOption",value:function(t,o,n){for(var i,r=0;r<t.length;++r){var s=t[r];if(Object.prototype.hasOwnProperty.call(s,o)){if(null==(i=s[o]))continue;var a={};if(e.parseFontString(a,i)&&(i=a),Object.prototype.hasOwnProperty.call(i,n))return i[n]}}if(Object.prototype.hasOwnProperty.call(this.fontOptions,n))return this.fontOptions[n];throw new Error("Did not find value for multi-font for property: '"+n+"'")}},{key:"getFontOptions",value:function(e,t){for(var o={},n=["color","size","face","mod","vadjust"],i=0;i<n.length;++i){var r=n[i];o[r]=this.getFontOption(e,t,r)}return o}},{key:"propagateFonts",value:function(e){var t=this,o=[];this.addFontOptionsToPile(o,e),this.fontOptions=this.getBasicOptions(o);for(var n=function(e){var n=Jd[e],i=t.fontOptions[n];El(t.getFontOptions(o,n),function(e,t){i[t]=e}),i.size=Number(i.size),i.vadjust=Number(i.vadjust)},i=0;i<Jd.length;++i)n(i)}},{key:"draw",value:function(e,t,o,n,i){var r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"middle";if(void 0!==this.elementOptions.label){var s=this.fontOptions.size*this.body.view.scale;this.elementOptions.label&&s<this.elementOptions.scaling.label.drawThreshold-1||(s>=this.elementOptions.scaling.label.maxVisible&&(s=Number(this.elementOptions.scaling.label.maxVisible)/this.body.view.scale),this.calculateLabelSize(e,n,i,t,o,r),this._drawBackground(e),this._drawText(e,t,this.size.yLine,r,s))}}},{key:"_drawBackground",value:function(e){if(void 0!==this.fontOptions.background&&"none"!==this.fontOptions.background){e.fillStyle=this.fontOptions.background;var t=this.getSize();e.fillRect(t.left,t.top,t.width,t.height)}}},{key:"_drawText",value:function(e,t,o){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"middle",i=arguments.length>4?arguments[4]:void 0,r=this._setAlignment(e,t,o,n),s=Pr(r,2);t=s[0],o=s[1],e.textAlign="left",t-=this.size.width/2,this.fontOptions.valign&&this.size.height>this.size.labelHeight&&("top"===this.fontOptions.valign&&(o-=(this.size.height-this.size.labelHeight)/2),"bottom"===this.fontOptions.valign&&(o+=(this.size.height-this.size.labelHeight)/2));for(var a=0;a<this.lineCount;a++){var l=this.lines[a];if(l&&l.blocks){var u=0;this.isEdgeLabel||"center"===this.fontOptions.align?u+=(this.size.width-l.width)/2:"right"===this.fontOptions.align&&(u+=this.size.width-l.width);for(var c=0;c<l.blocks.length;c++){var d=l.blocks[c];e.font=d.font;var h=this._getColor(d.color,i,d.strokeColor),p=Pr(h,2),f=p[0],v=p[1];d.strokeWidth>0&&(e.lineWidth=d.strokeWidth,e.strokeStyle=v,e.lineJoin="round"),e.fillStyle=f,d.strokeWidth>0&&e.strokeText(d.text,t+u,o+d.vadjust),e.fillText(d.text,t+u,o+d.vadjust),u+=d.width}o+=l.height}}}},{key:"_setAlignment",value:function(e,t,o,n){return this.isEdgeLabel&&"horizontal"!==this.fontOptions.align&&!1===this.pointToSelf?(t=0,o=0,"top"===this.fontOptions.align?(e.textBaseline="alphabetic",o-=4):"bottom"===this.fontOptions.align?(e.textBaseline="hanging",o+=4):e.textBaseline="middle"):e.textBaseline=n,[t,o]}},{key:"_getColor",value:function(e,t,o){var n=e||"#000000",i=o||"#ffffff";if(t<=this.elementOptions.scaling.label.drawThreshold){var r=Math.max(0,Math.min(1,1-(this.elementOptions.scaling.label.drawThreshold-t)));n=Il(n,r),i=Il(i,r)}return[n,i]}},{key:"getTextSize",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this._processLabel(e,t,o),{width:this.size.width,height:this.size.height,lineCount:this.lineCount}}},{key:"getSize",value:function(){var e=this.size.left,t=this.size.top-1;if(this.isEdgeLabel){var o=.5*-this.size.width;switch(this.fontOptions.align){case"middle":e=o,t=.5*-this.size.height;break;case"top":e=o,t=-(this.size.height+2);break;case"bottom":e=o,t=2}}return{left:e,top:t,width:this.size.width,height:this.size.height}}},{key:"calculateLabelSize",value:function(e,t,o){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"middle";this._processLabel(e,t,o),this.size.left=n-.5*this.size.width,this.size.top=i-.5*this.size.height,this.size.yLine=i+.5*(1-this.lineCount)*this.fontOptions.size,"hanging"===r&&(this.size.top+=.5*this.fontOptions.size,this.size.top+=4,this.size.yLine+=4)}},{key:"getFormattingValues",value:function(e,t,o,n){var i=function(e,t,o){return"normal"===t?"mod"===o?"":e[o]:void 0!==e[t][o]?e[t][o]:e[o]},r={color:i(this.fontOptions,n,"color"),size:i(this.fontOptions,n,"size"),face:i(this.fontOptions,n,"face"),mod:i(this.fontOptions,n,"mod"),vadjust:i(this.fontOptions,n,"vadjust"),strokeWidth:this.fontOptions.strokeWidth,strokeColor:this.fontOptions.strokeColor};(t||o)&&("normal"===n&&!0===this.fontOptions.chooser&&this.elementOptions.labelHighlightBold?r.mod="bold":"function"==typeof this.fontOptions.chooser&&this.fontOptions.chooser(r,this.elementOptions.id,t,o));var s="";return void 0!==r.mod&&""!==r.mod&&(s+=r.mod+" "),e.font=(s+=r.size+"px "+r.face).replace(/"/g,""),r.font=e.font,r.height=r.size,r}},{key:"differentState",value:function(e,t){return e!==this.selectedState||t!==this.hoverState}},{key:"_processLabelText",value:function(e,t,o,n){return new Kd(e,this,t,o).process(n)}},{key:"_processLabel",value:function(e,t,o){if(!1!==this.labelDirty||this.differentState(t,o)){var n=this._processLabelText(e,t,o,this.elementOptions.label);this.fontOptions.minWdt>0&&n.width<this.fontOptions.minWdt&&(n.width=this.fontOptions.minWdt),this.size.labelHeight=n.height,this.fontOptions.minHgt>0&&n.height<this.fontOptions.minHgt&&(n.height=this.fontOptions.minHgt),this.lines=n.lines,this.lineCount=n.lines.length,this.size.width=n.width,this.size.height=n.height,this.selectedState=t,this.hoverState=o,this.labelDirty=!1}}},{key:"visible",value:function(){return 0!==this.size.width&&0!==this.size.height&&void 0!==this.elementOptions.label&&!(this.fontOptions.size*this.body.view.scale<this.elementOptions.scaling.label.drawThreshold-1)}}],[{key:"parseFontString",value:function(e,t){if(!t||"string"!=typeof t)return!1;var o=t.split(" ");return e.size=+o[0].replace("px",""),e.face=o[1],e.color=o[2],!0}}]),e}(),Qd=function(){function e(t,o,n){Sn(this,e),this.body=o,this.labelModule=n,this.setOptions(t),this.top=void 0,this.left=void 0,this.height=void 0,this.width=void 0,this.radius=void 0,this.margin=void 0,this.refreshNeeded=!0,this.boundingBox={top:0,left:0,right:0,bottom:0}}return Ln(e,[{key:"setOptions",value:function(e){this.options=e}},{key:"_setMargins",value:function(e){this.margin={},this.options.margin&&("object"==$r(this.options.margin)?(this.margin.top=this.options.margin.top,this.margin.right=this.options.margin.right,this.margin.bottom=this.options.margin.bottom,this.margin.left=this.options.margin.left):(this.margin.top=this.options.margin,this.margin.right=this.options.margin,this.margin.bottom=this.options.margin,this.margin.left=this.options.margin)),e.adjustSizes(this.margin)}},{key:"_distanceToBorder",value:function(e,t){var o=this.options.borderWidth;return e&&this.resize(e),Math.min(Math.abs(this.width/2/Math.cos(t)),Math.abs(this.height/2/Math.sin(t)))+o}},{key:"enableShadow",value:function(e,t){t.shadow&&(e.shadowColor=t.shadowColor,e.shadowBlur=t.shadowSize,e.shadowOffsetX=t.shadowX,e.shadowOffsetY=t.shadowY)}},{key:"disableShadow",value:function(e,t){t.shadow&&(e.shadowColor="rgba(0,0,0,0)",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0)}},{key:"enableBorderDashes",value:function(e,t){if(!1!==t.borderDashes)if(void 0!==e.setLineDash){var o=t.borderDashes;!0===o&&(o=[5,15]),e.setLineDash(o)}else console.warn("setLineDash is not supported in this browser. The dashed borders cannot be used."),this.options.shapeProperties.borderDashes=!1,t.borderDashes=!1}},{key:"disableBorderDashes",value:function(e,t){!1!==t.borderDashes&&(void 0!==e.setLineDash?e.setLineDash([0]):(console.warn("setLineDash is not supported in this browser. The dashed borders cannot be used."),this.options.shapeProperties.borderDashes=!1,t.borderDashes=!1))}},{key:"needsRefresh",value:function(e,t){return!0===this.refreshNeeded?(this.refreshNeeded=!1,!0):void 0===this.width||this.labelModule.differentState(e,t)}},{key:"initContextForDraw",value:function(e,t){e.lineWidth=Math.min(this.width,t.borderWidth/this.body.view.scale),e.strokeStyle=t.borderColor,e.fillStyle=t.color}},{key:"performStroke",value:function(e,t){var o=t.borderWidth/this.body.view.scale;e.save(),o>0&&(this.enableBorderDashes(e,t),e.stroke(),this.disableBorderDashes(e,t)),e.restore()}},{key:"performFill",value:function(e,t){e.save(),e.fillStyle=t.color,this.enableShadow(e,t),yn(e).call(e),this.disableShadow(e,t),e.restore(),this.performStroke(e,t)}},{key:"_addBoundingBoxMargin",value:function(e){this.boundingBox.left-=e,this.boundingBox.top-=e,this.boundingBox.bottom+=e,this.boundingBox.right+=e}},{key:"_updateBoundingBox",value:function(e,t,o,n,i){void 0!==o&&this.resize(o,n,i),this.left=e-this.width/2,this.top=t-this.height/2,this.boundingBox.left=this.left,this.boundingBox.top=this.top,this.boundingBox.bottom=this.top+this.height,this.boundingBox.right=this.left+this.width}},{key:"updateBoundingBox",value:function(e,t,o,n,i){this._updateBoundingBox(e,t,o,n,i)}},{key:"getDimensionsFromLabel",value:function(e,t,o){this.textSize=this.labelModule.getTextSize(e,t,o);var n=this.textSize.width,i=this.textSize.height;return 0===n&&(n=14,i=14),{width:n,height:i}}}]),e}(),Zd=function(e){Rc(o,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!xc)return!1;if(xc.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(xc(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var o,n=zc(e);if(t){var i=zc(this).constructor;o=xc(n,arguments,i)}else o=n.apply(this,arguments);return Pc(this,o)}}(o);function o(e,n,i){var r;return Sn(this,o),(r=t.call(this,e,n,i))._setMargins(i),r}return Ln(o,[{key:"resize",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.selected,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.hover;if(this.needsRefresh(t,o)){var n=this.getDimensionsFromLabel(e,t,o);this.width=n.width+this.margin.right+this.margin.left,this.height=n.height+this.margin.top+this.margin.bottom,this.radius=this.width/2}}},{key:"draw",value:function(e,t,o,n,i,r){this.resize(e,n,i),this.left=t-this.width/2,this.top=o-this.height/2,this.initContextForDraw(e,r),je(e,this.left,this.top,this.width,this.height,r.borderRadius),this.performFill(e,r),this.updateBoundingBox(t,o,e,n,i),this.labelModule.draw(e,this.left+this.textSize.width/2+this.margin.left,this.top+this.textSize.height/2+this.margin.top,n,i)}},{key:"updateBoundingBox",value:function(e,t,o,n,i){this._updateBoundingBox(e,t,o,n,i),this._addBoundingBoxMargin(this.options.shapeProperties.borderRadius)}},{key:"distanceToBorder",value:function(e,t){e&&this.resize(e);var o=this.options.borderWidth;return Math.min(Math.abs(this.width/2/Math.cos(t)),Math.abs(this.height/2/Math.sin(t)))+o}}]),o}(Qd),eh=function(e){Rc(o,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!xc)return!1;if(xc.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(xc(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var o,n=zc(e);if(t){var i=zc(this).constructor;o=xc(n,arguments,i)}else o=n.apply(this,arguments);return Pc(this,o)}}(o);function o(e,n,i){var r;return Sn(this,o),(r=t.call(this,e,n,i)).labelOffset=0,r.selected=!1,r}return Ln(o,[{key:"setOptions",value:function(e,t,o){this.options=e,void 0===t&&void 0===o||this.setImages(t,o)}},{key:"setImages",value:function(e,t){t&&this.selected?(this.imageObj=t,this.imageObjAlt=e):(this.imageObj=e,this.imageObjAlt=t)}},{key:"switchImages",value:function(e){var t=e&&!this.selected||!e&&this.selected;if(this.selected=e,void 0!==this.imageObjAlt&&t){var o=this.imageObj;this.imageObj=this.imageObjAlt,this.imageObjAlt=o}}},{key:"_getImagePadding",value:function(){var e={top:0,right:0,bottom:0,left:0};if(this.options.imagePadding){var t=this.options.imagePadding;"object"==$r(t)?(e.top=t.top,e.right=t.right,e.bottom=t.bottom,e.left=t.left):(e.top=t,e.right=t,e.bottom=t,e.left=t)}return e}},{key:"_resizeImage",value:function(){var e,t;if(!1===this.options.shapeProperties.useImageSize){var o=1,n=1;this.imageObj.width&&this.imageObj.height&&(this.imageObj.width>this.imageObj.height?o=this.imageObj.width/this.imageObj.height:n=this.imageObj.height/this.imageObj.width),e=2*this.options.size*o,t=2*this.options.size*n}else{var i=this._getImagePadding();e=this.imageObj.width+i.left+i.right,t=this.imageObj.height+i.top+i.bottom}this.width=e,this.height=t,this.radius=.5*this.width}},{key:"_drawRawCircle",value:function(e,t,o,n){this.initContextForDraw(e,n),ye(e,t,o,n.size),this.performFill(e,n)}},{key:"_drawImageAtPosition",value:function(e,t){if(0!=this.imageObj.width){e.globalAlpha=void 0!==t.opacity?t.opacity:1,this.enableShadow(e,t);var o=1;!0===this.options.shapeProperties.interpolation&&(o=this.imageObj.width/this.width/this.body.view.scale);var n=this._getImagePadding();this.imageObj.drawImageAtPosition(e,o,this.left+n.left,this.top+n.top,this.width-n.left-n.right,this.height-n.top-n.bottom),this.disableShadow(e,t)}}},{key:"_drawImageLabel",value:function(e,t,o,n,i){var r=0;if(void 0!==this.height){r=.5*this.height;var s=this.labelModule.getTextSize(e,n,i);s.lineCount>=1&&(r+=s.height/2)}var a=o+r;this.options.label&&(this.labelOffset=r),this.labelModule.draw(e,t,a,n,i,"hanging")}}]),o}(Qd),th=function(e){Rc(o,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!xc)return!1;if(xc.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(xc(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var o,n=zc(e);if(t){var i=zc(this).constructor;o=xc(n,arguments,i)}else o=n.apply(this,arguments);return Pc(this,o)}}(o);function o(e,n,i){var r;return Sn(this,o),(r=t.call(this,e,n,i))._setMargins(i),r}return Ln(o,[{key:"resize",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.selected,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.hover;if(this.needsRefresh(t,o)){var n=this.getDimensionsFromLabel(e,t,o),i=Math.max(n.width+this.margin.right+this.margin.left,n.height+this.margin.top+this.margin.bottom);this.options.size=i/2,this.width=i,this.height=i,this.radius=this.width/2}}},{key:"draw",value:function(e,t,o,n,i,r){this.resize(e,n,i),this.left=t-this.width/2,this.top=o-this.height/2,this._drawRawCircle(e,t,o,r),this.updateBoundingBox(t,o),this.labelModule.draw(e,this.left+this.textSize.width/2+this.margin.left,o,n,i)}},{key:"updateBoundingBox",value:function(e,t){this.boundingBox.top=t-this.options.size,this.boundingBox.left=e-this.options.size,this.boundingBox.right=e+this.options.size,this.boundingBox.bottom=t+this.options.size}},{key:"distanceToBorder",value:function(e){return e&&this.resize(e),.5*this.width}}]),o}(eh),oh=function(e){Rc(o,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!xc)return!1;if(xc.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(xc(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var o,n=zc(e);if(t){var i=zc(this).constructor;o=xc(n,arguments,i)}else o=n.apply(this,arguments);return Pc(this,o)}}(o);function o(e,n,i,r,s){var a;return Sn(this,o),(a=t.call(this,e,n,i)).setImages(r,s),a}return Ln(o,[{key:"resize",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.selected,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.hover,n=void 0===this.imageObj.src||void 0===this.imageObj.width||void 0===this.imageObj.height;if(n){var i=2*this.options.size;return this.width=i,this.height=i,void(this.radius=.5*this.width)}this.needsRefresh(t,o)&&this._resizeImage()}},{key:"draw",value:function(e,t,o,n,i,r){this.switchImages(n),this.resize();var s=t,a=o;"top-left"===this.options.shapeProperties.coordinateOrigin?(this.left=t,this.top=o,s+=this.width/2,a+=this.height/2):(this.left=t-this.width/2,this.top=o-this.height/2),this._drawRawCircle(e,s,a,r),e.save(),e.clip(),this._drawImageAtPosition(e,r),e.restore(),this._drawImageLabel(e,s,a,n,i),this.updateBoundingBox(t,o)}},{key:"updateBoundingBox",value:function(e,t){"top-left"===this.options.shapeProperties.coordinateOrigin?(this.boundingBox.top=t,this.boundingBox.left=e,this.boundingBox.right=e+2*this.options.size,this.boundingBox.bottom=t+2*this.options.size):(this.boundingBox.top=t-this.options.size,this.boundingBox.left=e-this.options.size,this.boundingBox.right=e+this.options.size,this.boundingBox.bottom=t+this.options.size),this.boundingBox.left=Math.min(this.boundingBox.left,this.labelModule.size.left),this.boundingBox.right=Math.max(this.boundingBox.right,this.labelModule.size.left+this.labelModule.size.width),this.boundingBox.bottom=Math.max(this.boundingBox.bottom,this.boundingBox.bottom+this.labelOffset)}},{key:"distanceToBorder",value:function(e){return e&&this.resize(e),.5*this.width}}]),o}(eh),nh=function(e){Rc(o,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!xc)return!1;if(xc.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(xc(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var o,n=zc(e);if(t){var i=zc(this).constructor;o=xc(n,arguments,i)}else o=n.apply(this,arguments);return Pc(this,o)}}(o);function o(e,n,i){return Sn(this,o),t.call(this,e,n,i)}return Ln(o,[{key:"resize",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.selected,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.hover,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{size:this.options.size};if(this.needsRefresh(t,o)){var i,r;this.labelModule.getTextSize(e,t,o);var s=2*n.size;this.width=null!==(i=this.customSizeWidth)&&void 0!==i?i:s,this.height=null!==(r=this.customSizeHeight)&&void 0!==r?r:s,this.radius=.5*this.width}}},{key:"_drawShape",value:function(e,t,o,n,i,r,s,a){var l,u=this;return this.resize(e,r,s,a),this.left=n-this.width/2,this.top=i-this.height/2,this.initContextForDraw(e,a),(l=t,Object.prototype.hasOwnProperty.call(Ee,l)?Ee[l]:function(e){for(var t=arguments.length,o=new Array(t>1?t-1:0),n=1;n<t;n++)o[n-1]=arguments[n];CanvasRenderingContext2D.prototype[l].call(e,o)})(e,n,i,a.size),this.performFill(e,a),void 0!==this.options.icon&&void 0!==this.options.icon.code&&(e.font=(r?"bold ":"")+this.height/2+"px "+(this.options.icon.face||"FontAwesome"),e.fillStyle=this.options.icon.color||"black",e.textAlign="center",e.textBaseline="middle",e.fillText(this.options.icon.code,n,i)),{drawExternalLabel:function(){void 0!==u.options.label&&(u.labelModule.calculateLabelSize(e,r,s,n,i,"hanging"),u.labelModule.draw(e,n,i+.5*u.height+.5*u.labelModule.size.height,r,s,"hanging")),u.updateBoundingBox(n,i)}}}},{key:"updateBoundingBox",value:function(e,t){this.boundingBox.top=t-this.options.size,this.boundingBox.left=e-this.options.size,this.boundingBox.right=e+this.options.size,this.boundingBox.bottom=t+this.options.size,void 0!==this.options.label&&this.labelModule.size.width>0&&(this.boundingBox.left=Math.min(this.boundingBox.left,this.labelModule.size.left),this.boundingBox.right=Math.max(this.boundingBox.right,this.labelModule.size.left+this.labelModule.size.width),this.boundingBox.bottom=Math.max(this.boundingBox.bottom,this.boundingBox.bottom+this.labelModule.size.height))}}]),o}(Qd);function ih(e,t){var o=Hr(e);if(Co){var n=Co(e);t&&(n=Si(n).call(n,function(t){return He(e,t).enumerable})),o.push.apply(o,n)}return o}function rh(e){for(var t=1;t<arguments.length;t++){var o,n=null!=arguments[t]?arguments[t]:{};if(t%2)pr(o=ih(Object(n),!0)).call(o,function(t){zn(e,t,n[t])});else if(Fe)Me(e,Fe(n));else{var i;pr(i=ih(Object(n))).call(i,function(t){Ae(e,t,He(n,t))})}}return e}var sh=function(e){Rc(o,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!xc)return!1;if(xc.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(xc(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var o,n=zc(e);if(t){var i=zc(this).constructor;o=xc(n,arguments,i)}else o=n.apply(this,arguments);return Pc(this,o)}}(o);function o(e,n,i,r){var s;return Sn(this,o),(s=t.call(this,e,n,i,r)).ctxRenderer=r,s}return Ln(o,[{key:"draw",value:function(e,t,o,n,i,r){this.resize(e,n,i,r),this.left=t-this.width/2,this.top=o-this.height/2,e.save();var s=this.ctxRenderer({ctx:e,id:this.options.id,x:t,y:o,state:{selected:n,hover:i},style:rh({},r),label:this.options.label});if(null!=s.drawNode&&s.drawNode(),e.restore(),s.drawExternalLabel){var a=s.drawExternalLabel;s.drawExternalLabel=function(){e.save(),a(),e.restore()}}return s.nodeDimensions&&(this.customSizeWidth=s.nodeDimensions.width,this.customSizeHeight=s.nodeDimensions.height),s}},{key:"distanceToBorder",value:function(e,t){return this._distanceToBorder(e,t)}}]),o}(nh),ah=function(e){Rc(o,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!xc)return!1;if(xc.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(xc(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var o,n=zc(e);if(t){var i=zc(this).constructor;o=xc(n,arguments,i)}else o=n.apply(this,arguments);return Pc(this,o)}}(o);function o(e,n,i){var r;return Sn(this,o),(r=t.call(this,e,n,i))._setMargins(i),r}return Ln(o,[{key:"resize",value:function(e,t,o){if(this.needsRefresh(t,o)){var n=this.getDimensionsFromLabel(e,t,o).width+this.margin.right+this.margin.left;this.width=n,this.height=n,this.radius=this.width/2}}},{key:"draw",value:function(e,t,o,n,i,r){this.resize(e,n,i),this.left=t-this.width/2,this.top=o-this.height/2,this.initContextForDraw(e,r),xe(e,t-this.width/2,o-this.height/2,this.width,this.height),this.performFill(e,r),this.updateBoundingBox(t,o,e,n,i),this.labelModule.draw(e,this.left+this.textSize.width/2+this.margin.left,this.top+this.textSize.height/2+this.margin.top,n,i)}},{key:"distanceToBorder",value:function(e,t){return this._distanceToBorder(e,t)}}]),o}(Qd),lh=function(e){Rc(o,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!xc)return!1;if(xc.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(xc(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var o,n=zc(e);if(t){var i=zc(this).constructor;o=xc(n,arguments,i)}else o=n.apply(this,arguments);return Pc(this,o)}}(o);function o(e,n,i){return Sn(this,o),t.call(this,e,n,i)}return Ln(o,[{key:"draw",value:function(e,t,o,n,i,r){return this._drawShape(e,"diamond",4,t,o,n,i,r)}},{key:"distanceToBorder",value:function(e,t){return this._distanceToBorder(e,t)}}]),o}(nh),uh=function(e){Rc(o,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!xc)return!1;if(xc.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(xc(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var o,n=zc(e);if(t){var i=zc(this).constructor;o=xc(n,arguments,i)}else o=n.apply(this,arguments);return Pc(this,o)}}(o);function o(e,n,i){return Sn(this,o),t.call(this,e,n,i)}return Ln(o,[{key:"draw",value:function(e,t,o,n,i,r){return this._drawShape(e,"circle",2,t,o,n,i,r)}},{key:"distanceToBorder",value:function(e){return e&&this.resize(e),this.options.size}}]),o}(nh),ch=function(e){Rc(o,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!xc)return!1;if(xc.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(xc(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var o,n=zc(e);if(t){var i=zc(this).constructor;o=xc(n,arguments,i)}else o=n.apply(this,arguments);return Pc(this,o)}}(o);function o(e,n,i){return Sn(this,o),t.call(this,e,n,i)}return Ln(o,[{key:"resize",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.selected,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.hover;if(this.needsRefresh(t,o)){var n=this.getDimensionsFromLabel(e,t,o);this.height=2*n.height,this.width=n.width+n.height,this.radius=.5*this.width}}},{key:"draw",value:function(e,t,o,n,i,r){this.resize(e,n,i),this.left=t-.5*this.width,this.top=o-.5*this.height,this.initContextForDraw(e,r),we(e,this.left,this.top,this.width,this.height),this.performFill(e,r),this.updateBoundingBox(t,o,e,n,i),this.labelModule.draw(e,t,o,n,i)}},{key:"distanceToBorder",value:function(e,t){e&&this.resize(e);var o=.5*this.width,n=.5*this.height,i=Math.sin(t)*o,r=Math.cos(t)*n;return o*n/Math.sqrt(i*i+r*r)}}]),o}(Qd),dh=function(e){Rc(o,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!xc)return!1;if(xc.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(xc(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var o,n=zc(e);if(t){var i=zc(this).constructor;o=xc(n,arguments,i)}else o=n.apply(this,arguments);return Pc(this,o)}}(o);function o(e,n,i){var r;return Sn(this,o),(r=t.call(this,e,n,i))._setMargins(i),r}return Ln(o,[{key:"resize",value:function(e,t,o){this.needsRefresh(t,o)&&(this.iconSize={width:Number(this.options.icon.size),height:Number(this.options.icon.size)},this.width=this.iconSize.width+this.margin.right+this.margin.left,this.height=this.iconSize.height+this.margin.top+this.margin.bottom,this.radius=.5*this.width)}},{key:"draw",value:function(e,t,o,n,i,r){var s=this;return this.resize(e,n,i),this.options.icon.size=this.options.icon.size||50,this.left=t-this.width/2,this.top=o-this.height/2,this._icon(e,t,o,n,i,r),{drawExternalLabel:function(){void 0!==s.options.label&&s.labelModule.draw(e,s.left+s.iconSize.width/2+s.margin.left,o+s.height/2+5,n),s.updateBoundingBox(t,o)}}}},{key:"updateBoundingBox",value:function(e,t){this.boundingBox.top=t-.5*this.options.icon.size,this.boundingBox.left=e-.5*this.options.icon.size,this.boundingBox.right=e+.5*this.options.icon.size,this.boundingBox.bottom=t+.5*this.options.icon.size,void 0!==this.options.label&&this.labelModule.size.width>0&&(this.boundingBox.left=Math.min(this.boundingBox.left,this.labelModule.size.left),this.boundingBox.right=Math.max(this.boundingBox.right,this.labelModule.size.left+this.labelModule.size.width),this.boundingBox.bottom=Math.max(this.boundingBox.bottom,this.boundingBox.bottom+this.labelModule.size.height+5))}},{key:"_icon",value:function(e,t,o,n,i,r){var s=Number(this.options.icon.size);void 0!==this.options.icon.code?(e.font=[null!=this.options.icon.weight?this.options.icon.weight:n?"bold":"",(null!=this.options.icon.weight&&n?5:0)+s+"px",this.options.icon.face].join(" "),e.fillStyle=this.options.icon.color||"black",e.textAlign="center",e.textBaseline="middle",this.enableShadow(e,r),e.fillText(this.options.icon.code,t,o),this.disableShadow(e,r)):console.error("When using the icon shape, you need to define the code in the icon options object. This can be done per node or globally.")}},{key:"distanceToBorder",value:function(e,t){return this._distanceToBorder(e,t)}}]),o}(Qd),hh=function(e){Rc(o,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!xc)return!1;if(xc.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(xc(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var o,n=zc(e);if(t){var i=zc(this).constructor;o=xc(n,arguments,i)}else o=n.apply(this,arguments);return Pc(this,o)}}(o);function o(e,n,i,r,s){var a;return Sn(this,o),(a=t.call(this,e,n,i)).setImages(r,s),a}return Ln(o,[{key:"resize",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.selected,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.hover,n=void 0===this.imageObj.src||void 0===this.imageObj.width||void 0===this.imageObj.height;if(n){var i=2*this.options.size;return this.width=i,void(this.height=i)}this.needsRefresh(t,o)&&this._resizeImage()}},{key:"draw",value:function(e,t,o,n,i,r){e.save(),this.switchImages(n),this.resize();var s=t,a=o;if("top-left"===this.options.shapeProperties.coordinateOrigin?(this.left=t,this.top=o,s+=this.width/2,a+=this.height/2):(this.left=t-this.width/2,this.top=o-this.height/2),!0===this.options.shapeProperties.useBorderWithImage){e.lineWidth=Math.min(this.width,(n?this.options.borderWidthSelected||2*this.options.borderWidth:this.options.borderWidth)/this.body.view.scale),e.beginPath();var l=n?this.options.color.highlight.border:i?this.options.color.hover.border:this.options.color.border,u=n?this.options.color.highlight.background:i?this.options.color.hover.background:this.options.color.background;void 0!==r.opacity&&(l=Il(l,r.opacity),u=Il(u,r.opacity)),e.strokeStyle=l,e.fillStyle=u,e.rect(this.left-.5*e.lineWidth,this.top-.5*e.lineWidth,this.width+e.lineWidth,this.height+e.lineWidth),yn(e).call(e),this.performStroke(e,r),e.closePath()}this._drawImageAtPosition(e,r),this._drawImageLabel(e,s,a,n,i),this.updateBoundingBox(t,o),e.restore()}},{key:"updateBoundingBox",value:function(e,t){this.resize(),"top-left"===this.options.shapeProperties.coordinateOrigin?(this.left=e,this.top=t):(this.left=e-this.width/2,this.top=t-this.height/2),this.boundingBox.left=this.left,this.boundingBox.top=this.top,this.boundingBox.bottom=this.top+this.height,this.boundingBox.right=this.left+this.width,void 0!==this.options.label&&this.labelModule.size.width>0&&(this.boundingBox.left=Math.min(this.boundingBox.left,this.labelModule.size.left),this.boundingBox.right=Math.max(this.boundingBox.right,this.labelModule.size.left+this.labelModule.size.width),this.boundingBox.bottom=Math.max(this.boundingBox.bottom,this.boundingBox.bottom+this.labelOffset))}},{key:"distanceToBorder",value:function(e,t){return this._distanceToBorder(e,t)}}]),o}(eh),ph=function(e){Rc(o,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!xc)return!1;if(xc.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(xc(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var o,n=zc(e);if(t){var i=zc(this).constructor;o=xc(n,arguments,i)}else o=n.apply(this,arguments);return Pc(this,o)}}(o);function o(e,n,i){return Sn(this,o),t.call(this,e,n,i)}return Ln(o,[{key:"draw",value:function(e,t,o,n,i,r){return this._drawShape(e,"square",2,t,o,n,i,r)}},{key:"distanceToBorder",value:function(e,t){return this._distanceToBorder(e,t)}}]),o}(nh),fh=function(e){Rc(o,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!xc)return!1;if(xc.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(xc(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var o,n=zc(e);if(t){var i=zc(this).constructor;o=xc(n,arguments,i)}else o=n.apply(this,arguments);return Pc(this,o)}}(o);function o(e,n,i){return Sn(this,o),t.call(this,e,n,i)}return Ln(o,[{key:"draw",value:function(e,t,o,n,i,r){return this._drawShape(e,"hexagon",4,t,o,n,i,r)}},{key:"distanceToBorder",value:function(e,t){return this._distanceToBorder(e,t)}}]),o}(nh),vh=function(e){Rc(o,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!xc)return!1;if(xc.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(xc(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var o,n=zc(e);if(t){var i=zc(this).constructor;o=xc(n,arguments,i)}else o=n.apply(this,arguments);return Pc(this,o)}}(o);function o(e,n,i){return Sn(this,o),t.call(this,e,n,i)}return Ln(o,[{key:"draw",value:function(e,t,o,n,i,r){return this._drawShape(e,"star",4,t,o,n,i,r)}},{key:"distanceToBorder",value:function(e,t){return this._distanceToBorder(e,t)}}]),o}(nh),gh=function(e){Rc(o,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!xc)return!1;if(xc.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(xc(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var o,n=zc(e);if(t){var i=zc(this).constructor;o=xc(n,arguments,i)}else o=n.apply(this,arguments);return Pc(this,o)}}(o);function o(e,n,i){var r;return Sn(this,o),(r=t.call(this,e,n,i))._setMargins(i),r}return Ln(o,[{key:"resize",value:function(e,t,o){this.needsRefresh(t,o)&&(this.textSize=this.labelModule.getTextSize(e,t,o),this.width=this.textSize.width+this.margin.right+this.margin.left,this.height=this.textSize.height+this.margin.top+this.margin.bottom,this.radius=.5*this.width)}},{key:"draw",value:function(e,t,o,n,i,r){this.resize(e,n,i),this.left=t-this.width/2,this.top=o-this.height/2,this.enableShadow(e,r),this.labelModule.draw(e,this.left+this.textSize.width/2+this.margin.left,this.top+this.textSize.height/2+this.margin.top,n,i),this.disableShadow(e,r),this.updateBoundingBox(t,o,e,n,i)}},{key:"distanceToBorder",value:function(e,t){return this._distanceToBorder(e,t)}}]),o}(Qd),bh=function(e){Rc(o,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!xc)return!1;if(xc.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(xc(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var o,n=zc(e);if(t){var i=zc(this).constructor;o=xc(n,arguments,i)}else o=n.apply(this,arguments);return Pc(this,o)}}(o);function o(e,n,i){return Sn(this,o),t.call(this,e,n,i)}return Ln(o,[{key:"draw",value:function(e,t,o,n,i,r){return this._drawShape(e,"triangle",3,t,o,n,i,r)}},{key:"distanceToBorder",value:function(e,t){return this._distanceToBorder(e,t)}}]),o}(nh),mh=function(e){Rc(o,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!xc)return!1;if(xc.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(xc(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var o,n=zc(e);if(t){var i=zc(this).constructor;o=xc(n,arguments,i)}else o=n.apply(this,arguments);return Pc(this,o)}}(o);function o(e,n,i){return Sn(this,o),t.call(this,e,n,i)}return Ln(o,[{key:"draw",value:function(e,t,o,n,i,r){return this._drawShape(e,"triangleDown",3,t,o,n,i,r)}},{key:"distanceToBorder",value:function(e,t){return this._distanceToBorder(e,t)}}]),o}(nh);function yh(e,t){var o=Hr(e);if(Co){var n=Co(e);t&&(n=Si(n).call(n,function(t){return He(e,t).enumerable})),o.push.apply(o,n)}return o}function jh(e){for(var t=1;t<arguments.length;t++){var o,n=null!=arguments[t]?arguments[t]:{};if(t%2)pr(o=yh(Object(n),!0)).call(o,function(t){zn(e,t,n[t])});else if(Fe)Me(e,Fe(n));else{var i;pr(i=yh(Object(n))).call(i,function(t){Ae(e,t,He(n,t))})}}return e}var wh=function(){function e(t,o,n,i,r,s){Sn(this,e),this.options=Wl(r),this.globalOptions=r,this.defaultOptions=s,this.body=o,this.edges=[],this.id=void 0,this.imagelist=n,this.grouplist=i,this.x=void 0,this.y=void 0,this.baseSize=this.options.size,this.baseFontSize=this.options.font.size,this.predefinedPosition=!1,this.selected=!1,this.hover=!1,this.labelModule=new $d(this.body,this.options,!1),this.setOptions(t)}return Ln(e,[{key:"attachEdge",value:function(e){var t;-1===ui(t=this.edges).call(t,e)&&this.edges.push(e)}},{key:"detachEdge",value:function(e){var t,o,n=ui(t=this.edges).call(t,e);-1!=n&&er(o=this.edges).call(o,n,1)}},{key:"setOptions",value:function(t){var o=this.options.shape;if(t){if(void 0!==t.color&&(this._localColor=t.color),void 0!==t.id&&(this.id=t.id),void 0===this.id)throw new Error("Node must have an id");return e.checkMass(t,this.id),void 0!==t.x&&(null===t.x?(this.x=void 0,this.predefinedPosition=!1):(this.x=fi(t.x),this.predefinedPosition=!0)),void 0!==t.y&&(null===t.y?(this.y=void 0,this.predefinedPosition=!1):(this.y=fi(t.y),this.predefinedPosition=!0)),void 0!==t.size&&(this.baseSize=t.size),void 0!==t.value&&(t.value=Hd(t.value)),e.parseOptions(this.options,t,!0,this.globalOptions,this.grouplist),this.chooser=Wd("node",[t,this.options,this.defaultOptions]),this._load_images(),this.updateLabelModule(t),void 0!==t.opacity&&e.checkOpacity(t.opacity)&&(this.options.opacity=t.opacity),this.updateShape(o),void 0!==t.hidden||void 0!==t.physics}}},{key:"_load_images",value:function(){if(("circularImage"===this.options.shape||"image"===this.options.shape)&&void 0===this.options.image)throw new Error("Option image must be defined for node type '"+this.options.shape+"'");if(void 0!==this.options.image){if(void 0===this.imagelist)throw new Error("Internal Error: No images provided");if("string"==typeof this.options.image)this.imageObj=this.imagelist.load(this.options.image,this.options.brokenImage,this.id);else{if(void 0===this.options.image.unselected)throw new Error("No unselected image provided");this.imageObj=this.imagelist.load(this.options.image.unselected,this.options.brokenImage,this.id),this.imageObjAlt=void 0!==this.options.image.selected?this.imagelist.load(this.options.image.selected,this.options.brokenImage,this.id):void 0}}}},{key:"getFormattingValues",value:function(){var e={color:this.options.color.background,opacity:this.options.opacity,borderWidth:this.options.borderWidth,borderColor:this.options.color.border,size:this.options.size,borderDashes:this.options.shapeProperties.borderDashes,borderRadius:this.options.shapeProperties.borderRadius,shadow:this.options.shadow.enabled,shadowColor:this.options.shadow.color,shadowSize:this.options.shadow.size,shadowX:this.options.shadow.x,shadowY:this.options.shadow.y};if(this.selected||this.hover?!0===this.chooser?this.selected?(null!=this.options.borderWidthSelected?e.borderWidth=this.options.borderWidthSelected:e.borderWidth*=2,e.color=this.options.color.highlight.background,e.borderColor=this.options.color.highlight.border,e.shadow=this.options.shadow.enabled):this.hover&&(e.color=this.options.color.hover.background,e.borderColor=this.options.color.hover.border,e.shadow=this.options.shadow.enabled):"function"==typeof this.chooser&&(this.chooser(e,this.options.id,this.selected,this.hover),!1===e.shadow&&(e.shadowColor===this.options.shadow.color&&e.shadowSize===this.options.shadow.size&&e.shadowX===this.options.shadow.x&&e.shadowY===this.options.shadow.y||(e.shadow=!0))):e.shadow=this.options.shadow.enabled,void 0!==this.options.opacity){var t=this.options.opacity;e.borderColor=Il(e.borderColor,t),e.color=Il(e.color,t),e.shadowColor=Il(e.shadowColor,t)}return e}},{key:"updateLabelModule",value:function(t){null!=this.options.label||(this.options.label=""),e.updateGroupOptions(this.options,jh(jh({},t),{},{color:t&&t.color||this._localColor||void 0}),this.grouplist);var o=this.grouplist.get(this.options.group,!1);this.labelModule.update(this.options,[t,this.options,o,this.globalOptions,this.defaultOptions]),void 0!==this.labelModule.baseSize&&(this.baseFontSize=this.labelModule.baseSize)}},{key:"updateShape",value:function(e){if(e===this.options.shape&&this.shape)this.shape.setOptions(this.options,this.imageObj,this.imageObjAlt);else switch(this.options.shape){case"box":this.shape=new Zd(this.options,this.body,this.labelModule);break;case"circle":this.shape=new th(this.options,this.body,this.labelModule);break;case"circularImage":this.shape=new oh(this.options,this.body,this.labelModule,this.imageObj,this.imageObjAlt);break;case"custom":this.shape=new sh(this.options,this.body,this.labelModule,this.options.ctxRenderer);break;case"database":this.shape=new ah(this.options,this.body,this.labelModule);break;case"diamond":this.shape=new lh(this.options,this.body,this.labelModule);break;case"dot":this.shape=new uh(this.options,this.body,this.labelModule);break;case"ellipse":this.shape=new ch(this.options,this.body,this.labelModule);break;case"icon":this.shape=new dh(this.options,this.body,this.labelModule);break;case"image":this.shape=new hh(this.options,this.body,this.labelModule,this.imageObj,this.imageObjAlt);break;case"square":this.shape=new ph(this.options,this.body,this.labelModule);break;case"hexagon":this.shape=new fh(this.options,this.body,this.labelModule);break;case"star":this.shape=new vh(this.options,this.body,this.labelModule);break;case"text":this.shape=new gh(this.options,this.body,this.labelModule);break;case"triangle":this.shape=new bh(this.options,this.body,this.labelModule);break;case"triangleDown":this.shape=new mh(this.options,this.body,this.labelModule);break;default:this.shape=new ch(this.options,this.body,this.labelModule)}this.needsRefresh()}},{key:"select",value:function(){this.selected=!0,this.needsRefresh()}},{key:"unselect",value:function(){this.selected=!1,this.needsRefresh()}},{key:"needsRefresh",value:function(){this.shape.refreshNeeded=!0}},{key:"getTitle",value:function(){return this.options.title}},{key:"distanceToBorder",value:function(e,t){return this.shape.distanceToBorder(e,t)}},{key:"isFixed",value:function(){return this.options.fixed.x&&this.options.fixed.y}},{key:"isSelected",value:function(){return this.selected}},{key:"getValue",value:function(){return this.options.value}},{key:"getLabelSize",value:function(){return this.labelModule.size()}},{key:"setValueRange",value:function(e,t,o){if(void 0!==this.options.value){var n=this.options.scaling.customScalingFunction(e,t,o,this.options.value),i=this.options.scaling.max-this.options.scaling.min;!0===this.options.scaling.label.enabled&&(this.options.font.size=this.options.scaling.label.min+n*(this.options.scaling.label.max-this.options.scaling.label.min)),this.options.size=this.options.scaling.min+n*i}else this.options.size=this.baseSize,this.options.font.size=this.baseFontSize;this.updateLabelModule()}},{key:"draw",value:function(e){var t=this.getFormattingValues();return this.shape.draw(e,this.x,this.y,this.selected,this.hover,t)||{}}},{key:"updateBoundingBox",value:function(e){this.shape.updateBoundingBox(this.x,this.y,e)}},{key:"resize",value:function(e){var t=this.getFormattingValues();this.shape.resize(e,this.selected,this.hover,t)}},{key:"getItemsOnPoint",value:function(e){var t=[];return this.labelModule.visible()&&Vd(this.labelModule.getSize(),e)&&t.push({nodeId:this.id,labelId:0}),Vd(this.shape.boundingBox,e)&&t.push({nodeId:this.id}),t}},{key:"isOverlappingWith",value:function(e){return this.shape.left<e.right&&this.shape.left+this.shape.width>e.left&&this.shape.top<e.bottom&&this.shape.top+this.shape.height>e.top}},{key:"isBoundingBoxOverlappingWith",value:function(e){return this.shape.boundingBox.left<e.right&&this.shape.boundingBox.right>e.left&&this.shape.boundingBox.top<e.bottom&&this.shape.boundingBox.bottom>e.top}}],[{key:"checkOpacity",value:function(e){return 0<=e&&e<=1}},{key:"checkCoordinateOrigin",value:function(e){return void 0===e||"center"===e||"top-left"===e}},{key:"updateGroupOptions",value:function(t,o,n){var i;if(void 0!==n){var r=t.group;if(void 0!==o&&void 0!==o.group&&r!==o.group)throw new Error("updateGroupOptions: group values in options don't match.");if("number"==typeof r||"string"==typeof r&&""!=r){var s=n.get(r);void 0!==s.opacity&&void 0===o.opacity&&(e.checkOpacity(s.opacity)||(console.error("Invalid option for node opacity. Value must be between 0 and 1, found: "+s.opacity),s.opacity=void 0));var a=Si(i=function(e){return Rd.getOwnPropertyNames(e)}(o)).call(i,function(e){return null!=o[e]});a.push("font"),ml(a,t,s),t.color=Sl(t.color)}}}},{key:"parseOptions",value:function(t,o){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=arguments.length>4?arguments[4]:void 0,s=["color","fixed","shadow"];if(ml(s,t,o,n),e.checkMass(o),void 0!==t.opacity&&(e.checkOpacity(t.opacity)||(console.error("Invalid option for node opacity. Value must be between 0 and 1, found: "+t.opacity),t.opacity=void 0)),void 0!==o.opacity&&(e.checkOpacity(o.opacity)||(console.error("Invalid option for node opacity. Value must be between 0 and 1, found: "+o.opacity),o.opacity=void 0)),o.shapeProperties&&!e.checkCoordinateOrigin(o.shapeProperties.coordinateOrigin)&&console.error("Invalid option for node coordinateOrigin, found: "+o.shapeProperties.coordinateOrigin),Vl(t,o,"shadow",i),null!=o.color){var a=Sl(o.color);vl(t.color,a)}else!0===n&&null===o.color&&(t.color=Wl(i.color));null!=o.fixed&&("boolean"==typeof o.fixed?(t.fixed.x=o.fixed,t.fixed.y=o.fixed):(void 0!==o.fixed.x&&"boolean"==typeof o.fixed.x&&(t.fixed.x=o.fixed.x),void 0!==o.fixed.y&&"boolean"==typeof o.fixed.y&&(t.fixed.y=o.fixed.y))),!0===n&&null===o.font&&(t.font=Wl(i.font)),e.updateGroupOptions(t,o,r),void 0!==o.scaling&&Vl(t.scaling,o.scaling,"label",i.scaling)}},{key:"checkMass",value:function(e,t){if(void 0!==e.mass&&e.mass<=0){var o="";void 0!==t&&(o=" in node id: "+t),console.error("%cNegative or zero mass disallowed"+o+", setting mass to 1.",iu),e.mass=1}}}]),e}();function xh(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}var Ch=function(){function e(t,o,n,i){var r,s=this;if(Sn(this,e),this.body=t,this.images=o,this.groups=n,this.layoutEngine=i,this.body.functions.createNode=$(r=this.create).call(r,this),this.nodesListeners={add:function(e,t){s.add(t.items)},update:function(e,t){s.update(t.items,t.data,t.oldData)},remove:function(e,t){s.remove(t.items)}},this.defaultOptions={borderWidth:1,borderWidthSelected:void 0,brokenImage:void 0,color:{border:"#2B7CE9",background:"#97C2FC",highlight:{border:"#2B7CE9",background:"#D2E5FF"},hover:{border:"#2B7CE9",background:"#D2E5FF"}},opacity:void 0,fixed:{x:!1,y:!1},font:{color:"#343434",size:14,face:"arial",background:"none",strokeWidth:0,strokeColor:"#ffffff",align:"center",vadjust:0,multi:!1,bold:{mod:"bold"},boldital:{mod:"bold italic"},ital:{mod:"italic"},mono:{mod:"",size:15,face:"monospace",vadjust:2}},group:void 0,hidden:!1,icon:{face:"FontAwesome",code:void 0,size:50,color:"#2B7CE9"},image:void 0,imagePadding:{top:0,right:0,bottom:0,left:0},label:void 0,labelHighlightBold:!0,level:void 0,margin:{top:5,right:5,bottom:5,left:5},mass:1,physics:!0,scaling:{min:10,max:30,label:{enabled:!1,min:14,max:30,maxVisible:30,drawThreshold:5},customScalingFunction:function(e,t,o,n){return t===e?.5:Math.max(0,1/(t-e)*(n-e))}},shadow:{enabled:!1,color:"rgba(0,0,0,0.5)",size:10,x:5,y:5},shape:"ellipse",shapeProperties:{borderDashes:!1,borderRadius:6,interpolation:!0,useImageSize:!1,useBorderWithImage:!1,coordinateOrigin:"center"},size:25,title:void 0,value:void 0,x:void 0,y:void 0},this.defaultOptions.mass<=0)throw"Internal error: mass in defaultOptions of NodesHandler may not be zero or negative";this.options=Wl(this.defaultOptions),this.bindEventListeners()}return Ln(e,[{key:"bindEventListeners",value:function(){var e,t,o=this;this.body.emitter.on("refreshNodes",$(e=this.refresh).call(e,this)),this.body.emitter.on("refresh",$(t=this.refresh).call(t,this)),this.body.emitter.on("destroy",function(){El(o.nodesListeners,function(e,t){o.body.data.nodes&&o.body.data.nodes.off(t,e)}),delete o.body.functions.createNode,delete o.nodesListeners.add,delete o.nodesListeners.update,delete o.nodesListeners.remove,delete o.nodesListeners})}},{key:"setOptions",value:function(e){if(void 0!==e){if(wh.parseOptions(this.options,e),void 0!==e.opacity&&(gc(e.opacity)||!vc(e.opacity)||e.opacity<0||e.opacity>1?console.error("Invalid option for node opacity. Value must be between 0 and 1, found: "+e.opacity):this.options.opacity=e.opacity),void 0!==e.shape)for(var t in this.body.nodes)Object.prototype.hasOwnProperty.call(this.body.nodes,t)&&this.body.nodes[t].updateShape();if(void 0!==e.font||void 0!==e.widthConstraint||void 0!==e.heightConstraint)for(var o=0,n=Hr(this.body.nodes);o<n.length;o++){var i=n[o];this.body.nodes[i].updateLabelModule(),this.body.nodes[i].needsRefresh()}if(void 0!==e.size)for(var r in this.body.nodes)Object.prototype.hasOwnProperty.call(this.body.nodes,r)&&this.body.nodes[r].needsRefresh();void 0===e.hidden&&void 0===e.physics||this.body.emitter.emit("_dataChanged")}}},{key:"setData",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=this.body.data.nodes;if(Td("id",e))this.body.data.nodes=e;else if(Gr(e))this.body.data.nodes=new Id,this.body.data.nodes.add(e);else{if(e)throw new TypeError("Array or DataSet expected");this.body.data.nodes=new Id}if(o&&El(this.nodesListeners,function(e,t){o.off(t,e)}),this.body.nodes={},this.body.data.nodes){var n=this;El(this.nodesListeners,function(e,t){n.body.data.nodes.on(t,e)});var i=this.body.data.nodes.getIds();this.add(i,!0)}!1===t&&this.body.emitter.emit("_dataChanged")}},{key:"add",value:function(e){for(var t,o=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=[],i=0;i<e.length;i++){var r=this.body.data.nodes.get(t=e[i]),s=this.create(r);n.push(s),this.body.nodes[t]=s}this.layoutEngine.positionInitially(n),!1===o&&this.body.emitter.emit("_dataChanged")}},{key:"update",value:function(e,t,o){for(var n=this.body.nodes,i=!1,r=0;r<e.length;r++){var s=e[r],a=n[s],l=t[r];void 0!==a?a.setOptions(l)&&(i=!0):(i=!0,a=this.create(l),n[s]=a)}i||void 0===o||(i=pc(t).call(t,function(e,t){var n=o[t];return n&&n.level!==e.level})),this.body.emitter.emit(!0===i?"_dataChanged":"_dataUpdated")}},{key:"remove",value:function(e){for(var t=this.body.nodes,o=0;o<e.length;o++)delete t[e[o]];this.body.emitter.emit("_dataChanged")}},{key:"create",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:wh;return new t(e,this.body,this.images,this.groups,this.options,this.defaultOptions)}},{key:"refresh",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];El(this.body.nodes,function(o,n){var i=e.body.data.nodes.get(n);void 0!==i&&(!0===t&&o.setOptions({x:null,y:null}),o.setOptions({fixed:!1}),o.setOptions(i))})}},{key:"getPositions",value:function(e){var t={};if(void 0!==e){if(!0===Gr(e)){for(var o=0;o<e.length;o++)if(void 0!==this.body.nodes[e[o]]){var n=this.body.nodes[e[o]];t[e[o]]={x:Math.round(n.x),y:Math.round(n.y)}}}else if(void 0!==this.body.nodes[e]){var i=this.body.nodes[e];t[e]={x:Math.round(i.x),y:Math.round(i.y)}}}else for(var r=0;r<this.body.nodeIndices.length;r++){var s=this.body.nodes[this.body.nodeIndices[r]];t[this.body.nodeIndices[r]]={x:Math.round(s.x),y:Math.round(s.y)}}return t}},{key:"getPosition",value:function(e){if(null==e)throw new TypeError("No id was specified for getPosition method.");if(null==this.body.nodes[e])throw new ReferenceError("NodeId provided for getPosition does not exist. Provided: ".concat(e));return{x:Math.round(this.body.nodes[e].x),y:Math.round(this.body.nodes[e].y)}}},{key:"storePositions",value:function(){var e,t=[],o=this.body.data.nodes.getDataSet(),n=function(e,t){var o;if(void 0===is||null==nn(e)){if(Gr(e)||(o=function(e,t){var o;if(e){if("string"==typeof e)return xh(e,t);var n=Zr(o=Object.prototype.toString.call(e)).call(o,8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?gn(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?xh(e,t):void 0}}(e))){o&&(e=o);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){o=on(e)},n:function(){var e=o.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==o.return||o.return()}finally{if(a)throw r}}}}(o.get());try{for(n.s();!(e=n.n()).done;){var i=e.value,r=i.id,s=this.body.nodes[r],a=Math.round(s.x),l=Math.round(s.y);i.x===a&&i.y===l||t.push({id:r,x:a,y:l})}}catch(e){n.e(e)}finally{n.f()}o.update(t)}},{key:"getBoundingBox",value:function(e){if(void 0!==this.body.nodes[e])return this.body.nodes[e].shape.boundingBox}},{key:"getConnectedNodes",value:function(e,t){var o=[];if(void 0!==this.body.nodes[e])for(var n=this.body.nodes[e],i={},r=0;r<n.edges.length;r++){var s=n.edges[r];"to"!==t&&s.toId==n.id?void 0===i[s.fromId]&&(o.push(s.fromId),i[s.fromId]=!0):"from"!==t&&s.fromId==n.id&&void 0===i[s.toId]&&(o.push(s.toId),i[s.toId]=!0)}return o}},{key:"getConnectedEdges",value:function(e){var t=[];if(void 0!==this.body.nodes[e])for(var o=this.body.nodes[e],n=0;n<o.edges.length;n++)t.push(o.edges[n].id);else console.error("NodeId provided for getConnectedEdges does not exist. Provided: ",e);return t}},{key:"moveNode",value:function(e,t,o){var n=this;void 0!==this.body.nodes[e]?(this.body.nodes[e].x=Number(t),this.body.nodes[e].y=Number(o),En(function(){n.body.emitter.emit("startSimulation")},0)):console.error("Node id supplied to moveNode does not exist. Provided: ",e)}}]),e}(),Eh=ze;V({target:"Reflect",stat:!0},{get:function e(t,o){var n,i,r=arguments.length<3?t:arguments[2];return R(t)===r?t[o]:(n=_.f(t,o))?j(n,"value")?n.value:void 0===n.get?void 0:n.get.call(r):b(i=Oo(t))?e(i,o,r):void 0}});var kh=D.Reflect.get,_h=o(function(e){function t(o,n,i){return e.exports=t="undefined"!=typeof Reflect&&kh?kh:function(e,t,o){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=zc(e)););return e}(e,t);if(n){var i=Eh(n,t);return i.get?i.get.call(o):i.value}},t(o,n,i||o)}e.exports=t}),Ah=Math.hypot,Oh=Math.abs,Mh=Math.sqrt,Ih=!!Ah&&Ah(1/0,NaN)!==1/0;V({target:"Math",stat:!0,forced:Ih},{hypot:function(e,t){for(var o,n,i=0,r=0,s=arguments.length,a=0;r<s;)a<(o=Oh(arguments[r++]))?(i=i*(n=a/o)*n+1,a=o):i+=o>0?(n=o/a)*n:o;return a===1/0?1/0:a*Mh(i)}});var Nh=D.Math.hypot;function Sh(e){var t=function(){if("undefined"==typeof Reflect||!xc)return!1;if(xc.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(xc(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var o,n=zc(e);if(t){var i=zc(this).constructor;o=xc(n,arguments,i)}else o=n.apply(this,arguments);return Pc(this,o)}}var Th=function(){function e(){Sn(this,e)}return Ln(e,null,[{key:"transform",value:function(e,t){Gr(e)||(e=[e]);for(var o=t.point.x,n=t.point.y,i=t.angle,r=t.length,s=0;s<e.length;++s){var a=e[s],l=a.x*Math.cos(i)-a.y*Math.sin(i),u=a.x*Math.sin(i)+a.y*Math.cos(i);a.x=o+r*l,a.y=n+r*u}}},{key:"drawPath",value:function(e,t){e.beginPath(),e.moveTo(t[0].x,t[0].y);for(var o=1;o<t.length;++o)e.lineTo(t[o].x,t[o].y);e.closePath()}}]),e}(),Dh=function(e){Rc(o,e);var t=Sh(o);function o(){return Sn(this,o),t.apply(this,arguments)}return Ln(o,null,[{key:"draw",value:function(e,t){if(t.image){e.save(),e.translate(t.point.x,t.point.y),e.rotate(Math.PI/2+t.angle);var o=null!=t.imageWidth?t.imageWidth:t.image.width;t.image.drawImageAtPosition(e,1,-o/2,0,o,null!=t.imageHeight?t.imageHeight:t.image.height),e.restore()}return!1}}]),o}(Th),Lh=function(e){Rc(o,e);var t=Sh(o);function o(){return Sn(this,o),t.apply(this,arguments)}return Ln(o,null,[{key:"draw",value:function(e,t){var o=[{x:0,y:0},{x:-1,y:.3},{x:-.9,y:0},{x:-1,y:-.3}];return Th.transform(o,t),Th.drawPath(e,o),!0}}]),o}(Th),Fh=function(){function e(){Sn(this,e)}return Ln(e,null,[{key:"draw",value:function(e,t){var o=[{x:-1,y:0},{x:0,y:.3},{x:-.4,y:0},{x:0,y:-.3}];return Th.transform(o,t),Th.drawPath(e,o),!0}}]),e}(),Rh=function(){function e(){Sn(this,e)}return Ln(e,null,[{key:"draw",value:function(e,t){var o={x:-.4,y:0};Th.transform(o,t),e.strokeStyle=e.fillStyle,e.fillStyle="rgba(0, 0, 0, 0)";var n=Math.PI,i=t.angle-n/2,r=t.angle+n/2;return e.beginPath(),e.arc(o.x,o.y,.4*t.length,i,r,!1),e.stroke(),!0}}]),e}(),Ph=function(){function e(){Sn(this,e)}return Ln(e,null,[{key:"draw",value:function(e,t){var o={x:-.3,y:0};Th.transform(o,t),e.strokeStyle=e.fillStyle,e.fillStyle="rgba(0, 0, 0, 0)";var n=Math.PI,i=t.angle+n/2,r=t.angle+3*n/2;return e.beginPath(),e.arc(o.x,o.y,.4*t.length,i,r,!1),e.stroke(),!0}}]),e}(),Bh=function(){function e(){Sn(this,e)}return Ln(e,null,[{key:"draw",value:function(e,t){var o=[{x:.02,y:0},{x:-1,y:.3},{x:-1,y:-.3}];return Th.transform(o,t),Th.drawPath(e,o),!0}}]),e}(),zh=function(){function e(){Sn(this,e)}return Ln(e,null,[{key:"draw",value:function(e,t){var o=[{x:0,y:.3},{x:0,y:-.3},{x:-1,y:0}];return Th.transform(o,t),Th.drawPath(e,o),!0}}]),e}(),Hh=function(){function e(){Sn(this,e)}return Ln(e,null,[{key:"draw",value:function(e,t){var o={x:-.4,y:0};return Th.transform(o,t),ye(e,o.x,o.y,.4*t.length),!0}}]),e}(),Wh=function(){function e(){Sn(this,e)}return Ln(e,null,[{key:"draw",value:function(e,t){var o=[{x:0,y:.5},{x:0,y:-.5},{x:-.15,y:-.5},{x:-.15,y:.5}];return Th.transform(o,t),Th.drawPath(e,o),!0}}]),e}(),Vh=function(){function e(){Sn(this,e)}return Ln(e,null,[{key:"draw",value:function(e,t){var o=[{x:0,y:.3},{x:0,y:-.3},{x:-.6,y:-.3},{x:-.6,y:.3}];return Th.transform(o,t),Th.drawPath(e,o),!0}}]),e}(),Uh=function(){function e(){Sn(this,e)}return Ln(e,null,[{key:"draw",value:function(e,t){var o=[{x:0,y:0},{x:-.5,y:-.3},{x:-1,y:0},{x:-.5,y:.3}];return Th.transform(o,t),Th.drawPath(e,o),!0}}]),e}(),Yh=function(){function e(){Sn(this,e)}return Ln(e,null,[{key:"draw",value:function(e,t){var o=[{x:-1,y:.3},{x:-.5,y:0},{x:-1,y:-.3},{x:0,y:0}];return Th.transform(o,t),Th.drawPath(e,o),!0}}]),e}(),qh=function(){function e(){Sn(this,e)}return Ln(e,null,[{key:"draw",value:function(e,t){var o;switch(t.type&&(o=t.type.toLowerCase()),o){case"image":return Dh.draw(e,t);case"circle":return Hh.draw(e,t);case"box":return Vh.draw(e,t);case"crow":return Fh.draw(e,t);case"curve":return Rh.draw(e,t);case"diamond":return Uh.draw(e,t);case"inv_curve":return Ph.draw(e,t);case"triangle":return Bh.draw(e,t);case"inv_triangle":return zh.draw(e,t);case"bar":return Wh.draw(e,t);case"vee":return Yh.draw(e,t);case"arrow":default:return Lh.draw(e,t)}}}]),e}();function Xh(e,t){var o=Hr(e);if(Co){var n=Co(e);t&&(n=Si(n).call(n,function(t){return He(e,t).enumerable})),o.push.apply(o,n)}return o}function Gh(e){for(var t=1;t<arguments.length;t++){var o,n=null!=arguments[t]?arguments[t]:{};if(t%2)pr(o=Xh(Object(n),!0)).call(o,function(t){zn(e,t,n[t])});else if(Fe)Me(e,Fe(n));else{var i;pr(i=Xh(Object(n))).call(i,function(t){Ae(e,t,He(n,t))})}}return e}var Kh=function(){function e(t,o,n){Sn(this,e),this._body=o,this._labelModule=n,this.color={},this.colorDirty=!0,this.hoverWidth=1.5,this.selectionWidth=2,this.setOptions(t),this.fromPoint=this.from,this.toPoint=this.to}return Ln(e,[{key:"connect",value:function(){this.from=this._body.nodes[this.options.from],this.to=this._body.nodes[this.options.to]}},{key:"cleanup",value:function(){return!1}},{key:"setOptions",value:function(e){this.options=e,this.from=this._body.nodes[this.options.from],this.to=this._body.nodes[this.options.to],this.id=this.options.id}},{key:"drawLine",value:function(e,t,o,n){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.getViaNode();e.strokeStyle=this.getColor(e,t),e.lineWidth=t.width,!1!==t.dashes?this._drawDashedLine(e,t,i):this._drawLine(e,t,i)}},{key:"_drawLine",value:function(e,t,o,n,i){if(this.from!=this.to)this._line(e,t,o,n,i);else{var r=this._getCircleData(e),s=Pr(r,3);this._circle(e,t,s[0],s[1],s[2])}}},{key:"_drawDashedLine",value:function(e,t,o,n,i){e.lineCap="round";var r=Gr(t.dashes)?t.dashes:[5,5];if(void 0!==e.setLineDash){if(e.save(),e.setLineDash(r),e.lineDashOffset=0,this.from!=this.to)this._line(e,t,o);else{var s=this._getCircleData(e),a=Pr(s,3);this._circle(e,t,a[0],a[1],a[2])}e.setLineDash([0]),e.lineDashOffset=0,e.restore()}else{if(this.from!=this.to)Ce(e,this.from.x,this.from.y,this.to.x,this.to.y,r);else{var l=this._getCircleData(e),u=Pr(l,3);this._circle(e,t,u[0],u[1],u[2])}this.enableShadow(e,t),e.stroke(),this.disableShadow(e,t)}}},{key:"findBorderPosition",value:function(e,t,o){return this.from!=this.to?this._findBorderPosition(e,t,o):this._findBorderPositionCircle(e,t,o)}},{key:"findBorderPositions",value:function(e){if(this.from!=this.to)return{from:this._findBorderPosition(this.from,e),to:this._findBorderPosition(this.to,e)};var t,o=Zr(t=this._getCircleData(e)).call(t,0,2),n=Pr(o,2),i=n[0],r=n[1];return{from:this._findBorderPositionCircle(this.from,e,{x:i,y:r,low:.25,high:.6,direction:-1}),to:this._findBorderPositionCircle(this.from,e,{x:i,y:r,low:.6,high:.8,direction:1})}}},{key:"_getCircleData",value:function(e){var t=this.options.selfReference.size;void 0!==e&&void 0===this.from.shape.width&&this.from.shape.resize(e);var o=Yd(e,this.options.selfReference.angle,t,this.from);return[o.x,o.y,t]}},{key:"_pointOnCircle",value:function(e,t,o,n){var i=2*n*Math.PI;return{x:e+o*Math.cos(i),y:t-o*Math.sin(i)}}},{key:"_findBorderPositionCircle",value:function(e,t,o){var n,i=o.x,r=o.y,s=o.low,a=o.high,l=o.direction,u=this.options.selfReference.size,c=.5*(s+a),d=0;!0===this.options.arrowStrikethrough&&(-1===l?d=this.options.endPointOffset.from:1===l&&(d=this.options.endPointOffset.to));var h=0;do{n=this._pointOnCircle(i,r,u,c=.5*(s+a));var p=Math.atan2(e.y-n.y,e.x-n.x),f=e.distanceToBorder(t,p)+d-Math.sqrt(Math.pow(n.x-e.x,2)+Math.pow(n.y-e.y,2));if(Math.abs(f)<.05)break;f>0?l>0?s=c:a=c:l>0?a=c:s=c,++h}while(s<=a&&h<10);return Gh(Gh({},n),{},{t:c})}},{key:"getLineWidth",value:function(e,t){return!0===e?Math.max(this.selectionWidth,.3/this._body.view.scale):!0===t?Math.max(this.hoverWidth,.3/this._body.view.scale):Math.max(this.options.width,.3/this._body.view.scale)}},{key:"getColor",value:function(e,t){if(!1!==t.inheritsColor){if("both"===t.inheritsColor&&this.from.id!==this.to.id){var o=e.createLinearGradient(this.from.x,this.from.y,this.to.x,this.to.y),n=this.from.options.color.highlight.border,i=this.to.options.color.highlight.border;return!1===this.from.selected&&!1===this.to.selected?(n=Il(this.from.options.color.border,t.opacity),i=Il(this.to.options.color.border,t.opacity)):!0===this.from.selected&&!1===this.to.selected?i=this.to.options.color.border:!1===this.from.selected&&!0===this.to.selected&&(n=this.from.options.color.border),o.addColorStop(0,n),o.addColorStop(1,i),o}return Il("to"===t.inheritsColor?this.to.options.color.border:this.from.options.color.border,t.opacity)}return Il(t.color,t.opacity)}},{key:"_circle",value:function(e,t,o,n,i){this.enableShadow(e,t);var r=0,s=2*Math.PI;if(!this.options.selfReference.renderBehindTheNode){var a=this.options.selfReference.angle,l=this.options.selfReference.angle+Math.PI,u=this._findBorderPositionCircle(this.from,e,{x:o,y:n,low:a,high:l,direction:-1}),c=this._findBorderPositionCircle(this.from,e,{x:o,y:n,low:a,high:l,direction:1});r=Math.atan2(u.y-n,u.x-o),s=Math.atan2(c.y-n,c.x-o)}e.beginPath(),e.arc(o,n,i,r,s,!1),e.stroke(),this.disableShadow(e,t)}},{key:"getDistanceToEdge",value:function(e,t,o,n,i,r){if(this.from!=this.to)return this._getDistanceToEdge(e,t,o,n,i,r);var s=this._getCircleData(void 0),a=Pr(s,3),l=a[2],u=a[0]-i,c=a[1]-r;return Math.abs(Math.sqrt(u*u+c*c)-l)}},{key:"_getDistanceToLine",value:function(e,t,o,n,i,r){var s=o-e,a=n-t,l=((i-e)*s+(r-t)*a)/(s*s+a*a);l>1?l=1:l<0&&(l=0);var u=e+l*s-i,c=t+l*a-r;return Math.sqrt(u*u+c*c)}},{key:"getArrowData",value:function(e,t,o,n,i,r){var s,a,l,u,c,d,h,p=r.width;"from"===t?(l=this.from,u=this.to,c=r.fromArrowScale<0,d=Math.abs(r.fromArrowScale),h=r.fromArrowType):"to"===t?(l=this.to,u=this.from,c=r.toArrowScale<0,d=Math.abs(r.toArrowScale),h=r.toArrowType):(l=this.to,u=this.from,c=r.middleArrowScale<0,d=Math.abs(r.middleArrowScale),h=r.middleArrowType);var f=15*d+3*p;if(l!=u){var v=f/Nh(l.x-u.x,l.y-u.y);if("middle"!==t)if(!0===this.options.smooth.enabled){var g=this._findBorderPosition(l,e,{via:o}),b=this.getPoint(g.t+v*("from"===t?1:-1),o);s=Math.atan2(g.y-b.y,g.x-b.x),a=g}else s=Math.atan2(l.y-u.y,l.x-u.x),a=this._findBorderPosition(l,e);else{var m=(c?-v:v)/2,y=this.getPoint(.5+m,o),j=this.getPoint(.5-m,o);s=Math.atan2(y.y-j.y,y.x-j.x),a=this.getPoint(.5,o)}}else{var w=this._getCircleData(e),x=Pr(w,3),C=x[0],E=x[1],k=x[2];if("from"===t){var _=this.options.selfReference.angle+Math.PI,A=this._findBorderPositionCircle(this.from,e,{x:C,y:E,low:this.options.selfReference.angle,high:_,direction:-1});s=-2*A.t*Math.PI+1.5*Math.PI+.1*Math.PI,a=A}else if("to"===t){var O=this.options.selfReference.angle+Math.PI,M=this._findBorderPositionCircle(this.from,e,{x:C,y:E,low:this.options.selfReference.angle,high:O,direction:1});s=-2*M.t*Math.PI+1.5*Math.PI-1.1*Math.PI,a=M}else{var I=this.options.selfReference.angle/(2*Math.PI);a=this._pointOnCircle(C,E,k,I),s=-2*I*Math.PI+1.5*Math.PI+.1*Math.PI}}return{point:a,core:{x:a.x-.9*f*Math.cos(s),y:a.y-.9*f*Math.sin(s)},angle:s,length:f,type:h}}},{key:"drawArrowHead",value:function(e,t,o,n,i){e.strokeStyle=this.getColor(e,t),e.fillStyle=e.strokeStyle,e.lineWidth=t.width,qh.draw(e,i)&&(this.enableShadow(e,t),yn(e).call(e),this.disableShadow(e,t))}},{key:"enableShadow",value:function(e,t){!0===t.shadow&&(e.shadowColor=t.shadowColor,e.shadowBlur=t.shadowSize,e.shadowOffsetX=t.shadowX,e.shadowOffsetY=t.shadowY)}},{key:"disableShadow",value:function(e,t){!0===t.shadow&&(e.shadowColor="rgba(0,0,0,0)",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0)}},{key:"drawBackground",value:function(e,t){if(!1!==t.background){var o={strokeStyle:e.strokeStyle,lineWidth:e.lineWidth,dashes:e.dashes};e.strokeStyle=t.backgroundColor,e.lineWidth=t.backgroundSize,this.setStrokeDashed(e,t.backgroundDashes),e.stroke(),e.strokeStyle=o.strokeStyle,e.lineWidth=o.lineWidth,e.dashes=o.dashes,this.setStrokeDashed(e,t.dashes)}}},{key:"setStrokeDashed",value:function(e,t){if(!1!==t)if(void 0!==e.setLineDash){var o=Gr(t)?t:[5,5];e.setLineDash(o)}else console.warn("setLineDash is not supported in this browser. The dashed stroke cannot be used.");else void 0!==e.setLineDash?e.setLineDash([]):console.warn("setLineDash is not supported in this browser. The dashed stroke cannot be used.")}}]),e}();function Jh(e,t){var o=Hr(e);if(Co){var n=Co(e);t&&(n=Si(n).call(n,function(t){return He(e,t).enumerable})),o.push.apply(o,n)}return o}function $h(e){for(var t=1;t<arguments.length;t++){var o,n=null!=arguments[t]?arguments[t]:{};if(t%2)pr(o=Jh(Object(n),!0)).call(o,function(t){zn(e,t,n[t])});else if(Fe)Me(e,Fe(n));else{var i;pr(i=Jh(Object(n))).call(i,function(t){Ae(e,t,He(n,t))})}}return e}var Qh=function(e){Rc(o,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!xc)return!1;if(xc.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(xc(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var o,n=zc(e);if(t){var i=zc(this).constructor;o=xc(n,arguments,i)}else o=n.apply(this,arguments);return Pc(this,o)}}(o);function o(e,n,i){return Sn(this,o),t.call(this,e,n,i)}return Ln(o,[{key:"_findBorderPositionBezier",value:function(e,t){var o,n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this._getViaCoordinates(),r=10,s=.2,a=!1,l=1,u=0,c=this.to,d=this.options.endPointOffset?this.options.endPointOffset.to:0;e.id===this.from.id&&(c=this.from,a=!0,d=this.options.endPointOffset?this.options.endPointOffset.from:0),!1===this.options.arrowStrikethrough&&(d=0);var h=0;do{o=this.getPoint(n=.5*(u+l),i);var p=Math.atan2(c.y-o.y,c.x-o.x),f=c.distanceToBorder(t,p)+d,v=Math.sqrt(Math.pow(o.x-c.x,2)+Math.pow(o.y-c.y,2)),g=f-v;if(Math.abs(g)<s)break;g<0?!1===a?u=n:l=n:!1===a?l=n:u=n,++h}while(u<=l&&h<r);return $h($h({},o),{},{t:n})}},{key:"_getDistanceToBezierEdge",value:function(e,t,o,n,i,r,s){var a,l,u,c,d,h=1e9,p=e,f=t;for(l=1;l<10;l++)u=.1*l,c=Math.pow(1-u,2)*e+2*u*(1-u)*s.x+Math.pow(u,2)*o,d=Math.pow(1-u,2)*t+2*u*(1-u)*s.y+Math.pow(u,2)*n,l>0&&(h=(a=this._getDistanceToLine(p,f,c,d,i,r))<h?a:h),p=c,f=d;return h}},{key:"_bezierCurve",value:function(e,t,o,n){e.beginPath(),e.moveTo(this.fromPoint.x,this.fromPoint.y),null!=o&&null!=o.x?null!=n&&null!=n.x?e.bezierCurveTo(o.x,o.y,n.x,n.y,this.toPoint.x,this.toPoint.y):e.quadraticCurveTo(o.x,o.y,this.toPoint.x,this.toPoint.y):e.lineTo(this.toPoint.x,this.toPoint.y),this.drawBackground(e,t),this.enableShadow(e,t),e.stroke(),this.disableShadow(e,t)}},{key:"getViaNode",value:function(){return this._getViaCoordinates()}}]),o}(Kh),Zh=function(e){Rc(o,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!xc)return!1;if(xc.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(xc(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var o,n=zc(e);if(t){var i=zc(this).constructor;o=xc(n,arguments,i)}else o=n.apply(this,arguments);return Pc(this,o)}}(o);function o(e,n,i){var r;return Sn(this,o),(r=t.call(this,e,n,i)).via=r.via,r._boundFunction=function(){r.positionBezierNode()},r._body.emitter.on("_repositionBezierNodes",r._boundFunction),r}return Ln(o,[{key:"setOptions",value:function(e){_h(zc(o.prototype),"setOptions",this).call(this,e);var t=!1;this.options.physics!==e.physics&&(t=!0),this.options=e,this.id=this.options.id,this.from=this._body.nodes[this.options.from],this.to=this._body.nodes[this.options.to],this.setupSupportNode(),this.connect(),!0===t&&(this.via.setOptions({physics:this.options.physics}),this.positionBezierNode())}},{key:"connect",value:function(){this.from=this._body.nodes[this.options.from],this.to=this._body.nodes[this.options.to],this.via.setOptions(void 0===this.from||void 0===this.to||!1===this.options.physics||this.from.id===this.to.id?{physics:!1}:{physics:!0})}},{key:"cleanup",value:function(){return this._body.emitter.off("_repositionBezierNodes",this._boundFunction),void 0!==this.via&&(delete this._body.nodes[this.via.id],this.via=void 0,!0)}},{key:"setupSupportNode",value:function(){if(void 0===this.via){var e="edgeId:"+this.id,t=this._body.functions.createNode({id:e,shape:"circle",physics:!0,hidden:!0});this._body.nodes[e]=t,this.via=t,this.via.parentEdgeId=this.id,this.positionBezierNode()}}},{key:"positionBezierNode",value:function(){void 0!==this.via&&void 0!==this.from&&void 0!==this.to?(this.via.x=.5*(this.from.x+this.to.x),this.via.y=.5*(this.from.y+this.to.y)):void 0!==this.via&&(this.via.x=0,this.via.y=0)}},{key:"_line",value:function(e,t,o){this._bezierCurve(e,t,o)}},{key:"_getViaCoordinates",value:function(){return this.via}},{key:"getViaNode",value:function(){return this.via}},{key:"getPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.via;if(this.from===this.to){var o=this._getCircleData(),n=Pr(o,3),i=n[0],r=n[1],s=n[2],a=2*Math.PI*(1-e);return{x:i+s*Math.sin(a),y:r+s-s*(1-Math.cos(a))}}return{x:Math.pow(1-e,2)*this.fromPoint.x+2*e*(1-e)*t.x+Math.pow(e,2)*this.toPoint.x,y:Math.pow(1-e,2)*this.fromPoint.y+2*e*(1-e)*t.y+Math.pow(e,2)*this.toPoint.y}}},{key:"_findBorderPosition",value:function(e,t){return this._findBorderPositionBezier(e,t,this.via)}},{key:"_getDistanceToEdge",value:function(e,t,o,n,i,r){return this._getDistanceToBezierEdge(e,t,o,n,i,r,this.via)}}]),o}(Qh),ep=function(e){Rc(o,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!xc)return!1;if(xc.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(xc(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var o,n=zc(e);if(t){var i=zc(this).constructor;o=xc(n,arguments,i)}else o=n.apply(this,arguments);return Pc(this,o)}}(o);function o(e,n,i){return Sn(this,o),t.call(this,e,n,i)}return Ln(o,[{key:"_line",value:function(e,t,o){this._bezierCurve(e,t,o)}},{key:"getViaNode",value:function(){return this._getViaCoordinates()}},{key:"_getViaCoordinates",value:function(){var e,t,o=this.options.smooth.roundness,n=this.options.smooth.type,i=Math.abs(this.from.x-this.to.x),r=Math.abs(this.from.y-this.to.y);if("discrete"===n||"diagonalCross"===n){var s,a;s=a=i<=r?o*r:o*i,this.from.x>this.to.x&&(s=-s),this.from.y>=this.to.y&&(a=-a);var l=this.from.x+s,u=this.from.y+a;return"discrete"===n&&(i<=r?l=i<o*r?this.from.x:l:u=r<o*i?this.from.y:u),{x:l,y:u}}if("straightCross"===n){var c=(1-o)*i,d=(1-o)*r;return i<=r?(c=0,this.from.y<this.to.y&&(d=-d)):(this.from.x<this.to.x&&(c=-c),d=0),{x:this.to.x+c,y:this.to.y+d}}if("horizontal"===n){var h=(1-o)*i;return this.from.x<this.to.x&&(h=-h),{x:this.to.x+h,y:this.from.y}}if("vertical"===n){var p=(1-o)*r;return this.from.y<this.to.y&&(p=-p),{x:this.from.x,y:this.to.y+p}}if("curvedCW"===n){i=this.to.x-this.from.x,r=this.from.y-this.to.y;var f=Math.sqrt(i*i+r*r),v=Math.PI,g=(Math.atan2(r,i)+(.5*o+.5)*v)%(2*v);return{x:this.from.x+(.5*o+.5)*f*Math.sin(g),y:this.from.y+(.5*o+.5)*f*Math.cos(g)}}if("curvedCCW"===n){i=this.to.x-this.from.x,r=this.from.y-this.to.y;var b=Math.sqrt(i*i+r*r),m=Math.PI,y=(Math.atan2(r,i)+(.5*-o+.5)*m)%(2*m);return{x:this.from.x+(.5*o+.5)*b*Math.sin(y),y:this.from.y+(.5*o+.5)*b*Math.cos(y)}}e=t=i<=r?o*r:o*i,this.from.x>this.to.x&&(e=-e),this.from.y>=this.to.y&&(t=-t);var j=this.from.x+e,w=this.from.y+t;return i<=r?j=this.from.x<=this.to.x?this.to.x<j?this.to.x:j:this.to.x>j?this.to.x:j:w=this.from.y>=this.to.y?this.to.y>w?this.to.y:w:this.to.y<w?this.to.y:w,{x:j,y:w}}},{key:"_findBorderPosition",value:function(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this._findBorderPositionBezier(e,t,o.via)}},{key:"_getDistanceToEdge",value:function(e,t,o,n,i,r){var s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:this._getViaCoordinates();return this._getDistanceToBezierEdge(e,t,o,n,i,r,s)}},{key:"getPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._getViaCoordinates(),o=e,n=Math.pow(1-o,2)*this.fromPoint.x+2*o*(1-o)*t.x+Math.pow(o,2)*this.toPoint.x,i=Math.pow(1-o,2)*this.fromPoint.y+2*o*(1-o)*t.y+Math.pow(o,2)*this.toPoint.y;return{x:n,y:i}}}]),o}(Qh),tp=function(e){Rc(o,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!xc)return!1;if(xc.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(xc(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var o,n=zc(e);if(t){var i=zc(this).constructor;o=xc(n,arguments,i)}else o=n.apply(this,arguments);return Pc(this,o)}}(o);function o(e,n,i){return Sn(this,o),t.call(this,e,n,i)}return Ln(o,[{key:"_line",value:function(e,t,o){this._bezierCurve(e,t,o[0],o[1])}},{key:"_getViaCoordinates",value:function(){var e,t,o,n,i=this.from.x-this.to.x,r=this.from.y-this.to.y,s=this.options.smooth.roundness;return(Math.abs(i)>Math.abs(r)||!0===this.options.smooth.forceDirection||"horizontal"===this.options.smooth.forceDirection)&&"vertical"!==this.options.smooth.forceDirection?(t=this.from.y,n=this.to.y,e=this.from.x-s*i,o=this.to.x+s*i):(t=this.from.y-s*r,n=this.to.y+s*r,e=this.from.x,o=this.to.x),[{x:e,y:t},{x:o,y:n}]}},{key:"getViaNode",value:function(){return this._getViaCoordinates()}},{key:"_findBorderPosition",value:function(e,t){return this._findBorderPositionBezier(e,t)}},{key:"_getDistanceToEdge",value:function(e,t,o,n,i,r){var s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:this._getViaCoordinates(),a=Pr(s,2),l=a[0],u=a[1];return this._getDistanceToBezierEdge2(e,t,o,n,i,r,l,u)}},{key:"getPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._getViaCoordinates(),o=Pr(t,2),n=o[0],i=o[1],r=e,s=[Math.pow(1-r,3),3*r*Math.pow(1-r,2),3*Math.pow(r,2)*(1-r),Math.pow(r,3)],a=s[0]*this.fromPoint.x+s[1]*n.x+s[2]*i.x+s[3]*this.toPoint.x,l=s[0]*this.fromPoint.y+s[1]*n.y+s[2]*i.y+s[3]*this.toPoint.y;return{x:a,y:l}}}]),o}(function(e){Rc(o,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!xc)return!1;if(xc.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(xc(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var o,n=zc(e);if(t){var i=zc(this).constructor;o=xc(n,arguments,i)}else o=n.apply(this,arguments);return Pc(this,o)}}(o);function o(e,n,i){return Sn(this,o),t.call(this,e,n,i)}return Ln(o,[{key:"_getDistanceToBezierEdge2",value:function(e,t,o,n,i,r,s,a){for(var l=1e9,u=e,c=t,d=[0,0,0,0],h=1;h<10;h++){var p=.1*h;d[0]=Math.pow(1-p,3),d[1]=3*p*Math.pow(1-p,2),d[2]=3*Math.pow(p,2)*(1-p),d[3]=Math.pow(p,3);var f=d[0]*e+d[1]*s.x+d[2]*a.x+d[3]*o,v=d[0]*t+d[1]*s.y+d[2]*a.y+d[3]*n;if(h>0){var g=this._getDistanceToLine(u,c,f,v,i,r);l=g<l?g:l}u=f,c=v}return l}}]),o}(Qh)),op=function(e){Rc(o,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!xc)return!1;if(xc.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(xc(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var o,n=zc(e);if(t){var i=zc(this).constructor;o=xc(n,arguments,i)}else o=n.apply(this,arguments);return Pc(this,o)}}(o);function o(e,n,i){return Sn(this,o),t.call(this,e,n,i)}return Ln(o,[{key:"_line",value:function(e,t){e.beginPath(),e.moveTo(this.fromPoint.x,this.fromPoint.y),e.lineTo(this.toPoint.x,this.toPoint.y),this.enableShadow(e,t),e.stroke(),this.disableShadow(e,t)}},{key:"getViaNode",value:function(){}},{key:"getPoint",value:function(e){return{x:(1-e)*this.fromPoint.x+e*this.toPoint.x,y:(1-e)*this.fromPoint.y+e*this.toPoint.y}}},{key:"_findBorderPosition",value:function(e,t){var o=this.to,n=this.from;e.id===this.from.id&&(o=this.from,n=this.to);var i=Math.atan2(o.y-n.y,o.x-n.x),r=o.x-n.x,s=o.y-n.y,a=Math.sqrt(r*r+s*s),l=(a-e.distanceToBorder(t,i))/a;return{x:(1-l)*n.x+l*o.x,y:(1-l)*n.y+l*o.y,t:0}}},{key:"_getDistanceToEdge",value:function(e,t,o,n,i,r){return this._getDistanceToLine(e,t,o,n,i,r)}}]),o}(Kh),np=function(){function e(t,o,n,i,r){if(Sn(this,e),void 0===o)throw new Error("No body provided");this.options=Wl(i),this.globalOptions=i,this.defaultOptions=r,this.body=o,this.imagelist=n,this.id=void 0,this.fromId=void 0,this.toId=void 0,this.selected=!1,this.hover=!1,this.labelDirty=!0,this.baseWidth=this.options.width,this.baseFontSize=this.options.font.size,this.from=void 0,this.to=void 0,this.edgeType=void 0,this.connected=!1,this.labelModule=new $d(this.body,this.options,!0),this.setOptions(t)}return Ln(e,[{key:"setOptions",value:function(t){if(t){var o=void 0!==t.physics&&this.options.physics!==t.physics||void 0!==t.hidden&&(this.options.hidden||!1)!==(t.hidden||!1)||void 0!==t.from&&this.options.from!==t.from||void 0!==t.to&&this.options.to!==t.to;return e.parseOptions(this.options,t,!0,this.globalOptions),void 0!==t.id&&(this.id=t.id),void 0!==t.from&&(this.fromId=t.from),void 0!==t.to&&(this.toId=t.to),void 0!==t.title&&(this.title=t.title),void 0!==t.value&&(t.value=Hd(t.value)),this.chooser=Wd("edge",[t,this.options,this.defaultOptions]),this.updateLabelModule(t),o=this.updateEdgeType()||o,this._setInteractionWidths(),this.connect(),o}}},{key:"getFormattingValues",value:function(){var e=this.options.color.inherit,t={toArrow:!0===this.options.arrows.to||!0===this.options.arrows.to.enabled,toArrowScale:this.options.arrows.to.scaleFactor,toArrowType:this.options.arrows.to.type,toArrowSrc:this.options.arrows.to.src,toArrowImageWidth:this.options.arrows.to.imageWidth,toArrowImageHeight:this.options.arrows.to.imageHeight,middleArrow:!0===this.options.arrows.middle||!0===this.options.arrows.middle.enabled,middleArrowScale:this.options.arrows.middle.scaleFactor,middleArrowType:this.options.arrows.middle.type,middleArrowSrc:this.options.arrows.middle.src,middleArrowImageWidth:this.options.arrows.middle.imageWidth,middleArrowImageHeight:this.options.arrows.middle.imageHeight,fromArrow:!0===this.options.arrows.from||!0===this.options.arrows.from.enabled,fromArrowScale:this.options.arrows.from.scaleFactor,fromArrowType:this.options.arrows.from.type,fromArrowSrc:this.options.arrows.from.src,fromArrowImageWidth:this.options.arrows.from.imageWidth,fromArrowImageHeight:this.options.arrows.from.imageHeight,arrowStrikethrough:this.options.arrowStrikethrough,color:e?void 0:this.options.color.color,inheritsColor:e,opacity:this.options.color.opacity,hidden:this.options.hidden,length:this.options.length,shadow:this.options.shadow.enabled,shadowColor:this.options.shadow.color,shadowSize:this.options.shadow.size,shadowX:this.options.shadow.x,shadowY:this.options.shadow.y,dashes:this.options.dashes,width:this.options.width,background:this.options.background.enabled,backgroundColor:this.options.background.color,backgroundSize:this.options.background.size,backgroundDashes:this.options.background.dashes};if(this.selected||this.hover)if(!0===this.chooser){if(this.selected){var o=this.options.selectionWidth;"function"==typeof o?t.width=o(t.width):"number"==typeof o&&(t.width+=o),t.width=Math.max(t.width,.3/this.body.view.scale),t.color=this.options.color.highlight,t.shadow=this.options.shadow.enabled}else if(this.hover){var n=this.options.hoverWidth;"function"==typeof n?t.width=n(t.width):"number"==typeof n&&(t.width+=n),t.width=Math.max(t.width,.3/this.body.view.scale),t.color=this.options.color.hover,t.shadow=this.options.shadow.enabled}}else"function"==typeof this.chooser&&(this.chooser(t,this.options.id,this.selected,this.hover),void 0!==t.color&&(t.inheritsColor=!1),!1===t.shadow&&(t.shadowColor===this.options.shadow.color&&t.shadowSize===this.options.shadow.size&&t.shadowX===this.options.shadow.x&&t.shadowY===this.options.shadow.y||(t.shadow=!0)));else t.shadow=this.options.shadow.enabled,t.width=Math.max(t.width,.3/this.body.view.scale);return t}},{key:"updateLabelModule",value:function(e){this.labelModule.update(this.options,[e,this.options,this.globalOptions,this.defaultOptions]),void 0!==this.labelModule.baseSize&&(this.baseFontSize=this.labelModule.baseSize)}},{key:"updateEdgeType",value:function(){var e=this.options.smooth,t=!1,o=!0;return void 0!==this.edgeType&&((this.edgeType instanceof Zh&&!0===e.enabled&&"dynamic"===e.type||this.edgeType instanceof tp&&!0===e.enabled&&"cubicBezier"===e.type||this.edgeType instanceof ep&&!0===e.enabled&&"dynamic"!==e.type&&"cubicBezier"!==e.type||this.edgeType instanceof op&&!1===e.type.enabled)&&(o=!1),!0===o&&(t=this.cleanup())),!0===o?!0===e.enabled?"dynamic"===e.type?(t=!0,this.edgeType=new Zh(this.options,this.body,this.labelModule)):this.edgeType="cubicBezier"===e.type?new tp(this.options,this.body,this.labelModule):new ep(this.options,this.body,this.labelModule):this.edgeType=new op(this.options,this.body,this.labelModule):this.edgeType.setOptions(this.options),t}},{key:"connect",value:function(){this.disconnect(),this.from=this.body.nodes[this.fromId]||void 0,this.to=this.body.nodes[this.toId]||void 0,this.connected=void 0!==this.from&&void 0!==this.to,!0===this.connected?(this.from.attachEdge(this),this.to.attachEdge(this)):(this.from&&this.from.detachEdge(this),this.to&&this.to.detachEdge(this)),this.edgeType.connect()}},{key:"disconnect",value:function(){this.from&&(this.from.detachEdge(this),this.from=void 0),this.to&&(this.to.detachEdge(this),this.to=void 0),this.connected=!1}},{key:"getTitle",value:function(){return this.title}},{key:"isSelected",value:function(){return this.selected}},{key:"getValue",value:function(){return this.options.value}},{key:"setValueRange",value:function(e,t,o){if(void 0!==this.options.value){var n=this.options.scaling.customScalingFunction(e,t,o,this.options.value),i=this.options.scaling.max-this.options.scaling.min;!0===this.options.scaling.label.enabled&&(this.options.font.size=this.options.scaling.label.min+n*(this.options.scaling.label.max-this.options.scaling.label.min)),this.options.width=this.options.scaling.min+n*i}else this.options.width=this.baseWidth,this.options.font.size=this.baseFontSize;this._setInteractionWidths(),this.updateLabelModule()}},{key:"_setInteractionWidths",value:function(){this.edgeType.hoverWidth="function"==typeof this.options.hoverWidth?this.options.hoverWidth(this.options.width):this.options.hoverWidth+this.options.width,this.edgeType.selectionWidth="function"==typeof this.options.selectionWidth?this.options.selectionWidth(this.options.width):this.options.selectionWidth+this.options.width}},{key:"draw",value:function(e){var t=this.getFormattingValues();if(!t.hidden){var o=this.edgeType.getViaNode();this.edgeType.drawLine(e,t,this.selected,this.hover,o),this.drawLabel(e,o)}}},{key:"drawArrows",value:function(e){var t=this.getFormattingValues();if(!t.hidden){var o=this.edgeType.getViaNode(),n={};this.edgeType.fromPoint=this.edgeType.from,this.edgeType.toPoint=this.edgeType.to,t.fromArrow&&(n.from=this.edgeType.getArrowData(e,"from",o,this.selected,this.hover,t),!1===t.arrowStrikethrough&&(this.edgeType.fromPoint=n.from.core),t.fromArrowSrc&&(n.from.image=this.imagelist.load(t.fromArrowSrc)),t.fromArrowImageWidth&&(n.from.imageWidth=t.fromArrowImageWidth),t.fromArrowImageHeight&&(n.from.imageHeight=t.fromArrowImageHeight)),t.toArrow&&(n.to=this.edgeType.getArrowData(e,"to",o,this.selected,this.hover,t),!1===t.arrowStrikethrough&&(this.edgeType.toPoint=n.to.core),t.toArrowSrc&&(n.to.image=this.imagelist.load(t.toArrowSrc)),t.toArrowImageWidth&&(n.to.imageWidth=t.toArrowImageWidth),t.toArrowImageHeight&&(n.to.imageHeight=t.toArrowImageHeight)),t.middleArrow&&(n.middle=this.edgeType.getArrowData(e,"middle",o,this.selected,this.hover,t),t.middleArrowSrc&&(n.middle.image=this.imagelist.load(t.middleArrowSrc)),t.middleArrowImageWidth&&(n.middle.imageWidth=t.middleArrowImageWidth),t.middleArrowImageHeight&&(n.middle.imageHeight=t.middleArrowImageHeight)),t.fromArrow&&this.edgeType.drawArrowHead(e,t,this.selected,this.hover,n.from),t.middleArrow&&this.edgeType.drawArrowHead(e,t,this.selected,this.hover,n.middle),t.toArrow&&this.edgeType.drawArrowHead(e,t,this.selected,this.hover,n.to)}}},{key:"drawLabel",value:function(e,t){if(void 0!==this.options.label){var o,n=this.from,i=this.to;if(this.labelModule.differentState(this.selected,this.hover)&&this.labelModule.getTextSize(e,this.selected,this.hover),n.id!=i.id){this.labelModule.pointToSelf=!1,o=this.edgeType.getPoint(.5,t),e.save();var r=this._getRotation(e);0!=r.angle&&(e.translate(r.x,r.y),e.rotate(r.angle)),this.labelModule.draw(e,o.x,o.y,this.selected,this.hover),e.restore()}else{this.labelModule.pointToSelf=!0;var s=Yd(e,this.options.selfReference.angle,this.options.selfReference.size,n);o=this._pointOnCircle(s.x,s.y,this.options.selfReference.size,this.options.selfReference.angle),this.labelModule.draw(e,o.x,o.y,this.selected,this.hover)}}}},{key:"getItemsOnPoint",value:function(e){var t=[];if(this.labelModule.visible()){var o=this._getRotation();Vd(this.labelModule.getSize(),e,o)&&t.push({edgeId:this.id,labelId:0})}return this.isOverlappingWith({left:e.x,top:e.y})&&t.push({edgeId:this.id}),t}},{key:"isOverlappingWith",value:function(e){return!!this.connected&&this.edgeType.getDistanceToEdge(this.from.x,this.from.y,this.to.x,this.to.y,e.left,e.top)<10}},{key:"_getRotation",value:function(e){var t=this.edgeType.getViaNode(),o=this.edgeType.getPoint(.5,t);void 0!==e&&this.labelModule.calculateLabelSize(e,this.selected,this.hover,o.x,o.y);var n={x:o.x,y:this.labelModule.size.yLine,angle:0};if(!this.labelModule.visible())return n;if("horizontal"===this.options.font.align)return n;var i=this.from.x-this.to.x,r=Math.atan2(this.from.y-this.to.y,i);return(r<-1&&i<0||r>0&&i<0)&&(r+=Math.PI),n.angle=r,n}},{key:"_pointOnCircle",value:function(e,t,o,n){return{x:e+o*Math.cos(n),y:t-o*Math.sin(n)}}},{key:"select",value:function(){this.selected=!0}},{key:"unselect",value:function(){this.selected=!1}},{key:"cleanup",value:function(){return this.edgeType.cleanup()}},{key:"remove",value:function(){this.cleanup(),this.disconnect(),delete this.body.edges[this.id]}},{key:"endPointsValid",value:function(){return void 0!==this.body.nodes[this.fromId]&&void 0!==this.body.nodes[this.toId]}}],[{key:"parseOptions",value:function(e,t){var o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],r=["endPointOffset","arrowStrikethrough","id","from","hidden","hoverWidth","labelHighlightBold","length","line","opacity","physics","scaling","selectionWidth","selfReferenceSize","selfReference","to","title","value","width","font","chosen","widthConstraint"];if(bl(r,e,t,o),void 0!==t.endPointOffset&&void 0!==t.endPointOffset.from&&(vc(t.endPointOffset.from)?e.endPointOffset.from=t.endPointOffset.from:(e.endPointOffset.from=void 0!==n.endPointOffset.from?n.endPointOffset.from:0,console.error("endPointOffset.from is not a valid number"))),void 0!==t.endPointOffset&&void 0!==t.endPointOffset.to&&(vc(t.endPointOffset.to)?e.endPointOffset.to=t.endPointOffset.to:(e.endPointOffset.to=void 0!==n.endPointOffset.to?n.endPointOffset.to:0,console.error("endPointOffset.to is not a valid number"))),Ud(t.label)?e.label=t.label:Ud(e.label)||(e.label=void 0),Vl(e,t,"smooth",n),Vl(e,t,"shadow",n),Vl(e,t,"background",n),null!=t.dashes?e.dashes=t.dashes:!0===o&&null===t.dashes&&(e.dashes=Bn(n.dashes)),null!=t.scaling?(void 0!==t.scaling.min&&(e.scaling.min=t.scaling.min),void 0!==t.scaling.max&&(e.scaling.max=t.scaling.max),Vl(e.scaling,t.scaling,"label",n.scaling)):!0===o&&null===t.scaling&&(e.scaling=Bn(n.scaling)),null!=t.arrows)if("string"==typeof t.arrows){var s=t.arrows.toLowerCase();e.arrows.to.enabled=-1!=ui(s).call(s,"to"),e.arrows.middle.enabled=-1!=ui(s).call(s,"middle"),e.arrows.from.enabled=-1!=ui(s).call(s,"from")}else{if("object"!==$r(t.arrows))throw new Error("The arrow newOptions can only be an object or a string. Refer to the documentation. You used:"+Nn(t.arrows));Vl(e.arrows,t.arrows,"to",n.arrows),Vl(e.arrows,t.arrows,"middle",n.arrows),Vl(e.arrows,t.arrows,"from",n.arrows)}else!0===o&&null===t.arrows&&(e.arrows=Bn(n.arrows));if(null!=t.color){var a=hl(t.color)?{color:t.color,highlight:t.color,hover:t.color,inherit:!1,opacity:1}:t.color,l=e.color;if(i)yl(l,n.color,!1,o);else for(var u in l)Object.prototype.hasOwnProperty.call(l,u)&&delete l[u];if(hl(l))l.color=l,l.highlight=l,l.hover=l,l.inherit=!1,void 0===a.opacity&&(l.opacity=1);else{var c=!1;void 0!==a.color&&(l.color=a.color,c=!0),void 0!==a.highlight&&(l.highlight=a.highlight,c=!0),void 0!==a.hover&&(l.hover=a.hover,c=!0),void 0!==a.inherit&&(l.inherit=a.inherit),void 0!==a.opacity&&(l.opacity=Math.min(1,Math.max(0,a.opacity))),!0===c?l.inherit=!1:void 0===l.inherit&&(l.inherit="from")}}else!0===o&&null===t.color&&(e.color=Wl(n.color));!0===o&&null===t.font&&(e.font=Wl(n.font)),Object.prototype.hasOwnProperty.call(t,"selfReferenceSize")&&(console.warn("The selfReferenceSize property has been deprecated. Please use selfReference property instead. The selfReference can be set like thise selfReference:{size:30, angle:Math.PI / 4}"),e.selfReference.size=t.selfReferenceSize)}}]),e}(),ip=function(){function e(t,o,n){var i,r=this;Sn(this,e),this.body=t,this.images=o,this.groups=n,this.body.functions.createEdge=$(i=this.create).call(i,this),this.edgesListeners={add:function(e,t){r.add(t.items)},update:function(e,t){r.update(t.items)},remove:function(e,t){r.remove(t.items)}},this.options={},this.defaultOptions={arrows:{to:{enabled:!1,scaleFactor:1,type:"arrow"},middle:{enabled:!1,scaleFactor:1,type:"arrow"},from:{enabled:!1,scaleFactor:1,type:"arrow"}},endPointOffset:{from:0,to:0},arrowStrikethrough:!0,color:{color:"#848484",highlight:"#848484",hover:"#848484",inherit:"from",opacity:1},dashes:!1,font:{color:"#343434",size:14,face:"arial",background:"none",strokeWidth:2,strokeColor:"#ffffff",align:"horizontal",multi:!1,vadjust:0,bold:{mod:"bold"},boldital:{mod:"bold italic"},ital:{mod:"italic"},mono:{mod:"",size:15,face:"courier new",vadjust:2}},hidden:!1,hoverWidth:1.5,label:void 0,labelHighlightBold:!0,length:void 0,physics:!0,scaling:{min:1,max:15,label:{enabled:!0,min:14,max:30,maxVisible:30,drawThreshold:5},customScalingFunction:function(e,t,o,n){return t===e?.5:Math.max(0,1/(t-e)*(n-e))}},selectionWidth:1.5,selfReference:{size:20,angle:Math.PI/4,renderBehindTheNode:!0},shadow:{enabled:!1,color:"rgba(0,0,0,0.5)",size:10,x:5,y:5},background:{enabled:!1,color:"rgba(111,111,111,1)",size:10,dashes:!1},smooth:{enabled:!0,type:"dynamic",forceDirection:"none",roundness:.5},title:void 0,width:1,value:void 0},yl(this.options,this.defaultOptions),this.bindEventListeners()}return Ln(e,[{key:"bindEventListeners",value:function(){var e,t,o=this;this.body.emitter.on("_forceDisableDynamicCurves",function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];"dynamic"===e&&(e="continuous");var n=!1;for(var i in o.body.edges)if(Object.prototype.hasOwnProperty.call(o.body.edges,i)){var r=o.body.edges[i],s=o.body.data.edges.get(i);if(null!=s){var a=s.smooth;void 0!==a&&!0===a.enabled&&"dynamic"===a.type&&(r.setOptions(void 0===e?{smooth:!1}:{smooth:{type:e}}),n=!0)}}!0===t&&!0===n&&o.body.emitter.emit("_dataChanged")}),this.body.emitter.on("_dataUpdated",function(){o.reconnectEdges()}),this.body.emitter.on("refreshEdges",$(e=this.refresh).call(e,this)),this.body.emitter.on("refresh",$(t=this.refresh).call(t,this)),this.body.emitter.on("destroy",function(){El(o.edgesListeners,function(e,t){o.body.data.edges&&o.body.data.edges.off(t,e)}),delete o.body.functions.createEdge,delete o.edgesListeners.add,delete o.edgesListeners.update,delete o.edgesListeners.remove,delete o.edgesListeners})}},{key:"setOptions",value:function(e){if(void 0!==e){np.parseOptions(this.options,e,!0,this.defaultOptions,!0);var t=!1;if(void 0!==e.smooth)for(var o in this.body.edges)Object.prototype.hasOwnProperty.call(this.body.edges,o)&&(t=this.body.edges[o].updateEdgeType()||t);if(void 0!==e.font)for(var n in this.body.edges)Object.prototype.hasOwnProperty.call(this.body.edges,n)&&this.body.edges[n].updateLabelModule();void 0===e.hidden&&void 0===e.physics&&!0!==t||this.body.emitter.emit("_dataChanged")}}},{key:"setData",value:function(e){var t=this,o=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.body.data.edges;if(Td("id",e))this.body.data.edges=e;else if(Gr(e))this.body.data.edges=new Id,this.body.data.edges.add(e);else{if(e)throw new TypeError("Array or DataSet expected");this.body.data.edges=new Id}if(n&&El(this.edgesListeners,function(e,t){n.off(t,e)}),this.body.edges={},this.body.data.edges){El(this.edgesListeners,function(e,o){t.body.data.edges.on(o,e)});var i=this.body.data.edges.getIds();this.add(i,!0)}this.body.emitter.emit("_adjustEdgesForHierarchicalLayout"),!1===o&&this.body.emitter.emit("_dataChanged")}},{key:"add",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=this.body.edges,n=this.body.data.edges,i=0;i<e.length;i++){var r=e[i],s=o[r];s&&s.disconnect();var a=n.get(r,{showInternalIds:!0});o[r]=this.create(a)}this.body.emitter.emit("_adjustEdgesForHierarchicalLayout"),!1===t&&this.body.emitter.emit("_dataChanged")}},{key:"update",value:function(e){for(var t=this.body.edges,o=this.body.data.edges,n=!1,i=0;i<e.length;i++){var r=e[i],s=o.get(r),a=t[r];void 0!==a?(a.disconnect(),n=a.setOptions(s)||n,a.connect()):(this.body.edges[r]=this.create(s),n=!0)}!0===n?(this.body.emitter.emit("_adjustEdgesForHierarchicalLayout"),this.body.emitter.emit("_dataChanged")):this.body.emitter.emit("_dataUpdated")}},{key:"remove",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(0!==e.length){var o=this.body.edges;El(e,function(e){var t=o[e];void 0!==t&&t.remove()}),t&&this.body.emitter.emit("_dataChanged")}}},{key:"refresh",value:function(){var e=this;El(this.body.edges,function(t,o){var n=e.body.data.edges.get(o);void 0!==n&&t.setOptions(n)})}},{key:"create",value:function(e){return new np(e,this.body,this.images,this.options,this.defaultOptions)}},{key:"reconnectEdges",value:function(){var e,t=this.body.nodes,o=this.body.edges;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&(t[e].edges=[]);for(e in o)if(Object.prototype.hasOwnProperty.call(o,e)){var n=o[e];n.from=null,n.to=null,n.connect()}}},{key:"getConnectedNodes",value:function(e){var t=[];if(void 0!==this.body.edges[e]){var o=this.body.edges[e];void 0!==o.fromId&&t.push(o.fromId),void 0!==o.toId&&t.push(o.toId)}return t}},{key:"_updateState",value:function(){this._addMissingEdges(),this._removeInvalidEdges()}},{key:"_removeInvalidEdges",value:function(){var e=this,t=[];El(this.body.edges,function(o,n){var i=e.body.nodes[o.toId],r=e.body.nodes[o.fromId];void 0!==i&&!0===i.isCluster||void 0!==r&&!0===r.isCluster||void 0!==i&&void 0!==r||t.push(n)}),this.remove(t,!1)}},{key:"_addMissingEdges",value:function(){var e=this.body.data.edges;if(null!=e){var t=this.body.edges,o=[];pr(e).call(e,function(e,n){void 0===t[n]&&o.push(n)}),this.add(o,!0)}}}]),e}(),rp=function(){function e(t,o,n){Sn(this,e),this.body=t,this.physicsBody=o,this.setOptions(n),this._rng=el("BARNES HUT SOLVER")}return Ln(e,[{key:"setOptions",value:function(e){this.options=e,this.thetaInversed=1/this.options.theta,this.overlapAvoidanceFactor=1-Math.max(0,Math.min(1,this.options.avoidOverlap))}},{key:"solve",value:function(){if(0!==this.options.gravitationalConstant&&this.physicsBody.physicsNodeIndices.length>0){var e,t=this.body.nodes,o=this.physicsBody.physicsNodeIndices,n=o.length,i=this._formBarnesHutTree(t,o);this.barnesHutTree=i;for(var r=0;r<n;r++)(e=t[o[r]]).options.mass>0&&this._getForceContributions(i.root,e)}}},{key:"_getForceContributions",value:function(e,t){this._getForceContribution(e.children.NW,t),this._getForceContribution(e.children.NE,t),this._getForceContribution(e.children.SW,t),this._getForceContribution(e.children.SE,t)}},{key:"_getForceContribution",value:function(e,t){if(e.childrenCount>0){var o=e.centerOfMass.x-t.x,n=e.centerOfMass.y-t.y,i=Math.sqrt(o*o+n*n);i*e.calcSize>this.thetaInversed?this._calculateForces(i,o,n,t,e):4===e.childrenCount?this._getForceContributions(e,t):e.children.data.id!=t.id&&this._calculateForces(i,o,n,t,e)}}},{key:"_calculateForces",value:function(e,t,o,n,i){0===e&&(t=e=.1),this.overlapAvoidanceFactor<1&&n.shape.radius&&(e=Math.max(.1+this.overlapAvoidanceFactor*n.shape.radius,e-n.shape.radius));var r=this.options.gravitationalConstant*i.mass*n.options.mass/Math.pow(e,3),s=o*r;this.physicsBody.forces[n.id].x+=t*r,this.physicsBody.forces[n.id].y+=s}},{key:"_formBarnesHutTree",value:function(e,t){for(var o,n=t.length,i=e[t[0]].x,r=e[t[0]].y,s=e[t[0]].x,a=e[t[0]].y,l=1;l<n;l++){var u=e[t[l]],c=u.x,d=u.y;u.options.mass>0&&(c<i&&(i=c),c>s&&(s=c),d<r&&(r=d),d>a&&(a=d))}var h=Math.abs(s-i)-Math.abs(a-r);h>0?(r-=.5*h,a+=.5*h):(i+=.5*h,s-=.5*h);var p=Math.max(1e-5,Math.abs(s-i)),f=.5*p,v=.5*(i+s),g=.5*(r+a),b={root:{centerOfMass:{x:0,y:0},mass:0,range:{minX:v-f,maxX:v+f,minY:g-f,maxY:g+f},size:p,calcSize:1/p,children:{data:null},maxWidth:0,level:0,childrenCount:4}};this._splitBranch(b.root);for(var m=0;m<n;m++)(o=e[t[m]]).options.mass>0&&this._placeInTree(b.root,o);return b}},{key:"_updateBranchMass",value:function(e,t){var o=e.centerOfMass,n=e.mass+t.options.mass,i=1/n;o.x=o.x*e.mass+t.x*t.options.mass,o.x*=i,o.y=o.y*e.mass+t.y*t.options.mass,o.y*=i,e.mass=n;var r=Math.max(Math.max(t.height,t.radius),t.width);e.maxWidth=e.maxWidth<r?r:e.maxWidth}},{key:"_placeInTree",value:function(e,t,o){1==o&&void 0!==o||this._updateBranchMass(e,t);var n=e.children.NW.range;this._placeInRegion(e,t,n.maxX>t.x?n.maxY>t.y?"NW":"SW":n.maxY>t.y?"NE":"SE")}},{key:"_placeInRegion",value:function(e,t,o){var n=e.children[o];switch(n.childrenCount){case 0:n.children.data=t,n.childrenCount=1,this._updateBranchMass(n,t);break;case 1:n.children.data.x===t.x&&n.children.data.y===t.y?(t.x+=this._rng(),t.y+=this._rng()):(this._splitBranch(n),this._placeInTree(n,t));break;case 4:this._placeInTree(n,t)}}},{key:"_splitBranch",value:function(e){var t=null;1===e.childrenCount&&(t=e.children.data,e.mass=0,e.centerOfMass.x=0,e.centerOfMass.y=0),e.childrenCount=4,e.children.data=null,this._insertRegion(e,"NW"),this._insertRegion(e,"NE"),this._insertRegion(e,"SW"),this._insertRegion(e,"SE"),null!=t&&this._placeInTree(e,t)}},{key:"_insertRegion",value:function(e,t){var o,n,i,r,s=.5*e.size;switch(t){case"NW":o=e.range.minX,n=e.range.minX+s,i=e.range.minY,r=e.range.minY+s;break;case"NE":o=e.range.minX+s,n=e.range.maxX,i=e.range.minY,r=e.range.minY+s;break;case"SW":o=e.range.minX,n=e.range.minX+s,i=e.range.minY+s,r=e.range.maxY;break;case"SE":o=e.range.minX+s,n=e.range.maxX,i=e.range.minY+s,r=e.range.maxY}e.children[t]={centerOfMass:{x:0,y:0},mass:0,range:{minX:o,maxX:n,minY:i,maxY:r},size:.5*e.size,calcSize:2*e.calcSize,children:{data:null},maxWidth:0,level:e.level+1,childrenCount:0}}},{key:"_debug",value:function(e,t){void 0!==this.barnesHutTree&&(e.lineWidth=1,this._drawBranch(this.barnesHutTree.root,e,t))}},{key:"_drawBranch",value:function(e,t,o){void 0===o&&(o="#FF0000"),4===e.childrenCount&&(this._drawBranch(e.children.NW,t),this._drawBranch(e.children.NE,t),this._drawBranch(e.children.SE,t),this._drawBranch(e.children.SW,t)),t.strokeStyle=o,t.beginPath(),t.moveTo(e.range.minX,e.range.minY),t.lineTo(e.range.maxX,e.range.minY),t.stroke(),t.beginPath(),t.moveTo(e.range.maxX,e.range.minY),t.lineTo(e.range.maxX,e.range.maxY),t.stroke(),t.beginPath(),t.moveTo(e.range.maxX,e.range.maxY),t.lineTo(e.range.minX,e.range.maxY),t.stroke(),t.beginPath(),t.moveTo(e.range.minX,e.range.maxY),t.lineTo(e.range.minX,e.range.minY),t.stroke()}}]),e}(),sp=function(){function e(t,o,n){Sn(this,e),this._rng=el("REPULSION SOLVER"),this.body=t,this.physicsBody=o,this.setOptions(n)}return Ln(e,[{key:"setOptions",value:function(e){this.options=e}},{key:"solve",value:function(){for(var e,t,o,n,i,r,s,a,l=this.body.nodes,u=this.physicsBody.physicsNodeIndices,c=this.physicsBody.forces,d=this.options.nodeDistance,h=-2/3/d,p=0;p<u.length-1;p++){s=l[u[p]];for(var f=p+1;f<u.length;f++)e=(a=l[u[f]]).x-s.x,t=a.y-s.y,0===(o=Math.sqrt(e*e+t*t))&&(e=o=.1*this._rng()),o<2*d&&(r=o<.5*d?1:h*o+1.3333333333333333,n=e*(r/=o),i=t*r,c[s.id].x-=n,c[s.id].y-=i,c[a.id].x+=n,c[a.id].y+=i)}}}]),e}(),ap=function(){function e(t,o,n){Sn(this,e),this.body=t,this.physicsBody=o,this.setOptions(n)}return Ln(e,[{key:"setOptions",value:function(e){this.options=e,this.overlapAvoidanceFactor=Math.max(0,Math.min(1,this.options.avoidOverlap||0))}},{key:"solve",value:function(){for(var e=this.body.nodes,t=this.physicsBody.physicsNodeIndices,o=this.physicsBody.forces,n=this.options.nodeDistance,i=0;i<t.length-1;i++)for(var r=e[t[i]],s=i+1;s<t.length;s++){var a=e[t[s]];if(r.level===a.level){var l=n+this.overlapAvoidanceFactor*((r.shape.radius||0)/2+(a.shape.radius||0)/2),u=a.x-r.x,c=a.y-r.y,d=Math.sqrt(u*u+c*c),h=void 0;h=d<l?-Math.pow(.05*d,2)+Math.pow(.05*l,2):0,0!==d&&(h/=d);var p=u*h,f=c*h;o[r.id].x-=p,o[r.id].y-=f,o[a.id].x+=p,o[a.id].y+=f}}}}]),e}(),lp=function(){function e(t,o,n){Sn(this,e),this.body=t,this.physicsBody=o,this.setOptions(n)}return Ln(e,[{key:"setOptions",value:function(e){this.options=e}},{key:"solve",value:function(){for(var e,t,o,n,i=this.physicsBody.physicsEdgeIndices,r=this.body.edges,s=0;s<i.length;s++)!0===(t=r[i[s]]).connected&&t.toId!==t.fromId&&void 0!==this.body.nodes[t.toId]&&void 0!==this.body.nodes[t.fromId]&&(void 0!==t.edgeType.via?(n=t.from,this._calculateSpringForce(t.to,o=t.edgeType.via,.5*(e=void 0===t.options.length?this.options.springLength:t.options.length)),this._calculateSpringForce(o,n,.5*e)):this._calculateSpringForce(t.from,t.to,e=void 0===t.options.length?1.5*this.options.springLength:t.options.length))}},{key:"_calculateSpringForce",value:function(e,t,o){var n=e.x-t.x,i=e.y-t.y,r=Math.max(Math.sqrt(n*n+i*i),.01),s=this.options.springConstant*(o-r)/r,a=n*s,l=i*s;void 0!==this.physicsBody.forces[e.id]&&(this.physicsBody.forces[e.id].x+=a,this.physicsBody.forces[e.id].y+=l),void 0!==this.physicsBody.forces[t.id]&&(this.physicsBody.forces[t.id].x-=a,this.physicsBody.forces[t.id].y-=l)}}]),e}(),up=function(){function e(t,o,n){Sn(this,e),this.body=t,this.physicsBody=o,this.setOptions(n)}return Ln(e,[{key:"setOptions",value:function(e){this.options=e}},{key:"solve",value:function(){for(var e,t,o,n,i,r,s,a,l,u,c=this.body.edges,d=.5,h=this.physicsBody.physicsEdgeIndices,p=this.physicsBody.physicsNodeIndices,f=this.physicsBody.forces,v=0;v<p.length;v++){var g=p[v];f[g].springFx=0,f[g].springFy=0}for(var b=0;b<h.length;b++)!0===(t=c[h[b]]).connected&&(e=void 0===t.options.length?this.options.springLength:t.options.length,o=t.from.x-t.to.x,n=t.from.y-t.to.y,a=0===(a=Math.sqrt(o*o+n*n))?.01:a,i=o*(s=this.options.springConstant*(e-a)/a),r=n*s,t.to.level!=t.from.level?(void 0!==f[t.toId]&&(f[t.toId].springFx-=i,f[t.toId].springFy-=r),void 0!==f[t.fromId]&&(f[t.fromId].springFx+=i,f[t.fromId].springFy+=r)):(void 0!==f[t.toId]&&(f[t.toId].x-=d*i,f[t.toId].y-=d*r),void 0!==f[t.fromId]&&(f[t.fromId].x+=d*i,f[t.fromId].y+=d*r)));s=1;for(var m=0;m<p.length;m++){var y=p[m];l=Math.min(s,Math.max(-s,f[y].springFx)),u=Math.min(s,Math.max(-s,f[y].springFy)),f[y].x+=l,f[y].y+=u}for(var j=0,w=0,x=0;x<p.length;x++){var C=p[x];j+=f[C].x,w+=f[C].y}for(var E=j/p.length,k=w/p.length,_=0;_<p.length;_++){var A=p[_];f[A].x-=E,f[A].y-=k}}}]),e}(),cp=function(){function e(t,o,n){Sn(this,e),this.body=t,this.physicsBody=o,this.setOptions(n)}return Ln(e,[{key:"setOptions",value:function(e){this.options=e}},{key:"solve",value:function(){for(var e,t,o,n,i=this.body.nodes,r=this.physicsBody.physicsNodeIndices,s=this.physicsBody.forces,a=0;a<r.length;a++)e=-(n=i[r[a]]).x,t=-n.y,o=Math.sqrt(e*e+t*t),this._calculateForces(o,e,t,s,n)}},{key:"_calculateForces",value:function(e,t,o,n,i){var r=0===e?0:this.options.centralGravity/e;n[i.id].x=t*r,n[i.id].y=o*r}}]),e}(),dp=function(e){Rc(o,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!xc)return!1;if(xc.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(xc(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var o,n=zc(e);if(t){var i=zc(this).constructor;o=xc(n,arguments,i)}else o=n.apply(this,arguments);return Pc(this,o)}}(o);function o(e,n,i){var r;return Sn(this,o),(r=t.call(this,e,n,i))._rng=el("FORCE ATLAS 2 BASED REPULSION SOLVER"),r}return Ln(o,[{key:"_calculateForces",value:function(e,t,o,n,i){0===e&&(t=e=.1*this._rng()),this.overlapAvoidanceFactor<1&&n.shape.radius&&(e=Math.max(.1+this.overlapAvoidanceFactor*n.shape.radius,e-n.shape.radius));var r=this.options.gravitationalConstant*i.mass*n.options.mass*(n.edges.length+1)/Math.pow(e,2),s=o*r;this.physicsBody.forces[n.id].x+=t*r,this.physicsBody.forces[n.id].y+=s}}]),o}(rp),hp=function(e){Rc(o,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!xc)return!1;if(xc.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(xc(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var o,n=zc(e);if(t){var i=zc(this).constructor;o=xc(n,arguments,i)}else o=n.apply(this,arguments);return Pc(this,o)}}(o);function o(e,n,i){return Sn(this,o),t.call(this,e,n,i)}return Ln(o,[{key:"_calculateForces",value:function(e,t,o,n,i){if(e>0){var r=this.options.centralGravity*(i.edges.length+1)*i.options.mass;n[i.id].x=t*r,n[i.id].y=o*r}}}]),o}(cp),pp=function(){function e(t){Sn(this,e),this.body=t,this.physicsBody={physicsNodeIndices:[],physicsEdgeIndices:[],forces:{},velocities:{}},this.physicsEnabled=!0,this.simulationInterval=1e3/60,this.requiresTimeout=!0,this.previousStates={},this.referenceState={},this.freezeCache={},this.renderTimer=void 0,this.adaptiveTimestep=!1,this.adaptiveTimestepEnabled=!1,this.adaptiveCounter=0,this.adaptiveInterval=3,this.stabilized=!1,this.startedStabilization=!1,this.stabilizationIterations=0,this.ready=!1,this.options={},this.defaultOptions={enabled:!0,barnesHut:{theta:.5,gravitationalConstant:-2e3,centralGravity:.3,springLength:95,springConstant:.04,damping:.09,avoidOverlap:0},forceAtlas2Based:{theta:.5,gravitationalConstant:-50,centralGravity:.01,springConstant:.08,springLength:100,damping:.4,avoidOverlap:0},repulsion:{centralGravity:.2,springLength:200,springConstant:.05,nodeDistance:100,damping:.09,avoidOverlap:0},hierarchicalRepulsion:{centralGravity:0,springLength:100,springConstant:.01,nodeDistance:120,damping:.09},maxVelocity:50,minVelocity:.75,solver:"barnesHut",stabilization:{enabled:!0,iterations:1e3,updateInterval:50,onlyDynamicEdges:!1,fit:!0},timestep:.5,adaptiveTimestep:!0,wind:{x:0,y:0}},me(this.options,this.defaultOptions),this.timestep=.5,this.layoutFailed=!1,this.bindEventListeners()}return Ln(e,[{key:"bindEventListeners",value:function(){var e=this;this.body.emitter.on("initPhysics",function(){e.initPhysics()}),this.body.emitter.on("_layoutFailed",function(){e.layoutFailed=!0}),this.body.emitter.on("resetPhysics",function(){e.stopSimulation(),e.ready=!1}),this.body.emitter.on("disablePhysics",function(){e.physicsEnabled=!1,e.stopSimulation()}),this.body.emitter.on("restorePhysics",function(){e.setOptions(e.options),!0===e.ready&&e.startSimulation()}),this.body.emitter.on("startSimulation",function(){!0===e.ready&&e.startSimulation()}),this.body.emitter.on("stopSimulation",function(){e.stopSimulation()}),this.body.emitter.on("destroy",function(){e.stopSimulation(!1),e.body.emitter.off()}),this.body.emitter.on("_dataChanged",function(){e.updatePhysicsData()})}},{key:"setOptions",value:function(e){if(void 0!==e)if(!1===e)this.options.enabled=!1,this.physicsEnabled=!1,this.stopSimulation();else if(!0===e)this.options.enabled=!0,this.physicsEnabled=!0,this.startSimulation();else{this.physicsEnabled=!0,ml(["stabilization"],this.options,e),Vl(this.options,e,"stabilization"),void 0===e.enabled&&(this.options.enabled=!0),!1===this.options.enabled&&(this.physicsEnabled=!1,this.stopSimulation());var t=this.options.wind;t&&(("number"!=typeof t.x||gc(t.x))&&(t.x=0),("number"!=typeof t.y||gc(t.y))&&(t.y=0)),this.timestep=this.options.timestep}this.init()}},{key:"init",value:function(){var e;"forceAtlas2Based"===this.options.solver?(this.nodesSolver=new dp(this.body,this.physicsBody,e=this.options.forceAtlas2Based),this.edgesSolver=new lp(this.body,this.physicsBody,e),this.gravitySolver=new hp(this.body,this.physicsBody,e)):"repulsion"===this.options.solver?(this.nodesSolver=new sp(this.body,this.physicsBody,e=this.options.repulsion),this.edgesSolver=new lp(this.body,this.physicsBody,e),this.gravitySolver=new cp(this.body,this.physicsBody,e)):"hierarchicalRepulsion"===this.options.solver?(this.nodesSolver=new ap(this.body,this.physicsBody,e=this.options.hierarchicalRepulsion),this.edgesSolver=new up(this.body,this.physicsBody,e),this.gravitySolver=new cp(this.body,this.physicsBody,e)):(this.nodesSolver=new rp(this.body,this.physicsBody,e=this.options.barnesHut),this.edgesSolver=new lp(this.body,this.physicsBody,e),this.gravitySolver=new cp(this.body,this.physicsBody,e)),this.modelOptions=e}},{key:"initPhysics",value:function(){!0===this.physicsEnabled&&!0===this.options.enabled?!0===this.options.stabilization.enabled?this.stabilize():(this.stabilized=!1,this.ready=!0,this.body.emitter.emit("fit",{},this.layoutFailed),this.startSimulation()):(this.ready=!0,this.body.emitter.emit("fit"))}},{key:"startSimulation",value:function(){var e;!0===this.physicsEnabled&&!0===this.options.enabled?(this.stabilized=!1,this.adaptiveTimestep=!1,this.body.emitter.emit("_resizeNodes"),void 0===this.viewFunction&&(this.viewFunction=$(e=this.simulationStep).call(e,this),this.body.emitter.on("initRedraw",this.viewFunction),this.body.emitter.emit("_startRendering"))):this.body.emitter.emit("_redraw")}},{key:"stopSimulation",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.stabilized=!0,!0===e&&this._emitStabilized(),void 0!==this.viewFunction&&(this.body.emitter.off("initRedraw",this.viewFunction),this.viewFunction=void 0,!0===e&&this.body.emitter.emit("_stopRendering"))}},{key:"simulationStep",value:function(){var e=Br();this.physicsTick(),(Br()-e<.4*this.simulationInterval||!0===this.runDoubleSpeed)&&!1===this.stabilized&&(this.physicsTick(),this.runDoubleSpeed=!0),!0===this.stabilized&&this.stopSimulation()}},{key:"_emitStabilized",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.stabilizationIterations;(this.stabilizationIterations>1||!0===this.startedStabilization)&&En(function(){e.body.emitter.emit("stabilized",{iterations:t}),e.startedStabilization=!1,e.stabilizationIterations=0},0)}},{key:"physicsStep",value:function(){this.gravitySolver.solve(),this.nodesSolver.solve(),this.edgesSolver.solve(),this.moveNodes()}},{key:"adjustTimeStep",value:function(){!0===this._evaluateStepQuality()?this.timestep=1.2*this.timestep:this.timestep/1.2<this.options.timestep?this.timestep=this.options.timestep:(this.adaptiveCounter=-1,this.timestep=Math.max(this.options.timestep,this.timestep/1.2))}},{key:"physicsTick",value:function(){this._startStabilizing(),!0!==this.stabilized&&(!0===this.adaptiveTimestep&&!0===this.adaptiveTimestepEnabled?(this.adaptiveCounter%this.adaptiveInterval==0?(this.timestep=2*this.timestep,this.physicsStep(),this.revert(),this.timestep=.5*this.timestep,this.physicsStep(),this.physicsStep(),this.adjustTimeStep()):this.physicsStep(),this.adaptiveCounter+=1):(this.timestep=this.options.timestep,this.physicsStep()),!0===this.stabilized&&this.revert(),this.stabilizationIterations++)}},{key:"updatePhysicsData",value:function(){this.physicsBody.forces={},this.physicsBody.physicsNodeIndices=[],this.physicsBody.physicsEdgeIndices=[];var e=this.body.nodes,t=this.body.edges;for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&!0===e[o].options.physics&&this.physicsBody.physicsNodeIndices.push(e[o].id);for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&!0===t[n].options.physics&&this.physicsBody.physicsEdgeIndices.push(t[n].id);for(var i=0;i<this.physicsBody.physicsNodeIndices.length;i++){var r=this.physicsBody.physicsNodeIndices[i];this.physicsBody.forces[r]={x:0,y:0},void 0===this.physicsBody.velocities[r]&&(this.physicsBody.velocities[r]={x:0,y:0})}for(var s in this.physicsBody.velocities)void 0===e[s]&&delete this.physicsBody.velocities[s]}},{key:"revert",value:function(){var e=Hr(this.previousStates),t=this.body.nodes,o=this.physicsBody.velocities;this.referenceState={};for(var n=0;n<e.length;n++){var i=e[n];void 0!==t[i]?!0===t[i].options.physics&&(this.referenceState[i]={positions:{x:t[i].x,y:t[i].y}},o[i].x=this.previousStates[i].vx,o[i].y=this.previousStates[i].vy,t[i].x=this.previousStates[i].x,t[i].y=this.previousStates[i].y):delete this.previousStates[i]}}},{key:"_evaluateStepQuality",value:function(){var e,t=this.body.nodes,o=this.referenceState;for(var n in this.referenceState)if(Object.prototype.hasOwnProperty.call(this.referenceState,n)&&void 0!==t[n]&&(e=t[n].y-o[n].positions.y,Math.sqrt(Math.pow(t[n].x-o[n].positions.x,2)+Math.pow(e,2))>.3))return!1;return!0}},{key:"moveNodes",value:function(){for(var e=this.physicsBody.physicsNodeIndices,t=0,o=0,n=0;n<e.length;n++){var i=this._performStep(e[n]);t=Math.max(t,i),o+=i}this.adaptiveTimestepEnabled=o/e.length<5,this.stabilized=t<this.options.minVelocity}},{key:"calculateComponentVelocity",value:function(e,t,o){e+=(t-this.modelOptions.damping*e)/o*this.timestep;var n=this.options.maxVelocity||1e9;return Math.abs(e)>n&&(e=e>0?n:-n),e}},{key:"_performStep",value:function(e){var t=this.body.nodes[e],o=this.physicsBody.forces[e];this.options.wind&&(o.x+=this.options.wind.x,o.y+=this.options.wind.y);var n=this.physicsBody.velocities[e];return this.previousStates[e]={x:t.x,y:t.y,vx:n.x,vy:n.y},!1===t.options.fixed.x?(n.x=this.calculateComponentVelocity(n.x,o.x,t.options.mass),t.x+=n.x*this.timestep):(o.x=0,n.x=0),!1===t.options.fixed.y?(n.y=this.calculateComponentVelocity(n.y,o.y,t.options.mass),t.y+=n.y*this.timestep):(o.y=0,n.y=0),Math.sqrt(Math.pow(n.x,2)+Math.pow(n.y,2))}},{key:"_freezeNodes",value:function(){var e=this.body.nodes;for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)&&e[t].x&&e[t].y){var o=e[t].options.fixed;this.freezeCache[t]={x:o.x,y:o.y},o.x=!0,o.y=!0}}},{key:"_restoreFrozenNodes",value:function(){var e=this.body.nodes;for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&void 0!==this.freezeCache[t]&&(e[t].options.fixed.x=this.freezeCache[t].x,e[t].options.fixed.y=this.freezeCache[t].y);this.freezeCache={}}},{key:"stabilize",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.options.stabilization.iterations;"number"!=typeof t&&(t=this.options.stabilization.iterations,console.error("The stabilize method needs a numeric amount of iterations. Switching to default: ",t)),0!==this.physicsBody.physicsNodeIndices.length?(this.adaptiveTimestep=this.options.adaptiveTimestep,this.body.emitter.emit("_resizeNodes"),this.stopSimulation(),this.stabilized=!1,this.body.emitter.emit("_blockRedraw"),this.targetIterations=t,!0===this.options.stabilization.onlyDynamicEdges&&this._freezeNodes(),this.stabilizationIterations=0,En(function(){return e._stabilizationBatch()},0)):this.ready=!0}},{key:"_startStabilizing",value:function(){return!0!==this.startedStabilization&&(this.body.emitter.emit("startStabilizing"),this.startedStabilization=!0,!0)}},{key:"_stabilizationBatch",value:function(){var e=this,t=function(){return!1===e.stabilized&&e.stabilizationIterations<e.targetIterations},o=function(){e.body.emitter.emit("stabilizationProgress",{iterations:e.stabilizationIterations,total:e.targetIterations})};this._startStabilizing()&&o();for(var n,i=0;t()&&i<this.options.stabilization.updateInterval;)this.physicsTick(),i++;o(),t()?En($(n=this._stabilizationBatch).call(n,this),0):this._finalizeStabilization()}},{key:"_finalizeStabilization",value:function(){this.body.emitter.emit("_allowRedraw"),!0===this.options.stabilization.fit&&this.body.emitter.emit("fit"),!0===this.options.stabilization.onlyDynamicEdges&&this._restoreFrozenNodes(),this.body.emitter.emit("stabilizationIterationsDone"),this.body.emitter.emit("_requestRedraw"),!0===this.stabilized?this._emitStabilized():this.startSimulation(),this.ready=!0}},{key:"_drawForces",value:function(e){for(var t=0;t<this.physicsBody.physicsNodeIndices.length;t++){var o=this.physicsBody.physicsNodeIndices[t],n=this.body.nodes[o],i=this.physicsBody.forces[o],r=Math.sqrt(Math.pow(i.x,2)+Math.pow(i.x,2)),s=Math.min(Math.max(5,r),15),a=3*s,l=Rl((180-180*Math.min(1,Math.max(0,.03*r)))/360,1,1),u={x:n.x+20*i.x,y:n.y+20*i.y};e.lineWidth=s,e.strokeStyle=l,e.beginPath(),e.moveTo(n.x,n.y),e.lineTo(u.x,u.y),e.stroke();var c=Math.atan2(i.y,i.x);e.fillStyle=l,qh.draw(e,{type:"arrow",point:u,angle:c,length:a}),yn(e).call(e)}}}]),e}(),fp=function(){function e(){Sn(this,e)}return Ln(e,null,[{key:"getRange",value:function(e){var t,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=1e9,i=-1e9,r=1e9,s=-1e9;if(o.length>0)for(var a=0;a<o.length;a++)r>(t=e[o[a]]).shape.boundingBox.left&&(r=t.shape.boundingBox.left),s<t.shape.boundingBox.right&&(s=t.shape.boundingBox.right),n>t.shape.boundingBox.top&&(n=t.shape.boundingBox.top),i<t.shape.boundingBox.bottom&&(i=t.shape.boundingBox.bottom);return 1e9===r&&-1e9===s&&1e9===n&&-1e9===i&&(n=0,i=0,r=0,s=0),{minX:r,maxX:s,minY:n,maxY:i}}},{key:"getRangeCore",value:function(e){var t,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=1e9,i=-1e9,r=1e9,s=-1e9;if(o.length>0)for(var a=0;a<o.length;a++)r>(t=e[o[a]]).x&&(r=t.x),s<t.x&&(s=t.x),n>t.y&&(n=t.y),i<t.y&&(i=t.y);return 1e9===r&&-1e9===s&&1e9===n&&-1e9===i&&(n=0,i=0,r=0,s=0),{minX:r,maxX:s,minY:n,maxY:i}}},{key:"findCenter",value:function(e){return{x:.5*(e.maxX+e.minX),y:.5*(e.maxY+e.minY)}}},{key:"cloneOptions",value:function(e,t){var o={};return void 0===t||"node"===t?(yl(o,e.options,!0),o.x=e.x,o.y=e.y,o.amountOfConnections=e.edges.length):yl(o,e.options,!0),o}}]),e}(),vp=function(e){Rc(o,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!xc)return!1;if(xc.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(xc(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var o,n=zc(e);if(t){var i=zc(this).constructor;o=xc(n,arguments,i)}else o=n.apply(this,arguments);return Pc(this,o)}}(o);function o(e,n,i,r,s,a){var l;return Sn(this,o),(l=t.call(this,e,n,i,r,s,a)).isCluster=!0,l.containedNodes={},l.containedEdges={},l}return Ln(o,[{key:"_openChildCluster",value:function(e){var t=this,o=this.body.nodes[e];if(void 0===this.containedNodes[e])throw new Error("node with id: "+e+" not in current cluster");if(!o.isCluster)throw new Error("node with id: "+e+" is not a cluster");delete this.containedNodes[e],El(o.edges,function(e){delete t.containedEdges[e.id]}),El(o.containedNodes,function(e,o){t.containedNodes[o]=e}),o.containedNodes={},El(o.containedEdges,function(e,o){t.containedEdges[o]=e}),o.containedEdges={},El(o.edges,function(e){El(t.edges,function(o){var n,i,r=ui(n=o.clusteringEdgeReplacingIds).call(n,e.id);-1!==r&&(El(e.clusteringEdgeReplacingIds,function(e){o.clusteringEdgeReplacingIds.push(e),t.body.edges[e].edgeReplacedById=o.id}),er(i=o.clusteringEdgeReplacingIds).call(i,r,1))})}),o.edges=[]}}]),o}(wh),gp=function(){function e(t){var o=this;Sn(this,e),this.body=t,this.clusteredNodes={},this.clusteredEdges={},this.options={},this.defaultOptions={},me(this.options,this.defaultOptions),this.body.emitter.on("_resetData",function(){o.clusteredNodes={},o.clusteredEdges={}})}return Ln(e,[{key:"clusterByHubsize",value:function(e,t){void 0===e?e=this._getHubSize():"object"===$r(e)&&(t=this._checkOptions(e),e=this._getHubSize());for(var o=[],n=0;n<this.body.nodeIndices.length;n++){var i=this.body.nodes[this.body.nodeIndices[n]];i.edges.length>=e&&o.push(i.id)}for(var r=0;r<o.length;r++)this.clusterByConnection(o[r],t,!0);this.body.emitter.emit("_dataChanged")}},{key:"cluster",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(void 0===t.joinCondition)throw new Error("Cannot call clusterByNodeData without a joinCondition function in the options.");t=this._checkOptions(t);var n={},i={};El(this.body.nodes,function(o,r){o.options&&!0===t.joinCondition(o.options)&&(n[r]=o,El(o.edges,function(t){void 0===e.clusteredEdges[t.id]&&(i[t.id]=t)}))}),this._cluster(n,i,t,o)}},{key:"clusterByEdgeCount",value:function(e,t){var o=this,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];t=this._checkOptions(t);for(var i,r,s,a=[],l={},u=function(n){var u={},c={},d=o.body.nodeIndices[n],h=o.body.nodes[d];if(void 0===l[d]){s=0,r=[];for(var p=0;p<h.edges.length;p++)void 0===o.clusteredEdges[(i=h.edges[p]).id]&&(i.toId!==i.fromId&&s++,r.push(i));if(s===e){for(var f=function(e){if(null==t.joinCondition)return!0;var o=fp.cloneOptions(e);return t.joinCondition(o)},v=!0,g=0;g<r.length;g++){var b=o._getConnectedId(i=r[g],d);if(!f(h)){v=!1;break}c[i.id]=i,u[d]=h,u[b]=o.body.nodes[b],l[d]=!0}if(Hr(u).length>0&&Hr(c).length>0&&!0===v){var m=function(){for(var e=0;e<a.length;++e)for(var t in u)if(void 0!==a[e].nodes[t])return a[e]}();if(void 0!==m){for(var y in u)void 0===m.nodes[y]&&(m.nodes[y]=u[y]);for(var j in c)void 0===m.edges[j]&&(m.edges[j]=c[j])}else a.push({nodes:u,edges:c})}}}},c=0;c<this.body.nodeIndices.length;c++)u(c);for(var d=0;d<a.length;d++)this._cluster(a[d].nodes,a[d].edges,t,!1);!0===n&&this.body.emitter.emit("_dataChanged")}},{key:"clusterOutliers",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.clusterByEdgeCount(1,e,t)}},{key:"clusterBridges",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.clusterByEdgeCount(2,e,t)}},{key:"clusterByConnection",value:function(e,t){var o,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(void 0===e)throw new Error("No nodeId supplied to clusterByConnection!");if(void 0===this.body.nodes[e])throw new Error("The nodeId given to clusterByConnection does not exist!");var i=this.body.nodes[e];void 0===(t=this._checkOptions(t,i)).clusterNodeProperties.x&&(t.clusterNodeProperties.x=i.x),void 0===t.clusterNodeProperties.y&&(t.clusterNodeProperties.y=i.y),void 0===t.clusterNodeProperties.fixed&&(t.clusterNodeProperties.fixed={},t.clusterNodeProperties.fixed.x=i.options.fixed.x,t.clusterNodeProperties.fixed.y=i.options.fixed.y);var r={},s={},a=i.id,l=fp.cloneOptions(i);r[a]=i;for(var u=0;u<i.edges.length;u++){var c=i.edges[u];if(void 0===this.clusteredEdges[c.id]){var d=this._getConnectedId(c,a);if(void 0===this.clusteredNodes[d])if(d!==a)if(void 0===t.joinCondition)s[c.id]=c,r[d]=this.body.nodes[d];else{var h=fp.cloneOptions(this.body.nodes[d]);!0===t.joinCondition(l,h)&&(s[c.id]=c,r[d]=this.body.nodes[d])}else s[c.id]=c}}var p=Xr(o=Hr(r)).call(o,function(e){return r[e].id});for(var f in r)if(Object.prototype.hasOwnProperty.call(r,f))for(var v=r[f],g=0;g<v.edges.length;g++){var b=v.edges[g];ui(p).call(p,this._getConnectedId(b,v.id))>-1&&(s[b.id]=b)}this._cluster(r,s,t,n)}},{key:"_createClusterEdges",value:function(e,t,o,n){for(var i,r,s,a,l,u,c=Hr(e),d=[],h=0;h<c.length;h++){s=e[r=c[h]];for(var p=0;p<s.edges.length;p++)void 0===this.clusteredEdges[(i=s.edges[p]).id]&&(i.toId==i.fromId?t[i.id]=i:i.toId==r?(a=o.id,u=l=i.fromId):(l=o.id,u=a=i.toId),void 0===e[u]&&d.push({edge:i,fromId:l,toId:a}))}for(var f=[],v=function(e){for(var t=0;t<f.length;t++){var o=f[t];if(e.fromId===o.fromId&&e.toId===o.toId||e.fromId===o.toId&&e.toId===o.fromId)return o}return null},g=0;g<d.length;g++){var b=d[g],m=b.edge,y=v(b);null===y?(y=this._createClusteredEdge(b.fromId,b.toId,m,n),f.push(y)):y.clusteringEdgeReplacingIds.push(m.id),this.body.edges[m.id].edgeReplacedById=y.id,this._backupEdgeOptions(m),m.setOptions({physics:!1})}}},{key:"_checkOptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return void 0===e.clusterEdgeProperties&&(e.clusterEdgeProperties={}),void 0===e.clusterNodeProperties&&(e.clusterNodeProperties={}),e}},{key:"_cluster",value:function(e,t,o){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&void 0!==this.clusteredNodes[r]&&i.push(r);for(var s=0;s<i.length;++s)delete e[i[s]];if(0!=Hr(e).length&&(1!=Hr(e).length||1==o.clusterNodeProperties.allowSingleNodeCluster)){var a=yl({},o.clusterNodeProperties);if(void 0!==o.processProperties){var l=[];for(var u in e)if(Object.prototype.hasOwnProperty.call(e,u)){var c=fp.cloneOptions(e[u]);l.push(c)}var d=[];for(var h in t)if(Object.prototype.hasOwnProperty.call(t,h)&&"clusterEdge:"!==h.substr(0,12)){var p=fp.cloneOptions(t[h],"edge");d.push(p)}if(!(a=o.processProperties(a,l,d)))throw new Error("The processProperties function does not return properties!")}void 0===a.id&&(a.id="cluster:"+md());var f=a.id;void 0===a.label&&(a.label="cluster");var v=void 0;void 0===a.x&&(v=this._getClusterPosition(e),a.x=v.x),void 0===a.y&&(void 0===v&&(v=this._getClusterPosition(e)),a.y=v.y),a.id=f;var g=this.body.functions.createNode(a,vp);g.containedNodes=e,g.containedEdges=t,g.clusterEdgeProperties=o.clusterEdgeProperties,this.body.nodes[a.id]=g,this._clusterEdges(e,t,a,o.clusterEdgeProperties),a.id=void 0,!0===n&&this.body.emitter.emit("_dataChanged")}}},{key:"_backupEdgeOptions",value:function(e){void 0===this.clusteredEdges[e.id]&&(this.clusteredEdges[e.id]={physics:e.options.physics})}},{key:"_restoreEdge",value:function(e){var t=this.clusteredEdges[e.id];void 0!==t&&(e.setOptions({physics:t.physics}),delete this.clusteredEdges[e.id])}},{key:"isCluster",value:function(e){return void 0!==this.body.nodes[e]?!0===this.body.nodes[e].isCluster:(console.error("Node does not exist."),!1)}},{key:"_getClusterPosition",value:function(e){for(var t,o=Hr(e),n=e[o[0]].x,i=e[o[0]].x,r=e[o[0]].y,s=e[o[0]].y,a=1;a<o.length;a++)n=(t=e[o[a]]).x<n?t.x:n,i=t.x>i?t.x:i,r=t.y<r?t.y:r,s=t.y>s?t.y:s;return{x:.5*(n+i),y:.5*(r+s)}}},{key:"openCluster",value:function(e,t){var o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(void 0===e)throw new Error("No clusterNodeId supplied to openCluster.");var n=this.body.nodes[e];if(void 0===n)throw new Error("The clusterNodeId supplied to openCluster does not exist.");if(!0!==n.isCluster||void 0===n.containedNodes||void 0===n.containedEdges)throw new Error("The node:"+e+" is not a valid cluster.");var i=this.findNode(e),r=ui(i).call(i,e)-1;if(r>=0){var s=i[r],a=this.body.nodes[s];return a._openChildCluster(e),delete this.body.nodes[e],void(!0===o&&this.body.emitter.emit("_dataChanged"))}var l=n.containedNodes,u=n.containedEdges;if(void 0!==t&&void 0!==t.releaseFunction&&"function"==typeof t.releaseFunction){var c={},d={x:n.x,y:n.y};for(var h in l)if(Object.prototype.hasOwnProperty.call(l,h)){var p=this.body.nodes[h];c[h]={x:p.x,y:p.y}}var f=t.releaseFunction(d,c);for(var v in l)if(Object.prototype.hasOwnProperty.call(l,v)){var g=this.body.nodes[v];void 0!==f[v]&&(g.x=void 0===f[v].x?n.x:f[v].x,g.y=void 0===f[v].y?n.y:f[v].y)}}else El(l,function(e){!1===e.options.fixed.x&&(e.x=n.x),!1===e.options.fixed.y&&(e.y=n.y)});for(var b in l)if(Object.prototype.hasOwnProperty.call(l,b)){var m=this.body.nodes[b];m.vx=n.vx,m.vy=n.vy,m.setOptions({physics:!0}),delete this.clusteredNodes[b]}for(var y=[],j=0;j<n.edges.length;j++)y.push(n.edges[j]);for(var w=0;w<y.length;w++){for(var x=y[w],C=this._getConnectedId(x,e),E=this.clusteredNodes[C],k=0;k<x.clusteringEdgeReplacingIds.length;k++){var _=x.clusteringEdgeReplacingIds[k],A=this.body.edges[_];if(void 0!==A)if(void 0!==E){var O=this.body.nodes[E.clusterId];O.containedEdges[A.id]=A,delete u[A.id];var M=A.fromId,I=A.toId;A.toId==C?I=E.clusterId:M=E.clusterId,this._createClusteredEdge(M,I,A,O.clusterEdgeProperties,{hidden:!1,physics:!0})}else this._restoreEdge(A)}x.remove()}for(var N in u)Object.prototype.hasOwnProperty.call(u,N)&&this._restoreEdge(u[N]);delete this.body.nodes[e],!0===o&&this.body.emitter.emit("_dataChanged")}},{key:"getNodesInCluster",value:function(e){var t=[];if(!0===this.isCluster(e)){var o=this.body.nodes[e].containedNodes;for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&t.push(this.body.nodes[n].id)}return t}},{key:"findNode",value:function(e){for(var t,o=[],n=0;void 0!==this.clusteredNodes[e]&&n<100;){if(void 0===(t=this.body.nodes[e]))return[];o.push(t.id),e=this.clusteredNodes[e].clusterId,n++}return void 0===(t=this.body.nodes[e])?[]:(o.push(t.id),rr(o).call(o),o)}},{key:"updateClusteredNode",value:function(e,t){if(void 0===e)throw new Error("No clusteredNodeId supplied to updateClusteredNode.");if(void 0===t)throw new Error("No newOptions supplied to updateClusteredNode.");if(void 0===this.body.nodes[e])throw new Error("The clusteredNodeId supplied to updateClusteredNode does not exist.");this.body.nodes[e].setOptions(t),this.body.emitter.emit("_dataChanged")}},{key:"updateEdge",value:function(e,t){if(void 0===e)throw new Error("No startEdgeId supplied to updateEdge.");if(void 0===t)throw new Error("No newOptions supplied to updateEdge.");if(void 0===this.body.edges[e])throw new Error("The startEdgeId supplied to updateEdge does not exist.");for(var o=this.getClusteredEdges(e),n=0;n<o.length;n++)this.body.edges[o[n]].setOptions(t);this.body.emitter.emit("_dataChanged")}},{key:"getClusteredEdges",value:function(e){for(var t=[],o=0;void 0!==e&&void 0!==this.body.edges[e]&&o<100;)t.push(this.body.edges[e].id),e=this.body.edges[e].edgeReplacedById,o++;return rr(t).call(t),t}},{key:"getBaseEdge",value:function(e){return this.getBaseEdges(e)[0]}},{key:"getBaseEdges",value:function(e){for(var t=[e],o=[],n=[],i=0;t.length>0&&i<100;){var r=t.pop();if(void 0!==r){var s=this.body.edges[r];if(void 0!==s){i++;var a=s.clusteringEdgeReplacingIds;if(void 0===a)n.push(r);else for(var l=0;l<a.length;++l){var u=a[l];-1===ui(t).call(t,a)&&-1===ui(o).call(o,a)&&t.push(u)}o.push(r)}}}return n}},{key:"_getConnectedId",value:function(e,t){return e.toId!=t?e.toId:e.fromId}},{key:"_getHubSize",value:function(){for(var e=0,t=0,o=0,n=0,i=0;i<this.body.nodeIndices.length;i++){var r=this.body.nodes[this.body.nodeIndices[i]];r.edges.length>n&&(n=r.edges.length),e+=r.edges.length,t+=Math.pow(r.edges.length,2),o+=1}e/=o;var s=(t/=o)-Math.pow(e,2),a=Math.sqrt(s),l=Math.floor(e+2*a);return l>n&&(l=n),l}},{key:"_createClusteredEdge",value:function(e,t,o,n,i){var r=fp.cloneOptions(o,"edge");yl(r,n),r.from=e,r.to=t,r.id="clusterEdge:"+md(),void 0!==i&&yl(r,i);var s=this.body.functions.createEdge(r);return s.clusteringEdgeReplacingIds=[o.id],s.connect(),this.body.edges[s.id]=s,s}},{key:"_clusterEdges",value:function(e,t,o,n){if(t instanceof np){var i={};i[t.id]=t,t=i}if(e instanceof wh){var r={};r[e.id]=e,e=r}if(null==o)throw new Error("_clusterEdges: parameter clusterNode required");for(var s in void 0===n&&(n=o.clusterEdgeProperties),this._createClusterEdges(e,t,o,n),t)if(Object.prototype.hasOwnProperty.call(t,s)&&void 0!==this.body.edges[s]){var a=this.body.edges[s];this._backupEdgeOptions(a),a.setOptions({physics:!1})}for(var l in e)Object.prototype.hasOwnProperty.call(e,l)&&(this.clusteredNodes[l]={clusterId:o.id,node:this.body.nodes[l]},this.body.nodes[l].setOptions({physics:!1}))}},{key:"_getClusterNodeForNode",value:function(e){if(void 0!==e){var t=this.clusteredNodes[e];if(void 0!==t){var o=t.clusterId;if(void 0!==o)return this.body.nodes[o]}}}},{key:"_filter",value:function(e,t){var o=[];return El(e,function(e){t(e)&&o.push(e)}),o}},{key:"_updateState",value:function(){var e,t=this,o=[],n={},i=function(e){El(t.body.nodes,function(t){!0===t.isCluster&&e(t)})};for(e in this.clusteredNodes)Object.prototype.hasOwnProperty.call(this.clusteredNodes,e)&&void 0===this.body.nodes[e]&&o.push(e);i(function(e){for(var t=0;t<o.length;t++)delete e.containedNodes[o[t]]});for(var r=0;r<o.length;r++)delete this.clusteredNodes[o[r]];El(this.clusteredEdges,function(e){var o=t.body.edges[e];void 0!==o&&o.endPointsValid()||(n[e]=e)}),i(function(e){El(e.containedEdges,function(e,t){e.endPointsValid()||n[t]||(n[t]=t)})}),El(this.body.edges,function(e,o){var i=!0,r=e.clusteringEdgeReplacingIds;if(void 0!==r){var s=0;El(r,function(e){var o=t.body.edges[e];void 0!==o&&o.endPointsValid()&&(s+=1)}),i=s>0}e.endPointsValid()&&i||(n[o]=o)}),i(function(e){El(n,function(o){delete e.containedEdges[o],El(e.edges,function(i,r){i.id!==o?i.clusteringEdgeReplacingIds=t._filter(i.clusteringEdgeReplacingIds,function(e){return!n[e]}):e.edges[r]=null}),e.edges=t._filter(e.edges,function(e){return null!==e})})}),El(n,function(e){delete t.clusteredEdges[e]}),El(n,function(e){delete t.body.edges[e]}),El(Hr(this.body.edges),function(e){var o=t.body.edges[e],n=t._isClusteredNode(o.fromId)||t._isClusteredNode(o.toId);if(n!==t._isClusteredEdge(o.id))if(n){var i=t._getClusterNodeForNode(o.fromId);void 0!==i&&t._clusterEdges(t.body.nodes[o.fromId],o,i);var r=t._getClusterNodeForNode(o.toId);void 0!==r&&t._clusterEdges(t.body.nodes[o.toId],o,r)}else delete t._clusterEdges[e],t._restoreEdge(o)});for(var s=!1,a=!0,l=function(){var e=[];i(function(t){var o=Hr(t.containedNodes).length,n=!0===t.options.allowSingleNodeCluster;(n&&o<1||!n&&o<2)&&e.push(t.id)});for(var o=0;o<e.length;++o)t.openCluster(e[o],{},!1);a=e.length>0,s=s||a};a;)l();s&&this._updateState()}},{key:"_isClusteredNode",value:function(e){return void 0!==this.clusteredNodes[e]}},{key:"_isClusteredEdge",value:function(e){return void 0!==this.clusteredEdges[e]}}]),e}();function bp(e,t){var o;if(void 0===is||null==nn(e)){if(Gr(e)||(o=function(e,t){var o;if(e){if("string"==typeof e)return mp(e,t);var n=Zr(o=Object.prototype.toString.call(e)).call(o,8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?gn(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?mp(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){o&&(e=o);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){o=on(e)},n:function(){var e=o.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==o.return||o.return()}finally{if(a)throw r}}}}function mp(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}var yp=function(){function e(t,o){var n;Sn(this,e),void 0!==window&&(n=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame),window.requestAnimationFrame=void 0===n?function(e){e()}:n,this.body=t,this.canvas=o,this.redrawRequested=!1,this.renderTimer=void 0,this.requiresTimeout=!0,this.renderingActive=!1,this.renderRequests=0,this.allowRedraw=!0,this.dragging=!1,this.zooming=!1,this.options={},this.defaultOptions={hideEdgesOnDrag:!1,hideEdgesOnZoom:!1,hideNodesOnDrag:!1},me(this.options,this.defaultOptions),this._determineBrowserMethod(),this.bindEventListeners()}return Ln(e,[{key:"bindEventListeners",value:function(){var e,t=this;this.body.emitter.on("dragStart",function(){t.dragging=!0}),this.body.emitter.on("dragEnd",function(){t.dragging=!1}),this.body.emitter.on("zoom",function(){t.zooming=!0,window.clearTimeout(t.zoomTimeoutId),t.zoomTimeoutId=window.setTimeout(function(){var e;t.zooming=!1,$(e=t._requestRedraw).call(e,t)()},250)}),this.body.emitter.on("_resizeNodes",function(){t._resizeNodes()}),this.body.emitter.on("_redraw",function(){!1===t.renderingActive&&t._redraw()}),this.body.emitter.on("_blockRedraw",function(){t.allowRedraw=!1}),this.body.emitter.on("_allowRedraw",function(){t.allowRedraw=!0,t.redrawRequested=!1}),this.body.emitter.on("_requestRedraw",$(e=this._requestRedraw).call(e,this)),this.body.emitter.on("_startRendering",function(){t.renderRequests+=1,t.renderingActive=!0,t._startRendering()}),this.body.emitter.on("_stopRendering",function(){t.renderRequests-=1,t.renderingActive=t.renderRequests>0,t.renderTimer=void 0}),this.body.emitter.on("destroy",function(){t.renderRequests=0,t.allowRedraw=!1,t.renderingActive=!1,!0===t.requiresTimeout?clearTimeout(t.renderTimer):window.cancelAnimationFrame(t.renderTimer),t.body.emitter.off()})}},{key:"setOptions",value:function(e){void 0!==e&&bl(["hideEdgesOnDrag","hideEdgesOnZoom","hideNodesOnDrag"],this.options,e)}},{key:"_requestNextFrame",value:function(e,t){if("undefined"!=typeof window){var o,n=window;return!0===this.requiresTimeout?o=n.setTimeout(e,t):n.requestAnimationFrame&&(o=n.requestAnimationFrame(e)),o}}},{key:"_startRendering",value:function(){var e;!0===this.renderingActive&&void 0===this.renderTimer&&(this.renderTimer=this._requestNextFrame($(e=this._renderStep).call(e,this),this.simulationInterval))}},{key:"_renderStep",value:function(){!0===this.renderingActive&&(this.renderTimer=void 0,!0===this.requiresTimeout&&this._startRendering(),this._redraw(),!1===this.requiresTimeout&&this._startRendering())}},{key:"redraw",value:function(){this.body.emitter.emit("setSize"),this._redraw()}},{key:"_requestRedraw",value:function(){var e=this;!0!==this.redrawRequested&&!1===this.renderingActive&&!0===this.allowRedraw&&(this.redrawRequested=!0,this._requestNextFrame(function(){e._redraw(!1)},0))}},{key:"_redraw",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!0===this.allowRedraw){this.body.emitter.emit("initRedraw"),this.redrawRequested=!1;var t={drawExternalLabels:null};0!==this.canvas.frame.canvas.width&&0!==this.canvas.frame.canvas.height||this.canvas.setSize(),this.canvas.setTransform();var o=this.canvas.getContext(),n=this.canvas.frame.canvas.clientWidth,i=this.canvas.frame.canvas.clientHeight;if(o.clearRect(0,0,n,i),0===this.canvas.frame.clientWidth)return;if(o.save(),o.translate(this.body.view.translation.x,this.body.view.translation.y),o.scale(this.body.view.scale,this.body.view.scale),o.beginPath(),this.body.emitter.emit("beforeDrawing",o),o.closePath(),!1===e&&(!1===this.dragging||!0===this.dragging&&!1===this.options.hideEdgesOnDrag)&&(!1===this.zooming||!0===this.zooming&&!1===this.options.hideEdgesOnZoom)&&this._drawEdges(o),!1===this.dragging||!0===this.dragging&&!1===this.options.hideNodesOnDrag){var r=this._drawNodes(o,e),s=r.drawExternalLabels;t.drawExternalLabels=s}!1===e&&(!1===this.dragging||!0===this.dragging&&!1===this.options.hideEdgesOnDrag)&&(!1===this.zooming||!0===this.zooming&&!1===this.options.hideEdgesOnZoom)&&this._drawArrows(o),null!=t.drawExternalLabels&&t.drawExternalLabels(),!1===e&&this._drawSelectionBox(o),o.beginPath(),this.body.emitter.emit("afterDrawing",o),o.closePath(),o.restore(),!0===e&&o.clearRect(0,0,n,i)}}},{key:"_resizeNodes",value:function(){this.canvas.setTransform();var e=this.canvas.getContext();e.save(),e.translate(this.body.view.translation.x,this.body.view.translation.y),e.scale(this.body.view.scale,this.body.view.scale);var t,o=this.body.nodes;for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&((t=o[n]).resize(e),t.updateBoundingBox(e,t.selected));e.restore()}},{key:"_drawNodes",value:function(e){for(var t,o,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.body.nodes,r=this.body.nodeIndices,s=[],a=[],l=20,u=this.canvas.DOMtoCanvas({x:-l,y:-l}),c=this.canvas.DOMtoCanvas({x:this.canvas.frame.canvas.clientWidth+l,y:this.canvas.frame.canvas.clientHeight+l}),d={top:u.y,left:u.x,bottom:c.y,right:c.x},h=[],p=0;p<r.length;p++)if((t=i[r[p]]).hover)a.push(r[p]);else if(t.isSelected())s.push(r[p]);else if(!0===n){var f=t.draw(e);null!=f.drawExternalLabel&&h.push(f.drawExternalLabel)}else if(!0===t.isBoundingBoxOverlappingWith(d)){var v=t.draw(e);null!=v.drawExternalLabel&&h.push(v.drawExternalLabel)}else t.updateBoundingBox(e,t.selected);var g=s.length,b=a.length;for(o=0;o<g;o++){var m=(t=i[s[o]]).draw(e);null!=m.drawExternalLabel&&h.push(m.drawExternalLabel)}for(o=0;o<b;o++){var y=(t=i[a[o]]).draw(e);null!=y.drawExternalLabel&&h.push(y.drawExternalLabel)}return{drawExternalLabels:function(){var e,t=bp(h);try{for(t.s();!(e=t.n()).done;)(0,e.value)()}catch(e){t.e(e)}finally{t.f()}}}}},{key:"_drawEdges",value:function(e){for(var t=this.body.edges,o=this.body.edgeIndices,n=0;n<o.length;n++){var i=t[o[n]];!0===i.connected&&i.draw(e)}}},{key:"_drawArrows",value:function(e){for(var t=this.body.edges,o=this.body.edgeIndices,n=0;n<o.length;n++){var i=t[o[n]];!0===i.connected&&i.drawArrows(e)}}},{key:"_determineBrowserMethod",value:function(){if("undefined"!=typeof window){var e=navigator.userAgent.toLowerCase();this.requiresTimeout=!1,(-1!=ui(e).call(e,"msie 9.0")||-1!=ui(e).call(e,"safari")&&ui(e).call(e,"chrome")<=-1)&&(this.requiresTimeout=!0)}else this.requiresTimeout=!0}},{key:"_drawSelectionBox",value:function(e){if(this.body.selectionBox.show){e.beginPath();var t=this.body.selectionBox.position.end.x-this.body.selectionBox.position.start.x,o=this.body.selectionBox.position.end.y-this.body.selectionBox.position.start.y;e.rect(this.body.selectionBox.position.start.x,this.body.selectionBox.position.start.y,t,o),e.fillStyle="rgba(151, 194, 252, 0.2)",e.fillRect(this.body.selectionBox.position.start.x,this.body.selectionBox.position.start.y,t,o),e.strokeStyle="rgba(151, 194, 252, 1)",e.stroke()}else e.closePath()}}]),e}(),jp=D.setInterval;function wp(e,t){t.inputHandler=function(e){e.isFirst&&t(e)},e.on("hammer.input",t.inputHandler)}function xp(e,t){return t.inputHandler=function(e){e.isFinal&&t(e)},e.on("hammer.input",t.inputHandler)}var Cp=function(){function e(t){Sn(this,e),this.body=t,this.pixelRatio=1,this.cameraState={},this.initialized=!1,this.canvasViewCenter={},this._cleanupCallbacks=[],this.options={},this.defaultOptions={autoResize:!0,height:"100%",width:"100%"},me(this.options,this.defaultOptions),this.bindEventListeners()}return Ln(e,[{key:"bindEventListeners",value:function(){var e,t=this;this.body.emitter.once("resize",function(e){0!==e.width&&(t.body.view.translation.x=.5*e.width),0!==e.height&&(t.body.view.translation.y=.5*e.height)}),this.body.emitter.on("setSize",$(e=this.setSize).call(e,this)),this.body.emitter.on("destroy",function(){t.hammerFrame.destroy(),t.hammer.destroy(),t._cleanUp()})}},{key:"setOptions",value:function(e){var t=this;if(void 0!==e&&bl(["width","height","autoResize"],this.options,e),this._cleanUp(),!0===this.options.autoResize){var o;if(window.ResizeObserver){var n=new ResizeObserver(function(){!0===t.setSize()&&t.body.emitter.emit("_requestRedraw")}),i=this.frame;n.observe(i),this._cleanupCallbacks.push(function(){n.unobserve(i)})}else{var r=jp(function(){!0===t.setSize()&&t.body.emitter.emit("_requestRedraw")},1e3);this._cleanupCallbacks.push(function(){clearInterval(r)})}var s=$(o=this._onResize).call(o,this);_l(window,"resize",s),this._cleanupCallbacks.push(function(){Al(window,"resize",s)})}}},{key:"_cleanUp",value:function(){var e,t,o;pr(e=rr(t=er(o=this._cleanupCallbacks).call(o,0)).call(t)).call(e,function(e){try{e()}catch(e){console.error(e)}})}},{key:"_onResize",value:function(){this.setSize(),this.body.emitter.emit("_redraw")}},{key:"_getCameraState",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.pixelRatio;!0===this.initialized&&(this.cameraState.previousWidth=this.frame.canvas.width/e,this.cameraState.previousHeight=this.frame.canvas.height/e,this.cameraState.scale=this.body.view.scale,this.cameraState.position=this.DOMtoCanvas({x:.5*this.frame.canvas.width/e,y:.5*this.frame.canvas.height/e}))}},{key:"_setCameraState",value:function(){if(void 0!==this.cameraState.scale&&0!==this.frame.canvas.clientWidth&&0!==this.frame.canvas.clientHeight&&0!==this.pixelRatio&&this.cameraState.previousWidth>0&&this.cameraState.previousHeight>0){var e=this.frame.canvas.width/this.pixelRatio/this.cameraState.previousWidth,t=this.frame.canvas.height/this.pixelRatio/this.cameraState.previousHeight,o=this.cameraState.scale;1!=e&&1!=t?o=.5*this.cameraState.scale*(e+t):1!=e?o=this.cameraState.scale*e:1!=t&&(o=this.cameraState.scale*t),this.body.view.scale=o;var n=this.DOMtoCanvas({x:.5*this.frame.canvas.clientWidth,y:.5*this.frame.canvas.clientHeight}),i={x:n.x-this.cameraState.position.x,y:n.y-this.cameraState.position.y};this.body.view.translation.x+=i.x*this.body.view.scale,this.body.view.translation.y+=i.y*this.body.view.scale}}},{key:"_prepareValue",value:function(e){if("number"==typeof e)return e+"px";if("string"==typeof e){if(-1!==ui(e).call(e,"%")||-1!==ui(e).call(e,"px"))return e;if(-1===ui(e).call(e,"%"))return e+"px"}throw new Error("Could not use the value supplied for width or height:"+e)}},{key:"_create",value:function(){for(;this.body.container.hasChildNodes();)this.body.container.removeChild(this.body.container.firstChild);if(this.frame=document.createElement("div"),this.frame.className="vis-network",this.frame.style.position="relative",this.frame.style.overflow="hidden",this.frame.tabIndex=0,this.frame.canvas=document.createElement("canvas"),this.frame.canvas.style.position="relative",this.frame.appendChild(this.frame.canvas),this.frame.canvas.getContext)this._setPixelRatio(),this.setTransform();else{var e=document.createElement("DIV");e.style.color="red",e.style.fontWeight="bold",e.style.padding="10px",e.innerText="Error: your browser does not support HTML canvas",this.frame.canvas.appendChild(e)}this.body.container.appendChild(this.frame),this.body.view.scale=1,this.body.view.translation={x:.5*this.frame.canvas.clientWidth,y:.5*this.frame.canvas.clientHeight},this._bindHammer()}},{key:"_bindHammer",value:function(){var e=this;void 0!==this.hammer&&this.hammer.destroy(),this.drag={},this.pinch={},this.hammer=new ou(this.frame.canvas),this.hammer.get("pinch").set({enable:!0}),this.hammer.get("pan").set({threshold:5,direction:ou.DIRECTION_ALL}),wp(this.hammer,function(t){e.body.eventListeners.onTouch(t)}),this.hammer.on("tap",function(t){e.body.eventListeners.onTap(t)}),this.hammer.on("doubletap",function(t){e.body.eventListeners.onDoubleTap(t)}),this.hammer.on("press",function(t){e.body.eventListeners.onHold(t)}),this.hammer.on("panstart",function(t){e.body.eventListeners.onDragStart(t)}),this.hammer.on("panmove",function(t){e.body.eventListeners.onDrag(t)}),this.hammer.on("panend",function(t){e.body.eventListeners.onDragEnd(t)}),this.hammer.on("pinch",function(t){e.body.eventListeners.onPinch(t)}),this.frame.canvas.addEventListener("wheel",function(t){e.body.eventListeners.onMouseWheel(t)}),this.frame.canvas.addEventListener("mousemove",function(t){e.body.eventListeners.onMouseMove(t)}),this.frame.canvas.addEventListener("contextmenu",function(t){e.body.eventListeners.onContext(t)}),this.hammerFrame=new ou(this.frame),xp(this.hammerFrame,function(t){e.body.eventListeners.onRelease(t)})}},{key:"setSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.options.width,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.options.height;e=this._prepareValue(e),t=this._prepareValue(t);var o=!1,n=this.frame.canvas.width,i=this.frame.canvas.height,r=this.pixelRatio;if(this._setPixelRatio(),e!=this.options.width||t!=this.options.height||this.frame.style.width!=e||this.frame.style.height!=t)this._getCameraState(r),this.frame.style.width=e,this.frame.style.height=t,this.frame.canvas.style.width="100%",this.frame.canvas.style.height="100%",this.frame.canvas.width=Math.round(this.frame.canvas.clientWidth*this.pixelRatio),this.frame.canvas.height=Math.round(this.frame.canvas.clientHeight*this.pixelRatio),this.options.width=e,this.options.height=t,this.canvasViewCenter={x:.5*this.frame.clientWidth,y:.5*this.frame.clientHeight},o=!0;else{var s=Math.round(this.frame.canvas.clientWidth*this.pixelRatio),a=Math.round(this.frame.canvas.clientHeight*this.pixelRatio);this.frame.canvas.width===s&&this.frame.canvas.height===a||this._getCameraState(r),this.frame.canvas.width!==s&&(this.frame.canvas.width=s,o=!0),this.frame.canvas.height!==a&&(this.frame.canvas.height=a,o=!0)}return!0===o&&(this.body.emitter.emit("resize",{width:Math.round(this.frame.canvas.width/this.pixelRatio),height:Math.round(this.frame.canvas.height/this.pixelRatio),oldWidth:Math.round(n/this.pixelRatio),oldHeight:Math.round(i/this.pixelRatio)}),this._setCameraState()),this.initialized=!0,o}},{key:"getContext",value:function(){return this.frame.canvas.getContext("2d")}},{key:"_determinePixelRatio",value:function(){var e=this.getContext();if(void 0===e)throw new Error("Could not get canvax context");var t=1;return"undefined"!=typeof window&&(t=window.devicePixelRatio||1),t/(e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1)}},{key:"_setPixelRatio",value:function(){this.pixelRatio=this._determinePixelRatio()}},{key:"setTransform",value:function(){var e=this.getContext();if(void 0===e)throw new Error("Could not get canvax context");e.setTransform(this.pixelRatio,0,0,this.pixelRatio,0,0)}},{key:"_XconvertDOMtoCanvas",value:function(e){return(e-this.body.view.translation.x)/this.body.view.scale}},{key:"_XconvertCanvasToDOM",value:function(e){return e*this.body.view.scale+this.body.view.translation.x}},{key:"_YconvertDOMtoCanvas",value:function(e){return(e-this.body.view.translation.y)/this.body.view.scale}},{key:"_YconvertCanvasToDOM",value:function(e){return e*this.body.view.scale+this.body.view.translation.y}},{key:"canvasToDOM",value:function(e){return{x:this._XconvertCanvasToDOM(e.x),y:this._YconvertCanvasToDOM(e.y)}}},{key:"DOMtoCanvas",value:function(e){return{x:this._XconvertDOMtoCanvas(e.x),y:this._YconvertDOMtoCanvas(e.y)}}}]),e}();function Ep(e,t){var o=me({nodes:t,minZoomLevel:Number.MIN_VALUE,maxZoomLevel:1},null!=e?e:{});if(!Gr(o.nodes))throw new TypeError("Nodes has to be an array of ids.");if(0===o.nodes.length&&(o.nodes=t),!("number"==typeof o.minZoomLevel&&o.minZoomLevel>0))throw new TypeError("Min zoom level has to be a number higher than zero.");if(!("number"==typeof o.maxZoomLevel&&o.minZoomLevel<=o.maxZoomLevel))throw new TypeError("Max zoom level has to be a number higher than min zoom level.");return o}var kp=function(){function e(t,o){var n,i,r=this;Sn(this,e),this.body=t,this.canvas=o,this.animationSpeed=1/this.renderRefreshRate,this.animationEasingFunction="easeInOutQuint",this.easingTime=0,this.sourceScale=0,this.targetScale=0,this.sourceTranslation=0,this.targetTranslation=0,this.lockedOnNodeId=void 0,this.lockedOnNodeOffset=void 0,this.touchTime=0,this.viewFunction=void 0,this.body.emitter.on("fit",$(n=this.fit).call(n,this)),this.body.emitter.on("animationFinished",function(){r.body.emitter.emit("_stopRendering")}),this.body.emitter.on("unlockNode",$(i=this.releaseNode).call(i,this))}return Ln(e,[{key:"setOptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.options=e}},{key:"fit",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e=Ep(e,this.body.nodeIndices);var o,n,i=this.canvas.frame.canvas.clientWidth,r=this.canvas.frame.canvas.clientHeight;if(0===i||0===r)n=1,o=fp.getRange(this.body.nodes,e.nodes);else if(!0===t){var s=0;for(var a in this.body.nodes)if(Object.prototype.hasOwnProperty.call(this.body.nodes,a)){var l=this.body.nodes[a];!0===l.predefinedPosition&&(s+=1)}if(s>.5*this.body.nodeIndices.length)return void this.fit(e,!1);o=fp.getRange(this.body.nodes,e.nodes);var u=this.body.nodeIndices.length;n=12.662/(u+7.4147)+.0964822;var c=Math.min(i/600,r/600);n*=c}else{this.body.emitter.emit("_resizeNodes"),o=fp.getRange(this.body.nodes,e.nodes);var d=1.1*Math.abs(o.maxX-o.minX),h=1.1*Math.abs(o.maxY-o.minY),p=i/d,f=r/h;n=p<=f?p:f}n>e.maxZoomLevel?n=e.maxZoomLevel:n<e.minZoomLevel&&(n=e.minZoomLevel);var v=fp.findCenter(o),g={position:v,scale:n,animation:e.animation};this.moveTo(g)}},{key:"focus",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(void 0!==this.body.nodes[e]){var o={x:this.body.nodes[e].x,y:this.body.nodes[e].y};t.position=o,t.lockedOnNode=e,this.moveTo(t)}else console.error("Node: "+e+" cannot be found.")}},{key:"moveTo",value:function(e){if(void 0!==e){if(null!=e.offset){if(null!=e.offset.x){if(e.offset.x=+e.offset.x,!vc(e.offset.x))throw new TypeError('The option "offset.x" has to be a finite number.')}else e.offset.x=0;if(null!=e.offset.y){if(e.offset.y=+e.offset.y,!vc(e.offset.y))throw new TypeError('The option "offset.y" has to be a finite number.')}else e.offset.x=0}else e.offset={x:0,y:0};if(null!=e.position){if(null!=e.position.x){if(e.position.x=+e.position.x,!vc(e.position.x))throw new TypeError('The option "position.x" has to be a finite number.')}else e.position.x=0;if(null!=e.position.y){if(e.position.y=+e.position.y,!vc(e.position.y))throw new TypeError('The option "position.y" has to be a finite number.')}else e.position.x=0}else e.position=this.getViewPosition();if(null!=e.scale){if(e.scale=+e.scale,!(e.scale>0))throw new TypeError('The option "scale" has to be a number greater than zero.')}else e.scale=this.body.view.scale;void 0===e.animation&&(e.animation={duration:0}),!1===e.animation&&(e.animation={duration:0}),!0===e.animation&&(e.animation={}),void 0===e.animation.duration&&(e.animation.duration=1e3),void 0===e.animation.easingFunction&&(e.animation.easingFunction="easeInOutQuad"),this.animateView(e)}else e={}}},{key:"animateView",value:function(e){if(void 0!==e){this.animationEasingFunction=e.animation.easingFunction,this.releaseNode(),!0===e.locked&&(this.lockedOnNodeId=e.lockedOnNode,this.lockedOnNodeOffset=e.offset),0!=this.easingTime&&this._transitionRedraw(!0),this.sourceScale=this.body.view.scale,this.sourceTranslation=this.body.view.translation,this.targetScale=e.scale,this.body.view.scale=this.targetScale;var t,o,n=this.canvas.DOMtoCanvas({x:.5*this.canvas.frame.canvas.clientWidth,y:.5*this.canvas.frame.canvas.clientHeight});this.targetTranslation={x:this.sourceTranslation.x+(n.x-e.position.x)*this.targetScale+e.offset.x,y:this.sourceTranslation.y+(n.y-e.position.y)*this.targetScale+e.offset.y},0===e.animation.duration?null!=this.lockedOnNodeId?(this.viewFunction=$(t=this._lockedRedraw).call(t,this),this.body.emitter.on("initRedraw",this.viewFunction)):(this.body.view.scale=this.targetScale,this.body.view.translation=this.targetTranslation,this.body.emitter.emit("_requestRedraw")):(this.animationSpeed=1/(60*e.animation.duration*.001)||1/60,this.animationEasingFunction=e.animation.easingFunction,this.viewFunction=$(o=this._transitionRedraw).call(o,this),this.body.emitter.on("initRedraw",this.viewFunction),this.body.emitter.emit("_startRendering"))}}},{key:"_lockedRedraw",value:function(){var e=this.body.nodes[this.lockedOnNodeId].x,t=this.body.nodes[this.lockedOnNodeId].y,o=this.canvas.DOMtoCanvas({x:.5*this.canvas.frame.canvas.clientWidth,y:.5*this.canvas.frame.canvas.clientHeight}),n=this.body.view.translation;this.body.view.translation={x:n.x+(o.x-e)*this.body.view.scale+this.lockedOnNodeOffset.x,y:n.y+(o.y-t)*this.body.view.scale+this.lockedOnNodeOffset.y}}},{key:"releaseNode",value:function(){void 0!==this.lockedOnNodeId&&void 0!==this.viewFunction&&(this.body.emitter.off("initRedraw",this.viewFunction),this.lockedOnNodeId=void 0,this.lockedOnNodeOffset=void 0)}},{key:"_transitionRedraw",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.easingTime+=this.animationSpeed,this.easingTime=!0===e?1:this.easingTime;var t,o=Ul[this.animationEasingFunction](this.easingTime);this.body.view.scale=this.sourceScale+(this.targetScale-this.sourceScale)*o,this.body.view.translation={x:this.sourceTranslation.x+(this.targetTranslation.x-this.sourceTranslation.x)*o,y:this.sourceTranslation.y+(this.targetTranslation.y-this.sourceTranslation.y)*o},this.easingTime>=1&&(this.body.emitter.off("initRedraw",this.viewFunction),this.easingTime=0,null!=this.lockedOnNodeId&&(this.viewFunction=$(t=this._lockedRedraw).call(t,this),this.body.emitter.on("initRedraw",this.viewFunction)),this.body.emitter.emit("animationFinished"))}},{key:"getScale",value:function(){return this.body.view.scale}},{key:"getViewPosition",value:function(){return this.canvas.DOMtoCanvas({x:.5*this.canvas.frame.canvas.clientWidth,y:.5*this.canvas.frame.canvas.clientHeight})}}]),e}();function _p(e){var t,o=e&&e.preventDefault||!1,n=e&&e.container||window,i={},r={keydown:{},keyup:{}},s={};for(t=97;t<=122;t++)s[String.fromCharCode(t)]={code:t-97+65,shift:!1};for(t=65;t<=90;t++)s[String.fromCharCode(t)]={code:t,shift:!0};for(t=0;t<=9;t++)s[""+t]={code:48+t,shift:!1};for(t=1;t<=12;t++)s["F"+t]={code:111+t,shift:!1};for(t=0;t<=9;t++)s["num"+t]={code:96+t,shift:!1};s["num*"]={code:106,shift:!1},s["num+"]={code:107,shift:!1},s["num-"]={code:109,shift:!1},s["num/"]={code:111,shift:!1},s["num."]={code:110,shift:!1},s.left={code:37,shift:!1},s.up={code:38,shift:!1},s.right={code:39,shift:!1},s.down={code:40,shift:!1},s.space={code:32,shift:!1},s.enter={code:13,shift:!1},s.shift={code:16,shift:void 0},s.esc={code:27,shift:!1},s.backspace={code:8,shift:!1},s.tab={code:9,shift:!1},s.ctrl={code:17,shift:!1},s.alt={code:18,shift:!1},s.delete={code:46,shift:!1},s.pageup={code:33,shift:!1},s.pagedown={code:34,shift:!1},s["="]={code:187,shift:!1},s["-"]={code:189,shift:!1},s["]"]={code:221,shift:!1},s["["]={code:219,shift:!1};var a=function(e){u(e,"keydown")},l=function(e){u(e,"keyup")},u=function(e,t){if(void 0!==r[t][e.keyCode]){for(var n=r[t][e.keyCode],i=0;i<n.length;i++)(void 0===n[i].shift||1==n[i].shift&&1==e.shiftKey||0==n[i].shift&&0==e.shiftKey)&&n[i].fn(e);1==o&&e.preventDefault()}};return i.bind=function(e,t,o){if(void 0===o&&(o="keydown"),void 0===s[e])throw new Error("unsupported key: "+e);void 0===r[o][s[e].code]&&(r[o][s[e].code]=[]),r[o][s[e].code].push({fn:t,shift:s[e].shift})},i.bindAll=function(e,t){for(var o in void 0===t&&(t="keydown"),s)s.hasOwnProperty(o)&&i.bind(o,e,t)},i.getKey=function(e){for(var t in s)if(s.hasOwnProperty(t)){if(1==e.shiftKey&&1==s[t].shift&&e.keyCode==s[t].code)return t;if(0==e.shiftKey&&0==s[t].shift&&e.keyCode==s[t].code)return t;if(e.keyCode==s[t].code&&"shift"==t)return t}return"unknown key, currently not supported"},i.unbind=function(e,t,o){if(void 0===o&&(o="keydown"),void 0===s[e])throw new Error("unsupported key: "+e);if(void 0!==t){var n=[],i=r[o][s[e].code];if(void 0!==i)for(var a=0;a<i.length;a++)i[a].fn==t&&i[a].shift==s[e].shift||n.push(r[o][s[e].code][a]);r[o][s[e].code]=n}else r[o][s[e].code]=[]},i.reset=function(){r={keydown:{},keyup:{}}},i.destroy=function(){r={keydown:{},keyup:{}},n.removeEventListener("keydown",a,!0),n.removeEventListener("keyup",l,!0)},n.addEventListener("keydown",a,!0),n.addEventListener("keyup",l,!0),i}var Ap=Object.freeze({__proto__:null,default:_p}),Op=function(){function e(t,o){var n=this;Sn(this,e),this.body=t,this.canvas=o,this.iconsCreated=!1,this.navigationHammers=[],this.boundFunctions={},this.touchTime=0,this.activated=!1,this.body.emitter.on("activate",function(){n.activated=!0,n.configureKeyboardBindings()}),this.body.emitter.on("deactivate",function(){n.activated=!1,n.configureKeyboardBindings()}),this.body.emitter.on("destroy",function(){void 0!==n.keycharm&&n.keycharm.destroy()}),this.options={}}return Ln(e,[{key:"setOptions",value:function(e){void 0!==e&&(this.options=e,this.create())}},{key:"create",value:function(){!0===this.options.navigationButtons?!1===this.iconsCreated&&this.loadNavigationElements():!0===this.iconsCreated&&this.cleanNavigation(),this.configureKeyboardBindings()}},{key:"cleanNavigation",value:function(){if(0!=this.navigationHammers.length){for(var e=0;e<this.navigationHammers.length;e++)this.navigationHammers[e].destroy();this.navigationHammers=[]}this.navigationDOM&&this.navigationDOM.wrapper&&this.navigationDOM.wrapper.parentNode&&this.navigationDOM.wrapper.parentNode.removeChild(this.navigationDOM.wrapper),this.iconsCreated=!1}},{key:"loadNavigationElements",value:function(){var e=this;this.cleanNavigation(),this.navigationDOM={};var t=["up","down","left","right","zoomIn","zoomOut","zoomExtends"],o=["_moveUp","_moveDown","_moveLeft","_moveRight","_zoomIn","_zoomOut","_fit"];this.navigationDOM.wrapper=document.createElement("div"),this.navigationDOM.wrapper.className="vis-navigation",this.canvas.frame.appendChild(this.navigationDOM.wrapper);for(var n=0;n<t.length;n++){this.navigationDOM[t[n]]=document.createElement("div"),this.navigationDOM[t[n]].className="vis-button vis-"+t[n],this.navigationDOM.wrapper.appendChild(this.navigationDOM[t[n]]);var i,r,s=new ou(this.navigationDOM[t[n]]);wp(s,"_fit"===o[n]?$(i=this._fit).call(i,this):$(r=this.bindToRedraw).call(r,this,o[n])),this.navigationHammers.push(s)}var a=new ou(this.canvas.frame);xp(a,function(){e._stopMovement()}),this.navigationHammers.push(a),this.iconsCreated=!0}},{key:"bindToRedraw",value:function(e){var t;void 0===this.boundFunctions[e]&&(this.boundFunctions[e]=$(t=this[e]).call(t,this),this.body.emitter.on("initRedraw",this.boundFunctions[e]),this.body.emitter.emit("_startRendering"))}},{key:"unbindFromRedraw",value:function(e){void 0!==this.boundFunctions[e]&&(this.body.emitter.off("initRedraw",this.boundFunctions[e]),this.body.emitter.emit("_stopRendering"),delete this.boundFunctions[e])}},{key:"_fit",value:function(){(new Date).valueOf()-this.touchTime>700&&(this.body.emitter.emit("fit",{duration:700}),this.touchTime=(new Date).valueOf())}},{key:"_stopMovement",value:function(){for(var e in this.boundFunctions)Object.prototype.hasOwnProperty.call(this.boundFunctions,e)&&(this.body.emitter.off("initRedraw",this.boundFunctions[e]),this.body.emitter.emit("_stopRendering"));this.boundFunctions={}}},{key:"_moveUp",value:function(){this.body.view.translation.y+=this.options.keyboard.speed.y}},{key:"_moveDown",value:function(){this.body.view.translation.y-=this.options.keyboard.speed.y}},{key:"_moveLeft",value:function(){this.body.view.translation.x+=this.options.keyboard.speed.x}},{key:"_moveRight",value:function(){this.body.view.translation.x-=this.options.keyboard.speed.x}},{key:"_zoomIn",value:function(){var e=this.body.view.scale*(1+this.options.keyboard.speed.zoom),t=this.body.view.translation,o=e/this.body.view.scale,n=(1-o)*this.canvas.canvasViewCenter.x+t.x*o,i=(1-o)*this.canvas.canvasViewCenter.y+t.y*o;this.body.view.scale=e,this.body.view.translation={x:n,y:i},this.body.emitter.emit("zoom",{direction:"+",scale:this.body.view.scale,pointer:null})}},{key:"_zoomOut",value:function(){var e=this.body.view.scale/(1+this.options.keyboard.speed.zoom),t=this.body.view.translation,o=e/this.body.view.scale,n=(1-o)*this.canvas.canvasViewCenter.x+t.x*o,i=(1-o)*this.canvas.canvasViewCenter.y+t.y*o;this.body.view.scale=e,this.body.view.translation={x:n,y:i},this.body.emitter.emit("zoom",{direction:"-",scale:this.body.view.scale,pointer:null})}},{key:"configureKeyboardBindings",value:function(){var e,t,o,n,i,r,s,a,l,u,c,d,h,p,f,v,g,b,m,y,j,w,x,C,E=this;void 0!==this.keycharm&&this.keycharm.destroy(),!0===this.options.keyboard.enabled&&(this.keycharm=_p(!0===this.options.keyboard.bindToWindow?{container:window,preventDefault:!0}:{container:this.canvas.frame,preventDefault:!0}),this.keycharm.reset(),!0===this.activated&&($(e=this.keycharm).call(e,"up",function(){E.bindToRedraw("_moveUp")},"keydown"),$(t=this.keycharm).call(t,"down",function(){E.bindToRedraw("_moveDown")},"keydown"),$(o=this.keycharm).call(o,"left",function(){E.bindToRedraw("_moveLeft")},"keydown"),$(n=this.keycharm).call(n,"right",function(){E.bindToRedraw("_moveRight")},"keydown"),$(i=this.keycharm).call(i,"=",function(){E.bindToRedraw("_zoomIn")},"keydown"),$(r=this.keycharm).call(r,"num+",function(){E.bindToRedraw("_zoomIn")},"keydown"),$(s=this.keycharm).call(s,"num-",function(){E.bindToRedraw("_zoomOut")},"keydown"),$(a=this.keycharm).call(a,"-",function(){E.bindToRedraw("_zoomOut")},"keydown"),$(l=this.keycharm).call(l,"[",function(){E.bindToRedraw("_zoomOut")},"keydown"),$(u=this.keycharm).call(u,"]",function(){E.bindToRedraw("_zoomIn")},"keydown"),$(c=this.keycharm).call(c,"pageup",function(){E.bindToRedraw("_zoomIn")},"keydown"),$(d=this.keycharm).call(d,"pagedown",function(){E.bindToRedraw("_zoomOut")},"keydown"),$(h=this.keycharm).call(h,"up",function(){E.unbindFromRedraw("_moveUp")},"keyup"),$(p=this.keycharm).call(p,"down",function(){E.unbindFromRedraw("_moveDown")},"keyup"),$(f=this.keycharm).call(f,"left",function(){E.unbindFromRedraw("_moveLeft")},"keyup"),$(v=this.keycharm).call(v,"right",function(){E.unbindFromRedraw("_moveRight")},"keyup"),$(g=this.keycharm).call(g,"=",function(){E.unbindFromRedraw("_zoomIn")},"keyup"),$(b=this.keycharm).call(b,"num+",function(){E.unbindFromRedraw("_zoomIn")},"keyup"),$(m=this.keycharm).call(m,"num-",function(){E.unbindFromRedraw("_zoomOut")},"keyup"),$(y=this.keycharm).call(y,"-",function(){E.unbindFromRedraw("_zoomOut")},"keyup"),$(j=this.keycharm).call(j,"[",function(){E.unbindFromRedraw("_zoomOut")},"keyup"),$(w=this.keycharm).call(w,"]",function(){E.unbindFromRedraw("_zoomIn")},"keyup"),$(x=this.keycharm).call(x,"pageup",function(){E.unbindFromRedraw("_zoomIn")},"keyup"),$(C=this.keycharm).call(C,"pagedown",function(){E.unbindFromRedraw("_zoomOut")},"keyup")))}}]),e}();function Mp(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}var Ip=function(){function e(t,o,n){var i,r,s,a,l,u,c,d,h,p,f,v,g;Sn(this,e),this.body=t,this.canvas=o,this.selectionHandler=n,this.navigationHandler=new Op(t,o),this.body.eventListeners.onTap=$(i=this.onTap).call(i,this),this.body.eventListeners.onTouch=$(r=this.onTouch).call(r,this),this.body.eventListeners.onDoubleTap=$(s=this.onDoubleTap).call(s,this),this.body.eventListeners.onHold=$(a=this.onHold).call(a,this),this.body.eventListeners.onDragStart=$(l=this.onDragStart).call(l,this),this.body.eventListeners.onDrag=$(u=this.onDrag).call(u,this),this.body.eventListeners.onDragEnd=$(c=this.onDragEnd).call(c,this),this.body.eventListeners.onMouseWheel=$(d=this.onMouseWheel).call(d,this),this.body.eventListeners.onPinch=$(h=this.onPinch).call(h,this),this.body.eventListeners.onMouseMove=$(p=this.onMouseMove).call(p,this),this.body.eventListeners.onRelease=$(f=this.onRelease).call(f,this),this.body.eventListeners.onContext=$(v=this.onContext).call(v,this),this.touchTime=0,this.drag={},this.pinch={},this.popup=void 0,this.popupObj=void 0,this.popupTimer=void 0,this.body.functions.getPointer=$(g=this.getPointer).call(g,this),this.options={},this.defaultOptions={dragNodes:!0,dragView:!0,hover:!1,keyboard:{enabled:!1,speed:{x:10,y:10,zoom:.02},bindToWindow:!0},navigationButtons:!1,tooltipDelay:300,zoomView:!0,zoomSpeed:1},me(this.options,this.defaultOptions),this.bindEventListeners()}return Ln(e,[{key:"bindEventListeners",value:function(){var e=this;this.body.emitter.on("destroy",function(){clearTimeout(e.popupTimer),delete e.body.functions.getPointer})}},{key:"setOptions",value:function(e){void 0!==e&&(ml(["hideEdgesOnDrag","hideEdgesOnZoom","hideNodesOnDrag","keyboard","multiselect","selectable","selectConnectedEdges"],this.options,e),Vl(this.options,e,"keyboard"),e.tooltip&&(me(this.options.tooltip,e.tooltip),e.tooltip.color&&(this.options.tooltip.color=Sl(e.tooltip.color)))),this.navigationHandler.setOptions(this.options)}},{key:"getPointer",value:function(e){return{x:e.x-xl(this.canvas.frame.canvas),y:e.y-Cl(this.canvas.frame.canvas)}}},{key:"onTouch",value:function(e){(new Date).valueOf()-this.touchTime>50&&(this.drag.pointer=this.getPointer(e.center),this.drag.pinched=!1,this.pinch.scale=this.body.view.scale,this.touchTime=(new Date).valueOf())}},{key:"onTap",value:function(e){var t=this.getPointer(e.center);this.checkSelectionChanges(t,this.selectionHandler.options.multiselect&&(e.changedPointers[0].ctrlKey||e.changedPointers[0].metaKey)),this.selectionHandler.commitAndEmit(t,e),this.selectionHandler.generateClickEvent("click",e,t)}},{key:"onDoubleTap",value:function(e){var t=this.getPointer(e.center);this.selectionHandler.generateClickEvent("doubleClick",e,t)}},{key:"onHold",value:function(e){var t=this.getPointer(e.center);this.checkSelectionChanges(t,this.selectionHandler.options.multiselect),this.selectionHandler.commitAndEmit(t,e),this.selectionHandler.generateClickEvent("click",e,t),this.selectionHandler.generateClickEvent("hold",e,t)}},{key:"onRelease",value:function(e){if((new Date).valueOf()-this.touchTime>10){var t=this.getPointer(e.center);this.selectionHandler.generateClickEvent("release",e,t),this.touchTime=(new Date).valueOf()}}},{key:"onContext",value:function(e){var t=this.getPointer({x:e.clientX,y:e.clientY});this.selectionHandler.generateClickEvent("oncontext",e,t)}},{key:"checkSelectionChanges",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];!0===t?this.selectionHandler.selectAdditionalOnPoint(e):this.selectionHandler.selectOnPoint(e)}},{key:"_determineDifference",value:function(e,t){var o=function(e,t){for(var o=[],n=0;n<e.length;n++){var i=e[n];-1===ui(t).call(t,i)&&o.push(i)}return o};return{nodes:o(e.nodes,t.nodes),edges:o(e.edges,t.edges)}}},{key:"onDragStart",value:function(e){if(!this.drag.dragging){void 0===this.drag.pointer&&this.onTouch(e);var t=this.selectionHandler.getNodeAt(this.drag.pointer);if(this.drag.dragging=!0,this.drag.selection=[],this.drag.translation=me({},this.body.view.translation),this.drag.nodeId=void 0,e.srcEvent.shiftKey){this.body.selectionBox.show=!0;var o=this.getPointer(e.center);this.body.selectionBox.position.start={x:this.canvas._XconvertDOMtoCanvas(o.x),y:this.canvas._YconvertDOMtoCanvas(o.y)},this.body.selectionBox.position.end={x:this.canvas._XconvertDOMtoCanvas(o.x),y:this.canvas._YconvertDOMtoCanvas(o.y)}}if(void 0!==t&&!0===this.options.dragNodes){this.drag.nodeId=t.id,!1===t.isSelected()&&(this.selectionHandler.unselectAll(),this.selectionHandler.selectObject(t)),this.selectionHandler.generateClickEvent("dragStart",e,this.drag.pointer);var n,i=function(e,t){var o;if(void 0===is||null==nn(e)){if(Gr(e)||(o=function(e,t){var o;if(e){if("string"==typeof e)return Mp(e,t);var n=Zr(o=Object.prototype.toString.call(e)).call(o,8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?gn(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Mp(e,t):void 0}}(e))){o&&(e=o);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){o=on(e)},n:function(){var e=o.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==o.return||o.return()}finally{if(a)throw r}}}}(this.selectionHandler.getSelectedNodes());try{for(i.s();!(n=i.n()).done;){var r=n.value,s={id:r.id,node:r,x:r.x,y:r.y,xFixed:r.options.fixed.x,yFixed:r.options.fixed.y};r.options.fixed.x=!0,r.options.fixed.y=!0,this.drag.selection.push(s)}}catch(e){i.e(e)}finally{i.f()}}else this.selectionHandler.generateClickEvent("dragStart",e,this.drag.pointer,void 0,!0)}}},{key:"onDrag",value:function(e){var t=this;if(!0!==this.drag.pinched){this.body.emitter.emit("unlockNode");var o=this.getPointer(e.center),n=this.drag.selection;if(n&&n.length&&!0===this.options.dragNodes){this.selectionHandler.generateClickEvent("dragging",e,o);var i=o.x-this.drag.pointer.x,r=o.y-this.drag.pointer.y;pr(n).call(n,function(e){var o=e.node;!1===e.xFixed&&(o.x=t.canvas._XconvertDOMtoCanvas(t.canvas._XconvertCanvasToDOM(e.x)+i)),!1===e.yFixed&&(o.y=t.canvas._YconvertDOMtoCanvas(t.canvas._YconvertCanvasToDOM(e.y)+r))}),this.body.emitter.emit("startSimulation")}else{if(e.srcEvent.shiftKey){if(this.selectionHandler.generateClickEvent("dragging",e,o,void 0,!0),void 0===this.drag.pointer)return void this.onDragStart(e);this.body.selectionBox.position.end={x:this.canvas._XconvertDOMtoCanvas(o.x),y:this.canvas._YconvertDOMtoCanvas(o.y)},this.body.emitter.emit("_requestRedraw")}if(!0===this.options.dragView&&!e.srcEvent.shiftKey){if(this.selectionHandler.generateClickEvent("dragging",e,o,void 0,!0),void 0===this.drag.pointer)return void this.onDragStart(e);this.body.view.translation={x:this.drag.translation.x+(o.x-this.drag.pointer.x),y:this.drag.translation.y+(o.y-this.drag.pointer.y)},this.body.emitter.emit("_requestRedraw")}}}}},{key:"onDragEnd",value:function(e){var t=this;if(this.drag.dragging=!1,this.body.selectionBox.show){var o;this.body.selectionBox.show=!1;var n=this.body.selectionBox.position,i={minX:Math.min(n.start.x,n.end.x),minY:Math.min(n.start.y,n.end.y),maxX:Math.max(n.start.x,n.end.x),maxY:Math.max(n.start.y,n.end.y)},r=Si(o=this.body.nodeIndices).call(o,function(e){var o=t.body.nodes[e];return o.x>=i.minX&&o.x<=i.maxX&&o.y>=i.minY&&o.y<=i.maxY});pr(r).call(r,function(e){return t.selectionHandler.selectObject(t.body.nodes[e])});var s=this.getPointer(e.center);this.selectionHandler.commitAndEmit(s,e),this.selectionHandler.generateClickEvent("dragEnd",e,this.getPointer(e.center),void 0,!0),this.body.emitter.emit("_requestRedraw")}else{var a=this.drag.selection;a&&a.length?(pr(a).call(a,function(e){e.node.options.fixed.x=e.xFixed,e.node.options.fixed.y=e.yFixed}),this.selectionHandler.generateClickEvent("dragEnd",e,this.getPointer(e.center)),this.body.emitter.emit("startSimulation")):(this.selectionHandler.generateClickEvent("dragEnd",e,this.getPointer(e.center),void 0,!0),this.body.emitter.emit("_requestRedraw"))}}},{key:"onPinch",value:function(e){var t=this.getPointer(e.center);this.drag.pinched=!0,void 0===this.pinch.scale&&(this.pinch.scale=1),this.zoom(this.pinch.scale*e.scale,t)}},{key:"zoom",value:function(e,t){if(!0===this.options.zoomView){var o=this.body.view.scale;e<1e-5&&(e=1e-5),e>10&&(e=10);var n=void 0;void 0!==this.drag&&!0===this.drag.dragging&&(n=this.canvas.DOMtoCanvas(this.drag.pointer));var i=this.body.view.translation,r=e/o,s=(1-r)*t.x+i.x*r,a=(1-r)*t.y+i.y*r;if(this.body.view.scale=e,this.body.view.translation={x:s,y:a},null!=n){var l=this.canvas.canvasToDOM(n);this.drag.pointer.x=l.x,this.drag.pointer.y=l.y}this.body.emitter.emit("_requestRedraw"),this.body.emitter.emit("zoom",o<e?{direction:"+",scale:this.body.view.scale,pointer:t}:{direction:"-",scale:this.body.view.scale,pointer:t})}}},{key:"onMouseWheel",value:function(e){if(!0===this.options.zoomView){if(0!==e.deltaY){var t=this.body.view.scale;t*=1+.1*this.options.zoomSpeed*(e.deltaY<0?1:-1);var o=this.getPointer({x:e.clientX,y:e.clientY});this.zoom(t,o)}e.preventDefault()}}},{key:"onMouseMove",value:function(e){var t=this,o=this.getPointer({x:e.clientX,y:e.clientY}),n=!1;void 0!==this.popup&&(!1===this.popup.hidden&&this._checkHidePopup(o),!1===this.popup.hidden&&(n=!0,this.popup.setPosition(o.x+3,o.y-5),this.popup.show())),!1===this.options.keyboard.bindToWindow&&!0===this.options.keyboard.enabled&&this.canvas.frame.focus(),!1===n&&(void 0!==this.popupTimer&&(clearInterval(this.popupTimer),this.popupTimer=void 0),this.drag.dragging||(this.popupTimer=En(function(){return t._checkShowPopup(o)},this.options.tooltipDelay))),!0===this.options.hover&&this.selectionHandler.hoverObject(e,o)}},{key:"_checkShowPopup",value:function(e){var t=this.canvas._XconvertDOMtoCanvas(e.x),o=this.canvas._YconvertDOMtoCanvas(e.y),n={left:t,top:o,right:t,bottom:o},i=void 0===this.popupObj?void 0:this.popupObj.id,r=!1,s="node";if(void 0===this.popupObj){for(var a,l=this.body.nodeIndices,u=this.body.nodes,c=[],d=0;d<l.length;d++)!0===(a=u[l[d]]).isOverlappingWith(n)&&(r=!0,void 0!==a.getTitle()&&c.push(l[d]));c.length>0&&(this.popupObj=u[c[c.length-1]],r=!0)}if(void 0===this.popupObj&&!1===r){for(var h,p=this.body.edgeIndices,f=this.body.edges,v=[],g=0;g<p.length;g++)!0===(h=f[p[g]]).isOverlappingWith(n)&&!0===h.connected&&void 0!==h.getTitle()&&v.push(p[g]);v.length>0&&(this.popupObj=f[v[v.length-1]],s="edge")}void 0!==this.popupObj?this.popupObj.id!==i&&(void 0===this.popup&&(this.popup=new nu(this.canvas.frame)),this.popup.popupTargetType=s,this.popup.popupTargetId=this.popupObj.id,this.popup.setPosition(e.x+3,e.y-5),this.popup.setText(this.popupObj.getTitle()),this.popup.show(),this.body.emitter.emit("showPopup",this.popupObj.id)):void 0!==this.popup&&(this.popup.hide(),this.body.emitter.emit("hidePopup"))}},{key:"_checkHidePopup",value:function(e){var t=this.selectionHandler._pointerToPositionObject(e),o=!1;if("node"===this.popup.popupTargetType){if(void 0!==this.body.nodes[this.popup.popupTargetId]&&!0===(o=this.body.nodes[this.popup.popupTargetId].isOverlappingWith(t))){var n=this.selectionHandler.getNodeAt(e);o=void 0!==n&&n.id===this.popup.popupTargetId}}else void 0===this.selectionHandler.getNodeAt(e)&&void 0!==this.body.edges[this.popup.popupTargetId]&&(o=this.body.edges[this.popup.popupTargetId].isOverlappingWith(t));!1===o&&(this.popupObj=void 0,this.popup.hide(),this.body.emitter.emit("hidePopup"))}}]),e}(),Np=Uu.getWeakData,Sp=Rt.set,Tp=Rt.getterFor,Dp=Wt.find,Lp=Wt.findIndex,Fp=0,Rp=function(e){return e.frozen||(e.frozen=new Pp)},Pp=function(){this.entries=[]},Bp=function(e,t){return Dp(e.entries,function(e){return e[0]===t})};Pp.prototype={get:function(e){var t=Bp(this,e);if(t)return t[1]},has:function(e){return!!Bp(this,e)},set:function(e,t){var o=Bp(this,e);o?o[1]=t:this.entries.push([e,t])},delete:function(e){var t=Lp(this.entries,function(t){return t[0]===e});return~t&&this.entries.splice(t,1),!!~t}};var zp,Hp,Wp,Vp,Up,Yp={getConstructor:function(e,t,o,n){var i=e(function(e,r){Xu(e,i,t),Sp(e,{type:t,id:Fp++,frozen:void 0}),null!=r&&qu(r,e[n],{that:e,AS_ENTRIES:o})}),r=Tp(t),s=function(e,t,o){var n=r(e),i=Np(R(t),!0);return!0===i?Rp(n).set(t,o):i[n.id]=o,e};return Zu(i.prototype,{delete:function(e){var t=r(this);if(!b(e))return!1;var o=Np(e);return!0===o?Rp(t).delete(e):o&&j(o,t.id)&&delete o[t.id]},has:function(e){var t=r(this);if(!b(e))return!1;var o=Np(e);return!0===o?Rp(t).has(e):o&&j(o,t.id)}}),Zu(i.prototype,o?{get:function(e){var t=r(this);if(b(e)){var o=Np(e);return!0===o?Rp(t).get(e):o?o[t.id]:void 0}},set:function(e,t){return s(this,e,t)}}:{add:function(e){return s(this,e,!0)}}),i}},qp=(o(function(e){var t,o=Rt.enforce,n=!i.ActiveXObject&&"ActiveXObject"in i,r=Object.isExtensible,s=function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},a=e.exports=Qu("WeakMap",s,Yp);if(Nt&&n){t=Yp.getConstructor(s,"WeakMap",!0),Uu.REQUIRED=!0;var l=a.prototype,u=l.delete,c=l.has,d=l.get,h=l.set;Zu(l,{delete:function(e){if(b(e)&&!r(e)){var n=o(this);return n.frozen||(n.frozen=new t),u.call(this,e)||n.frozen.delete(e)}return u.call(this,e)},has:function(e){if(b(e)&&!r(e)){var n=o(this);return n.frozen||(n.frozen=new t),c.call(this,e)||n.frozen.has(e)}return c.call(this,e)},get:function(e){if(b(e)&&!r(e)){var n=o(this);return n.frozen||(n.frozen=new t),c.call(this,e)?d.call(this,e):n.frozen.get(e)}return d.call(this,e)},set:function(e,n){if(b(e)&&!r(e)){var i=o(this);i.frozen||(i.frozen=new t),c.call(this,e)?h.call(this,e,n):i.frozen.set(e,n)}else h.call(this,e,n);return this}})}}),D.WeakMap);function Xp(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)}function Gp(e,t,o){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,o),o}function Kp(e,t){var o;if(void 0===is||null==nn(e)){if(Gr(e)||(o=function(e,t){var o;if(e){if("string"==typeof e)return Jp(e,t);var n=Zr(o=Object.prototype.toString.call(e)).call(o,8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?gn(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Jp(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){o&&(e=o);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){o=on(e)},n:function(){var e=o.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==o.return||o.return()}finally{if(a)throw r}}}}function Jp(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}function $p(e,t){var o,n=new Kc,i=Kp(t);try{for(i.s();!(o=i.n()).done;){var r=o.value;e.has(r)||n.add(r)}}catch(e){i.e(e)}finally{i.f()}return n}var Qp=function(){function e(){Sn(this,e),zp.set(this,new Kc),Hp.set(this,new Kc)}return Ln(e,[{key:"add",value:function(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];for(var n=0,i=t;n<i.length;n++){var r=i[n];Xp(this,Hp).add(r)}}},{key:"delete",value:function(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];for(var n=0,i=t;n<i.length;n++){var r=i[n];Xp(this,Hp).delete(r)}}},{key:"clear",value:function(){Xp(this,Hp).clear()}},{key:"getSelection",value:function(){return es(Xp(this,Hp))}},{key:"getChanges",value:function(){return{added:es($p(Xp(this,zp),Xp(this,Hp))),deleted:es($p(Xp(this,Hp),Xp(this,zp))),previous:es(new Kc(Xp(this,zp))),current:es(new Kc(Xp(this,Hp)))}}},{key:"commit",value:function(){var e=this.getChanges();Gp(this,zp,Xp(this,Hp)),Gp(this,Hp,new Kc(Xp(this,zp)));var t,o=Kp(e.added);try{for(o.s();!(t=o.n()).done;)t.value.select()}catch(e){o.e(e)}finally{o.f()}var n,i=Kp(e.deleted);try{for(i.s();!(n=i.n()).done;)n.value.unselect()}catch(e){i.e(e)}finally{i.f()}return e}},{key:"size",get:function(){return Xp(this,Hp).size}}]),e}();zp=new qp,Hp=new qp;var Zp=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){};Sn(this,e),Wp.set(this,new Qp),Vp.set(this,new Qp),Up.set(this,void 0),Gp(this,Up,t)}return Ln(e,[{key:"getNodes",value:function(){return Xp(this,Wp).getSelection()}},{key:"getEdges",value:function(){return Xp(this,Vp).getSelection()}},{key:"addNodes",value:function(){var e;(e=Xp(this,Wp)).add.apply(e,arguments)}},{key:"addEdges",value:function(){var e;(e=Xp(this,Vp)).add.apply(e,arguments)}},{key:"deleteNodes",value:function(e){Xp(this,Wp).delete(e)}},{key:"deleteEdges",value:function(e){Xp(this,Vp).delete(e)}},{key:"clear",value:function(){Xp(this,Wp).clear(),Xp(this,Vp).clear()}},{key:"commit",value:function(){for(var e,t,o={nodes:Xp(this,Wp).commit(),edges:Xp(this,Vp).commit()},n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(e=Xp(this,Up)).call.apply(e,ns(t=[this,o]).call(t,i)),o}},{key:"sizeNodes",get:function(){return Xp(this,Wp).size}},{key:"sizeEdges",get:function(){return Xp(this,Vp).size}}]),e}();function ef(e,t){var o;if(void 0===is||null==nn(e)){if(Gr(e)||(o=function(e,t){var o;if(e){if("string"==typeof e)return tf(e,t);var n=Zr(o=Object.prototype.toString.call(e)).call(o,8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?gn(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?tf(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){o&&(e=o);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){o=on(e)},n:function(){var e=o.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==o.return||o.return()}finally{if(a)throw r}}}}function tf(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}Wp=new qp,Vp=new qp,Up=new qp;var of,nf=function(){function e(t,o){var n=this;Sn(this,e),this.body=t,this.canvas=o,this._selectionAccumulator=new Zp,this.hoverObj={nodes:{},edges:{}},this.options={},this.defaultOptions={multiselect:!1,selectable:!0,selectConnectedEdges:!0,hoverConnectedEdges:!0},me(this.options,this.defaultOptions),this.body.emitter.on("_dataChanged",function(){n.updateSelection()})}return Ln(e,[{key:"setOptions",value:function(e){void 0!==e&&bl(["multiselect","hoverConnectedEdges","selectable","selectConnectedEdges"],this.options,e)}},{key:"selectOnPoint",value:function(e){var t=!1;if(!0===this.options.selectable){var o=this.getNodeAt(e)||this.getEdgeAt(e);this.unselectAll(),void 0!==o&&(t=this.selectObject(o)),this.body.emitter.emit("_requestRedraw")}return t}},{key:"selectAdditionalOnPoint",value:function(e){var t=!1;if(!0===this.options.selectable){var o=this.getNodeAt(e)||this.getEdgeAt(e);void 0!==o&&(t=!0,!0===o.isSelected()?this.deselectObject(o):this.selectObject(o),this.body.emitter.emit("_requestRedraw"))}return t}},{key:"_initBaseEvent",value:function(e,t){var o={};return o.pointer={DOM:{x:t.x,y:t.y},canvas:this.canvas.DOMtoCanvas(t)},o.event=e,o}},{key:"generateClickEvent",value:function(e,t,o,n){var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],r=this._initBaseEvent(t,o);if(!0===i)r.nodes=[],r.edges=[];else{var s=this.getSelection();r.nodes=s.nodes,r.edges=s.edges}void 0!==n&&(r.previousSelection=n),"click"==e&&(r.items=this.getClickedItems(o)),void 0!==t.controlEdge&&(r.controlEdge=t.controlEdge),this.body.emitter.emit(e,r)}},{key:"selectObject",value:function(e){var t,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.options.selectConnectedEdges;return void 0!==e&&(e instanceof wh?(!0===o&&(t=this._selectionAccumulator).addEdges.apply(t,es(e.edges)),this._selectionAccumulator.addNodes(e)):this._selectionAccumulator.addEdges(e),!0)}},{key:"deselectObject",value:function(e){!0===e.isSelected()&&(e.selected=!1,this._removeFromSelection(e))}},{key:"_getAllNodesOverlappingWith",value:function(e){for(var t=[],o=this.body.nodes,n=0;n<this.body.nodeIndices.length;n++){var i=this.body.nodeIndices[n];o[i].isOverlappingWith(e)&&t.push(i)}return t}},{key:"_pointerToPositionObject",value:function(e){var t=this.canvas.DOMtoCanvas(e);return{left:t.x-1,top:t.y+1,right:t.x+1,bottom:t.y-1}}},{key:"getNodeAt",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=this._pointerToPositionObject(e),n=this._getAllNodesOverlappingWith(o);return n.length>0?!0===t?this.body.nodes[n[n.length-1]]:n[n.length-1]:void 0}},{key:"_getEdgesOverlappingWith",value:function(e,t){for(var o=this.body.edges,n=0;n<this.body.edgeIndices.length;n++){var i=this.body.edgeIndices[n];o[i].isOverlappingWith(e)&&t.push(i)}}},{key:"_getAllEdgesOverlappingWith",value:function(e){var t=[];return this._getEdgesOverlappingWith(e,t),t}},{key:"getEdgeAt",value:function(e){for(var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=this.canvas.DOMtoCanvas(e),n=10,i=null,r=this.body.edges,s=0;s<this.body.edgeIndices.length;s++){var a=this.body.edgeIndices[s],l=r[a];if(l.connected){var u=l.from.x,c=l.from.y,d=l.to.x,h=l.to.y,p=l.edgeType.getDistanceToEdge(u,c,d,h,o.x,o.y);p<n&&(i=a,n=p)}}return null!==i?!0===t?this.body.edges[i]:i:void 0}},{key:"_addToHover",value:function(e){e instanceof wh?this.hoverObj.nodes[e.id]=e:this.hoverObj.edges[e.id]=e}},{key:"_removeFromSelection",value:function(e){var t;e instanceof wh?(this._selectionAccumulator.deleteNodes(e),(t=this._selectionAccumulator).deleteEdges.apply(t,es(e.edges))):this._selectionAccumulator.deleteEdges(e)}},{key:"unselectAll",value:function(){this._selectionAccumulator.clear(),this._selectionAccumulator.commit()}},{key:"getSelectedNodeCount",value:function(){return this._selectionAccumulator.sizeNodes}},{key:"getSelectedEdgeCount",value:function(){return this._selectionAccumulator.sizeEdges}},{key:"_hoverConnectedEdges",value:function(e){for(var t=0;t<e.edges.length;t++){var o=e.edges[t];o.hover=!0,this._addToHover(o)}}},{key:"emitBlurEvent",value:function(e,t,o){var n=this._initBaseEvent(e,t);!0===o.hover&&(o.hover=!1,o instanceof wh?(n.node=o.id,this.body.emitter.emit("blurNode",n)):(n.edge=o.id,this.body.emitter.emit("blurEdge",n)))}},{key:"emitHoverEvent",value:function(e,t,o){var n=this._initBaseEvent(e,t),i=!1;return!1===o.hover&&(o.hover=!0,this._addToHover(o),i=!0,o instanceof wh?(n.node=o.id,this.body.emitter.emit("hoverNode",n)):(n.edge=o.id,this.body.emitter.emit("hoverEdge",n))),i}},{key:"hoverObject",value:function(e,t){var o=this.getNodeAt(t);void 0===o&&(o=this.getEdgeAt(t));var n=!1;for(var i in this.hoverObj.nodes)Object.prototype.hasOwnProperty.call(this.hoverObj.nodes,i)&&(void 0===o||o instanceof wh&&o.id!=i||o instanceof np)&&(this.emitBlurEvent(e,t,this.hoverObj.nodes[i]),delete this.hoverObj.nodes[i],n=!0);for(var r in this.hoverObj.edges)Object.prototype.hasOwnProperty.call(this.hoverObj.edges,r)&&(!0===n?(this.hoverObj.edges[r].hover=!1,delete this.hoverObj.edges[r]):(void 0===o||o instanceof np&&o.id!=r||o instanceof wh&&!o.hover)&&(this.emitBlurEvent(e,t,this.hoverObj.edges[r]),delete this.hoverObj.edges[r],n=!0));if(void 0!==o){var s=Hr(this.hoverObj.edges).length,a=Hr(this.hoverObj.nodes).length;(n||o instanceof np&&0===s&&0===a||o instanceof wh&&0===s&&0===a)&&(n=this.emitHoverEvent(e,t,o)),o instanceof wh&&!0===this.options.hoverConnectedEdges&&this._hoverConnectedEdges(o)}!0===n&&this.body.emitter.emit("_requestRedraw")}},{key:"commitAndEmit",value:function(e,t){var o=!1,n=this._selectionAccumulator.commit(),i={nodes:n.nodes.previous,edges:n.edges.previous};n.edges.deleted.length>0&&(this.generateClickEvent("deselectEdge",t,e,i),o=!0),n.nodes.deleted.length>0&&(this.generateClickEvent("deselectNode",t,e,i),o=!0),n.nodes.added.length>0&&(this.generateClickEvent("selectNode",t,e),o=!0),n.edges.added.length>0&&(this.generateClickEvent("selectEdge",t,e),o=!0),!0===o&&this.generateClickEvent("select",t,e)}},{key:"getSelection",value:function(){return{nodes:this.getSelectedNodeIds(),edges:this.getSelectedEdgeIds()}}},{key:"getSelectedNodes",value:function(){return this._selectionAccumulator.getNodes()}},{key:"getSelectedEdges",value:function(){return this._selectionAccumulator.getEdges()}},{key:"getSelectedNodeIds",value:function(){var e;return Xr(e=this._selectionAccumulator.getNodes()).call(e,function(e){return e.id})}},{key:"getSelectedEdgeIds",value:function(){var e;return Xr(e=this._selectionAccumulator.getEdges()).call(e,function(e){return e.id})}},{key:"setSelection",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e||!e.nodes&&!e.edges)throw new TypeError("Selection must be an object with nodes and/or edges properties");if((t.unselectAll||void 0===t.unselectAll)&&this.unselectAll(),e.nodes){var o,n=ef(e.nodes);try{for(n.s();!(o=n.n()).done;){var i=o.value,r=this.body.nodes[i];if(!r)throw new RangeError('Node with id "'+i+'" not found');this.selectObject(r,t.highlightEdges)}}catch(e){n.e(e)}finally{n.f()}}if(e.edges){var s,a=ef(e.edges);try{for(a.s();!(s=a.n()).done;){var l=s.value,u=this.body.edges[l];if(!u)throw new RangeError('Edge with id "'+l+'" not found');this.selectObject(u)}}catch(e){a.e(e)}finally{a.f()}}this.body.emitter.emit("_requestRedraw"),this._selectionAccumulator.commit()}},{key:"selectNodes",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!e||void 0===e.length)throw"Selection must be an array with ids";this.setSelection({nodes:e},{highlightEdges:t})}},{key:"selectEdges",value:function(e){if(!e||void 0===e.length)throw"Selection must be an array with ids";this.setSelection({edges:e})}},{key:"updateSelection",value:function(){for(var e in this._selectionAccumulator.getNodes())Object.prototype.hasOwnProperty.call(this.body.nodes,e.id)||this._selectionAccumulator.deleteNodes(e);for(var t in this._selectionAccumulator.getEdges())Object.prototype.hasOwnProperty.call(this.body.edges,t.id)||this._selectionAccumulator.deleteEdges(t)}},{key:"getClickedItems",value:function(e){for(var t=this.canvas.DOMtoCanvas(e),o=[],n=this.body.nodeIndices,i=this.body.nodes,r=n.length-1;r>=0;r--){var s=i[n[r]].getItemsOnPoint(t);o.push.apply(o,s)}for(var a=this.body.edgeIndices,l=this.body.edges,u=a.length-1;u>=0;u--){var c=l[a[u]].getItemsOnPoint(t);o.push.apply(o,c)}return o}}]),e}(),rf=o(function(e,t){!function(e){e.__esModule=!0,e.sort=function(e,t,o,s){if(!Array.isArray(e))throw new TypeError("Can only sort arrays");t?"function"!=typeof t&&(s=o,o=t,t=n):t=n,o||(o=0),s||(s=e.length);var a=s-o;if(!(a<2)){var u=0;if(a<32)r(e,o,s,o+(u=i(e,o,s,t)),t);else{var c=new l(e,t),d=function(e){for(var t=0;e>=32;)t|=1&e,e>>=1;return e+t}(a);do{if((u=i(e,o,s,t))<d){var h=a;h>d&&(h=d),r(e,o,o+h,o+u,t),u=h}c.pushRun(o,u),c.mergeRuns(),a-=u,o+=u}while(0!==a);c.forceMergeRuns()}}};var t=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9];function o(e){return e<1e5?e<100?e<10?0:1:e<1e4?e<1e3?2:3:4:e<1e7?e<1e6?5:6:e<1e9?e<1e8?7:8:9}function n(e,n){if(e===n)return 0;if(~~e===e&&~~n===n){if(0===e||0===n)return e<n?-1:1;if(e<0||n<0){if(n>=0)return-1;if(e>=0)return 1;e=-e,n=-n}var i=o(e),r=o(n),s=0;return i<r?(e*=t[r-i-1],n/=10,s=-1):i>r&&(n*=t[i-r-1],e/=10,s=1),e===n?s:e<n?-1:1}var a=String(e),l=String(n);return a===l?0:a<l?-1:1}function i(e,t,o,n){var i=t+1;if(i===o)return 1;if(n(e[i++],e[t])<0){for(;i<o&&n(e[i],e[i-1])<0;)i++;!function(e,t,o){for(o--;t<o;){var n=e[t];e[t++]=e[o],e[o--]=n}}(e,t,i)}else for(;i<o&&n(e[i],e[i-1])>=0;)i++;return i-t}function r(e,t,o,n,i){for(n===t&&n++;n<o;n++){for(var r=e[n],s=t,a=n;s<a;){var l=s+a>>>1;i(r,e[l])<0?a=l:s=l+1}var u=n-s;switch(u){case 3:e[s+3]=e[s+2];case 2:e[s+2]=e[s+1];case 1:e[s+1]=e[s];break;default:for(;u>0;)e[s+u]=e[s+u-1],u--}e[s]=r}}function s(e,t,o,n,i,r){var s=0,a=0,l=1;if(r(e,t[o+i])>0){for(a=n-i;l<a&&r(e,t[o+i+l])>0;)s=l,(l=1+(l<<1))<=0&&(l=a);l>a&&(l=a),s+=i,l+=i}else{for(a=i+1;l<a&&r(e,t[o+i-l])<=0;)s=l,(l=1+(l<<1))<=0&&(l=a);l>a&&(l=a);var u=s;s=i-l,l=i-u}for(s++;s<l;){var c=s+(l-s>>>1);r(e,t[o+c])>0?s=c+1:l=c}return l}function a(e,t,o,n,i,r){var s=0,a=0,l=1;if(r(e,t[o+i])<0){for(a=i+1;l<a&&r(e,t[o+i-l])<0;)s=l,(l=1+(l<<1))<=0&&(l=a);l>a&&(l=a);var u=s;s=i-l,l=i-u}else{for(a=n-i;l<a&&r(e,t[o+i+l])>=0;)s=l,(l=1+(l<<1))<=0&&(l=a);l>a&&(l=a),s+=i,l+=i}for(s++;s<l;){var c=s+(l-s>>>1);r(e,t[o+c])<0?l=c:s=c+1}return l}var l=function(){function e(t,o){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.array=null,this.compare=null,this.minGallop=7,this.length=0,this.tmpStorageLength=256,this.stackLength=0,this.runStart=null,this.runLength=null,this.stackSize=0,this.array=t,this.compare=o,this.length=t.length,this.length<512&&(this.tmpStorageLength=this.length>>>1),this.tmp=new Array(this.tmpStorageLength),this.stackLength=this.length<120?5:this.length<1542?10:this.length<119151?19:40,this.runStart=new Array(this.stackLength),this.runLength=new Array(this.stackLength)}return e.prototype.pushRun=function(e,t){this.runStart[this.stackSize]=e,this.runLength[this.stackSize]=t,this.stackSize+=1},e.prototype.mergeRuns=function(){for(;this.stackSize>1;){var e=this.stackSize-2;if(e>=1&&this.runLength[e-1]<=this.runLength[e]+this.runLength[e+1]||e>=2&&this.runLength[e-2]<=this.runLength[e]+this.runLength[e-1])this.runLength[e-1]<this.runLength[e+1]&&e--;else if(this.runLength[e]>this.runLength[e+1])break;this.mergeAt(e)}},e.prototype.forceMergeRuns=function(){for(;this.stackSize>1;){var e=this.stackSize-2;e>0&&this.runLength[e-1]<this.runLength[e+1]&&e--,this.mergeAt(e)}},e.prototype.mergeAt=function(e){var t=this.compare,o=this.array,n=this.runStart[e],i=this.runLength[e],r=this.runStart[e+1],l=this.runLength[e+1];this.runLength[e]=i+l,e===this.stackSize-3&&(this.runStart[e+1]=this.runStart[e+2],this.runLength[e+1]=this.runLength[e+2]),this.stackSize--;var u=a(o[r],o,n,i,0,t);n+=u,0!=(i-=u)&&0!==(l=s(o[n+i-1],o,r,l,l-1,t))&&(i<=l?this.mergeLow(n,i,r,l):this.mergeHigh(n,i,r,l))},e.prototype.mergeLow=function(e,t,o,n){var i=this.compare,r=this.array,l=this.tmp,u=0;for(u=0;u<t;u++)l[u]=r[e+u];var c=0,d=o,h=e;if(r[h++]=r[d++],0!=--n)if(1!==t){for(var p=this.minGallop;;){var f=0,v=0,g=!1;do{if(i(r[d],l[c])<0){if(r[h++]=r[d++],v++,f=0,0==--n){g=!0;break}}else if(r[h++]=l[c++],f++,v=0,1==--t){g=!0;break}}while((f|v)<p);if(g)break;do{if(0!==(f=a(r[d],l,c,t,0,i))){for(u=0;u<f;u++)r[h+u]=l[c+u];if(h+=f,c+=f,(t-=f)<=1){g=!0;break}}if(r[h++]=r[d++],0==--n){g=!0;break}if(0!==(v=s(l[c],r,d,n,0,i))){for(u=0;u<v;u++)r[h+u]=r[d+u];if(h+=v,d+=v,0==(n-=v)){g=!0;break}}if(r[h++]=l[c++],1==--t){g=!0;break}p--}while(f>=7||v>=7);if(g)break;p<0&&(p=0),p+=2}if(this.minGallop=p,p<1&&(this.minGallop=1),1===t){for(u=0;u<n;u++)r[h+u]=r[d+u];r[h+n]=l[c]}else{if(0===t)throw new Error("mergeLow preconditions were not respected");for(u=0;u<t;u++)r[h+u]=l[c+u]}}else{for(u=0;u<n;u++)r[h+u]=r[d+u];r[h+n]=l[c]}else for(u=0;u<t;u++)r[h+u]=l[c+u]},e.prototype.mergeHigh=function(e,t,o,n){var i=this.compare,r=this.array,l=this.tmp,u=0;for(u=0;u<n;u++)l[u]=r[o+u];var c=e+t-1,d=n-1,h=o+n-1,p=0,f=0;if(r[h--]=r[c--],0!=--t)if(1!==n){for(var v=this.minGallop;;){var g=0,b=0,m=!1;do{if(i(l[d],r[c])<0){if(r[h--]=r[c--],g++,b=0,0==--t){m=!0;break}}else if(r[h--]=l[d--],b++,g=0,1==--n){m=!0;break}}while((g|b)<v);if(m)break;do{if(0!=(g=t-a(l[d],r,e,t,t-1,i))){for(t-=g,f=1+(h-=g),p=1+(c-=g),u=g-1;u>=0;u--)r[f+u]=r[p+u];if(0===t){m=!0;break}}if(r[h--]=l[d--],1==--n){m=!0;break}if(0!=(b=n-s(r[c],l,0,n,n-1,i))){for(n-=b,f=1+(h-=b),p=1+(d-=b),u=0;u<b;u++)r[f+u]=l[p+u];if(n<=1){m=!0;break}}if(r[h--]=r[c--],0==--t){m=!0;break}v--}while(g>=7||b>=7);if(m)break;v<0&&(v=0),v+=2}if(this.minGallop=v,v<1&&(this.minGallop=1),1===n){for(f=1+(h-=t),p=1+(c-=t),u=t-1;u>=0;u--)r[f+u]=r[p+u];r[h]=l[d]}else{if(0===n)throw new Error("mergeHigh preconditions were not respected");for(p=h-(n-1),u=0;u<n;u++)r[p+u]=l[u]}}else{for(f=1+(h-=t),p=1+(c-=t),u=t-1;u>=0;u--)r[f+u]=r[p+u];r[h]=l[d]}else for(p=h-(n-1),u=0;u<n;u++)r[p+u]=l[u]},e}()}(t)});(of=rf)&&of.__esModule&&Object.prototype.hasOwnProperty.call(of,"default");var sf=rf,af=sf.sort;function lf(e){var t=function(){if("undefined"==typeof Reflect||!xc)return!1;if(xc.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(xc(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var o,n=zc(e);if(t){var i=zc(this).constructor;o=xc(n,arguments,i)}else o=n.apply(this,arguments);return Pc(this,o)}}var uf=function(){function e(){Sn(this,e)}return Ln(e,[{key:"abstract",value:function(){throw new Error("Can't instantiate abstract class!")}},{key:"fake_use",value:function(){}},{key:"curveType",value:function(){return this.abstract()}},{key:"getPosition",value:function(e){return this.fake_use(e),this.abstract()}},{key:"setPosition",value:function(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;this.fake_use(e,t,o),this.abstract()}},{key:"getTreeSize",value:function(e){return this.fake_use(e),this.abstract()}},{key:"sort",value:function(e){this.fake_use(e),this.abstract()}},{key:"fix",value:function(e,t){this.fake_use(e,t),this.abstract()}},{key:"shift",value:function(e,t){this.fake_use(e,t),this.abstract()}}]),e}(),cf=function(e){Rc(o,e);var t=lf(o);function o(e){var n;return Sn(this,o),(n=t.call(this)).layout=e,n}return Ln(o,[{key:"curveType",value:function(){return"horizontal"}},{key:"getPosition",value:function(e){return e.x}},{key:"setPosition",value:function(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;void 0!==o&&this.layout.hierarchical.addToOrdering(e,o),e.x=t}},{key:"getTreeSize",value:function(e){var t=this.layout.hierarchical.getTreeSize(this.layout.body.nodes,e);return{min:t.min_x,max:t.max_x}}},{key:"sort",value:function(e){af(e,function(e,t){return e.x-t.x})}},{key:"fix",value:function(e,t){e.y=this.layout.options.hierarchical.levelSeparation*t,e.options.fixed.y=!0}},{key:"shift",value:function(e,t){this.layout.body.nodes[e].x+=t}}]),o}(uf),df=function(e){Rc(o,e);var t=lf(o);function o(e){var n;return Sn(this,o),(n=t.call(this)).layout=e,n}return Ln(o,[{key:"curveType",value:function(){return"vertical"}},{key:"getPosition",value:function(e){return e.y}},{key:"setPosition",value:function(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;void 0!==o&&this.layout.hierarchical.addToOrdering(e,o),e.y=t}},{key:"getTreeSize",value:function(e){var t=this.layout.hierarchical.getTreeSize(this.layout.body.nodes,e);return{min:t.min_y,max:t.max_y}}},{key:"sort",value:function(e){af(e,function(e,t){return e.y-t.y})}},{key:"fix",value:function(e,t){e.x=this.layout.options.hierarchical.levelSeparation*t,e.options.fixed.x=!0}},{key:"shift",value:function(e,t){this.layout.body.nodes[e].y+=t}}]),o}(uf),hf=Wt.every,pf=$n("every"),ff=ti("every");V({target:"Array",proto:!0,forced:!pf||!ff},{every:function(e){return hf(this,e,arguments.length>1?arguments[1]:void 0)}});var vf=G("Array").every,gf=Array.prototype,bf=function(e){var t=e.every;return e===gf||e instanceof Array&&t===gf.every?vf:t};function mf(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}function yf(e,t){var o=new Kc;return pr(e).call(e,function(e){var t;pr(t=e.edges).call(t,function(e){e.connected&&o.add(e)})}),pr(o).call(o,function(e){var o=e.from.id,n=e.to.id;null==t[o]&&(t[o]=0),(null==t[n]||t[o]>=t[n])&&(t[n]=t[o]+1)}),t}function jf(e,t,o,n){var i,r,s=Bn(null),a=dd(i=es(Mc(n).call(n))).call(i,function(e,t){return e+1+t.edges.length},0),l=o+"Id",u="to"===o?1:-1,c=function(e,t){var o;if(void 0===is||null==nn(e)){if(Gr(e)||(o=function(e,t){var o;if(e){if("string"==typeof e)return mf(e,t);var n=Zr(o=Object.prototype.toString.call(e)).call(o,8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?gn(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?mf(e,t):void 0}}(e))){o&&(e=o);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){o=on(e)},n:function(){var e=o.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==o.return||o.return()}finally{if(a)throw r}}}}(n);try{var d=function(){var i=Pr(r.value,2),c=i[0],d=i[1];if(!n.has(c)||!e(d))return"continue";s[c]=0;for(var h=[d],p=0,f=void 0,v=function(){var e,i;if(!n.has(c))return"continue";var r=s[f.id]+u;if(pr(e=Si(i=f.edges).call(i,function(e){return e.connected&&e.to!==e.from&&e[o]!==f&&n.has(e.toId)&&n.has(e.fromId)})).call(e,function(e){var n=e[l],i=s[n];(null==i||t(r,i))&&(s[n]=r,h.push(e[o]))}),p>a)return{v:{v:yf(n,s)}};++p};f=h.pop();){var g=v();if("continue"!==g&&"object"===$r(g))return g.v}};for(c.s();!(r=c.n()).done;){var h=d();if("continue"!==h&&"object"===$r(h))return h.v}}catch(e){c.e(e)}finally{c.f()}return s}var wf=function(){function e(){Sn(this,e),this.childrenReference={},this.parentReference={},this.trees={},this.distributionOrdering={},this.levels={},this.distributionIndex={},this.isTree=!1,this.treeIndex=-1}return Ln(e,[{key:"addRelation",value:function(e,t){void 0===this.childrenReference[e]&&(this.childrenReference[e]=[]),this.childrenReference[e].push(t),void 0===this.parentReference[t]&&(this.parentReference[t]=[]),this.parentReference[t].push(e)}},{key:"checkIfTree",value:function(){for(var e in this.parentReference)if(this.parentReference[e].length>1)return void(this.isTree=!1);this.isTree=!0}},{key:"numTrees",value:function(){return this.treeIndex+1}},{key:"setTreeIndex",value:function(e,t){void 0!==t&&void 0===this.trees[e.id]&&(this.trees[e.id]=t,this.treeIndex=Math.max(t,this.treeIndex))}},{key:"ensureLevel",value:function(e){void 0===this.levels[e]&&(this.levels[e]=0)}},{key:"getMaxLevel",value:function(e){var t=this,o={};return function e(n){if(void 0!==o[n])return o[n];var i=t.levels[n];if(t.childrenReference[n]){var r=t.childrenReference[n];if(r.length>0)for(var s=0;s<r.length;s++)i=Math.max(i,e(r[s]))}return o[n]=i,i}(e)}},{key:"levelDownstream",value:function(e,t){void 0===this.levels[t.id]&&(void 0===this.levels[e.id]&&(this.levels[e.id]=0),this.levels[t.id]=this.levels[e.id]+1)}},{key:"setMinLevelToZero",value:function(e){var t=1e9;for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&void 0!==this.levels[o]&&(t=Math.min(this.levels[o],t));for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&void 0!==this.levels[n]&&(this.levels[n]-=t)}},{key:"getTreeSize",value:function(e,t){var o=1e9,n=-1e9,i=1e9,r=-1e9;for(var s in this.trees)if(Object.prototype.hasOwnProperty.call(this.trees,s)&&this.trees[s]===t){var a=e[s];o=Math.min(a.x,o),n=Math.max(a.x,n),i=Math.min(a.y,i),r=Math.max(a.y,r)}return{min_x:o,max_x:n,min_y:i,max_y:r}}},{key:"hasSameParent",value:function(e,t){var o=this.parentReference[e.id],n=this.parentReference[t.id];if(void 0===o||void 0===n)return!1;for(var i=0;i<o.length;i++)for(var r=0;r<n.length;r++)if(o[i]==n[r])return!0;return!1}},{key:"inSameSubNetwork",value:function(e,t){return this.trees[e.id]===this.trees[t.id]}},{key:"getLevels",value:function(){return Hr(this.distributionOrdering)}},{key:"addToOrdering",value:function(e,t){void 0===this.distributionOrdering[t]&&(this.distributionOrdering[t]=[]);var o=!1,n=this.distributionOrdering[t];for(var i in n)if(n[i]===e){o=!0;break}o||(this.distributionOrdering[t].push(e),this.distributionIndex[e.id]=this.distributionOrdering[t].length-1)}}]),e}(),xf=function(){function e(t){Sn(this,e),this.body=t,this._resetRNG(Math.random()+":"+Br()),this.setPhysics=!1,this.options={},this.optionsBackup={physics:{}},this.defaultOptions={randomSeed:void 0,improvedLayout:!0,clusterThreshold:150,hierarchical:{enabled:!1,levelSeparation:150,nodeSpacing:100,treeSpacing:200,blockShifting:!0,edgeMinimization:!0,parentCentralization:!0,direction:"UD",sortMethod:"hubsize"}},me(this.options,this.defaultOptions),this.bindEventListeners()}return Ln(e,[{key:"bindEventListeners",value:function(){var e=this;this.body.emitter.on("_dataChanged",function(){e.setupHierarchicalLayout()}),this.body.emitter.on("_dataLoaded",function(){e.layoutNetwork()}),this.body.emitter.on("_resetHierarchicalLayout",function(){e.setupHierarchicalLayout()}),this.body.emitter.on("_adjustEdgesForHierarchicalLayout",function(){if(!0===e.options.hierarchical.enabled){var t=e.direction.curveType();e.body.emitter.emit("_forceDisableDynamicCurves",t,!1)}})}},{key:"setOptions",value:function(e,t){if(void 0!==e){var o=this.options.hierarchical,n=o.enabled;if(bl(["randomSeed","improvedLayout","clusterThreshold"],this.options,e),Vl(this.options,e,"hierarchical"),void 0!==e.randomSeed&&this._resetRNG(e.randomSeed),!0===o.enabled)return!0===n&&this.body.emitter.emit("refresh",!0),"RL"===o.direction||"DU"===o.direction?o.levelSeparation>0&&(o.levelSeparation*=-1):o.levelSeparation<0&&(o.levelSeparation*=-1),this.setDirectionStrategy(),this.body.emitter.emit("_resetHierarchicalLayout"),this.adaptAllOptionsForHierarchicalLayout(t);if(!0===n)return this.body.emitter.emit("refresh"),yl(t,this.optionsBackup)}return t}},{key:"_resetRNG",value:function(e){this.initialRandomSeed=e,this._rng=el(this.initialRandomSeed)}},{key:"adaptAllOptionsForHierarchicalLayout",value:function(e){if(!0===this.options.hierarchical.enabled){var t=this.optionsBackup.physics;void 0===e.physics||!0===e.physics?(e.physics={enabled:void 0===t.enabled||t.enabled,solver:"hierarchicalRepulsion"},t.enabled=void 0===t.enabled||t.enabled,t.solver=t.solver||"barnesHut"):"object"===$r(e.physics)?(t.enabled=void 0===e.physics.enabled||e.physics.enabled,t.solver=e.physics.solver||"barnesHut",e.physics.solver="hierarchicalRepulsion"):!1!==e.physics&&(t.solver="barnesHut",e.physics={solver:"hierarchicalRepulsion"});var o=this.direction.curveType();if(void 0===e.edges)this.optionsBackup.edges={smooth:{enabled:!0,type:"dynamic"}},e.edges={smooth:!1};else if(void 0===e.edges.smooth)this.optionsBackup.edges={smooth:{enabled:!0,type:"dynamic"}},e.edges.smooth=!1;else if("boolean"==typeof e.edges.smooth)this.optionsBackup.edges={smooth:e.edges.smooth},e.edges.smooth={enabled:e.edges.smooth,type:o};else{var n=e.edges.smooth;void 0!==n.type&&"dynamic"!==n.type&&(o=n.type),this.optionsBackup.edges={smooth:{enabled:void 0===n.enabled||n.enabled,type:void 0===n.type?"dynamic":n.type,roundness:void 0===n.roundness?.5:n.roundness,forceDirection:void 0!==n.forceDirection&&n.forceDirection}},e.edges.smooth={enabled:void 0===n.enabled||n.enabled,type:o,roundness:void 0===n.roundness?.5:n.roundness,forceDirection:void 0!==n.forceDirection&&n.forceDirection}}this.body.emitter.emit("_forceDisableDynamicCurves",o)}return e}},{key:"positionInitially",value:function(e){if(!0!==this.options.hierarchical.enabled){this._resetRNG(this.initialRandomSeed);for(var t=e.length+50,o=0;o<e.length;o++){var n=e[o],i=2*Math.PI*this._rng();void 0===n.x&&(n.x=t*Math.cos(i)),void 0===n.y&&(n.y=t*Math.sin(i))}}}},{key:"layoutNetwork",value:function(){if(!0!==this.options.hierarchical.enabled&&!0===this.options.improvedLayout){for(var e=this.body.nodeIndices,t=0,o=0;o<e.length;o++)!0===this.body.nodes[e[o]].predefinedPosition&&(t+=1);if(t<.5*e.length){var n=0,i=this.options.clusterThreshold,r={clusterNodeProperties:{shape:"ellipse",label:"",group:"",font:{multi:!1}},clusterEdgeProperties:{label:"",font:{multi:!1},smooth:{enabled:!1}}};if(e.length>i){for(var s=e.length;e.length>i&&n<=10;){var a=e.length;if((n+=1)%3==0?this.body.modules.clustering.clusterBridges(r):this.body.modules.clustering.clusterOutliers(r),a==e.length&&n%3!=0)return this._declusterAll(),this.body.emitter.emit("_layoutFailed"),void console.info("This network could not be positioned by this version of the improved layout algorithm. Please disable improvedLayout for better performance.")}this.body.modules.kamadaKawai.setOptions({springLength:Math.max(150,2*s)})}n>10&&console.info("The clustering didn't succeed within the amount of interations allowed, progressing with partial result."),this.body.modules.kamadaKawai.solve(e,this.body.edgeIndices,!0),this._shiftToCenter();for(var l=0;l<e.length;l++){var u=this.body.nodes[e[l]];!1===u.predefinedPosition&&(u.x+=70*(.5-this._rng()),u.y+=70*(.5-this._rng()))}this._declusterAll(),this.body.emitter.emit("_repositionBezierNodes")}}}},{key:"_shiftToCenter",value:function(){for(var e=fp.getRangeCore(this.body.nodes,this.body.nodeIndices),t=fp.findCenter(e),o=0;o<this.body.nodeIndices.length;o++){var n=this.body.nodes[this.body.nodeIndices[o]];n.x-=t.x,n.y-=t.y}}},{key:"_declusterAll",value:function(){for(var e=!0;!0===e;){e=!1;for(var t=0;t<this.body.nodeIndices.length;t++)!0===this.body.nodes[this.body.nodeIndices[t]].isCluster&&(e=!0,this.body.modules.clustering.openCluster(this.body.nodeIndices[t],{},!1));!0===e&&this.body.emitter.emit("_dataChanged")}}},{key:"getSeed",value:function(){return this.initialRandomSeed}},{key:"setupHierarchicalLayout",value:function(){if(!0===this.options.hierarchical.enabled&&this.body.nodeIndices.length>0){var e,t,o=!1,n=!1;for(t in this.lastNodeOnLevel={},this.hierarchical=new wf,this.body.nodes)Object.prototype.hasOwnProperty.call(this.body.nodes,t)&&(void 0!==(e=this.body.nodes[t]).options.level?(o=!0,this.hierarchical.levels[t]=e.options.level):n=!0);if(!0===n&&!0===o)throw new Error("To use the hierarchical layout, nodes require either no predefined levels or levels have to be defined for all nodes.");if(!0===n){var i=this.options.hierarchical.sortMethod;"hubsize"===i?this._determineLevelsByHubsize():"directed"===i?this._determineLevelsDirected():"custom"===i&&this._determineLevelsCustomCallback()}for(var r in this.body.nodes)Object.prototype.hasOwnProperty.call(this.body.nodes,r)&&this.hierarchical.ensureLevel(r);var s=this._getDistribution();this._generateMap(),this._placeNodesByHierarchy(s),this._condenseHierarchy(),this._shiftToCenter()}}},{key:"_condenseHierarchy",value:function(){var e=this,t=!1,o={},n=function(t,o){var n=e.hierarchical.trees;for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&n[i]===t&&e.direction.shift(i,o)},i=function t(o,n){if(!n[o.id]&&(n[o.id]=!0,e.hierarchical.childrenReference[o.id])){var i=e.hierarchical.childrenReference[o.id];if(i.length>0)for(var r=0;r<i.length;r++)t(e.body.nodes[i[r]],n)}},r=function(t){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e9,n=1e9,i=1e9,r=1e9,s=-1e9;for(var a in t)if(Object.prototype.hasOwnProperty.call(t,a)){var l=e.body.nodes[a],u=e.hierarchical.levels[l.id],c=e.direction.getPosition(l),d=e._getSpaceAroundNode(l,t),h=Pr(d,2),p=h[0],f=h[1];n=Math.min(p,n),i=Math.min(f,i),u<=o&&(r=Math.min(c,r),s=Math.max(c,s))}return[r,s,n,i]},s=function(t,o){var n=e.hierarchical.getMaxLevel(t.id),i=e.hierarchical.getMaxLevel(o.id);return Math.min(n,i)},a=function(t,o,n){for(var i=e.hierarchical,r=0;r<o.length;r++){var s=i.distributionOrdering[o[r]];if(s.length>1)for(var a=0;a<s.length-1;a++){var l=s[a],u=s[a+1];i.hasSameParent(l,u)&&i.inSameSubNetwork(l,u)&&t(l,u,n)}}},l=function(o,n){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],l=e.direction.getPosition(o),u=e.direction.getPosition(n),c=Math.abs(u-l),d=e.options.hierarchical.nodeSpacing;if(c>d){var h={},p={};i(o,h),i(n,p);var f=s(o,n),v=r(h,f),g=r(p,f),b=v[1],m=g[0],y=g[2],j=Math.abs(b-m);if(j>d){var w=b-m+d;w<-y+d&&(w=-y+d),w<0&&(e._shiftBlock(n.id,w),t=!0,!0===a&&e._centerParent(n))}}},u=function(n,s){for(var a=s.id,l=s.edges,u=e.hierarchical.levels[s.id],c=e.options.hierarchical.levelSeparation*e.options.hierarchical.levelSeparation,d={},h=[],p=0;p<l.length;p++){var f=l[p];if(f.toId!=f.fromId){var v=f.toId==a?f.from:f.to;d[l[p].id]=v,e.hierarchical.levels[v.id]<u&&h.push(f)}}var g=function(t,o){for(var n=0,i=0;i<o.length;i++)if(void 0!==d[o[i].id]){var r=e.direction.getPosition(d[o[i].id])-t;n+=r/Math.sqrt(r*r+c)}return n},b=function(t,o){for(var n=0,i=0;i<o.length;i++)if(void 0!==d[o[i].id]){var r=e.direction.getPosition(d[o[i].id])-t;n-=c*Math.pow(r*r+c,-1.5)}return n},m=function(t,o){for(var n=e.direction.getPosition(s),i={},r=0;r<t;r++){var a=g(n,o),l=b(n,o);if(void 0!==i[n-=Math.max(-40,Math.min(40,Math.round(a/l)))])break;i[n]=r}return n},y=m(n,h);!function(n){var a=e.direction.getPosition(s);if(void 0===o[s.id]){var l={};i(s,l),o[s.id]=l}var u=r(o[s.id]),c=u[2],d=n-a,h=0;d>0?h=Math.min(d,u[3]-e.options.hierarchical.nodeSpacing):d<0&&(h=-Math.min(-d,c-e.options.hierarchical.nodeSpacing)),0!=h&&(e._shiftBlock(s.id,h),t=!0)}(y),function(o){var n=e.direction.getPosition(s),i=e._getSpaceAroundNode(s),r=Pr(i,2),a=r[0],l=o-n,u=n;l>0?u=Math.min(n+(r[1]-e.options.hierarchical.nodeSpacing),o):l<0&&(u=Math.max(n-(a-e.options.hierarchical.nodeSpacing),o)),u!==n&&(e.direction.setPosition(s,u),t=!0)}(y=m(n,l))};!0===this.options.hierarchical.blockShifting&&(function(o){var n=e.hierarchical.getLevels();n=rr(n).call(n);for(var i=0;i<5&&(t=!1,a(l,n,!0),!0===t);i++);}(),function(){for(var t in e.body.nodes)Object.prototype.hasOwnProperty.call(e.body.nodes,t)&&e._centerParent(e.body.nodes[t])}()),!0===this.options.hierarchical.edgeMinimization&&function(o){var n=e.hierarchical.getLevels();n=rr(n).call(n);for(var i=0;i<20;i++){t=!1;for(var r=0;r<n.length;r++)for(var s=e.hierarchical.distributionOrdering[n[r]],a=0;a<s.length;a++)u(1e3,s[a]);if(!0!==t)break}}(),!0===this.options.hierarchical.parentCentralization&&function(){var t=e.hierarchical.getLevels();t=rr(t).call(t);for(var o=0;o<t.length;o++)for(var n=e.hierarchical.distributionOrdering[t[o]],i=0;i<n.length;i++)e._centerParent(n[i])}(),function(){for(var t=function(){for(var t=[],o=0;o<e.hierarchical.numTrees();o++)t.push(e.direction.getTreeSize(o));return t}(),o=0,i=0;i<t.length-1;i++)n(i+1,o+=t[i].max-t[i+1].min+e.options.hierarchical.treeSpacing)}()}},{key:"_getSpaceAroundNode",value:function(e,t){var o=!0;void 0===t&&(o=!1);var n=this.hierarchical.levels[e.id];if(void 0!==n){var i=this.hierarchical.distributionIndex[e.id],r=this.direction.getPosition(e),s=this.hierarchical.distributionOrdering[n],a=1e9,l=1e9;if(0!==i){var u=s[i-1];(!0===o&&void 0===t[u.id]||!1===o)&&(a=r-this.direction.getPosition(u))}if(i!=s.length-1){var c=s[i+1];if(!0===o&&void 0===t[c.id]||!1===o){var d=this.direction.getPosition(c);l=Math.min(l,d-r)}}return[a,l]}return[0,0]}},{key:"_centerParent",value:function(e){if(this.hierarchical.parentReference[e.id])for(var t=this.hierarchical.parentReference[e.id],o=0;o<t.length;o++){var n=t[o],i=this.body.nodes[n],r=this.hierarchical.childrenReference[n];if(void 0!==r){var s=this._getCenterPosition(r),a=this.direction.getPosition(i),l=this._getSpaceAroundNode(i),u=Pr(l,2),c=u[0],d=u[1],h=a-s;(h<0&&Math.abs(h)<d-this.options.hierarchical.nodeSpacing||h>0&&Math.abs(h)<c-this.options.hierarchical.nodeSpacing)&&this.direction.setPosition(i,s)}}}},{key:"_placeNodesByHierarchy",value:function(e){for(var t in this.positionedNodes={},e)if(Object.prototype.hasOwnProperty.call(e,t)){var o,n=Hr(e[t]);n=this._indexArrayToNodes(n),Gc(o=this.direction).call(o,n);for(var i=0,r=0;r<n.length;r++){var s=n[r];if(void 0===this.positionedNodes[s.id]){var a=this.options.hierarchical.nodeSpacing,l=a*i;i>0&&(l=this.direction.getPosition(n[r-1])+a),this.direction.setPosition(s,l,t),this._validatePositionAndContinue(s,t,l),i++}}}}},{key:"_placeBranchNodes",value:function(e,t){var o,n=this.hierarchical.childrenReference[e];if(void 0!==n){for(var i=[],r=0;r<n.length;r++)i.push(this.body.nodes[n[r]]);Gc(o=this.direction).call(o,i);for(var s=0;s<i.length;s++){var a=i[s],l=this.hierarchical.levels[a.id];if(!(l>t&&void 0===this.positionedNodes[a.id]))return;var u,c=this.options.hierarchical.nodeSpacing;u=0===s?this.direction.getPosition(this.body.nodes[e]):this.direction.getPosition(i[s-1])+c,this.direction.setPosition(a,u,l),this._validatePositionAndContinue(a,l,u)}var d=this._getCenterPosition(i);this.direction.setPosition(this.body.nodes[e],d,t)}}},{key:"_validatePositionAndContinue",value:function(e,t,o){if(this.hierarchical.isTree){if(void 0!==this.lastNodeOnLevel[t]){var n=this.direction.getPosition(this.body.nodes[this.lastNodeOnLevel[t]]);if(o-n<this.options.hierarchical.nodeSpacing){var i=n+this.options.hierarchical.nodeSpacing-o,r=this._findCommonParent(this.lastNodeOnLevel[t],e.id);this._shiftBlock(r.withChild,i)}}this.lastNodeOnLevel[t]=e.id,this.positionedNodes[e.id]=!0,this._placeBranchNodes(e.id,t)}}},{key:"_indexArrayToNodes",value:function(e){for(var t=[],o=0;o<e.length;o++)t.push(this.body.nodes[e[o]]);return t}},{key:"_getDistribution",value:function(){var e,t,o={};for(e in this.body.nodes)if(Object.prototype.hasOwnProperty.call(this.body.nodes,e)){var n=void 0===this.hierarchical.levels[e]?0:this.hierarchical.levels[e];this.direction.fix(t=this.body.nodes[e],n),void 0===o[n]&&(o[n]={}),o[n][e]=t}return o}},{key:"_getActiveEdges",value:function(e){var t=this,o=[];return El(e.edges,function(e){var n;-1!==ui(n=t.body.edgeIndices).call(n,e.id)&&o.push(e)}),o}},{key:"_getHubSizes",value:function(){var e=this,t={};El(this.body.nodeIndices,function(o){var n=e._getActiveEdges(e.body.nodes[o]).length;t[n]=!0});var o=[];return El(t,function(e){o.push(Number(e))}),Gc(sf).call(sf,o,function(e,t){return t-e}),o}},{key:"_determineLevelsByHubsize",value:function(){for(var e=this,t=function(t,o){e.hierarchical.levelDownstream(t,o)},o=this._getHubSizes(),n=function(n){var i=o[n];if(0===i)return"break";El(e.body.nodeIndices,function(o){i===e._getActiveEdges(e.body.nodes[o]).length&&e._crawlNetwork(t,o)})},i=0;i<o.length&&"break"!==n(i);++i);}},{key:"_determineLevelsCustomCallback",value:function(){var e=this;this._crawlNetwork(function(t,o,n){var i=e.hierarchical.levels[t.id];void 0===i&&(i=e.hierarchical.levels[t.id]=1e5);var r=(fp.cloneOptions(t,"node"),fp.cloneOptions(o,"node"),void fp.cloneOptions(n,"edge"));e.hierarchical.levels[o.id]=i+r}),this.hierarchical.setMinLevelToZero(this.body.nodes)}},{key:"_determineLevelsDirected",value:function(){var e,t=this,o=dd(e=this.body.nodeIndices).call(e,function(e,o){return e.set(o,t.body.nodes[o]),e},new sc);this.hierarchical.levels="roots"===this.options.hierarchical.shakeTowards?function(e){return jf(function(t){var o,n;return bf(o=Si(n=t.edges).call(n,function(t){return e.has(t.toId)})).call(o,function(e){return e.from===t})},function(e,t){return t<e},"to",e)}(o):function(e){return jf(function(t){var o,n;return bf(o=Si(n=t.edges).call(n,function(t){return e.has(t.toId)})).call(o,function(e){return e.to===t})},function(e,t){return t>e},"from",e)}(o),this.hierarchical.setMinLevelToZero(this.body.nodes)}},{key:"_generateMap",value:function(){var e=this;this._crawlNetwork(function(t,o){e.hierarchical.levels[o.id]>e.hierarchical.levels[t.id]&&e.hierarchical.addRelation(t.id,o.id)}),this.hierarchical.checkIfTree()}},{key:"_crawlNetwork",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){},o=arguments.length>1?arguments[1]:void 0,n={},i=function o(i,r){if(void 0===n[i.id]){var s;e.hierarchical.setTreeIndex(i,r),n[i.id]=!0;for(var a=e._getActiveEdges(i),l=0;l<a.length;l++){var u=a[l];!0===u.connected&&i.id!=(s=u.toId==i.id?u.from:u.to).id&&(t(i,s,u),o(s,r))}}};if(void 0===o)for(var r=0,s=0;s<this.body.nodeIndices.length;s++){var a=this.body.nodeIndices[s];if(void 0===n[a]){var l=this.body.nodes[a];i(l,r),r+=1}}else{var u=this.body.nodes[o];if(void 0===u)return void console.error("Node not found:",o);i(u)}}},{key:"_shiftBlock",value:function(e,t){var o=this,n={};!function e(i){if(!n[i]){n[i]=!0,o.direction.shift(i,t);var r=o.hierarchical.childrenReference[i];if(void 0!==r)for(var s=0;s<r.length;s++)e(r[s])}}(e)}},{key:"_findCommonParent",value:function(e,t){var o=this,n={};return function e(t,n){var i=o.hierarchical.parentReference[n];if(void 0!==i)for(var r=0;r<i.length;r++){var s=i[r];t[s]=!0,e(t,s)}}(n,e),function e(t,n){var i=o.hierarchical.parentReference[n];if(void 0!==i)for(var r=0;r<i.length;r++){var s=i[r];if(void 0!==t[s])return{foundParent:s,withChild:n};var a=e(t,s);if(null!==a.foundParent)return a}return{foundParent:null,withChild:n}}(n,t)}},{key:"setDirectionStrategy",value:function(){this.direction="UD"===this.options.hierarchical.direction||"DU"===this.options.hierarchical.direction?new cf(this):new df(this)}},{key:"_getCenterPosition",value:function(e){for(var t=1e9,o=-1e9,n=0;n<e.length;n++){var i=this.direction.getPosition(void 0!==e[n].id?e[n]:this.body.nodes[e[n]]);t=Math.min(t,i),o=Math.max(o,i)}return.5*(t+o)}}]),e}();function Cf(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}var Ef=function(){function e(t,o,n,i){var r,s,a=this;Sn(this,e),this.body=t,this.canvas=o,this.selectionHandler=n,this.interactionHandler=i,this.editMode=!1,this.manipulationDiv=void 0,this.editModeDiv=void 0,this.closeDiv=void 0,this._domEventListenerCleanupQueue=[],this.temporaryUIFunctions={},this.temporaryEventFunctions=[],this.touchTime=0,this.temporaryIds={nodes:[],edges:[]},this.guiEnabled=!1,this.inMode=!1,this.selectedControlNode=void 0,this.options={},this.defaultOptions={enabled:!1,initiallyActive:!1,addNode:!0,addEdge:!0,editNode:void 0,editEdge:!0,deleteNode:!0,deleteEdge:!0,controlNodeStyle:{shape:"dot",size:6,color:{background:"#ff0000",border:"#3c3c3c",highlight:{background:"#07f968",border:"#3c3c3c"}},borderWidth:2,borderWidthSelected:2}},me(this.options,this.defaultOptions),this.body.emitter.on("destroy",function(){a._clean()}),this.body.emitter.on("_dataChanged",$(r=this._restore).call(r,this)),this.body.emitter.on("_resetData",$(s=this._restore).call(s,this))}return Ln(e,[{key:"_restore",value:function(){!1!==this.inMode&&(!0===this.options.initiallyActive?this.enableEditMode():this.disableEditMode())}},{key:"setOptions",value:function(e,t,o){void 0!==t&&(this.options.locale=void 0!==t.locale?t.locale:o.locale,this.options.locales=void 0!==t.locales?t.locales:o.locales),void 0!==e&&("boolean"==typeof e?this.options.enabled=e:(this.options.enabled=!0,yl(this.options,e)),!0===this.options.initiallyActive&&(this.editMode=!0),this._setup())}},{key:"toggleEditMode",value:function(){!0===this.editMode?this.disableEditMode():this.enableEditMode()}},{key:"enableEditMode",value:function(){this.editMode=!0,this._clean(),!0===this.guiEnabled&&(this.manipulationDiv.style.display="block",this.closeDiv.style.display="block",this.editModeDiv.style.display="none",this.showManipulatorToolbar())}},{key:"disableEditMode",value:function(){this.editMode=!1,this._clean(),!0===this.guiEnabled&&(this.manipulationDiv.style.display="none",this.closeDiv.style.display="none",this.editModeDiv.style.display="block",this._createEditButton())}},{key:"showManipulatorToolbar",value:function(){if(this._clean(),this.manipulationDOM={},!0===this.guiEnabled){var e,t;this.editMode=!0,this.manipulationDiv.style.display="block",this.closeDiv.style.display="block";var o=this.selectionHandler.getSelectedNodeCount(),n=this.selectionHandler.getSelectedEdgeCount(),i=o+n,r=this.options.locales[this.options.locale],s=!1;!1!==this.options.addNode&&(this._createAddNodeButton(r),s=!0),!1!==this.options.addEdge&&(!0===s?this._createSeperator(1):s=!0,this._createAddEdgeButton(r)),1===o&&"function"==typeof this.options.editNode?(!0===s?this._createSeperator(2):s=!0,this._createEditNodeButton(r)):1===n&&0===o&&!1!==this.options.editEdge&&(!0===s?this._createSeperator(3):s=!0,this._createEditEdgeButton(r)),0!==i&&(o>0&&!1!==this.options.deleteNode||0===o&&!1!==this.options.deleteEdge)&&(!0===s&&this._createSeperator(4),this._createDeleteButton(r)),this._bindElementEvents(this.closeDiv,$(e=this.toggleEditMode).call(e,this)),this._temporaryBindEvent("select",$(t=this.showManipulatorToolbar).call(t,this))}this.body.emitter.emit("_redraw")}},{key:"addNodeMode",value:function(){var e;if(!0!==this.editMode&&this.enableEditMode(),this._clean(),this.inMode="addNode",!0===this.guiEnabled){var t,o=this.options.locales[this.options.locale];this.manipulationDOM={},this._createBackButton(o),this._createSeperator(),this._createDescription(o.addDescription||this.options.locales.en.addDescription),this._bindElementEvents(this.closeDiv,$(t=this.toggleEditMode).call(t,this))}this._temporaryBindEvent("click",$(e=this._performAddNode).call(e,this))}},{key:"editNode",value:function(){var e=this;!0!==this.editMode&&this.enableEditMode(),this._clean();var t=this.selectionHandler.getSelectedNodes()[0];if(void 0!==t){if(this.inMode="editNode","function"!=typeof this.options.editNode)throw new Error("No function has been configured to handle the editing of nodes.");if(!0!==t.isCluster){var o=yl({},t.options,!1);if(o.x=t.x,o.y=t.y,2!==this.options.editNode.length)throw new Error("The function for edit does not support two arguments (data, callback)");this.options.editNode(o,function(t){null!=t&&"editNode"===e.inMode&&e.body.data.nodes.getDataSet().update(t),e.showManipulatorToolbar()})}else alert(this.options.locales[this.options.locale].editClusterError||this.options.locales.en.editClusterError)}else this.showManipulatorToolbar()}},{key:"addEdgeMode",value:function(){var e,t,o,n,i;if(!0!==this.editMode&&this.enableEditMode(),this._clean(),this.inMode="addEdge",!0===this.guiEnabled){var r,s=this.options.locales[this.options.locale];this.manipulationDOM={},this._createBackButton(s),this._createSeperator(),this._createDescription(s.edgeDescription||this.options.locales.en.edgeDescription),this._bindElementEvents(this.closeDiv,$(r=this.toggleEditMode).call(r,this))}this._temporaryBindUI("onTouch",$(e=this._handleConnect).call(e,this)),this._temporaryBindUI("onDragEnd",$(t=this._finishConnect).call(t,this)),this._temporaryBindUI("onDrag",$(o=this._dragControlNode).call(o,this)),this._temporaryBindUI("onRelease",$(n=this._finishConnect).call(n,this)),this._temporaryBindUI("onDragStart",$(i=this._dragStartEdge).call(i,this)),this._temporaryBindUI("onHold",function(){})}},{key:"editEdgeMode",value:function(){if(!0!==this.editMode&&this.enableEditMode(),this._clean(),this.inMode="editEdge","object"!==$r(this.options.editEdge)||"function"!=typeof this.options.editEdge.editWithoutDrag||(this.edgeBeingEditedId=this.selectionHandler.getSelectedEdgeIds()[0],void 0===this.edgeBeingEditedId)){if(!0===this.guiEnabled){var e,t=this.options.locales[this.options.locale];this.manipulationDOM={},this._createBackButton(t),this._createSeperator(),this._createDescription(t.editEdgeDescription||this.options.locales.en.editEdgeDescription),this._bindElementEvents(this.closeDiv,$(e=this.toggleEditMode).call(e,this))}if(this.edgeBeingEditedId=this.selectionHandler.getSelectedEdgeIds()[0],void 0!==this.edgeBeingEditedId){var o,n,i,r,s=this.body.edges[this.edgeBeingEditedId],a=this._getNewTargetNode(s.from.x,s.from.y),l=this._getNewTargetNode(s.to.x,s.to.y);this.temporaryIds.nodes.push(a.id),this.temporaryIds.nodes.push(l.id),this.body.nodes[a.id]=a,this.body.nodeIndices.push(a.id),this.body.nodes[l.id]=l,this.body.nodeIndices.push(l.id),this._temporaryBindUI("onTouch",$(o=this._controlNodeTouch).call(o,this)),this._temporaryBindUI("onTap",function(){}),this._temporaryBindUI("onHold",function(){}),this._temporaryBindUI("onDragStart",$(n=this._controlNodeDragStart).call(n,this)),this._temporaryBindUI("onDrag",$(i=this._controlNodeDrag).call(i,this)),this._temporaryBindUI("onDragEnd",$(r=this._controlNodeDragEnd).call(r,this)),this._temporaryBindUI("onMouseMove",function(){}),this._temporaryBindEvent("beforeDrawing",function(e){var t=s.edgeType.findBorderPositions(e);!1===a.selected&&(a.x=t.from.x,a.y=t.from.y),!1===l.selected&&(l.x=t.to.x,l.y=t.to.y)}),this.body.emitter.emit("_redraw")}else this.showManipulatorToolbar()}else{var u=this.body.edges[this.edgeBeingEditedId];this._performEditEdge(u.from.id,u.to.id)}}},{key:"deleteSelected",value:function(){var e=this;!0!==this.editMode&&this.enableEditMode(),this._clean(),this.inMode="delete";var t=this.selectionHandler.getSelectedNodeIds(),o=this.selectionHandler.getSelectedEdgeIds(),n=void 0;if(t.length>0){for(var i=0;i<t.length;i++)if(!0===this.body.nodes[t[i]].isCluster)return void alert(this.options.locales[this.options.locale].deleteClusterError||this.options.locales.en.deleteClusterError);"function"==typeof this.options.deleteNode&&(n=this.options.deleteNode)}else o.length>0&&"function"==typeof this.options.deleteEdge&&(n=this.options.deleteEdge);if("function"==typeof n){var r={nodes:t,edges:o};if(2!==n.length)throw new Error("The function for delete does not support two arguments (data, callback)");n(r,function(t){null!=t&&"delete"===e.inMode?(e.body.data.edges.getDataSet().remove(t.edges),e.body.data.nodes.getDataSet().remove(t.nodes),e.body.emitter.emit("startSimulation"),e.showManipulatorToolbar()):(e.body.emitter.emit("startSimulation"),e.showManipulatorToolbar())})}else this.body.data.edges.getDataSet().remove(o),this.body.data.nodes.getDataSet().remove(t),this.body.emitter.emit("startSimulation"),this.showManipulatorToolbar()}},{key:"_setup",value:function(){!0===this.options.enabled?(this.guiEnabled=!0,this._createWrappers(),!1===this.editMode?this._createEditButton():this.showManipulatorToolbar()):(this._removeManipulationDOM(),this.guiEnabled=!1)}},{key:"_createWrappers",value:function(){var e,t;void 0===this.manipulationDiv&&(this.manipulationDiv=document.createElement("div"),this.manipulationDiv.className="vis-manipulation",this.manipulationDiv.style.display=!0===this.editMode?"block":"none",this.canvas.frame.appendChild(this.manipulationDiv)),void 0===this.editModeDiv&&(this.editModeDiv=document.createElement("div"),this.editModeDiv.className="vis-edit-mode",this.editModeDiv.style.display=!0===this.editMode?"none":"block",this.canvas.frame.appendChild(this.editModeDiv)),void 0===this.closeDiv&&(this.closeDiv=document.createElement("button"),this.closeDiv.className="vis-close",this.closeDiv.setAttribute("aria-label",null!==(e=null===(t=this.options.locales[this.options.locale])||void 0===t?void 0:t.close)&&void 0!==e?e:this.options.locales.en.close),this.closeDiv.style.display=this.manipulationDiv.style.display,this.canvas.frame.appendChild(this.closeDiv))}},{key:"_getNewTargetNode",value:function(e,t){var o=yl({},this.options.controlNodeStyle);o.id="targetNode"+md(),o.hidden=!1,o.physics=!1,o.x=e,o.y=t;var n=this.body.functions.createNode(o);return n.shape.boundingBox={left:e,right:e,top:t,bottom:t},n}},{key:"_createEditButton",value:function(){var e;this._clean(),this.manipulationDOM={},dl(this.editModeDiv);var t=this._createButton("editMode","vis-edit vis-edit-mode",this.options.locales[this.options.locale].edit||this.options.locales.en.edit);this.editModeDiv.appendChild(t),this._bindElementEvents(t,$(e=this.toggleEditMode).call(e,this))}},{key:"_clean",value:function(){this.inMode=!1,!0===this.guiEnabled&&(dl(this.editModeDiv),dl(this.manipulationDiv),this._cleanupDOMEventListeners()),this._cleanupTemporaryNodesAndEdges(),this._unbindTemporaryUIs(),this._unbindTemporaryEvents(),this.body.emitter.emit("restorePhysics")}},{key:"_cleanupDOMEventListeners",value:function(){var e,t,o=function(e,t){var o;if(void 0===is||null==nn(e)){if(Gr(e)||(o=function(e,t){var o;if(e){if("string"==typeof e)return Cf(e,t);var n=Zr(o=Object.prototype.toString.call(e)).call(o,8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?gn(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Cf(e,t):void 0}}(e))){o&&(e=o);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){o=on(e)},n:function(){var e=o.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==o.return||o.return()}finally{if(a)throw r}}}}(er(e=this._domEventListenerCleanupQueue).call(e,0));try{for(o.s();!(t=o.n()).done;)(0,t.value)()}catch(e){o.e(e)}finally{o.f()}}},{key:"_removeManipulationDOM",value:function(){this._clean(),dl(this.manipulationDiv),dl(this.editModeDiv),dl(this.closeDiv),this.manipulationDiv&&this.canvas.frame.removeChild(this.manipulationDiv),this.editModeDiv&&this.canvas.frame.removeChild(this.editModeDiv),this.closeDiv&&this.canvas.frame.removeChild(this.closeDiv),this.manipulationDiv=void 0,this.editModeDiv=void 0,this.closeDiv=void 0}},{key:"_createSeperator",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.manipulationDOM["seperatorLineDiv"+e]=document.createElement("div"),this.manipulationDOM["seperatorLineDiv"+e].className="vis-separator-line",this.manipulationDiv.appendChild(this.manipulationDOM["seperatorLineDiv"+e])}},{key:"_createAddNodeButton",value:function(e){var t,o=this._createButton("addNode","vis-add",e.addNode||this.options.locales.en.addNode);this.manipulationDiv.appendChild(o),this._bindElementEvents(o,$(t=this.addNodeMode).call(t,this))}},{key:"_createAddEdgeButton",value:function(e){var t,o=this._createButton("addEdge","vis-connect",e.addEdge||this.options.locales.en.addEdge);this.manipulationDiv.appendChild(o),this._bindElementEvents(o,$(t=this.addEdgeMode).call(t,this))}},{key:"_createEditNodeButton",value:function(e){var t,o=this._createButton("editNode","vis-edit",e.editNode||this.options.locales.en.editNode);this.manipulationDiv.appendChild(o),this._bindElementEvents(o,$(t=this.editNode).call(t,this))}},{key:"_createEditEdgeButton",value:function(e){var t,o=this._createButton("editEdge","vis-edit",e.editEdge||this.options.locales.en.editEdge);this.manipulationDiv.appendChild(o),this._bindElementEvents(o,$(t=this.editEdgeMode).call(t,this))}},{key:"_createDeleteButton",value:function(e){var t,o=this._createButton("delete",this.options.rtl?"vis-delete-rtl":"vis-delete",e.del||this.options.locales.en.del);this.manipulationDiv.appendChild(o),this._bindElementEvents(o,$(t=this.deleteSelected).call(t,this))}},{key:"_createBackButton",value:function(e){var t,o=this._createButton("back","vis-back",e.back||this.options.locales.en.back);this.manipulationDiv.appendChild(o),this._bindElementEvents(o,$(t=this.showManipulatorToolbar).call(t,this))}},{key:"_createButton",value:function(e,t,o){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"vis-label";return this.manipulationDOM[e+"Div"]=document.createElement("button"),this.manipulationDOM[e+"Div"].className="vis-button "+t,this.manipulationDOM[e+"Label"]=document.createElement("div"),this.manipulationDOM[e+"Label"].className=n,this.manipulationDOM[e+"Label"].innerText=o,this.manipulationDOM[e+"Div"].appendChild(this.manipulationDOM[e+"Label"]),this.manipulationDOM[e+"Div"]}},{key:"_createDescription",value:function(e){this.manipulationDOM.descriptionLabel=document.createElement("div"),this.manipulationDOM.descriptionLabel.className="vis-none",this.manipulationDOM.descriptionLabel.innerText=e,this.manipulationDiv.appendChild(this.manipulationDOM.descriptionLabel)}},{key:"_temporaryBindEvent",value:function(e,t){this.temporaryEventFunctions.push({event:e,boundFunction:t}),this.body.emitter.on(e,t)}},{key:"_temporaryBindUI",value:function(e,t){if(void 0===this.body.eventListeners[e])throw new Error("This UI function does not exist. Typo? You tried: "+e+" possible are: "+Nn(Hr(this.body.eventListeners)));this.temporaryUIFunctions[e]=this.body.eventListeners[e],this.body.eventListeners[e]=t}},{key:"_unbindTemporaryUIs",value:function(){for(var e in this.temporaryUIFunctions)Object.prototype.hasOwnProperty.call(this.temporaryUIFunctions,e)&&(this.body.eventListeners[e]=this.temporaryUIFunctions[e],delete this.temporaryUIFunctions[e]);this.temporaryUIFunctions={}}},{key:"_unbindTemporaryEvents",value:function(){for(var e=0;e<this.temporaryEventFunctions.length;e++)this.body.emitter.off(this.temporaryEventFunctions[e].event,this.temporaryEventFunctions[e].boundFunction);this.temporaryEventFunctions=[]}},{key:"_bindElementEvents",value:function(e,t){var o=new ou(e,{});wp(o,t),this._domEventListenerCleanupQueue.push(function(){o.destroy()});var n=function(e){var o=e.keyCode,n=e.key;"Enter"!==n&&" "!==n&&13!==o&&32!==o||t()};e.addEventListener("keyup",n,!1),this._domEventListenerCleanupQueue.push(function(){e.removeEventListener("keyup",n,!1)})}},{key:"_cleanupTemporaryNodesAndEdges",value:function(){for(var e=0;e<this.temporaryIds.edges.length;e++){var t;this.body.edges[this.temporaryIds.edges[e]].disconnect(),delete this.body.edges[this.temporaryIds.edges[e]];var o,n=ui(t=this.body.edgeIndices).call(t,this.temporaryIds.edges[e]);-1!==n&&er(o=this.body.edgeIndices).call(o,n,1)}for(var i=0;i<this.temporaryIds.nodes.length;i++){var r;delete this.body.nodes[this.temporaryIds.nodes[i]];var s,a=ui(r=this.body.nodeIndices).call(r,this.temporaryIds.nodes[i]);-1!==a&&er(s=this.body.nodeIndices).call(s,a,1)}this.temporaryIds={nodes:[],edges:[]}}},{key:"_controlNodeTouch",value:function(e){this.selectionHandler.unselectAll(),this.lastTouch=this.body.functions.getPointer(e.center),this.lastTouch.translation=me({},this.body.view.translation)}},{key:"_controlNodeDragStart",value:function(){var e=this.selectionHandler._pointerToPositionObject(this.lastTouch),t=this.body.nodes[this.temporaryIds.nodes[0]],o=this.body.nodes[this.temporaryIds.nodes[1]],n=this.body.edges[this.edgeBeingEditedId];this.selectedControlNode=void 0;var i=t.isOverlappingWith(e),r=o.isOverlappingWith(e);!0===i?(this.selectedControlNode=t,n.edgeType.from=t):!0===r&&(this.selectedControlNode=o,n.edgeType.to=o),void 0!==this.selectedControlNode&&this.selectionHandler.selectObject(this.selectedControlNode),this.body.emitter.emit("_redraw")}},{key:"_controlNodeDrag",value:function(e){this.body.emitter.emit("disablePhysics");var t=this.body.functions.getPointer(e.center),o=this.canvas.DOMtoCanvas(t);void 0!==this.selectedControlNode?(this.selectedControlNode.x=o.x,this.selectedControlNode.y=o.y):this.interactionHandler.onDrag(e),this.body.emitter.emit("_redraw")}},{key:"_controlNodeDragEnd",value:function(e){var t=this.body.functions.getPointer(e.center),o=this.selectionHandler._pointerToPositionObject(t),n=this.body.edges[this.edgeBeingEditedId];if(void 0!==this.selectedControlNode){this.selectionHandler.unselectAll();for(var i=this.selectionHandler._getAllNodesOverlappingWith(o),r=void 0,s=i.length-1;s>=0;s--)if(i[s]!==this.selectedControlNode.id){r=this.body.nodes[i[s]];break}void 0!==r&&void 0!==this.selectedControlNode?!0===r.isCluster?alert(this.options.locales[this.options.locale].createEdgeError||this.options.locales.en.createEdgeError):this.selectedControlNode.id===this.body.nodes[this.temporaryIds.nodes[0]].id?this._performEditEdge(r.id,n.to.id):this._performEditEdge(n.from.id,r.id):(n.updateEdgeType(),this.body.emitter.emit("restorePhysics")),this.body.emitter.emit("_redraw")}}},{key:"_handleConnect",value:function(e){if((new Date).valueOf()-this.touchTime>100){this.lastTouch=this.body.functions.getPointer(e.center),this.lastTouch.translation=me({},this.body.view.translation),this.interactionHandler.drag.pointer=this.lastTouch,this.interactionHandler.drag.translation=this.lastTouch.translation;var t=this.selectionHandler.getNodeAt(this.lastTouch);if(void 0!==t)if(!0===t.isCluster)alert(this.options.locales[this.options.locale].createEdgeError||this.options.locales.en.createEdgeError);else{var o=this._getNewTargetNode(t.x,t.y);this.body.nodes[o.id]=o,this.body.nodeIndices.push(o.id);var n=this.body.functions.createEdge({id:"connectionEdge"+md(),from:t.id,to:o.id,physics:!1,smooth:{enabled:!0,type:"continuous",roundness:.5}});this.body.edges[n.id]=n,this.body.edgeIndices.push(n.id),this.temporaryIds.nodes.push(o.id),this.temporaryIds.edges.push(n.id)}this.touchTime=(new Date).valueOf()}}},{key:"_dragControlNode",value:function(e){var t=this.body.functions.getPointer(e.center),o=this.selectionHandler._pointerToPositionObject(t),n=void 0;void 0!==this.temporaryIds.edges[0]&&(n=this.body.edges[this.temporaryIds.edges[0]].fromId);for(var i=this.selectionHandler._getAllNodesOverlappingWith(o),r=void 0,s=i.length-1;s>=0;s--){var a;if(-1===ui(a=this.temporaryIds.nodes).call(a,i[s])){r=this.body.nodes[i[s]];break}}if(e.controlEdge={from:n,to:r?r.id:void 0},this.selectionHandler.generateClickEvent("controlNodeDragging",e,t),void 0!==this.temporaryIds.nodes[0]){var l=this.body.nodes[this.temporaryIds.nodes[0]];l.x=this.canvas._XconvertDOMtoCanvas(t.x),l.y=this.canvas._YconvertDOMtoCanvas(t.y),this.body.emitter.emit("_redraw")}else this.interactionHandler.onDrag(e)}},{key:"_finishConnect",value:function(e){var t=this.body.functions.getPointer(e.center),o=this.selectionHandler._pointerToPositionObject(t),n=void 0;void 0!==this.temporaryIds.edges[0]&&(n=this.body.edges[this.temporaryIds.edges[0]].fromId);for(var i=this.selectionHandler._getAllNodesOverlappingWith(o),r=void 0,s=i.length-1;s>=0;s--){var a;if(-1===ui(a=this.temporaryIds.nodes).call(a,i[s])){r=this.body.nodes[i[s]];break}}this._cleanupTemporaryNodesAndEdges(),void 0!==r&&(!0===r.isCluster?alert(this.options.locales[this.options.locale].createEdgeError||this.options.locales.en.createEdgeError):void 0!==this.body.nodes[n]&&void 0!==this.body.nodes[r.id]&&this._performAddEdge(n,r.id)),e.controlEdge={from:n,to:r?r.id:void 0},this.selectionHandler.generateClickEvent("controlNodeDragEnd",e,t),this.body.emitter.emit("_redraw")}},{key:"_dragStartEdge",value:function(e){this.selectionHandler.generateClickEvent("dragStart",e,this.lastTouch,void 0,!0)}},{key:"_performAddNode",value:function(e){var t=this,o={id:md(),x:e.pointer.canvas.x,y:e.pointer.canvas.y,label:"new"};if("function"==typeof this.options.addNode){if(2!==this.options.addNode.length)throw this.showManipulatorToolbar(),new Error("The function for add does not support two arguments (data,callback)");this.options.addNode(o,function(e){null!=e&&"addNode"===t.inMode&&t.body.data.nodes.getDataSet().add(e),t.showManipulatorToolbar()})}else this.body.data.nodes.getDataSet().add(o),this.showManipulatorToolbar()}},{key:"_performAddEdge",value:function(e,t){var o=this,n={from:e,to:t};if("function"==typeof this.options.addEdge){if(2!==this.options.addEdge.length)throw new Error("The function for connect does not support two arguments (data,callback)");this.options.addEdge(n,function(e){null!=e&&"addEdge"===o.inMode&&(o.body.data.edges.getDataSet().add(e),o.selectionHandler.unselectAll(),o.showManipulatorToolbar())})}else this.body.data.edges.getDataSet().add(n),this.selectionHandler.unselectAll(),this.showManipulatorToolbar()}},{key:"_performEditEdge",value:function(e,t){var o=this,n={id:this.edgeBeingEditedId,from:e,to:t,label:this.body.data.edges.get(this.edgeBeingEditedId).label},i=this.options.editEdge;if("object"===$r(i)&&(i=i.editWithoutDrag),"function"==typeof i){if(2!==i.length)throw new Error("The function for edit does not support two arguments (data, callback)");i(n,function(e){null==e||"editEdge"!==o.inMode?(o.body.edges[n.id].updateEdgeType(),o.body.emitter.emit("_redraw"),o.showManipulatorToolbar()):(o.body.data.edges.getDataSet().update(e),o.selectionHandler.unselectAll(),o.showManipulatorToolbar())})}else this.body.data.edges.getDataSet().update(n),this.selectionHandler.unselectAll(),this.showManipulatorToolbar()}}]),e}(),kf="string",_f="boolean",Af="number",Of="array",Mf="object",If=["arrow","bar","box","circle","crow","curve","diamond","image","inv_curve","inv_triangle","triangle","vee"],Nf={borderWidth:{number:Af},borderWidthSelected:{number:Af,undefined:"undefined"},brokenImage:{string:kf,undefined:"undefined"},chosen:{label:{boolean:_f,function:"function"},node:{boolean:_f,function:"function"},__type__:{object:Mf,boolean:_f}},color:{border:{string:kf},background:{string:kf},highlight:{border:{string:kf},background:{string:kf},__type__:{object:Mf,string:kf}},hover:{border:{string:kf},background:{string:kf},__type__:{object:Mf,string:kf}},__type__:{object:Mf,string:kf}},opacity:{number:Af,undefined:"undefined"},fixed:{x:{boolean:_f},y:{boolean:_f},__type__:{object:Mf,boolean:_f}},font:{align:{string:kf},color:{string:kf},size:{number:Af},face:{string:kf},background:{string:kf},strokeWidth:{number:Af},strokeColor:{string:kf},vadjust:{number:Af},multi:{boolean:_f,string:kf},bold:{color:{string:kf},size:{number:Af},face:{string:kf},mod:{string:kf},vadjust:{number:Af},__type__:{object:Mf,string:kf}},boldital:{color:{string:kf},size:{number:Af},face:{string:kf},mod:{string:kf},vadjust:{number:Af},__type__:{object:Mf,string:kf}},ital:{color:{string:kf},size:{number:Af},face:{string:kf},mod:{string:kf},vadjust:{number:Af},__type__:{object:Mf,string:kf}},mono:{color:{string:kf},size:{number:Af},face:{string:kf},mod:{string:kf},vadjust:{number:Af},__type__:{object:Mf,string:kf}},__type__:{object:Mf,string:kf}},group:{string:kf,number:Af,undefined:"undefined"},heightConstraint:{minimum:{number:Af},valign:{string:kf},__type__:{object:Mf,boolean:_f,number:Af}},hidden:{boolean:_f},icon:{face:{string:kf},code:{string:kf},size:{number:Af},color:{string:kf},weight:{string:kf,number:Af},__type__:{object:Mf}},id:{string:kf,number:Af},image:{selected:{string:kf,undefined:"undefined"},unselected:{string:kf,undefined:"undefined"},__type__:{object:Mf,string:kf}},imagePadding:{top:{number:Af},right:{number:Af},bottom:{number:Af},left:{number:Af},__type__:{object:Mf,number:Af}},label:{string:kf,undefined:"undefined"},labelHighlightBold:{boolean:_f},level:{number:Af,undefined:"undefined"},margin:{top:{number:Af},right:{number:Af},bottom:{number:Af},left:{number:Af},__type__:{object:Mf,number:Af}},mass:{number:Af},physics:{boolean:_f},scaling:{min:{number:Af},max:{number:Af},label:{enabled:{boolean:_f},min:{number:Af},max:{number:Af},maxVisible:{number:Af},drawThreshold:{number:Af},__type__:{object:Mf,boolean:_f}},customScalingFunction:{function:"function"},__type__:{object:Mf}},shadow:{enabled:{boolean:_f},color:{string:kf},size:{number:Af},x:{number:Af},y:{number:Af},__type__:{object:Mf,boolean:_f}},shape:{string:["custom","ellipse","circle","database","box","text","image","circularImage","diamond","dot","star","triangle","triangleDown","square","icon","hexagon"]},ctxRenderer:{function:"function"},shapeProperties:{borderDashes:{boolean:_f,array:Of},borderRadius:{number:Af},interpolation:{boolean:_f},useImageSize:{boolean:_f},useBorderWithImage:{boolean:_f},coordinateOrigin:{string:["center","top-left"]},__type__:{object:Mf}},size:{number:Af},title:{string:kf,dom:"dom",undefined:"undefined"},value:{number:Af,undefined:"undefined"},widthConstraint:{minimum:{number:Af},maximum:{number:Af},__type__:{object:Mf,boolean:_f,number:Af}},x:{number:Af},y:{number:Af},__type__:{object:Mf}},Sf={configure:{enabled:{boolean:_f},filter:{boolean:_f,string:kf,array:Of,function:"function"},container:{dom:"dom"},showButton:{boolean:_f},__type__:{object:Mf,boolean:_f,string:kf,array:Of,function:"function"}},edges:{arrows:{to:{enabled:{boolean:_f},scaleFactor:{number:Af},type:{string:If},imageHeight:{number:Af},imageWidth:{number:Af},src:{string:kf},__type__:{object:Mf,boolean:_f}},middle:{enabled:{boolean:_f},scaleFactor:{number:Af},type:{string:If},imageWidth:{number:Af},imageHeight:{number:Af},src:{string:kf},__type__:{object:Mf,boolean:_f}},from:{enabled:{boolean:_f},scaleFactor:{number:Af},type:{string:If},imageWidth:{number:Af},imageHeight:{number:Af},src:{string:kf},__type__:{object:Mf,boolean:_f}},__type__:{string:["from","to","middle"],object:Mf}},endPointOffset:{from:{number:Af},to:{number:Af},__type__:{object:Mf,number:Af}},arrowStrikethrough:{boolean:_f},background:{enabled:{boolean:_f},color:{string:kf},size:{number:Af},dashes:{boolean:_f,array:Of},__type__:{object:Mf,boolean:_f}},chosen:{label:{boolean:_f,function:"function"},edge:{boolean:_f,function:"function"},__type__:{object:Mf,boolean:_f}},color:{color:{string:kf},highlight:{string:kf},hover:{string:kf},inherit:{string:["from","to","both"],boolean:_f},opacity:{number:Af},__type__:{object:Mf,string:kf}},dashes:{boolean:_f,array:Of},font:{color:{string:kf},size:{number:Af},face:{string:kf},background:{string:kf},strokeWidth:{number:Af},strokeColor:{string:kf},align:{string:["horizontal","top","middle","bottom"]},vadjust:{number:Af},multi:{boolean:_f,string:kf},bold:{color:{string:kf},size:{number:Af},face:{string:kf},mod:{string:kf},vadjust:{number:Af},__type__:{object:Mf,string:kf}},boldital:{color:{string:kf},size:{number:Af},face:{string:kf},mod:{string:kf},vadjust:{number:Af},__type__:{object:Mf,string:kf}},ital:{color:{string:kf},size:{number:Af},face:{string:kf},mod:{string:kf},vadjust:{number:Af},__type__:{object:Mf,string:kf}},mono:{color:{string:kf},size:{number:Af},face:{string:kf},mod:{string:kf},vadjust:{number:Af},__type__:{object:Mf,string:kf}},__type__:{object:Mf,string:kf}},hidden:{boolean:_f},hoverWidth:{function:"function",number:Af},label:{string:kf,undefined:"undefined"},labelHighlightBold:{boolean:_f},length:{number:Af,undefined:"undefined"},physics:{boolean:_f},scaling:{min:{number:Af},max:{number:Af},label:{enabled:{boolean:_f},min:{number:Af},max:{number:Af},maxVisible:{number:Af},drawThreshold:{number:Af},__type__:{object:Mf,boolean:_f}},customScalingFunction:{function:"function"},__type__:{object:Mf}},selectionWidth:{function:"function",number:Af},selfReferenceSize:{number:Af},selfReference:{size:{number:Af},angle:{number:Af},renderBehindTheNode:{boolean:_f},__type__:{object:Mf}},shadow:{enabled:{boolean:_f},color:{string:kf},size:{number:Af},x:{number:Af},y:{number:Af},__type__:{object:Mf,boolean:_f}},smooth:{enabled:{boolean:_f},type:{string:["dynamic","continuous","discrete","diagonalCross","straightCross","horizontal","vertical","curvedCW","curvedCCW","cubicBezier"]},roundness:{number:Af},forceDirection:{string:["horizontal","vertical","none"],boolean:_f},__type__:{object:Mf,boolean:_f}},title:{string:kf,undefined:"undefined"},width:{number:Af},widthConstraint:{maximum:{number:Af},__type__:{object:Mf,boolean:_f,number:Af}},value:{number:Af,undefined:"undefined"},__type__:{object:Mf}},groups:{useDefaultGroups:{boolean:_f},__any__:Nf,__type__:{object:Mf}},interaction:{dragNodes:{boolean:_f},dragView:{boolean:_f},hideEdgesOnDrag:{boolean:_f},hideEdgesOnZoom:{boolean:_f},hideNodesOnDrag:{boolean:_f},hover:{boolean:_f},keyboard:{enabled:{boolean:_f},speed:{x:{number:Af},y:{number:Af},zoom:{number:Af},__type__:{object:Mf}},bindToWindow:{boolean:_f},__type__:{object:Mf,boolean:_f}},multiselect:{boolean:_f},navigationButtons:{boolean:_f},selectable:{boolean:_f},selectConnectedEdges:{boolean:_f},hoverConnectedEdges:{boolean:_f},tooltipDelay:{number:Af},zoomView:{boolean:_f},zoomSpeed:{number:Af},__type__:{object:Mf}},layout:{randomSeed:{undefined:"undefined",number:Af,string:kf},improvedLayout:{boolean:_f},clusterThreshold:{number:Af},hierarchical:{enabled:{boolean:_f},levelSeparation:{number:Af},nodeSpacing:{number:Af},treeSpacing:{number:Af},blockShifting:{boolean:_f},edgeMinimization:{boolean:_f},parentCentralization:{boolean:_f},direction:{string:["UD","DU","LR","RL"]},sortMethod:{string:["hubsize","directed"]},shakeTowards:{string:["leaves","roots"]},__type__:{object:Mf,boolean:_f}},__type__:{object:Mf}},manipulation:{enabled:{boolean:_f},initiallyActive:{boolean:_f},addNode:{boolean:_f,function:"function"},addEdge:{boolean:_f,function:"function"},editNode:{function:"function"},editEdge:{editWithoutDrag:{function:"function"},__type__:{object:Mf,boolean:_f,function:"function"}},deleteNode:{boolean:_f,function:"function"},deleteEdge:{boolean:_f,function:"function"},controlNodeStyle:Nf,__type__:{object:Mf,boolean:_f}},nodes:Nf,physics:{enabled:{boolean:_f},barnesHut:{theta:{number:Af},gravitationalConstant:{number:Af},centralGravity:{number:Af},springLength:{number:Af},springConstant:{number:Af},damping:{number:Af},avoidOverlap:{number:Af},__type__:{object:Mf}},forceAtlas2Based:{theta:{number:Af},gravitationalConstant:{number:Af},centralGravity:{number:Af},springLength:{number:Af},springConstant:{number:Af},damping:{number:Af},avoidOverlap:{number:Af},__type__:{object:Mf}},repulsion:{centralGravity:{number:Af},springLength:{number:Af},springConstant:{number:Af},nodeDistance:{number:Af},damping:{number:Af},__type__:{object:Mf}},hierarchicalRepulsion:{centralGravity:{number:Af},springLength:{number:Af},springConstant:{number:Af},nodeDistance:{number:Af},damping:{number:Af},avoidOverlap:{number:Af},__type__:{object:Mf}},maxVelocity:{number:Af},minVelocity:{number:Af},solver:{string:["barnesHut","repulsion","hierarchicalRepulsion","forceAtlas2Based"]},stabilization:{enabled:{boolean:_f},iterations:{number:Af},updateInterval:{number:Af},onlyDynamicEdges:{boolean:_f},fit:{boolean:_f},__type__:{object:Mf,boolean:_f}},timestep:{number:Af},adaptiveTimestep:{boolean:_f},wind:{x:{number:Af},y:{number:Af},__type__:{object:Mf}},__type__:{object:Mf,boolean:_f}},autoResize:{boolean:_f},clickToUse:{boolean:_f},locale:{string:kf},locales:{__any__:{any:"any"},__type__:{object:Mf}},height:{string:kf},width:{string:kf},__type__:{object:Mf}},Tf={nodes:{borderWidth:[1,0,10,1],borderWidthSelected:[2,0,10,1],color:{border:["color","#2B7CE9"],background:["color","#97C2FC"],highlight:{border:["color","#2B7CE9"],background:["color","#D2E5FF"]},hover:{border:["color","#2B7CE9"],background:["color","#D2E5FF"]}},opacity:[0,0,1,.1],fixed:{x:!1,y:!1},font:{color:["color","#343434"],size:[14,0,100,1],face:["arial","verdana","tahoma"],background:["color","none"],strokeWidth:[0,0,50,1],strokeColor:["color","#ffffff"]},hidden:!1,labelHighlightBold:!0,physics:!0,scaling:{min:[10,0,200,1],max:[30,0,200,1],label:{enabled:!1,min:[14,0,200,1],max:[30,0,200,1],maxVisible:[30,0,200,1],drawThreshold:[5,0,20,1]}},shadow:{enabled:!1,color:"rgba(0,0,0,0.5)",size:[10,0,20,1],x:[5,-30,30,1],y:[5,-30,30,1]},shape:["ellipse","box","circle","database","diamond","dot","square","star","text","triangle","triangleDown","hexagon"],shapeProperties:{borderDashes:!1,borderRadius:[6,0,20,1],interpolation:!0,useImageSize:!1},size:[25,0,200,1]},edges:{arrows:{to:{enabled:!1,scaleFactor:[1,0,3,.05],type:"arrow"},middle:{enabled:!1,scaleFactor:[1,0,3,.05],type:"arrow"},from:{enabled:!1,scaleFactor:[1,0,3,.05],type:"arrow"}},endPointOffset:{from:[0,-10,10,1],to:[0,-10,10,1]},arrowStrikethrough:!0,color:{color:["color","#848484"],highlight:["color","#848484"],hover:["color","#848484"],inherit:["from","to","both",!0,!1],opacity:[1,0,1,.05]},dashes:!1,font:{color:["color","#343434"],size:[14,0,100,1],face:["arial","verdana","tahoma"],background:["color","none"],strokeWidth:[2,0,50,1],strokeColor:["color","#ffffff"],align:["horizontal","top","middle","bottom"]},hidden:!1,hoverWidth:[1.5,0,5,.1],labelHighlightBold:!0,physics:!0,scaling:{min:[1,0,100,1],max:[15,0,100,1],label:{enabled:!0,min:[14,0,200,1],max:[30,0,200,1],maxVisible:[30,0,200,1],drawThreshold:[5,0,20,1]}},selectionWidth:[1.5,0,5,.1],selfReferenceSize:[20,0,200,1],selfReference:{size:[20,0,200,1],angle:[Math.PI/2,-6*Math.PI,6*Math.PI,Math.PI/8],renderBehindTheNode:!0},shadow:{enabled:!1,color:"rgba(0,0,0,0.5)",size:[10,0,20,1],x:[5,-30,30,1],y:[5,-30,30,1]},smooth:{enabled:!0,type:["dynamic","continuous","discrete","diagonalCross","straightCross","horizontal","vertical","curvedCW","curvedCCW","cubicBezier"],forceDirection:["horizontal","vertical","none"],roundness:[.5,0,1,.05]},width:[1,0,30,1]},layout:{hierarchical:{enabled:!1,levelSeparation:[150,20,500,5],nodeSpacing:[100,20,500,5],treeSpacing:[200,20,500,5],blockShifting:!0,edgeMinimization:!0,parentCentralization:!0,direction:["UD","DU","LR","RL"],sortMethod:["hubsize","directed"],shakeTowards:["leaves","roots"]}},interaction:{dragNodes:!0,dragView:!0,hideEdgesOnDrag:!1,hideEdgesOnZoom:!1,hideNodesOnDrag:!1,hover:!1,keyboard:{enabled:!1,speed:{x:[10,0,40,1],y:[10,0,40,1],zoom:[.02,0,.1,.005]},bindToWindow:!0},multiselect:!1,navigationButtons:!1,selectable:!0,selectConnectedEdges:!0,hoverConnectedEdges:!0,tooltipDelay:[300,0,1e3,25],zoomView:!0,zoomSpeed:[1,.1,2,.1]},manipulation:{enabled:!1,initiallyActive:!1},physics:{enabled:!0,barnesHut:{theta:[.5,.1,1,.05],gravitationalConstant:[-2e3,-3e4,0,50],centralGravity:[.3,0,10,.05],springLength:[95,0,500,5],springConstant:[.04,0,1.2,.005],damping:[.09,0,1,.01],avoidOverlap:[0,0,1,.01]},forceAtlas2Based:{theta:[.5,.1,1,.05],gravitationalConstant:[-50,-500,0,1],centralGravity:[.01,0,1,.005],springLength:[95,0,500,5],springConstant:[.08,0,1.2,.005],damping:[.4,0,1,.01],avoidOverlap:[0,0,1,.01]},repulsion:{centralGravity:[.2,0,10,.05],springLength:[200,0,500,5],springConstant:[.05,0,1.2,.005],nodeDistance:[100,0,500,5],damping:[.09,0,1,.01]},hierarchicalRepulsion:{centralGravity:[.2,0,10,.05],springLength:[100,0,500,5],springConstant:[.01,0,1.2,.005],nodeDistance:[120,0,500,5],damping:[.09,0,1,.01],avoidOverlap:[0,0,1,.01]},maxVelocity:[50,0,150,1],minVelocity:[.1,.01,.5,.01],solver:["barnesHut","forceAtlas2Based","repulsion","hierarchicalRepulsion"],timestep:[.5,.01,1,.01],wind:{x:[0,-10,10,.1],y:[0,-10,10,.1]}}},Df=function(e,t,o){var n;return!(!Yi(e).call(e,"physics")||!Yi(n=Tf.physics.solver).call(n,t)||o.physics.solver===t||"wind"===t)},Lf=Object.freeze({__proto__:null,configuratorHideOption:Df,allOptions:Sf,configureOptions:Tf}),Ff=function(){function e(){Sn(this,e)}return Ln(e,[{key:"getDistances",value:function(e,t,o){for(var n={},i=e.edges,r=0;r<t.length;r++){var s={};n[t[r]]=s;for(var a=0;a<t.length;a++)s[t[a]]=r==a?0:1e9}for(var l=0;l<o.length;l++){var u=i[o[l]];!0===u.connected&&void 0!==n[u.fromId]&&void 0!==n[u.toId]&&(n[u.fromId][u.toId]=1,n[u.toId][u.fromId]=1)}for(var c=t.length,d=0;d<c;d++)for(var h=t[d],p=n[h],f=0;f<c-1;f++)for(var v=t[f],g=n[v],b=f+1;b<c;b++){var m=t[b],y=n[m],j=Math.min(g[m],g[h]+p[m]);g[m]=j,y[v]=j}return n}}]),e}(),Rf=function(){function e(t,o,n){Sn(this,e),this.body=t,this.springLength=o,this.springConstant=n,this.distanceSolver=new Ff}return Ln(e,[{key:"setOptions",value:function(e){e&&(e.springLength&&(this.springLength=e.springLength),e.springConstant&&(this.springConstant=e.springConstant))}},{key:"solve",value:function(e,t){var o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=this.distanceSolver.getDistances(this.body,e,t);this._createL_matrix(n),this._createK_matrix(n),this._createE_matrix();for(var i=.01,r=1,s=0,a=Math.max(1e3,Math.min(10*this.body.nodeIndices.length,6e3)),l=5,u=1e9,c=0,d=0,h=0,p=0,f=0;u>i&&s<a;){s+=1;var v=this._getHighestEnergyNode(o),g=Pr(v,4);for(c=g[0],d=g[2],h=g[3],p=u=g[1],f=0;p>r&&f<l;){f+=1,this._moveNode(c,d,h);var b=this._getEnergy(c),m=Pr(b,3);p=m[0],d=m[1],h=m[2]}}}},{key:"_getHighestEnergyNode",value:function(e){for(var t=this.body.nodeIndices,o=this.body.nodes,n=0,i=t[0],r=0,s=0,a=0;a<t.length;a++){var l=t[a];if(!0!==o[l].predefinedPosition||!0===o[l].isCluster&&!0===e||!0!==o[l].options.fixed.x||!0!==o[l].options.fixed.y){var u=this._getEnergy(l),c=Pr(u,3),d=c[0];n<d&&(n=d,i=l,r=c[1],s=c[2])}}return[i,n,r,s]}},{key:"_getEnergy",value:function(e){var t=Pr(this.E_sums[e],2),o=t[0],n=t[1];return[Math.sqrt(Math.pow(o,2)+Math.pow(n,2)),o,n]}},{key:"_moveNode",value:function(e,t,o){for(var n=this.body.nodeIndices,i=this.body.nodes,r=0,s=0,a=0,l=i[e].x,u=i[e].y,c=this.K_matrix[e],d=this.L_matrix[e],h=0;h<n.length;h++){var p=n[h];if(p!==e){var f=i[p].x,v=i[p].y,g=c[p],b=d[p],m=1/Math.pow(Math.pow(l-f,2)+Math.pow(u-v,2),1.5);r+=g*(1-b*Math.pow(u-v,2)*m),s+=g*(b*(l-f)*(u-v)*m),a+=g*(1-b*Math.pow(l-f,2)*m)}}var y=(t/r+o/s)/(s/r-a/s);i[e].x+=-(s*y+t)/r,i[e].y+=y,this._updateE_matrix(e)}},{key:"_createL_matrix",value:function(e){var t=this.body.nodeIndices,o=this.springLength;this.L_matrix=[];for(var n=0;n<t.length;n++){this.L_matrix[t[n]]={};for(var i=0;i<t.length;i++)this.L_matrix[t[n]][t[i]]=o*e[t[n]][t[i]]}}},{key:"_createK_matrix",value:function(e){var t=this.body.nodeIndices,o=this.springConstant;this.K_matrix=[];for(var n=0;n<t.length;n++){this.K_matrix[t[n]]={};for(var i=0;i<t.length;i++)this.K_matrix[t[n]][t[i]]=o*Math.pow(e[t[n]][t[i]],-2)}}},{key:"_createE_matrix",value:function(){var e=this.body.nodeIndices,t=this.body.nodes;this.E_matrix={},this.E_sums={};for(var o=0;o<e.length;o++)this.E_matrix[e[o]]=[];for(var n=0;n<e.length;n++){for(var i=e[n],r=t[i].x,s=t[i].y,a=0,l=0,u=n;u<e.length;u++){var c=e[u];if(c!==i){var d=t[c].x,h=t[c].y,p=1/Math.sqrt(Math.pow(r-d,2)+Math.pow(s-h,2));this.E_matrix[i][u]=[this.K_matrix[i][c]*(r-d-this.L_matrix[i][c]*(r-d)*p),this.K_matrix[i][c]*(s-h-this.L_matrix[i][c]*(s-h)*p)],this.E_matrix[c][n]=this.E_matrix[i][u],a+=this.E_matrix[i][u][0],l+=this.E_matrix[i][u][1]}}this.E_sums[i]=[a,l]}}},{key:"_updateE_matrix",value:function(e){for(var t=this.body.nodeIndices,o=this.body.nodes,n=this.E_matrix[e],i=this.K_matrix[e],r=this.L_matrix[e],s=o[e].x,a=o[e].y,l=0,u=0,c=0;c<t.length;c++){var d=t[c];if(d!==e){var h=n[c],p=h[0],f=h[1],v=o[d].x,g=o[d].y,b=1/Math.sqrt(Math.pow(s-v,2)+Math.pow(a-g,2)),m=i[d]*(s-v-r[d]*(s-v)*b),y=i[d]*(a-g-r[d]*(a-g)*b);n[c]=[m,y],l+=m,u+=y;var j=this.E_sums[d];j[0]+=m-p,j[1]+=y-f}}this.E_sums[e]=[l,u]}}]),e}();function Pf(e,t,o){var n,i,r,s,a=this;if(!(this instanceof Pf))throw new SyntaxError("Constructor must be called with the new operator");this.options={},this.defaultOptions={locale:"en",locales:zu,clickToUse:!1},me(this.options,this.defaultOptions),this.body={container:e,nodes:{},nodeIndices:[],edges:{},edgeIndices:[],emitter:{on:$(n=this.on).call(n,this),off:$(i=this.off).call(i,this),emit:$(r=this.emit).call(r,this),once:$(s=this.once).call(s,this)},eventListeners:{onTap:function(){},onTouch:function(){},onDoubleTap:function(){},onHold:function(){},onDragStart:function(){},onDrag:function(){},onDragEnd:function(){},onMouseWheel:function(){},onPinch:function(){},onMouseMove:function(){},onRelease:function(){},onContext:function(){}},data:{nodes:null,edges:null},functions:{createNode:function(){},createEdge:function(){},getPointer:function(){}},modules:{},view:{scale:1,translation:{x:0,y:0}},selectionBox:{show:!1,position:{start:{x:0,y:0},end:{x:0,y:0}}}},this.bindEventListeners(),this.images=new Wu(function(){return a.body.emitter.emit("_requestRedraw")}),this.groups=new ac,this.canvas=new Cp(this.body),this.selectionHandler=new nf(this.body,this.canvas),this.interactionHandler=new Ip(this.body,this.canvas,this.selectionHandler),this.view=new kp(this.body,this.canvas),this.renderer=new yp(this.body,this.canvas),this.physics=new pp(this.body),this.layoutEngine=new xf(this.body),this.clustering=new gp(this.body),this.manipulation=new Ef(this.body,this.canvas,this.selectionHandler,this.interactionHandler),this.nodesHandler=new Ch(this.body,this.images,this.groups,this.layoutEngine),this.edgesHandler=new ip(this.body,this.images,this.groups),this.body.modules.kamadaKawai=new Rf(this.body,150,.05),this.body.modules.clustering=this.clustering,this.canvas._create(),this.setOptions(o),this.setData(t)}function Bf(e){for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(e[t].redundant=e[t].used,e[t].used=[])}function zf(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)&&e[t].redundant){for(var o=0;o<e[t].redundant.length;o++)e[t].redundant[o].parentNode.removeChild(e[t].redundant[o]);e[t].redundant=[]}}function Hf(e,t,o){var n;return Object.prototype.hasOwnProperty.call(t,e)?t[e].redundant.length>0?(n=t[e].redundant[0],t[e].redundant.shift()):(n=document.createElementNS("http://www.w3.org/2000/svg",e),o.appendChild(n)):(n=document.createElementNS("http://www.w3.org/2000/svg",e),t[e]={used:[],redundant:[]},o.appendChild(n)),t[e].used.push(n),n}ke(Pf.prototype),Pf.prototype.setOptions=function(e){var t=this;if(null===e&&(e=void 0),void 0!==e){if(!0===ru.validate(e,Sf)&&console.error("%cErrors have been found in the supplied options object.",iu),bl(["locale","locales","clickToUse"],this.options,e),void 0!==e.locale&&(e.locale=function(e,t){try{var o=t.split(/[-_ /]/,2),n=Pr(o,2),i=n[0],r=n[1],s=null!=i?i.toLowerCase():null,a=null!=r?r.toUpperCase():null;if(s&&a){var l,u=s+"-"+a;if(Object.prototype.hasOwnProperty.call(e,u))return u;console.warn(ns(l="Unknown variant ".concat(a," of language ")).call(l,s,"."))}if(s){var c=s;if(Object.prototype.hasOwnProperty.call(e,c))return c;console.warn("Unknown language ".concat(s))}return console.warn("Unknown locale ".concat(t,", falling back to English.")),"en"}catch(e){return console.error(e),console.warn("Unexpected error while normalizing locale ".concat(t,", falling back to English.")),"en"}}(e.locales||this.options.locales,e.locale)),e=this.layoutEngine.setOptions(e.layout,e),this.canvas.setOptions(e),this.groups.setOptions(e.groups),this.nodesHandler.setOptions(e.nodes),this.edgesHandler.setOptions(e.edges),this.physics.setOptions(e.physics),this.manipulation.setOptions(e.manipulation,e,this.options),this.interactionHandler.setOptions(e.interaction),this.renderer.setOptions(e.interaction),this.selectionHandler.setOptions(e.interaction),void 0!==e.groups&&this.body.emitter.emit("refreshNodes"),"configure"in e&&(this.configurator||(this.configurator=new tu(this,this.body.container,Tf,this.canvas.pixelRatio,Df)),this.configurator.setOptions(e.configure)),this.configurator&&!0===this.configurator.options.enabled){var o={nodes:{},edges:{},layout:{},interaction:{},manipulation:{},physics:{},global:{}};yl(o.nodes,this.nodesHandler.options),yl(o.edges,this.edgesHandler.options),yl(o.layout,this.layoutEngine.options),yl(o.interaction,this.selectionHandler.options),yl(o.interaction,this.renderer.options),yl(o.interaction,this.interactionHandler.options),yl(o.manipulation,this.manipulation.options),yl(o.physics,this.physics.options),yl(o.global,this.canvas.options),yl(o.global,this.options),this.configurator.setModuleOptions(o)}void 0!==e.clickToUse?!0===e.clickToUse?void 0===this.activator&&(this.activator=new Zl(this.canvas.frame),this.activator.on("change",function(){t.body.emitter.emit("activate")})):(void 0!==this.activator&&(this.activator.destroy(),delete this.activator),this.body.emitter.emit("activate")):this.body.emitter.emit("activate"),this.canvas.setSize(),this.body.emitter.emit("startSimulation")}},Pf.prototype._updateVisibleIndices=function(){var e=this.body.nodes,t=this.body.edges;for(var o in this.body.nodeIndices=[],this.body.edgeIndices=[],e)Object.prototype.hasOwnProperty.call(e,o)&&(this.clustering._isClusteredNode(o)||!1!==e[o].options.hidden||this.body.nodeIndices.push(e[o].id));for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var i=t[n],r=e[i.fromId],s=e[i.toId],a=void 0!==r&&void 0!==s;!this.clustering._isClusteredEdge(n)&&!1===i.options.hidden&&a&&!1===r.options.hidden&&!1===s.options.hidden&&this.body.edgeIndices.push(i.id)}},Pf.prototype.bindEventListeners=function(){var e=this;this.body.emitter.on("_dataChanged",function(){e.edgesHandler._updateState(),e.body.emitter.emit("_dataUpdated")}),this.body.emitter.on("_dataUpdated",function(){e.clustering._updateState(),e._updateVisibleIndices(),e._updateValueRange(e.body.nodes),e._updateValueRange(e.body.edges),e.body.emitter.emit("startSimulation"),e.body.emitter.emit("_requestRedraw")})},Pf.prototype.setData=function(e){if(this.body.emitter.emit("resetPhysics"),this.body.emitter.emit("_resetData"),this.selectionHandler.unselectAll(),e&&e.dot&&(e.nodes||e.edges))throw new SyntaxError('Data must contain either parameter "dot" or  parameter pair "nodes" and "edges", but not both.');if(this.setOptions(e&&e.options),e&&e.dot){console.warn("The dot property has been deprecated. Please use the static convertDot method to convert DOT into vis.network format and use the normal data format with nodes and edges. This converter is used like this: var data = vis.network.convertDot(dotString);");var t=Fu(e.dot);this.setData(t)}else if(e&&e.gephi){console.warn("The gephi property has been deprecated. Please use the static convertGephi method to convert gephi into vis.network format and use the normal data format with nodes and edges. This converter is used like this: var data = vis.network.convertGephi(gephiJson);");var o=Pu(e.gephi);this.setData(o)}else this.nodesHandler.setData(e&&e.nodes,!0),this.edgesHandler.setData(e&&e.edges,!0),this.body.emitter.emit("_dataChanged"),this.body.emitter.emit("_dataLoaded"),this.body.emitter.emit("initPhysics")},Pf.prototype.destroy=function(){for(var e in this.body.emitter.emit("destroy"),this.body.emitter.off(),this.off(),delete this.groups,delete this.canvas,delete this.selectionHandler,delete this.interactionHandler,delete this.view,delete this.renderer,delete this.physics,delete this.layoutEngine,delete this.clustering,delete this.manipulation,delete this.nodesHandler,delete this.edgesHandler,delete this.configurator,delete this.images,this.body.nodes)Object.prototype.hasOwnProperty.call(this.body.nodes,e)&&delete this.body.nodes[e];for(var t in this.body.edges)Object.prototype.hasOwnProperty.call(this.body.edges,t)&&delete this.body.edges[t];dl(this.body.container)},Pf.prototype._updateValueRange=function(e){var t,o=void 0,n=void 0,i=0;for(t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var r=e[t].getValue();void 0!==r&&(o=void 0===o?r:Math.min(r,o),n=void 0===n?r:Math.max(r,n),i+=r)}if(void 0!==o&&void 0!==n)for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&e[t].setValueRange(o,n,i)},Pf.prototype.isActive=function(){return!this.activator||this.activator.active},Pf.prototype.setSize=function(){return this.canvas.setSize.apply(this.canvas,arguments)},Pf.prototype.canvasToDOM=function(){return this.canvas.canvasToDOM.apply(this.canvas,arguments)},Pf.prototype.DOMtoCanvas=function(){return this.canvas.DOMtoCanvas.apply(this.canvas,arguments)},Pf.prototype.findNode=function(){return this.clustering.findNode.apply(this.clustering,arguments)},Pf.prototype.isCluster=function(){return this.clustering.isCluster.apply(this.clustering,arguments)},Pf.prototype.openCluster=function(){return this.clustering.openCluster.apply(this.clustering,arguments)},Pf.prototype.cluster=function(){return this.clustering.cluster.apply(this.clustering,arguments)},Pf.prototype.getNodesInCluster=function(){return this.clustering.getNodesInCluster.apply(this.clustering,arguments)},Pf.prototype.clusterByConnection=function(){return this.clustering.clusterByConnection.apply(this.clustering,arguments)},Pf.prototype.clusterByHubsize=function(){return this.clustering.clusterByHubsize.apply(this.clustering,arguments)},Pf.prototype.updateClusteredNode=function(){return this.clustering.updateClusteredNode.apply(this.clustering,arguments)},Pf.prototype.getClusteredEdges=function(){return this.clustering.getClusteredEdges.apply(this.clustering,arguments)},Pf.prototype.getBaseEdge=function(){return this.clustering.getBaseEdge.apply(this.clustering,arguments)},Pf.prototype.getBaseEdges=function(){return this.clustering.getBaseEdges.apply(this.clustering,arguments)},Pf.prototype.updateEdge=function(){return this.clustering.updateEdge.apply(this.clustering,arguments)},Pf.prototype.clusterOutliers=function(){return this.clustering.clusterOutliers.apply(this.clustering,arguments)},Pf.prototype.getSeed=function(){return this.layoutEngine.getSeed.apply(this.layoutEngine,arguments)},Pf.prototype.enableEditMode=function(){return this.manipulation.enableEditMode.apply(this.manipulation,arguments)},Pf.prototype.disableEditMode=function(){return this.manipulation.disableEditMode.apply(this.manipulation,arguments)},Pf.prototype.addNodeMode=function(){return this.manipulation.addNodeMode.apply(this.manipulation,arguments)},Pf.prototype.editNode=function(){return this.manipulation.editNode.apply(this.manipulation,arguments)},Pf.prototype.editNodeMode=function(){return console.warn("Deprecated: Please use editNode instead of editNodeMode."),this.manipulation.editNode.apply(this.manipulation,arguments)},Pf.prototype.addEdgeMode=function(){return this.manipulation.addEdgeMode.apply(this.manipulation,arguments)},Pf.prototype.editEdgeMode=function(){return this.manipulation.editEdgeMode.apply(this.manipulation,arguments)},Pf.prototype.deleteSelected=function(){return this.manipulation.deleteSelected.apply(this.manipulation,arguments)},Pf.prototype.getPositions=function(){return this.nodesHandler.getPositions.apply(this.nodesHandler,arguments)},Pf.prototype.getPosition=function(){return this.nodesHandler.getPosition.apply(this.nodesHandler,arguments)},Pf.prototype.storePositions=function(){return this.nodesHandler.storePositions.apply(this.nodesHandler,arguments)},Pf.prototype.moveNode=function(){return this.nodesHandler.moveNode.apply(this.nodesHandler,arguments)},Pf.prototype.getBoundingBox=function(){return this.nodesHandler.getBoundingBox.apply(this.nodesHandler,arguments)},Pf.prototype.getConnectedNodes=function(e){return void 0!==this.body.nodes[e]?this.nodesHandler.getConnectedNodes.apply(this.nodesHandler,arguments):this.edgesHandler.getConnectedNodes.apply(this.edgesHandler,arguments)},Pf.prototype.getConnectedEdges=function(){return this.nodesHandler.getConnectedEdges.apply(this.nodesHandler,arguments)},Pf.prototype.startSimulation=function(){return this.physics.startSimulation.apply(this.physics,arguments)},Pf.prototype.stopSimulation=function(){return this.physics.stopSimulation.apply(this.physics,arguments)},Pf.prototype.stabilize=function(){return this.physics.stabilize.apply(this.physics,arguments)},Pf.prototype.getSelection=function(){return this.selectionHandler.getSelection.apply(this.selectionHandler,arguments)},Pf.prototype.setSelection=function(){return this.selectionHandler.setSelection.apply(this.selectionHandler,arguments)},Pf.prototype.getSelectedNodes=function(){return this.selectionHandler.getSelectedNodeIds.apply(this.selectionHandler,arguments)},Pf.prototype.getSelectedEdges=function(){return this.selectionHandler.getSelectedEdgeIds.apply(this.selectionHandler,arguments)},Pf.prototype.getNodeAt=function(){var e=this.selectionHandler.getNodeAt.apply(this.selectionHandler,arguments);return void 0!==e&&void 0!==e.id?e.id:e},Pf.prototype.getEdgeAt=function(){var e=this.selectionHandler.getEdgeAt.apply(this.selectionHandler,arguments);return void 0!==e&&void 0!==e.id?e.id:e},Pf.prototype.selectNodes=function(){return this.selectionHandler.selectNodes.apply(this.selectionHandler,arguments)},Pf.prototype.selectEdges=function(){return this.selectionHandler.selectEdges.apply(this.selectionHandler,arguments)},Pf.prototype.unselectAll=function(){this.selectionHandler.unselectAll.apply(this.selectionHandler,arguments),this.redraw()},Pf.prototype.redraw=function(){return this.renderer.redraw.apply(this.renderer,arguments)},Pf.prototype.getScale=function(){return this.view.getScale.apply(this.view,arguments)},Pf.prototype.getViewPosition=function(){return this.view.getViewPosition.apply(this.view,arguments)},Pf.prototype.fit=function(){return this.view.fit.apply(this.view,arguments)},Pf.prototype.moveTo=function(){return this.view.moveTo.apply(this.view,arguments)},Pf.prototype.focus=function(){return this.view.focus.apply(this.view,arguments)},Pf.prototype.releaseNode=function(){return this.view.releaseNode.apply(this.view,arguments)},Pf.prototype.getOptionsFromConfigurator=function(){var e={};return this.configurator&&(e=this.configurator.getOptions.apply(this.configurator)),e};var Wf=Object.freeze({__proto__:null,prepareElements:Bf,cleanupElements:zf,resetElements:function(e){Bf(e),zf(e),Bf(e)},getSVGElement:Hf,getDOMElement:function(e,t,o,n){var i;return Object.prototype.hasOwnProperty.call(t,e)?t[e].redundant.length>0?(i=t[e].redundant[0],t[e].redundant.shift()):(i=document.createElement(e),void 0!==n?o.insertBefore(i,n):o.appendChild(i)):(i=document.createElement(e),t[e]={used:[],redundant:[]},void 0!==n?o.insertBefore(i,n):o.appendChild(i)),t[e].used.push(i),i},drawPoint:function(e,t,o,n,i,r){var s;if("circle"==o.style?((s=Hf("circle",n,i)).setAttributeNS(null,"cx",e),s.setAttributeNS(null,"cy",t),s.setAttributeNS(null,"r",.5*o.size)):((s=Hf("rect",n,i)).setAttributeNS(null,"x",e-.5*o.size),s.setAttributeNS(null,"y",t-.5*o.size),s.setAttributeNS(null,"width",o.size),s.setAttributeNS(null,"height",o.size)),void 0!==o.styles&&s.setAttributeNS(null,"style",o.styles),s.setAttributeNS(null,"class",o.className+" vis-point"),r){var a=Hf("text",n,i);r.xOffset&&(e+=r.xOffset),r.yOffset&&(t+=r.yOffset),r.content&&(a.textContent=r.content),r.className&&a.setAttributeNS(null,"class",r.className+" vis-label"),a.setAttributeNS(null,"x",e),a.setAttributeNS(null,"y",t)}return s},drawBar:function(e,t,o,n,i,r,s,a){if(0!=n){n<0&&(t-=n*=-1);var l=Hf("rect",r,s);l.setAttributeNS(null,"x",e-.5*o),l.setAttributeNS(null,"y",t),l.setAttributeNS(null,"width",o),l.setAttributeNS(null,"height",n),l.setAttributeNS(null,"class",i),a&&l.setAttributeNS(null,"style",a)}}}),Vf={Images:Wu,dotparser:Ru,gephiParser:Bu,allOptions:Lf,convertDot:Fu,convertGephi:Pu},Uf=Object.freeze({__proto__:null,network:Vf,DOMutil:Wf,util:su,data:Dd,Hammer:ou,keycharm:Ap,DataSet:Id,DataView:Nd,Queue:Ad,Network:Pf});e.DOMutil=Wf,e.DataSet=Id,e.DataView=Nd,e.Hammer=ou,e.Network=Pf,e.Queue=Ad,e.data=Dd,e.default=Uf,e.keycharm=Ap,e.network=Vf,e.util=su,Object.defineProperty(e,"__esModule",{value:!0})});